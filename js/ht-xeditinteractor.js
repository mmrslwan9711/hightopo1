!function(r,h,L){"use strict";var Z="ht",p=r[Z],y=p.Default,Q=p.graph,B=y.getInternal(),C=B.ui(),S=C.NodeUI.prototype,a=C.ShapeUI.prototype,A=Q.GraphView,F=A.prototype,O=C.EdgeUI.prototype,I=p.Node,M=p.Shape,k=p.Edge,Y=p.Group,w=y.isTouchable,K=y.isTouchEvent,D=y.preventDefault,e=r.setTimeout,o=y.grow,f=y.isDragging,g=y.getDistance,b=null,j=p.List,X="undefined"!=typeof Float32Array?Float32Array:Array,U=Math,$=U.PI,s="Crossing",t="No Crossing",d=$/2,v=2*$,m=U.atan2,T=U.sqrt,n=U.pow,V=U.sin,c=U.cos,H=U.min,J=U.max,R=U.abs,q=U.ceil,E=U.round,N=y.unionPoint,x=y.unionRect,G=y.containsPoint,W=y.clone,l="rgb(52, 152, 219)",P="red",_={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},u={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var L=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],i=0;i<L.length;i++){var K=L[i];K=0===i%2?K/400*u.width:K/100*u.height,L[i]=K}return u.width>120&&(L[4]=u.width-26,L[6]=u.width-40,L[10]=u.width-40,L[12]=u.width-26,L[18]=33),L}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},z={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:l,rotation:.61},{type:"circle",rect:[200,120,70,70],background:l,rotation:.61},{type:"circle",rect:[200,220,70,70],background:l,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:l},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:l}]},i={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:P,rotation:.61}]},Jl={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:l},{type:"circle",rect:[0,210,90,90],background:l},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:l}]},wm={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:P},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:P}]},Ik={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:l}]},gj={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:P}]},lg={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},ee={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},De=function(z){var T=z.touches[0];return T?T:z.changedTouches[0]},_d=function(F,M,T,x){return m(x-M,T-F)},Xb=function(n,M){return{x:n.x*M,y:n.y*M}},Rp=function(N,z){N.each(function(l){return N.isSelected(l)?z(l):void 0})},Wm=function(m,o){m.reverseEach(function(t){return m.isSelected(t)?o(t):void 0})},Jq=function(f,C,Z){var k,v,$,l,u,z=this,A=C,c=z.gv;if(f instanceof M){$=f.getSegments();var R=c.getDataUI(f);u=R._55O.$15l,$&&$.size()||($=ck(u)),f.isClosePath()&&$.indexOf(5)<0&&($=new j($._as),$.add(5)),k=ql(f,R,A),v=u[k]}else{var g=c.getDataUI(f);u=dk(g,f.s("edge.points")),$=f.s("edge.segments"),$&&$.size()||($=ck(u)),u=u._as,k=ql(f,g,A),v=u[k]}if($&&(l=$.get(A)),2===l||1===l||5===l){var W=u[k+1];5===l&&(W=u[0]);var E=kp(v,Z,W);return E}return Z},Tp=function(A,V,b,J){var R=V/2,M=b/2,Q=Nd(A,-R,-M,J),z=Nd(A,R,-M,J),c=Nd(A,-R,M,J),U=Nd(A,R,M,J),n=Nd(A,0,-M,J),C=Nd(A,R,0,J),X=Nd(A,0,M,J),p=Nd(A,-R,0,J);return[Q,z,c,U,n,C,X,p]},kp=function(E,F,q){var t={x:F.x-E.x,y:F.y-E.y},Q={x:q.x-E.x,y:q.y-E.y},I=T(n(q.x-E.x,2)+n(q.y-E.y,2)),p={x:Q.x/I,y:Q.y/I},C=t.x*p.x+t.y*p.y,o={x:p.x*C,y:p.y*C};return{x:E.x+o.x,y:E.y+o.y}},Nd=function(q,m,D,y){var O=c(y)*m-V(y)*D,j=V(y)*m+c(y)*D;return q?{x:q.x+O,y:q.y+j}:{x:O,y:j}},ln=function(l,L){return L>2*l?l:L/2},xn=function(C,j,c,O){var d=g(C,j);return c=O?H(c,d):ln(c,d),d?c/=d:c=0,{x:C.x+(j.x-C.x)*c,y:C.y+(j.y-C.y)*c}},ri=function(t,J){var h,w,o=t.gv,m=t._data,O=m._40I,G=m._41I,K=m.s("edge.offset"),W=m.s("edge.source.position"),y=m.s("edge.target.position"),u=m.s("edge.source.offset.x"),b=m.s("edge.source.offset.y"),S=m.s("edge.target.offset.x"),q=m.s("edge.target.offset.y"),d=m.s("edge.source.anchor.x"),C=m.s("edge.source.anchor.y"),l=m.s("edge.target.anchor.x"),A=m.s("edge.target.anchor.y");if(J?(h=B.getEdgeAgentPosition(o,O,W,u,b,d,C),w=B.getEdgeAgentPosition(o,G,y,S,q,l,A)):(h=B.getEdgeAgentPosition(o,O,W,0,0,d,C),w=B.getEdgeAgentPosition(o,G,y,0,0,l,A)),"points"===m.s("edge.type")&&K&&!m.s("edge.center")&&h){var p=m.s("edge.points")||new j,Z=p.size(),Q=xn(h,Z?p.get(0):w,K,Z),n=xn(w,Z?p.get(Z-1):h,K,Z);h=Q,w=n}return[h,w]},dk=function($,l,v){var A=$._78o,W=$._data,G=W.s("edge.type"),U=[A.sourcePoint,A.targetPoint];return"points"===G?v&&(U=ri($)):U=A.center?G?v?ri($):ri($,!0):v?ri($):[A.c1,A.c2]:v?ri($):ri($,!0),l=new j(l?l._as:b),l.add(U[0],0),l.add(U[1]),l},Xm=function($){return $=new j($._as),$.removeAt(0),$.removeAt($.size()-1),$},ck=function(g){g._as||(g=new j(g));var z=new j;z.add(1);for(var v=1;v<g.size();v++)z.add(2);return z},Gq=function(U,P){return{x:(U.x+P.x)/2,y:(U.y+P.y)/2}},te=function(b,H){return{x:b.x+1*(H.x-b.x)/4,y:b.y+1*(H.y-b.y)/4}},hm=function(I,q){return{x:I.x+3*(q.x-I.x)/4,y:I.y+3*(q.y-I.y)/4}},ao=function(s,Q,p,R){var O=Q.x+Q.width/2,C=Q.y+Q.height/2,$=T(O*O+C*C),A=m(C,O)+p;return{x:R.x+$*c(A),y:R.y+$*V(A)}},Nl=F.validateImpl,jp=F.isRectEditable,Uo=F.isPointEditable,rn=F._42,Lg=a._79o,fr=O._79o,$d=a._48O,Un=a._47O,qp=S._48O,Nf=S._80o,Qp=a._80o,ec=S.getSelectWidth,lf=S._47O,wh=O._47O,Ag=F.isEditable,Og=["northwest","north","northeast","east","southeast","south","southwest","west"],wf=function(d,m,p,L,Q,C,o,J,M,v){var s=d.x,l=d.y,k=d.width,n=d.height,Z={x:s+k/2,y:l+n/2};L=L||0,m=Nd(Z,m.x-Z.x,m.y-Z.y,-L),o&&!J&&(m.x+=M,m.y+=v);var e=.01;if("northwest"===p?(m.x+Q>s+k-e&&(m.x=s+k-Q-e),m.y+Q>l+n-e&&(m.y=l+n-Q-e),d=N(m,{x:s+k,y:l+n})):"north"===p?(m.y+Q>l+n-e&&(m.y=l+n-Q-e),d=N({x:s,y:m.y},{x:s+k,y:l+n})):"northeast"===p?(m.x<s+Q+e&&(m.x=s+Q+e),m.y+Q>l+n-e&&(m.y=l+n-Q-e),d=N({x:s,y:m.y},{x:m.x,y:l+n})):"west"===p?(m.x+Q>s+k-e&&(m.x=s+k-Q-e),d=N({x:m.x,y:l},{x:s+k,y:l+n})):"east"===p?(m.x<s+Q+e&&(m.x=s+Q+e),d=N({x:s,y:l},{x:m.x,y:l+n})):"southwest"===p?(m.x+Q>s+k-e&&(m.x=s+k-Q-e),m.y<l+Q+e&&(m.y=l+Q+e),d=N({x:m.x,y:l},{x:s+k,y:m.y})):"south"===p?(m.y<l+Q+e&&(m.y=l+Q+e),d=N({x:s,y:l},{x:s+k,y:m.y})):"southeast"===p&&(m.x<s+Q+e&&(m.x=s+Q+e),m.y<l+Q+e&&(m.y=l+Q+e),d=N({x:s,y:l},m)),"keepRatio"===C&&(!o&&J||o&&!J)&&("northeast"===p||"southeast"===p||"northwest"===p||"southwest"===p)){var O=d.width,w=d.height,D=O/k,V=w/n,K=H(D,V);d.width=k*K,d.height=n*K,"northeast"===p?d.y=l+(n-d.height):"northwest"===p?(d.y=l+(n-d.height),d.x=s+(k-d.width)):"southwest"===p&&(d.x=s+(k-d.width))}d.x-=Z.x,d.y-=Z.y;var I=ao(b,d,L,Z);return d.x=I.x-d.width/2,d.y=I.y-d.height/2,d},Bd=function(q,J,R,d){var o=q.getRotation(),l=J,T=l.x,Y=l.y,P=l.width,O=l.height,h={x:T+l.width/2,y:Y+l.height/2};d=Nd(h,d.x-h.x,d.y-h.y,-o),"northwest"===R?l=N(d,{x:T+P,y:Y+O}):"north"===R?l=N({x:T,y:d.y},{x:T+P,y:Y+O}):"northeast"===R?l=N({x:T,y:d.y},{x:d.x,y:Y+O}):"west"===R?l=N({x:d.x,y:Y},{x:T+P,y:Y+O}):"east"===R?l=N({x:T,y:Y},{x:d.x,y:Y+O}):"southwest"===R?l=N({x:d.x,y:Y},{x:T+P,y:d.y}):"south"===R?l=N({x:T,y:Y},{x:T+P,y:d.y}):"southeast"===R&&(l=N({x:T,y:Y},d)),q.setRect(l),l.x-=h.x,l.y-=h.y;var j=ao(q,l,o,h);q.p(j.x,j.y)},Lf=function(k,B,r,$,G,o,a,N){var e=b;o?(e=Nd(b,G.x-B.x,G.y-B.y,-r),e.x-=a.x,e.y-=a.y):e=Nd(b,G.x-B.x,G.y-B.y,0);var t={x:B.x+e.x,y:B.y+e.y};N&&(t=N(t.x,t.y)),t.e=k.getPoints().get($).e,k.setPoint($,t);var Q=k.getWidth(),Z=k.getHeight(),d=k.p().x-Q/2,f=k.p().y-Z/2;d-=B.x,f-=B.y;var X=ao(k,{x:d,y:f,width:Q,height:Z},r,B);k.p(X.x,X.y)},ql=function(H,J,P){var N,X;if(H instanceof M?(N=H.getPoints(),X=H.getSegments()):H instanceof k&&"points"===H.s("edge.type")&&(N=H.s("edge.points"),X=H.s("edge.segments"),N=dk(J,N)),X&&X.size()||(X=ck(N)),H instanceof M&&H.isClosePath()&&X.indexOf(5)<0&&(X=new j(X._as),X.add(5)),X)for(var v=-1,a=0;a<X.size();a++){if(a===P)return v;var F=X.get(a);1===F?v+=1:2===F?v+=1:3===F?v+=2:4===F&&(v+=3)}},go=function(r,O,v){var H,G;if(r instanceof M?(H=r.getPoints(),G=r.getSegments()):r instanceof k&&"points"===r.s("edge.type")&&(H=r.s("edge.points"),G=r.s("edge.segments"),H=dk(O,H)),G&&G.size()||(G=ck(H)),G)for(var P=-1,F=0;F<G.size();F++){var Z=G.get(F);if(1===Z?P+=1:2===Z?P+=1:3===Z?P+=2:4===Z&&(P+=3),P===v)return F}},dj=function(w,P){var F=[w[0]-P[0],w[1]-P[1],w[2]-P[2]];return F},Gc=function(){var h=new X(16);return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},Zn=function(H,U){var b=H[0],B=H[1],A=H[2];return H[0]=U[0]*b+U[4]*B+U[8]*A+U[12],H[1]=U[1]*b+U[5]*B+U[9]*A+U[13],H[2]=U[2]*b+U[6]*B+U[10]*A+U[14],H},dq=function(L,m){if(m){var P=V(m),W=c(m),E=L[0],s=L[1],e=L[2],u=L[3],y=L[8],o=L[9],b=L[10],w=L[11];L[0]=E*W-y*P,L[1]=s*W-o*P,L[2]=e*W-b*P,L[3]=u*W-w*P,L[8]=E*P+y*W,L[9]=s*P+o*W,L[10]=e*P+b*W,L[11]=u*P+w*W}},Ym=function(J,Z){for(var o=J.s("grid.row.count"),u=J.s("grid.column.count"),M=0;o>M;M++)for(var Y=0;u>Y;Y++){var g=J.getCellRect(M,Y);if(G(g,Z))return{rowIndex:M,columnIndex:Y,rect:g,grid:J}}return null},Iq=function(S,N,C,Y,p,Q){var l={},D=C-S,t=Y-N,q=U.sqrt(D*D+t*t),a=D/q,f=t/q,k=(-S+p)*a+(-N+Q)*f;return 0>=k?(l.x=S,l.y=N):k>=q?(l.x=C,l.y=Y):(l.x=S+k*a,l.y=N+k*f),D=p-l.x,t=Q-l.y,l.z=U.sqrt(D*D+t*t),l},Wg=function($,I){var n,S,A,r,F,e,B,P,O=$.getPoints(),D=$.getSegments(),X=$.p(),y=$.getRotation();if(!D||!(D.indexOf(3)>0||D.indexOf(4)>0)){for(P=0;P<=O.size()-1;P++)if(P===O.size()-1?(F=O.get(0),r=O.get(P)):(r=O.get(P),F=O.get(P+1)),r=Nd(X,r.x-X.x,r.y-X.y,y),F=Nd(X,F.x-X.x,F.y-X.y,y),e=Iq(r.x,r.y,F.x,F.y,I.x,I.y),B=e.z,B<($.s("shape.border.width")||10)){S=r,A=F,n=P;break}if(n!=b){var Y=Iq(S.x,S.y,A.x,A.y,I.x,I.y),c=g(S,Y);return{attachIndex:n,attachOffset:c}}}},Sh=function(c){for(var x=c._data,C=x.p(),w=x.getRotation(),Z=x.getPoints(),h=b,l=[],X=0;X<Z.size();X++)h=Z.get(X),l.push(Nd(C,h.x-C.x,h.y-C.y,w));c._55O.$15l=l};y.setImage("xeditinteractor_parentIcon",z),y.setImage("xeditinteractor_hostIcon",i),y.setImage("xeditinteractor_edgeIcon",Jl),y.setImage("xeditinteractor_removeIcon",wm),y.setImage("xeditinteractor_sourceIcon",Ik),y.setImage("xeditinteractor_targetIcon",gj),y.setImage("xeditinteractor_elevationIcon",lg),y.setImage("xeditinteractor_tallIcon",ee),F._editPointSize=w?24:9,F._edgeHelpers=["parent","remove","source","target"],F._leftTopHelpers=["parent"],F._rightTopHelpers=["host"],F._leftBottomHelpers=["edge"],F._rightBottomHelpers=["remove"],Og=Og.concat(Og).concat(Og),O._79o=function(){var v=this,G=v.gv,h=G.getZoom(),H=G._editInteractor,T=fr.call(v);if(!T)return null;var i=ri(v,!0),V=i[0],m=i[1],n={x:T.x,y:T.y,width:T.width,height:T.height},B=N(V,m);if(H instanceof Q.XEditInteractor){n=x(n,B);var p=v._55O,_=G.getEditPointSize()/h+2,Z=0;p&&p._43O&&(Z+=_/2,o(n,Z))}return n},O._47O=function(n){var v=this,e=v.gv,f=e._editInteractor;f instanceof Q.XEditInteractor||wh.call(v,n)},O.rectIntersects=function(m){var E=this,Y=E._data,N=E.gv,i=N.getZoom(),$=E._55O,p=N._editInteractor;if(p instanceof Q.XEditInteractor&&N.isEditable(Y)&&$&&$._43O&&"points"===Y.s("edge.type")){var R=Y.s("edge.points"),L=Y.s("edge.segments");R=dk(E,R),L&&L.size()||(L=ck(R)),R=R._as;var x=!1,o=w?5:1,D=m.x+o,l=m.y+o,P={x:D,y:l};if(p._edge===Y&&p._hoverSegmentIndex>=0){var c=N._editInteractor._hoverSegmentIndex,V=L.get(c),B=ql(Y,E,c),k=b;if(B!=b&&B>=0){var A=R[B],z=N.getSegmentHoverWidth()/i;if(2===V||1===V){var G=R[B+1];k=bg(new Dl(A.x,A.y),new Dl(G.x,G.y),new Dl(P.x-z,P.y-z),new Dl(P.x+2*z,P.y+2*z)),k.$62l===s&&(x=!0)}else if(3===V){var q=R[B+1],G=R[B+2];k=hc(new Dl(A.x,A.y),new Dl(q.x,q.y),new Dl(G.x,G.y),new Dl(P.x-z,P.y-z),new Dl(P.x+2*z,P.y+2*z)),k.$62l===s&&(x=!0)}else if(4===V){var e=R[B+1],_=R[B+2];G=R[B+3],k=ul(new Dl(A.x,A.y),new Dl(e.x,e.y),new Dl(_.x,_.y),new Dl(G.x,G.y),new Dl(P.x-z,P.y-z),new Dl(P.x+2*z,P.y+2*z)),k.$62l===s&&(x=!0)}}}if(x)return!0}return b},a._47O=function(x){var I=this,H=I.gv,Z=H._editInteractor;Z instanceof Q.XEditInteractor||Un.call(I,x)},a.rectIntersects=function(K){var q=this,N=q._data,p=q.gv,E=p.getZoom(),o=q._55O,i=p._editInteractor;if(i instanceof Q.XEditInteractor&&p.isEditable(N)&&o&&o._43O){var Y=o.$15l,v=!1,z=w?5:1,J=K.x+z,H=K.y+z,n={x:J,y:H};if(Y&&Y.length===N.getPoints().size()||(Sh(q),Y=o.$15l),i._shape===N&&i._hoverSegmentIndex>=0){var A=N.getSegments();A&&A.size()||(A=ck(Y));var M=p._editInteractor._hoverSegmentIndex,_=A.get(M),L=ql(N,q,M),X=b;if(L!=b&&L>=0){var u=Y[L],d=p.getSegmentHoverWidth()/E;if(2===_||1===_){var e=Y[L+1];X=bg(new Dl(u.x,u.y),new Dl(e.x,e.y),new Dl(n.x-d,n.y-d),new Dl(n.x+2*d,n.y+2*d)),X.$62l===s&&(v=!0)}else if(3===_){var h=Y[L+1],e=Y[L+2];X=hc(new Dl(u.x,u.y),new Dl(h.x,h.y),new Dl(e.x,e.y),new Dl(n.x-d,n.y-d),new Dl(n.x+2*d,n.y+2*d)),X.$62l===s&&(v=!0)}else if(4===_){var C=Y[L+1],y=Y[L+2];e=Y[L+3],X=ul(new Dl(u.x,u.y),new Dl(C.x,C.y),new Dl(y.x,y.y),new Dl(e.x,e.y),new Dl(n.x-d,n.y-d),new Dl(n.x+2*d,n.y+2*d)),X.$62l===s&&(v=!0)}}}if(v)return!0}return b},a._48O=function(){var B=this,E=B.gv,M=E._editInteractor;M instanceof Q.XEditInteractor?(S._48O.call(B),B._55O._43O&&Sh(B)):$d.call(B)},a._79o=function(){var x=this,g=x.gv,u=g.getZoom(),O=g._editInteractor,v=Lg.call(x);if(v){var M={x:v.x,y:v.y,width:v.width,height:v.height};if(O instanceof Q.XEditInteractor){var j=x._55O,c=g.getEditPointSize()/u+2,L=0;j&&j._43O&&(L+=c/2,o(M,L))}return M}},S._47O=function(S){var R=this,w=R.gv,n=w._editInteractor;if(n instanceof Q.XEditInteractor);else{var K=R._55O;K&&K._98o&&lf.call(R,S)}},S.getSelectWidth=function(){var q=this,f=q.gv,R=f._editInteractor,d=q._data;return f.isEditable(d)&&R instanceof Q.XEditInteractor?0:ec.call(q)},S._80o=function(j){var g=this,C=g.gv._editInteractor;if(Nf.call(g,j),C&&C._debug){j.save(),j.beginPath(),j.lineWidth=1,j.strokeStyle="green";var d=g._79o();d&&(j.rect(d.x,d.y,d.width,d.height),j.stroke()),j.restore()}},a._80o=function(p){var c=this,j=c.gv._editInteractor;if(Qp.call(c,p),j&&j._debug){p.save(),p.beginPath(),p.lineWidth=1,p.strokeStyle="green";var F=c._79o();p.rect(F.x,F.y,F.width,F.height),p.stroke(),p.restore()}},S._48O=function(){var R=this,Y=R.gv,y=R._data,A=Y._editInteractor,J=R._55O,O=y.p(),m=y.getRotation();if(A instanceof Q.XEditInteractor){if(J._42O){var v=Tp(O,y.getWidth(),y.getHeight(),m),T=v[0],E=v[1],Z=v[2],$=v[3],V=v[4],p=v[5],B=v[6],n=v[7];J.$45l=[T,V,E,p,$,B,Z,n]}}else qp.call(R)},F.getResizeMode=function(){return this.$25l||"normal"},F.setResizeMode=function(Z){var B=this.$25l;this.$25l=Z,this.fp("resizeMode",B,Z)},F.getSnapAngle=function(){return this.$26l||Math.PI/36},F.setSnapAngle=function(m){var P=this.$26l;this.$26l=m,this.fp("snapAngle",P,m)},F.getSnapSpacing=function(){return this.$27l},F.setSnapSpacing=function(e){var c=this.$27l;this.$27l=e,this.fp("snapSpacing",c,e)},F.getPointSnapSpacing=function(){return this._pointSnapSpacing},F.setPointSnapSpacing=function(l){var T=this._pointSnapSpacing;this._pointSnapSpacing=l,this.fp("pointSnapSpacing",T,l)},F.setHelperEditableFunc=function(g){var u=this._helperEditableFunc;this._helperEditableFunc=g,this.fp("helperEditableFunc",u,g)},F.getHelperEditableFunc=function(){return this._helperEditableFunc},F.setLeftTopHelpers=function(y){var b=this._leftTopHelpers;this._leftTopHelpers=y,this.fp("leftTopHelpers",b,y)},F.getLeftTopHelpers=function(){return this._leftTopHelpers},F.setLeftTopHelpersAlign=function(C){var p=this._leftTopHelpersAlign;this._leftTopHelpersAlign=C,this.fp("leftTopHelpersAlign",p,C)},F.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},F.setRightTopHelpers=function(e){var a=this._rightTopHelpers;this._rightTopHelpers=e,this.fp("rightTopHelpers",a,e)},F.getRightTopHelpers=function(){return this._rightTopHelpers},F.setRightTopHelpersAlign=function(z){var A=this._rightTopHelpersAlign;this._rightTopHelpersAlign=z,this.fp("rightTopHelpersAlign",A,z)},F.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},F.setLeftBottomHelpers=function(j){var F=this._leftBottomHelpers;this._leftBottomHelpers=j,this.fp("leftBottomHelpers",F,j)},F.getLeftBottomHelpers=function(){return this._leftBottomHelpers},F.setLeftBottomHelpersAlign=function(a){var H=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=a,this.fp("leftBottomHelpersAlign",H,a)},F.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},F.setRightBottomHelpers=function(e){var s=this._rightBottomHelpers;this._rightBottomHelpers=e,this.fp("rightBottomHelpers",s,e)},F.getRightBottomHelpers=function(){return this._rightBottomHelpers},F.setRightBottomHelpersAlign=function(M){var W=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=M,this.fp("rightBottomHelpersAlign",W,M)},F.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},F.setEdgeHelpers=function(N){var J=this._edgeHelpers;this._edgeHelpers=N,this.fp("edgeHelpers",J,N)},F.getEdgeHelpers=function(){return this._edgeHelpers},F.isHelperEditable=function(Y,T){return Y instanceof k&&("host"===T||"edge"===T||"elevation"===T||"tall"===T)?!1:Y instanceof I&&("source"===T||"target"===T)?!1:"pointElevation"===T?this._helperEditableFunc?this._helperEditableFunc(Y,T):!1:this._helperEditableFunc?this._helperEditableFunc(Y,T):!0},F.getEditHelperSize=function(){return this._editHelperSize||(w?28:16)},F.setEditHelperSize=function(g){var $=this._editHelperSize;this._editHelperSize=g,this.fp("editHelperSize",$,g)},F.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},F.setEditRectBorderColor=function(d){var h=this.$28l;this.$28l=d,this.fp("editRectBorderColor",h,d)},F.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},F.setNodeBorderColor=function(d){var M=this.$29l;this.$29l=d,this.fp("nodeBorderColor",M,d)},F.getEditRectBorderStyle=function(){return this.$30l||"dashed"},F.setEditRectBorderStyle=function(W){var y=this.$30l;this.$30l=W,this.fp("editRectBorderStyle",y,W)},F.getControlPointBackground=function(){return this.$31l||"#ff0"},F.setControlPointBackground=function(e){var U=this.$31l;this.$31l=e,this.fp("controlPointBackground",U,e)},F.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},F.setControlPointBorderColor=function(e){var c=this.$32l;this.$32l=e,this.fp("controlPointBorderColor",c,e)},F.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},F.setJoinPointBackground=function(o){var L=this.$33l;this.$33l=o,this.fp("joinPointBackground",L,o)},F.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},F.setJoinPointBorderColor=function(r){var R=this.$34l;this.$34l=r,this.fp("joinPointBorderColor",R,r)},F.getDirectionLineColor=function(){return this.$35l||"#888"},F.setDirectionLineColor=function(N){var E=this.$35l;this.$35l=N,this.fp("directionLineColor",E,N)},F.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},F.setSegmentHoverColor=function(n){var W=this.$36l;this.$36l=n,this.fp("segmentHoverColor",W,n)},F.getSegmentHoverWidth=function(){return this.$22l||(w?16:8)},F.setSegmentHoverWidth=function(N){var $=this.$22l;this.$22l=N,this.fp("segmentHoverWidth",$,N)},F.getSnapPointBorderColor=function(){return this.$38l||"#f00"},F.setSnapPointBorderColor=function(Q){var L=this.$38l;this.$38l=Q,this.fp("snapPointBorderColor",L,Q)},F.getEditRectPadding=function(){return this.$39l!=b?this.$39l:6},F.setEditRectPadding=function(e){var A=this.$39l;this.$39l=e,this.fp("editRectPading",A,e)},F.isRectEditable=function(H){var L=this,M=L._editInteractor;return M instanceof Q.XEditInteractor?L._rectEditableFunc?L._rectEditableFunc(H):!0:jp.call(L,H)},F.isPointEditable=function(v){var u=this,P=u._editInteractor;return P instanceof Q.XEditInteractor?u._pointEditableFunc?u._pointEditableFunc(v):!0:Uo.call(u,v)},F.validateImpl=function(){var y=this,c=y.$14l,T=y._editInteractor;if(c){var D=y.getWidth(),g=y.getHeight();(D!==c.clientWidth||g!==c.clientHeight)&&(T&&(T._68I=1),B.setCanvas(c,D,g),y._32I=1)}Nl.call(this)},F.isEditable=function(P){var W=Ag.call(this,P),N=this._editInteractor;if(N instanceof Q.XEditInteractor&&P instanceof k){if(!P.s("2d.editable"))return!1;var $=this.getEditableFunc();W=$?$(P):!0}return W},F._42=function(o,e){var W=this,A=W._editInteractor;rn.call(W,o,e),A instanceof Q.XEditInteractor&&A._68I&&A._42()},F.isSnapPoint=function(){return!0};var js=function(C){arguments.length>0&&this.$58l(C)},eo=js.prototype;eo.$58l=function(r){this.$62l=r,this.points=new Array},eo.$56l=function(D){this.points.push(D)},eo.$57l=function(P){this.points=this.points.concat(P)};var Dl=function(P,p){arguments.length>0&&this.$58l(P,p)},lh=Dl.prototype;lh.$58l=function(g,R){this.x=g,this.y=R},lh.add=function(y){return new Dl(this.x+y.x,this.y+y.y)},lh.addEquals=function(v){return this.x+=v.x,this.y+=v.y,this},lh.$55l=function(h){return new Dl(this.x*h,this.y*h)},lh.eq=function(r){return this.x==r.x&&this.y==r.y},lh.lt=function(V){return this.x<V.x&&this.y<V.y},lh.lte=function(q){return this.x<=q.x&&this.y<=q.y},lh.gt=function(q){return this.x>q.x&&this.y>q.y},lh.gte=function(S){return this.x>=S.x&&this.y>=S.y},lh.lerp=function(e,h){return new Dl(this.x+(e.x-this.x)*h,this.y+(e.y-this.y)*h)},lh.distanceFrom=function(_){var s=this.x-_.x,C=this.y-_.y;return T(s*s+C*C)},lh.min=function(u){return new Dl(H(this.x,u.x),H(this.y,u.y))},lh.max=function(r){return new Dl(J(this.x,r.x),J(this.y,r.y))},lh.toString=function(){return this.x+","+this.y};var Vd=function(){this.$58l(arguments)},Oh=Vd.prototype;Vd.TO=1e-6,Vd.AC=6,Oh.$58l=function(s){this.co=new Array;for(var W=s.length-1;W>=0;W--)this.co.push(s[W])},Oh.$55l=function(V){for(var y=new Vd,M=0;M<=this.$50l()+V.$50l();M++)y.co.push(0);for(var M=0;M<=this.$50l();M++)for(var Y=0;Y<=V.$50l();Y++)y.co[M+Y]+=this.co[M]*V.co[Y];return y},Oh.$59l=function(){for(var J=this.$50l();J>=0&&R(this.co[J])<=Vd.TO;J--)this.co.pop()},Oh.$50l=function(){return this.co.length-1},Oh.$51l=function(){var v;switch(this.$59l(),this.$50l()){case 0:v=new Array;break;case 1:v=this.$52l();break;case 2:v=this.$53l();break;case 3:v=this.$54l();break;case 4:v=this.$63l();break;default:v=new Array}return v},Oh.$52l=function(){var t=new Array,N=this.co[1];return 0!=N&&t.push(-this.co[0]/N),t},Oh.$53l=function(){var $=new Array;if(2==this.$50l()){var F=this.co[2],o=this.co[1]/F,D=this.co[0]/F,L=o*o-4*D;if(L>0){var t=T(L);$.push(.5*(-o+t)),$.push(.5*(-o-t))}else 0==L&&$.push(.5*-o)}return $},Oh.$63l=function(){var j=new Array;if(4==this.$50l()){var F=this.co[4],n=this.co[3]/F,u=this.co[2]/F,Q=this.co[1]/F,l=this.co[0]/F,W=new Vd(1,-u,n*Q-4*l,-n*n*l+4*u*l-Q*Q).$54l(),t=W[0],v=n*n/4-u+t;if(R(v)<=Vd.TO&&(v=0),v>0){var y=T(v),m=3*n*n/4-y*y-2*u,o=(4*n*u-8*Q-n*n*n)/(4*y),q=m+o,s=m-o;if(R(q)<=Vd.TO&&(q=0),R(s)<=Vd.TO&&(s=0),q>=0){var B=T(q);j.push(-n/4+(y+B)/2),j.push(-n/4+(y-B)/2)}if(s>=0){var B=T(s);j.push(-n/4+(B-y)/2),j.push(-n/4-(B+y)/2)}}else if(0>v);else{var o=t*t-4*l;if(o>=-Vd.TO){if(0>o&&(o=0),o=2*T(o),m=3*n*n/4-2*u,m+o>=Vd.TO){var h=T(m+o);j.push(-n/4+h/2),j.push(-n/4-h/2)}if(m-o>=Vd.TO){var h=T(m-o);j.push(-n/4+h/2),j.push(-n/4-h/2)}}}}return j},Oh.$54l=function(){var g=new Array;if(3==this.$50l()){var L=this.co[3],D=this.co[2]/L,b=this.co[1]/L,u=this.co[0]/L,o=(3*b-D*D)/3,M=(2*D*D*D-9*b*D+27*u)/27,P=D/3,H=M*M/4+o*o*o/27,_=M/2;if(R(H)<=Vd.TO&&(H=0),H>0){var d,p,J=T(H);d=-_+J,p=d>=0?n(d,1/3):-n(-d,1/3),d=-_-J,d>=0?p+=n(d,1/3):p-=n(-d,1/3),g.push(p-P)}else if(0>H){var X=T(-o/3),y=m(T(-H),-_)/3,N=c(y),K=V(y),a=T(3);g.push(2*X*N-P),g.push(-X*(N+a*K)-P),g.push(-X*(N-a*K)-P)}else{var d;d=_>=0?-n(_,1/3):n(-_,1/3),g.push(2*d-P),g.push(-d-P)}}return g};var em=function(D,J){arguments.length>0&&this.$58l(D,J)},Ob=em.prototype;Ob.$58l=function($,w){this.x=$,this.y=w},Ob.length=function(){return T(this.x*this.x+this.y*this.y)},Ob.$60l=function(z){return this.x*z.x+this.y*z.y};var Gr=function(c,N,F,e){var J,y=(e.x-F.x)*(c.y-F.y)-(e.y-F.y)*(c.x-F.x),Z=(N.x-c.x)*(c.y-F.y)-(N.y-c.y)*(c.x-F.x),b=(e.y-F.y)*(N.x-c.x)-(e.x-F.x)*(N.y-c.y);if(0!=b){var d=y/b,M=Z/b;d>=0&&1>=d&&M>=0&&1>=M?(J=new js(s),J.points.push(new Dl(c.x+d*(N.x-c.x),c.y+d*(N.y-c.y)))):J=new js(t)}else J=0==y||0==Z?new js("C"):new js("P");return J},Eh=function(q,i,I,v,M){var H,C,Z,f,g,F,z,K=v.min(M),X=v.max(M),W=new js(t);H=i.$55l(-2),Z=q.add(H.add(I)),H=q.$55l(-2),C=i.$55l(2),f=H.add(C),g=new Dl(q.x,q.y),z=new em(v.y-M.y,M.x-v.x),F=v.x*M.y-M.x*v.y;for(var b=new Vd(z.$60l(Z),z.$60l(f),z.$60l(g)+F).$51l(),Y=0;Y<b.length;Y++){var d=b[Y];if(d>=0&&1>=d){var T=q.lerp(i,d),c=i.lerp(I,d),N=T.lerp(c,d);v.x==M.x?K.y<=N.y&&N.y<=X.y&&(W.$62l=s,W.$56l(N)):v.y==M.y?K.x<=N.x&&N.x<=X.x&&(W.$62l=s,W.$56l(N)):N.gte(K)&&N.lte(X)&&(W.$62l=s,W.$56l(N))}}return W},hc=function(w,U,a,L,E){var Z=L.min(E),k=L.max(E),F=new Dl(k.x,Z.y),z=new Dl(Z.x,k.y),h=Eh(w,U,a,Z,F),X=Eh(w,U,a,F,k),G=Eh(w,U,a,k,z),m=Eh(w,U,a,z,Z),r=new js(t);return r.$57l(h.points),r.$57l(X.points),r.$57l(G.points),r.$57l(m.points),r.points.length>0&&(r.$62l=s),r},bo=function(R,w,Z,o,I,M){var X,S,b,e,j,V,D,r,H,E,J=I.min(M),L=I.max(M),_=new js(t);X=R.$55l(-1),S=w.$55l(3),b=Z.$55l(-3),e=X.add(S.add(b.add(o))),j=new em(e.x,e.y),X=R.$55l(3),S=w.$55l(-6),b=Z.$55l(3),e=X.add(S.add(b)),V=new em(e.x,e.y),X=R.$55l(-3),S=w.$55l(3),b=X.add(S),D=new em(b.x,b.y),r=new em(R.x,R.y),E=new em(I.y-M.y,M.x-I.x),H=I.x*M.y-M.x*I.y;for(var h=new Vd(E.$60l(j),E.$60l(V),E.$60l(D),E.$60l(r)+H).$51l(),G=0;G<h.length;G++){var m=h[G];if(m>=0&&1>=m){var z=R.lerp(w,m),g=w.lerp(Z,m),l=Z.lerp(o,m),F=z.lerp(g,m),d=g.lerp(l,m),K=F.lerp(d,m);I.x==M.x?J.y<=K.y&&K.y<=L.y&&(_.$62l=s,_.$56l(K)):I.y==M.y?J.x<=K.x&&K.x<=L.x&&(_.$62l=s,_.$56l(K)):K.gte(J)&&K.lte(L)&&(_.$62l=s,_.$56l(K))}}return _},ul=function(R,U,x,S,i,n){var L=i.min(n),O=i.max(n),G=new Dl(O.x,L.y),_=new Dl(L.x,O.y),g=bo(R,U,x,S,L,G),Z=bo(R,U,x,S,G,O),C=bo(R,U,x,S,O,_),Q=bo(R,U,x,S,_,L),K=new js(t);return K.$57l(g.points),K.$57l(Z.points),K.$57l(C.points),K.$57l(Q.points),K.points.length>0&&(K.$62l=s),K},bg=function(o,V,X,n){var k=X.min(n),R=X.max(n),B=new Dl(R.x,k.y),j=new Dl(k.x,R.y),c=Gr(k,B,o,V),Y=Gr(B,R,o,V),U=Gr(R,j,o,V),i=Gr(j,k,o,V),l=new js(t);return l.$57l(c.points),l.$57l(Y.points),l.$57l(U.points),l.$57l(i.points),l.points.length>0&&(l.$62l=s),l},oq=Q.XEditInteractor=function(D){var V=this,w=V._view=document.createElement("canvas");w.className="editCanvas",w.style.position="absolute",oq.superClass.constructor.call(V,D)};y.def(oq,Q.Interactor,{ms_edit:1,setUp:function(){var E=this,N=E.gv,w=N.getView(),x=E._view;oq.superClass.setUp.call(E),N.setEditInteractor(E),N.$14l=x,N._79O?w.insertBefore(x,N._79O):w.appendChild(x);var M=E.$49l=E.$11l.bind(E);N.dm().md(M),N.sm().ms(M),N.mp(M)},tearDown:function(){var r=this,G=r.gv,T=G.getView(),a=r.$49l;oq.superClass.tearDown.call(r),G.setEditInteractor(b),G.$14l=b,T.removeChild(r._view),G.dm().umd(a),G.sm().ums(a),G.ump(a)},clear:function(){var K=this,u=K.gv;delete K._hoverSegmentIndex,delete K._edge,delete K._shape,delete u._editing,delete K.$10l,delete K.$13l,delete K.$9l,delete K._removePointIndex,delete K._lp,K.$12l="",delete K.$40l,delete K.$67l,delete K.$72l,delete K.$73l,delete K.$75l,delete K.$1l,delete K.$3l,delete K.$2l,delete K.$92l,delete K.$93l,delete K.$94l,K.clearDragging()},handle_keydown:function(r){this.$48l!==r.shiftKey&&(this.$48l=r.shiftKey,this.handle_mousemove(r,L,!0))},handle_keyup:function(l){this.$48l!==l.shiftKey&&(this.$48l=l.shiftKey,this.handle_mousemove(l,L,!0))},handle_touchstart:function(H){this.handle_mousemove(H),this.handle_mousedown(H)},handle_mousedown:function($){D($);var z=this,Q=z.$13l,B=z.gv,G=B.dm(),U=B.sm(),g=B.getZoom(),p=B.lp($),Z=y.isDoubleClick($),d=y.isLeftButton($),E=z.$7l,l=z._shape,v=z._hoverSegmentIndex,P=z._edge,H=z.$87l,q=z.$88l,R=function(){z._68I||H===z.$87l&&q===z.$88l||z.$43l()};if(7!==z.$67l&&(delete z.$87l,delete z.$88l),d&&(l||P)&&v>=0&&Z&&(l&&U.contains(l)||P&&U.contains(P))){var A=Jq.call(z,l||P,v,p);return z.addShapePoint(l||P,v,A),e(function(){z.handle_mousemove($)},40),void 0}if(d&&(l||P)&&z._removePointIndex>=0&&Z)return z.removeShapePoint(),z.$5l=1,e(function(){z.handle_mousemove($)},40),void 0;if(!d||!B._editing)return R(),void 0;if(l&&Q>=0){var T=l.getPoints().get(Q),M=l.p(),f=Nd(M,T.x-M.x,T.y-M.y,-E+l.getRotation());a=Nd(M,p.x-M.x,p.y-M.y,-E),z.$24l={x:a.x-f.x,y:a.y-f.y},z.startDragging($),G.beginTransaction(),z.fi({kind:"beginEditPoint",event:$,data:l,index:Q}),z.$88l=Q,z.$87l=l}else if(z.$10l){var j=B.sm().getSelection(),c=z.$6l,F=z.$1l={},N=z.$3l={},r=z.$16l[_[z.$10l]],S={x:c.x,y:c.y},w={x:c.x+c.width/2,y:c.y+c.height/2};z.$24l={x:p.x-r.x/g,y:p.y-r.y/g},z.$2l=W(z.$8l),z.$4l=W(c),j.each(function(l){if(l instanceof I){var g=l.p(),B=l.getWidth(),J=l.getHeight(),b=Nd(w,g.x-w.x,g.y-w.y,-E);F[l.getId()]={x:g.x-B/2,y:g.y-J/2,width:B,height:J},N[l.getId()]={x:(b.x-S.x)/c.width,y:(b.y-S.y)/c.height}}}),z.startDragging($),G.beginTransaction(),z.fi({kind:"beginEditRect",event:$,direction:z.$10l})}else if(P&&Q>=0){var X=dk(B.getDataUI(P),P.s("edge.points")),T=X.get(Q);z.$24l={x:p.x-T.x,y:p.y-T.y},z.startDragging($),G.beginTransaction(),z.fi({kind:"beginEditPoint",event:$,data:P,index:Q}),z.$88l=Q,z.$87l=P}else if(z.$40l){var c=z.$6l,w={x:c.x+c.width/2,y:c.y+c.height/2},i=W(z.$23l);i.x/=g,i.y/=g;var n=Nd(w,i.x-w.x,i.y-w.y,-E),a=Nd(w,p.x-w.x,p.y-w.y,-E);z.$24l={x:a.x-n.x,y:a.y-n.y},z.startDragging($),G.beginTransaction(),z.fi({kind:"beginEditRotation",event:$,data:z._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(z.$67l)>=0){var K=z.$67l;(7===K||8===K||9===K)&&G.beginTransaction(),z.startDragging($)}else if(z.$71l&&Z&&z.$79l(z.$71l,p)){var x=U.toSelection();G.beginTransaction(),x.each(function(I){G.remove(I)}),G.endTransaction()}R()},$11l:function(){var a=this,T=a.gv;T._editing&&(a.$13l==b||a._shape==b&&a._edge==b)&&(a.$73l==b||1!==a.$67l&&5!==a.$67l&&6!==a.$67l)||(a.$5l=1),a._68I=1},$46l:function(t){var O=this,j=O.gv,i=j.lp(t),u=[];return Wm(j,function(f){var n=j.getDataUI(f);if(n){var J=n._79o();G(J,i)&&u.push(f)}}),u},$47l:function(K){var P=this,p=P.$13l,D=P.gv.dm();P.$10l?(P.fi({kind:"endEditRect",event:K,direction:P.$10l}),D.endTransaction()):P._shape&&p>=0?(P.fi({kind:"endEditPoint",event:K,data:P._shape,index:p}),D.endTransaction()):P._edge&&p>=0?(P.fi({kind:"endEditPoint",event:K,data:P._edge,index:p}),D.endTransaction()):P.$23l&&P.$40l&&(P.fi({kind:"endEditRotation",event:K}),D.endTransaction())},handleWindowTouchEnd:function(h){this.handleWindowMouseUp(h)},handleWindowMouseUp:function(l){var c=this,H=c.gv,x=H.dm(),G=c._shape,_=c._edge,C=c.$13l,X=c.$40l,o=c.$9l,V=c.$10l,y=c.$67l;if((G||_)&&C>=0&&o>=0){var m,f;if(G){var Y=G.p(),i=G.getRotation();m=G.getPoints(),f=m.get(o),Lf(G,Y,i,C,f,!1)}else if(m=dk(H.getDataUI(_),_.s("edge.points"),!0),f=m.get(o),0===C){var B=m.get(0);_.s("edge.source.offset.x",f.x-B.x),_.s("edge.source.offset.y",f.y-B.y)}else if(C===m.size()-1){var E=m.get(m.size()-1);_.s("edge.target.offset.x",f.x-E.x),_.s("edge.target.offset.y",f.y-E.y)}else"points"===_.s("edge.type")&&(m.set(C,f),_.s("edge.points",Xm(m)))}c.$47l(l);var u=c.$73l;1===y?(x.beginTransaction(),u?H.sm().each(function(M){if(M.setHost&&H.isHelperEditable(M,"host")){M.setHost(u);
var y=c.$75l,Z=c.$74l;y&&(M.s("attach.row.index",y.rowIndex),M.s("attach.column.index",y.columnIndex)),Z&&(M.s("attach.index",Z.attachIndex),M.s("attach.offset",Z.attachOffset),M.s("attach.offset.relative",!1),M.s("attach.offset.opposite",!1))}}):H.sm().each(function(x){x.setHost&&H.isHelperEditable(x,"host")&&(x.setHost(b),x.s("attach.row.index",L),x.s("attach.column.index",L),x.s("attach.index",L),x.s("attach.offset",L),x.s("attach.offset.relative",!1),x.s("attach.offset.opposite",!1))}),x.endTransaction()):2===y?(x.beginTransaction(),u?H.sm().each(function(U){U.setParent&&H.isHelperEditable(U,"parent")&&U.setParent(u)}):H.sm().each(function(V){V.setParent&&H.isHelperEditable(V,"parent")&&V.setParent(b)}),x.endTransaction()):3===y?u&&(x.beginTransaction(),H.sm().each(function(S){if(H.isHelperEditable(S,"edge")&&S instanceof I&&u instanceof I){var m=new p.Edge;x.add(m),m.setSource(S),m.setTarget(u),c.onEdgeCreated&&c.onEdgeCreated(l,m)}}),x.endTransaction()):5===y||6===y?u&&(x.beginTransaction(),H.sm().each(function(V){V instanceof k&&u instanceof I&&(5===y&&H.isHelperEditable(V,"source")?V.setSource(u):6===y&&H.isHelperEditable(V,"source")&&V.setTarget(u))}),x.endTransaction()):(7===y||8===y||9===y)&&x.endTransaction(),(V||X)&&c.$43l(!0),K(l)?(c.clear(),delete c.$64l,c._68I||c.$43l()):(c.handle_mousemove(l,!0),y&&!c._68I&&c.$43l())},handleWindowTouchMove:function(F){this.handleWindowMouseMove(F)},handleWindowMouseMove:function(X){this._78I(X)},handle_mousemove:function(T,w,G){if(!this._pause){if(!G){var j=K(T)?De(T):T;this.$61l={clientX:j.clientX,clientY:j.clientY}}if(w===!0||!f()){var g=this,i=g.gv,d=!1,P=b;g.clear(),i.sm().size()>0&&(P=i.lp(G?g.$61l:T),d=g._79I(T,P)),d&&(i._editing=1),g.$12l!==g.$65l&&(g.$65l=g.$12l,g.setCursor(g.$12l)),g.$40l!==g.$64l&&(g.$64l=g.$40l,g._68I||g.$43l()),g._hoverSegmentIndex!==g.$66l&&(g.$66l=g._hoverSegmentIndex,g._68I||g.$43l())}}},_78I:function(i){this.autoScroll(i);var H=this,q=H.gv,A=q.lp(i),U=q.getZoom(),z=H.$13l;if((H._shape||H._edge)&&z>=0){var G,t,O,L=H._shape,Z=H._edge,Q=H.$24l,K=q.getPointSnapSpacing(),B=function(T,P){return K==b||isNaN(K)?{x:T,y:P}:{x:E(T/K)*K,y:E(P/K)*K}};if(L){G=L.getPoints();var r=L.p(),V=L.getRotation(),C=0;t=Nd(r,A.x-r.x,A.y-r.y,-V),Lf(L,r,V,z,A,!0,Q,B),H.fi({kind:"betweenEditPoint",event:i,data:L,index:z})}else if(Z){G=dk(q.getDataUI(Z),Z.s("edge.points"),!0),A.x-=Q.x,A.y-=Q.y,t=A;var l,D,o=Z.s("edge.offset"),a=G.size(),N=a>2;if(0===z){var F=G.get(0);o&&(F=xn(F,G.get(1),-o,N),A=xn(A,G.get(1),-o,N)),l=A.x-F.x,D=A.y-F.y,O=B(l,D),Z.s("edge.source.offset.x",O.x),Z.s("edge.source.offset.y",O.y)}else if(z===a-1){var f=G.get(a-1);o&&(f=xn(f,G.get(a-2),-o,N),A=xn(A,G.get(a-2),-o,N)),l=A.x-f.x,D=A.y-f.y,O=B(l,D),Z.s("edge.target.offset.x",O.x),Z.s("edge.target.offset.y",O.y)}else"points"===Z.s("edge.type")&&(O=B(A.x,A.y),O.e=G.get(z).e,G.set(z,O),Z.s("edge.points",Xm(G)));H.fi({kind:"betweenEditPoint",event:i,data:Z,index:z})}if(delete H.$9l,q.isSnapPoint(L)||q.isSnapPoint(Z))for(C=0;C<G.size();C++)if(C!==z){var w=G.get(C);if(g(w,t)<q.getEditPointSize()/U){H.$9l=C;break}}}else if(H.$10l){var Q=H.$24l;A.x-=Q.x,A.y-=Q.y;var s=q.sm().getSelection(),Y=H.$1l,u=H.$7l,S=H.$10l,c=H.$4l,W=H.$2l,P=q.getEditRectPadding()/U,X=2*P,J=q.getSnapSpacing(),j=J!=b&&!isNaN(J),h=wf(W,A,S,u,2*P,q.getResizeMode(),j,!0),n=H.$6l;if(j){var p=h.width-X,_=h.height-X,x=E(p/J)*J,Ec=E(_/J)*J,ug=x-p,wn=Ec-_;("west"===S||"northwest"===S||"southwest"===S)&&(ug=-ug),("north"===S||"northwest"===S||"northeast"===S)&&(wn=-wn),h=wf(W,A,S,u,2*P,q.getResizeMode(),j,!1,ug,wn)}H.$8l=h,n.x=h.x+P,n.y=h.y+P,n.width=h.width-X,n.height=h.height-X;var oo=h.x+h.width/2,Ai=h.y+h.height/2,oc=n.x,Zq=n.y,rf=n.width/c.width,Wi=n.height/c.height;s.each(function(l){if(l instanceof I&&q.isEditable(l)&&q.isRectEditable(l)){var W=Y[l.getId()],v=H.$3l[l.getId()],w={x:W.x+W.width/2,y:W.y+W.height/2},c=0,r=0,g=S,p=180*R(u-l.getRotation())/$;"northeast"===S?p>=315||45>p?(c=W.width*rf+W.x,r=W.height*(1-Wi)+W.y,g="northeast"):p>=45&&135>p?(c=W.width*(1-Wi)+W.x,r=W.height*(1-rf)+W.y,g="northwest"):p>=135&&225>p?(c=W.width*(1-rf)+W.x,r=W.height*Wi+W.y,g="southwest"):(c=W.width*Wi+W.x,r=W.height*rf+W.y,g="southeast"):"north"===S?p>=315||45>p?(r=W.height*(1-Wi)+W.y,g="north"):p>=45&&135>p?(c=W.width*(1-Wi)+W.x,g="west"):p>=135&&225>p?(r=W.height*Wi+W.y,g="south"):(c=W.width*Wi+W.x,g="east"):"northwest"===S?p>=315||45>p?(c=W.width*(1-rf)+W.x,r=W.height*(1-Wi)+W.y,g="northwest"):p>=45&&135>p?(c=W.width*(1-Wi)+W.x,r=W.height*rf+W.y,g="southwest"):p>=135&&225>p?(c=W.width*rf+W.x,r=W.height*Wi+W.y,g="southeast"):(c=W.width*Wi+W.x,r=W.height*(1-rf)+W.y,g="northeast"):"west"===S?p>=315||45>p?(c=W.width*(1-rf)+W.x,g="west"):p>=45&&135>p?(r=W.height*rf+W.y,g="south"):p>=135&&225>p?(c=W.width*rf+W.x,g="east"):(r=W.height*(1-rf)+W.y,g="north"):"southwest"===S?p>=315||45>p?(c=W.width*(1-rf)+W.x,r=W.height*Wi+W.y,g="southwest"):p>=45&&135>p?(c=W.width*Wi+W.x,r=W.height*rf+W.y,g="southeast"):p>=135&&225>p?(c=W.width*rf+W.x,r=W.height*(1-Wi)+W.y,g="northeast"):(c=W.width*(1-Wi)+W.x,r=W.height*(1-rf)+W.y,g="northwest"):"east"===S?p>=315||45>p?(c=W.width*rf+W.x,g="east"):p>=45&&135>p?(r=W.height*(1-rf)+W.y,g="north"):p>=135&&225>p?(c=W.width*(1-rf)+W.x,g="west"):(r=W.height*rf+W.y,g="south"):"south"===S?p>=315||45>p?(r=W.height*Wi+W.y,g="south"):p>=45&&135>p?(c=W.width*Wi+W.x,g="east"):p>=135&&225>p?(r=W.height*(1-Wi)+W.y,g="north"):(c=W.width*(1-Wi)+W.x,g="west"):"southeast"===S&&(p>=315||45>p?(c=W.width*rf+W.x,r=W.height*Wi+W.y,g="southeast"):p>=45&&135>p?(c=W.width*Wi+W.x,r=W.height*(1-rf)+W.y,g="northeast"):p>=135&&225>p?(c=W.width*(1-rf)+W.x,r=W.height*(1-Wi)+W.y,g="northwest"):(c=W.width*(1-Wi)+W.x,r=W.height*rf+W.y,g="southwest"));var A=Nd(w,c-w.x,r-w.y,l.getRotation());Bd(l,W,g,{x:A.x,y:A.y});var K=oc+n.width*v.x,N=Zq+n.height*v.y,L={x:K,y:N};L=Nd({x:oo,y:Ai},L.x-oo,L.y-Ai,u),l.p(L.x,L.y)}}),H.fi({kind:"betweenEditRect",event:i,direction:S})}else if(H.$23l&&H.$40l){var Co=H.$8l,qd=Co.width,vn=Co.height,r={x:Co.x+qd/2,y:Co.y+vn/2},Q=H.$24l,$l=H.$23l,Ho=$l.x/U-r.x,Qq=$l.y/U-r.y,Mr=T(Ho*Ho+Qq*Qq),Bo=Math.asin(Q.x/Mr),mp=q.sm().getSelection(),Dq=d+m(A.y-r.y,A.x-r.x)-Bo,vi=q.getSnapAngle(),Dq=E(Dq/vi)*vi;0>Dq&&(Dq+=v);var vf=Dq-H.$7l,jo=[r.x,0,r.y];mp.each(function($){if(q.isEditable($)&&q.isRotationEditable($)&&q.isVisible($)){var X=dj($.p3(),jo),k=Gc();dq(k,-vf),$.setRotation($.getRotation()+vf),Zn(X,k),$.p3(jo[0]+X[0],jo[1]+X[1],jo[2]+X[2])}}),H.$7l=Dq,H.fi({kind:"betweenEditRotation",event:i})}else if([1,2,3,5,6].indexOf(H.$67l)>=0)H.$72l=i,H.$78l||(H.$78l=1,e(function(){y.isDragging()&&H.$43l(),delete H.$78l},12));else if(7===H.$67l){if(H.$87l instanceof M){var L=H.$87l,hg=H.$88l,tf=y.clone(L.getPoints().get(hg)),qh=A.y-tf.y;tf.e||(tf.e=0),H.$92l||(H.$92l=tf.e),tf.e=H.$92l-qh,L.setPoint(hg,tf)}else if(H.$87l instanceof k){var Z=H.$87l,hg=H.$88l,G=dk(q.getDataUI(Z),Z.s("edge.points")),tf=G.get(hg),qh=A.y-tf.y;tf.e||(tf.e=0),H.$92l||(H.$92l=tf.e),tf.e=H.$92l-qh,G.set(hg,tf),Z.s("edge.points",Xm(G))}}else if(8===H.$67l){var mp=q.sm().getSelection(),md=H.$93l;md||(md=H.$93l={}),mp.each(function(i){if(i.p3){var K=i.p3(),I=md[i.getId()];I==b&&(I=md[i.getId()]=K[1]),i.p3([K[0],I-(A.y-H.$90l.y/U),K[2]])}})}else if(9===H.$67l){var mp=q.sm().getSelection(),Am=H.$94l;Am||(Am=H.$94l={}),mp.each(function(R){if(R.s3){var k=R.s3(),Q=Am[R.getId()];Q==b&&(Q=Am[R.getId()]=k[1]);var r=Q-(A.y-H.$91l.y/U);0>r&&(r=.01),R.s3([k[0],r,k[2]])}})}},$79l:function(l,U){var C=this,F=C.gv,g=F.getZoom(),H=F.getEditHelperSize(),t=l.x/g,x=l.y/g,X=H/g,R=X/2;return G({x:t-R,y:x-R,width:X,height:X},U)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(n,D){for(var x=this,Y=x.gv,o=Y.getZoom(),h=Y.getEditPointSize(),b=h/o,s=b/2,A=x.$46l(n),g=0;g<A.length;g++){var w,K,L=A[g],f=Y.getDataUI(L);if(f&&f._55O){var d=f._55O;if(d._43O&&L instanceof k){if(w=L.s("edge.points"),w=dk(f,w),K=L.s("edge.segments"),K&&K.size()||(K=ck(w)),x.$42l(L,D,w._as,K,"edge"))return!0;if("points"===L.s("edge.type")&&x.$41l(L,D,w._as,K,"edge"))return}if(d._43O&&L instanceof M&&d.$15l&&d.$15l.length===L.getPoints().size()){if(w=d.$15l,K=L.getSegments(),K&&K.size()||(K=ck(w)),x.$42l(L,D,w,K,"shape"))return!0;if(x.$41l(L,D,w,K,"shape"))return}}}if(x.$16l){var w,t=x.$16l,C=t[3].x-t[7].x,$=t[3].y-t[7].y,F=T(C*C+$*$),p=t[1].x-t[5].x,E=t[1].y-t[5].y,H=T(p*p+E*E),U={x:D.x*o,y:D.y*o};if(x._80I(U,0,t[0],"northwest",F,H)||x._80I(U,1,t[1],"north",F,H)||x._80I(U,2,t[2],"northeast",F,H)||x._80I(U,7,t[7],"west",F,H)||x._80I(U,3,t[3],"east",F,H)||x._80I(U,6,t[6],"southwest",F,H)||x._80I(U,5,t[5],"south",F,H)||x._80I(U,4,t[4],"southeast",F,H))return!0}if(x.$23l){var B=x.$23l,W=B.x/o,i=B.y/o;if(G({x:W-s,y:i-s,width:b,height:b},D))return x.$40l=1,x.$12l=x.getHelperCursor("rotation")||"crosshair",!0}return x.$68l&&x.$79l(x.$68l,D)?(x.$67l=1,x.$12l=x.getHelperCursor("host")||"crosshair",!0):x.$69l&&x.$79l(x.$69l,D)?(x.$67l=2,x.$12l=x.getHelperCursor("parent")||"crosshair",!0):x.$70l&&x.$79l(x.$70l,D)?(x.$67l=3,x.$12l=x.getHelperCursor("edge")||"crosshair",!0):x.$71l&&x.$79l(x.$71l,D)?(x.$67l=4,x.$12l=x.getHelperCursor("remove")||"crosshair",!0):x.$82l&&x.$79l(x.$82l,D)?(x.$67l=5,x.$12l=x.getHelperCursor("source")||"crosshair",!0):x.$83l&&x.$79l(x.$83l,D)?(x.$67l=6,x.$12l=x.getHelperCursor("target")||"crosshair",!0):x._pointElevationHelperPoint&&x.$79l(x._pointElevationHelperPoint,D)?(x.$67l=7,x.$12l=x.getHelperCursor("pointElevation")||"crosshair",!0):x.$90l&&x.$79l(x.$90l,D)?(x.$67l=8,x.$12l=x.getHelperCursor("elevation")||"crosshair",!0):x.$91l&&x.$79l(x.$91l,D)?(x.$67l=9,x.$12l=x.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(n,q,b,K,e,l){var F=this,f=F.gv,D=f.getEditPointSize(),o=D/2,Y=f.sm(),X=f.isDirectionEditable;if(X&&1===Y.size()){var T=Y.ld();if(X=X.bind(f),T instanceof I){if(!X(T,K))return!1;if("east"===K){if(X(T,"northeast")&&X(T,"southeast")&&2*D>=l)return!1}else if("west"===K){if(X(T,"northwest")&&X(T,"southwest")&&2*D>=l)return!1}else if("north"===K){if(X(T,"northwest")&&X(T,"northeast")&&2*D>=e)return!1}else if("south"===K&&X(T,"southwest")&&X(T,"southeast")&&2*D>=e)return!1}}else{if(2*D>=e&&("north"===K||"south"===K))return!1;if(2*D>=l&&("east"===K||"west"===K))return!1}if(G({x:b.x-o,y:b.y-o,width:D,height:D},n)){if(F.$10l!==K){var h=180*F.$7l/$,d="";h>=337.5||22.5>h?d="north":h>=22.5&&67.5>h?d="northeast":h>=67.5&&112.5>h?d="east":h>=112.5&&157.5>h?d="southeast":h>=157.5&&202.5>h?d="south":h>=202.5&&247.5>h?d="southwest":h>=247.5&&292.5>h?d="west":h>=292.5&&337.5>h&&(d="northwest");var u=Og.indexOf(d),d=Og[q-(1-u)+8];switch(d){case"northwest":F.$12l="nwse-resize";break;case"northeast":F.$12l="nesw-resize";break;case"southwest":F.$12l="nesw-resize";break;case"southeast":F.$12l="nwse-resize";break;case"north":F.$12l="ns-resize";break;case"east":F.$12l="ew-resize";break;case"south":F.$12l="ns-resize";break;case"west":F.$12l="ew-resize"}F.$10l=K}return!0}return!1},$42l:function(Z,f,K,N,D){var e,v=this,E=v.gv,X=E.getEditPointSize(),M=X/E.getZoom(),P=-1,p={x:f.x,y:f.y,width:0,height:0},m=function(M){"shape"===D?v._shape=Z:v._edge=Z,v._removePointIndex=M},r=function(W){"shape"===D?v._shape=Z:v._edge=Z,v.$13l=W,v.$12l="crosshair"};for(o(p,M/2),P=K.length-1,e=N.size()-1;e>=0;e--){var F=N.get(e);if(1===F||2===F)P-=1;else if(3===F){var W=K[P-1];if(G(p,W))return r(P-1),!0;P-=2}else if(4===F){var w=K[P-1],y=K[P-2];if(G(p,w))return r(P-1),!0;if(G(p,y))return r(P-2),!0;P-=3}}for(P=K.length-1,e=N.size()-1;e>=0;e--){var F=N.get(e),R=K[P];if(G(p,R))return m(P),r(P),!0;1===F||2===F?P-=1:3===F?P-=2:4===F&&(P-=3)}return!1},$41l:function(r,e,W,d,g){var b=this,T=b.gv,E=-1,y=0,$={x:e.x,y:e.y,width:0,height:0},v=function(F,a){b._hoverSegmentIndex=a,b._lp=e,"shape"===g?b._shape=r:b._edge=r};for(o($,T.getSegmentHoverWidth()/2/T.getZoom()),r instanceof M&&r.isClosePath()&&d.indexOf(5)<0&&(d=new j(d._as),d.add(5));y<d.size();y++){var L=d.get(y);if(1===L){var h=W[E],I=W[E+1];if(h){var w=bg(new Dl(h.x,h.y),new Dl(I.x,I.y),new Dl($.x,$.y),new Dl($.x+$.width,$.y+$.height));if(w.$62l===s&&w.points.length>0)return v(w,y),!0}E+=1}else if(2===L){var h=W[E],I=W[E+1],w=bg(new Dl(h.x,h.y),new Dl(I.x,I.y),new Dl($.x,$.y),new Dl($.x+$.width,$.y+$.height));if(w.$62l===s&&w.points.length>0)return v(w,y),!0;E+=1}else if(3===L){var h=W[E],F=W[E+1],U=W[E+2],w=hc(new Dl(h.x,h.y),new Dl(F.x,F.y),new Dl(U.x,U.y),new Dl($.x,$.y),new Dl($.x+$.width,$.y+$.height));if(w.$62l===s)return v(w,y),!0;E+=2}else if(4===L){var h=W[E],B=W[E+1],R=W[E+2],U=W[E+3],w=ul(new Dl(h.x,h.y),new Dl(B.x,B.y),new Dl(R.x,R.y),new Dl(U.x,U.y),new Dl($.x,$.y),new Dl($.x+$.width,$.y+$.height));if(w.$62l===s)return v(w,y),!0;E+=3}else if(5===L){var h=W[E],I=W[0];if(h){var w=bg(new Dl(h.x,h.y),new Dl(I.x,I.y),new Dl($.x,$.y),new Dl($.x+$.width,$.y+$.height));if(w.$62l===s&&w.points.length>0)return v(w,y),!0}}}return!1},addShapePoint:function(y,h,N){var B=this,v=B.gv,H=v.dm();if(H.beginTransaction(),0===arguments.length&&(y=B._shape||B._edge,h=B._hoverSegmentIndex,N=B._lp),y instanceof M||y instanceof k){var l=ql(y,v.getDataUI(y),h);if(!isNaN(h)&&N&&!isNaN(l)){var F=N;if(y instanceof M){var D=y.p(),R=y.getRotation(),o=y.toSegments();o&&o.size()||(o=ck(y.getPoints())),y.isClosePath()&&o.indexOf(5)<0&&(o=new j(o._as),o.add(5));var w=o.get(h),T="addPoint",c="removePointAt";if(2===w||1===w){var a={x:F.x,y:F.y};o.add(w,h),a=Nd(D,a.x-D.x,a.y-D.y,-R),y[T](a,l+1)}else if(3===w){var E=y.getPoints(),z=E.get(l),I=E.get(l+2),a={x:F.x,y:F.y};a=Nd(D,a.x-D.x,a.y-D.y,-R);var r=Gq(z,a),V=Gq(a,I);o.removeAt(h),o.add(3,h),o.add(3,h),y.setPoint(l+1,a),y[T](V,l+2),y[T](r,l+1)}else if(4===w){var E=y.getPoints(),z=E.get(l),I=E.get(l+3),a={x:F.x,y:F.y};a=Nd(D,a.x-D.x,a.y-D.y,-R);var r=te(z,a),V=hm(z,a),G=te(a,I),f=hm(a,I);o.removeAt(h),o.add(4,h),o.add(4,h),y[c](l+1),y[c](l+1),y[T](a,l+1),y[T](f,l+2),y[T](G,l+2),y[T](V,l+1),y[T](r,l+1)}else if(5===w){var a={x:F.x,y:F.y};o.add(2,h),a=Nd(D,a.x-D.x,a.y-D.y,-R),y[T](a,l+1)}y.isClosePath()&&o.remove(5),y.setSegments(o);var s=y.getWidth(),O=y.getHeight(),t=y.p().x-s/2,x=y.p().y-O/2;t-=D.x,x-=D.y;var P=ao(y,{x:t,y:x,width:s,height:O},R,D);y.p(P.x,P.y)}else if(y instanceof k){if("points"!==y.s("edge.type"))return H.endTransaction(),void 0;var E=y.s("edge.points");o=y.s("edge.segments"),E=dk(v.getDataUI(y),E),o&&o.size()||(o=ck(E)),o=new j(o._as.slice(0)),E=new j(E._as.slice(0));var w=o.get(h);if(2===w||1===w){var a={x:F.x,y:F.y};o.add(w,h),E.add(a,l+1)}else if(3===w){var z=E.get(l),I=E.get(l+2),a={x:F.x,y:F.y},r=Gq(z,a),V=Gq(a,I);o.removeAt(h),o.add(3,h),o.add(3,h),E.set(l+1,a),E.add(V,l+2),E.add(r,l+1)}else if(4===w){var z=E.get(l),I=E.get(l+3),a={x:F.x,y:F.y},r=te(z,a),V=hm(z,a),G=te(a,I),f=hm(a,I);o.removeAt(h),o.add(4,h),o.add(4,h),E.removeAt(l+1),E.removeAt(l+1),E.add(a,l+1),E.add(f,l+2),E.add(G,l+2),E.add(V,l+1),E.add(r,l+1)}y.s("edge.points",Xm(E)),y.s("edge.segments",o)}}}H.endTransaction()},removeShapePoint:function(z,J){var A=this,L="removeAt",N=A.gv,s=N.dm();if(s.beginTransaction(),0===arguments.length&&(z=A._shape||A._edge,J=A._removePointIndex),J>=0&&(z instanceof M||z instanceof k)){var W=go(z,A.gv.getDataUI(z),J),I=J;if(z instanceof M){var B=z.p(),e=z.toSegments();e&&e.size()||(e=ck(z.getPoints()));var X=e.get(W),u="removePointAt";if(1===X&&0===I)if(z.getPoints().size()>1){var Q=e.get(W+1);e[L](W+1),3===Q?z[u](I+1):4===Q&&(z[u](I+2),z[u](I+1)),z[u](I)}else z.dm().remove(z);else 2===X||1===X?(e[L](W),z[u](I)):3===X?(e[L](W),z[u](I),z[u](I-1)):4===X&&(e[L](W),z[u](I),z[u](I-1),z[u](I-2));z.setSegments(e);var $=z.getWidth(),w=z.getHeight(),S=z.p().x-$/2,x=z.p().y-w/2;S-=B.x,x-=B.y;var a=ao(z,{x:S,y:x,width:$,height:w},z.getRotation(),B);z.p(a.x,a.y)}else if(z instanceof k){if("points"!==z.s("edge.type"))return s.endTransaction(),void 0;var G=z.s("edge.points");if(e=z.s("edge.segments"),G&&(G=dk(A.gv.getDataUI(z),G),e&&e.size()||(e=ck(G))),0===J||J===G.size()-1)return s.endTransaction(),void 0;e=new j(e._as.slice(0)),G=new j(G._as.slice(0));var X=e.get(W);2===X||1===X?(e[L](W),G[L](I)):3===X?(e[L](W),G[L](I),G[L](I-1)):4===X&&(e[L](W),G[L](I),G[L](I-1),G[L](I-2)),z.s("edge.segments",e),z.s("edge.points",Xm(G))}}s.endTransaction()},changeShapeSegment:function(l,$,Z){var W=this,Y=W.gv,e=Y.dm();if(e.beginTransaction(),1!==arguments.length||isNaN(l)||(Z=l,l=W._shape||W._edge,$=W._hoverSegmentIndex),l instanceof M||l instanceof k){var A=ql(l,W.gv.getDataUI(l),$);if(!isNaN($)&&!isNaN(A))if(l instanceof M){var p=l.p(),T=l.toSegments();T&&T.size()||(T=ck(l.getPoints()));var c=T.get($),s=l.toPoints();if(1===Z||2===Z)1===c||2===c?T.set($,Z):3===c?(T.set($,Z),s.removeAt(A+1)):4===c&&(T.set($,Z),s.removeAt(A+1),s.removeAt(A+1));else if(3===Z){var K=function(){var z=s.get(A),w=s.get(A+1),V=Gq(z,w);T.set($,3),s.add(V,A+1)};2===c||1===c?K():4===c&&(s.removeAt(A+1),s.removeAt(A+1),K())}else if(4===Z){var F=function(){var p=s.get(A),g=s.get(A+1),J=te(p,g),n=hm(p,g);T.set($,4),s.add(J,A+1),s.add(n,A+2)};2===c||1===c?F():3===c&&(s.removeAt(A+1),F())}l.setSegments(T),l.setPoints(s);var w=l.getWidth(),N=l.getHeight(),d=l.p().x-w/2,m=l.p().y-N/2;d-=p.x,m-=p.y;var q=new ao(l,{x:d,y:m,width:w,height:N},l.getRotation(),p);l.p(q.x,q.y)}else if(l instanceof k){if("points"!==l.s("edge.type"))return e.endTransaction(),void 0;var s=l.s("edge.points");T=l.s("edge.segments"),s&&(s=dk(W.gv.getDataUI(l),s),T&&T.size()||(T=ck(s))),T=new j(T._as.slice(0)),s=new j(s._as.slice(0));var c=T.get($);if(1===Z||2===Z)1===c||2===c?T.set($,Z):3===c?(T.set($,Z),s.removeAt(A+1)):4===c&&(T.set($,Z),s.removeAt(A+1),s.removeAt(A+1));else if(3===Z){var K=function(){var r=s.get(A),F=s.get(A+1),y=Gq(r,F);T.set($,3),s.add(y,A+1)};2===c||1===c?K():4===c&&(s.removeAt(A+1),s.removeAt(A+1),K())}else if(4===Z){var F=function(){var R=s.get(A),w=s.get(A+1),B=te(R,w),r=hm(R,w);T.set($,4),s.add(B,A+1),s.add(r,A+2)};2===c||1===c?F():3===c&&(s.removeAt(A+1),F())}l.s("edge.points",Xm(s)),l.s("edge.segments",T)}}e.endTransaction()},getDefaultSegments:function(j){var w=this.gv,y=w.getDataUI(j);if(j instanceof k){var T=j.s("edge.points");return T=dk(y,T),ck(T)}if(j instanceof M){var T=j.getPoints(),l=j.getSegments();return l&&l.size()>0?l:ck(T)}},$43l:function(f){var q=this;f&&(q.$5l=1),q._68I=1,q._42()},_42:function(){var G=this;if(G._68I){delete G._68I;var J=G.gv,Q=G.$5l,O=J.getZoom(),E=J.getEditPointSize(),X=E/2,i=new j,c=G._view,$=G._edge,s=G._shape,e=c.getContext("2d"),K=J.tx(),D=J.ty(),w=b,n=J.getEditPointBackground(),t=J.getControlPointBackground(),z=J.getControlPointBorderColor(),a=J.getEditPointBorderColor(),U=J.getEditRectBorderColor(),g=J.getDirectionLineColor(),H=J.getSegmentHoverColor(),L=J.getSnapPointBorderColor(),_=J.getJoinPointBackground(),F=J.getJoinPointBorderColor(),h=J.getSegmentHoverWidth(),Z=[5,5],C=J.getEditRectBorderStyle();Rp(J,function(r){J.isSelected(r)&&J.isVisible(r)&&i.add(r)}),e.clearRect(0,0,q(c.width),q(c.height)),e.save(),B.translateAndScale(e,K,D,1);var m=b,A={x:0,y:0,width:0,height:0},r=0,S=0,R=0,f=0,d=0,V=0,Kj=0,sh=0,sd=0,zh=0,lr=[];if(Q?(delete G.$6l,delete G.$8l,delete G.$7l,delete G.$16l,delete G.$23l):(m=G.$6l,w=G.$7l),delete G.$68l,delete G.$69l,delete G.$71l,delete G.$70l,delete G.$82l,delete G.$83l,delete G._pointElevationHelperPoint,delete G.$90l,delete G.$91l,delete G.$75l,delete G.$74l,i.each(function(X){var H=J.getDataUI(X);if(H){var j=H._55O;if(J.isEditable(X))j._56O&&X instanceof I&&S++,lr.push(X),j._42O&&X instanceof I&&r++,J.isHelperEditable(X,"host")&&f++,J.isHelperEditable(X,"parent")&&R++,J.isHelperEditable(X,"remove")&&d++,J.isHelperEditable(X,"edge")&&V++,J.isHelperEditable(X,"source")&&Kj++,J.isHelperEditable(X,"target")&&sh++,J.isHelperEditable(X,"elevation")&&sd++,J.isHelperEditable(X,"tall")&&zh++;else if(X instanceof Y&&X.isExpanded()){var C=!0,h=J.getEditableFunc();h&&(C=h(X)),C&&(J.isHelperEditable(X,"host")&&f++,J.isHelperEditable(X,"parent")&&R++,J.isHelperEditable(X,"remove")&&d++,J.isHelperEditable(X,"edge")&&V++,J.isHelperEditable(X,"source")&&Kj++,J.isHelperEditable(X,"target")&&sh++,J.isHelperEditable(X,"elevation")&&sd++,J.isHelperEditable(X,"tall")&&zh++,lr.push(X))}}}),e.beginPath(),e.lineWidth=1,e.strokeStyle=J.getNodeBorderColor(),lr.forEach(function(i){var S=J.getDataUI(i),u=S._55O;if(Q)if(w==b&&(w=i instanceof k?0:i instanceof Y&&i.isExpanded()?0:i.getRotation(),G.$7l=w),m==b){var B,g,_;if(i instanceof Y&&i.isExpanded()||i instanceof k){var C=J.getDataUIBounds(i);g=C.width,_=C.height,B={x:C.x+g/2,y:C.y+_/2}}else B=i.p(),g=i.getWidth(),_=i.getHeight();m={x:B.x,y:B.y,width:0,height:0},A.x=B.x-g/2,A.y=B.y-_/2,A.width=g,A.height=_,m=x(m,A)}else{var B,g,_,n,a=m.x+m.width/2,U=m.y+m.height/2,F={x:a,y:U};if(i instanceof Y&&i.isExpanded()||i instanceof k){n=0;var C=J.getDataUIBounds(i);g=C.width,_=C.height,B={x:C.x+g/2,y:C.y+_/2}}else B=i.p(),g=i.getWidth(),_=i.getHeight(),n=i.getRotation();var E={x:B.x-g/2,y:B.y-_/2,width:g,height:_},D={x:E.x,y:E.y},V={x:E.x+E.width,y:E.y},s={x:E.x,y:E.y+E.height},K={x:E.x+E.width,y:E.y+E.height},D=Nd(B,D.x-B.x,D.y-B.y,n),s=Nd(B,s.x-B.x,s.y-B.y,n),K=Nd(B,K.x-B.x,K.y-B.y,n),V=Nd(B,V.x-B.x,V.y-B.y,n),p=-w,Z=Nd(F,D.x-F.x,D.y-F.y,p),W=Nd(F,V.x-F.x,V.y-F.y,p),t=Nd(F,s.x-F.x,s.y-F.y,p),c=Nd(F,K.x-F.x,K.y-F.y,p),M=N([Z,W,t,c]);m=x(m,M),m.x-=a,m.y-=U;var y=ao(b,m,w,F);m.x=y.x-m.width/2,m.y=y.y-m.height/2}if(r>1&&J.isEditable(i)&&J.isRectEditable(i)&&i instanceof I){var L=i.getRect(),P=u.$45l,R=Xb(P[0],O),q=Xb(P[2],O),d=Xb(P[4],O),f=Xb(P[6],O);i.getRotation()?(e.moveTo(R.x,R.y),e.lineTo(q.x,q.y),e.lineTo(d.x,d.y),e.lineTo(f.x,f.y),e.lineTo(R.x,R.y)):e.rect(L.x*O,L.y*O,L.width*O,L.height*O)}}),e.stroke(),m){G.$6l=W(m),o(m,J.getEditRectPadding()/O);var Mo={x:m.x+m.width/2,y:m.y+m.height/2},Hp=Tp(Mo,m.width,m.height,w),zq=Hp[0],Ql=Hp[1],bf=Hp[2],pg=Hp[3],zi=Hp[4],Ai=Hp[5],Qc=Hp[6],fp=Hp[7];if(zq=Xb(Hp[0],O),Ql=Xb(Hp[1],O),bf=Xb(Hp[2],O),pg=Xb(Hp[3],O),zi=Xb(Hp[4],O),Ai=Xb(Hp[5],O),Qc=Xb(Hp[6],O),fp=Xb(Hp[7],O),G.$8l=m,r>0&&(G.$16l=[zq,zi,Ql,Ai,pg,Qc,bf,fp],e.beginPath(),e.lineWidth=1,e.strokeStyle=U,"dashed"===C&&e.setLineDash&&e.setLineDash(Z),e.moveTo(zq.x,zq.y),e.lineTo(Ql.x,Ql.y),e.lineTo(pg.x,pg.y),e.lineTo(bf.x,bf.y),e.lineTo(zq.x,zq.y),e.stroke(),"dashed"===C&&e.setLineDash&&e.setLineDash([])),e.beginPath(),e.lineWidth=1,e.fillStyle=n,e.strokeStyle=a,r>0){var ld=Ai.x-fp.x,yf=Ai.y-fp.y,nm=T(ld*ld+yf*yf),Ef=zi.x-Qc.x,Qp=zi.y-Qc.y,Um=T(Ef*Ef+Qp*Qp),wh=2*E;if(J.isDirectionEditable&&1===lr.length){var El=lr[0],ne=J.getDataUI(El),gi=ne._55O,ph=J.isDirectionEditable.bind(J);if(gi._42O){var Oo,bh,Fb,Ph;ph(El,"northwest")&&(Oo=!0,e.rect(zq.x-X,zq.y-X,E,E)),ph(El,"northeast")&&(bh=!0,e.rect(Ql.x-X,Ql.y-X,E,E)),ph(El,"southwest")&&(Fb=!0,e.rect(bf.x-X,bf.y-X,E,E)),ph(El,"southeast")&&(Ph=!0,e.rect(pg.x-X,pg.y-X,E,E)),ph(El,"north")&&(Oo&&bh?nm>wh&&e.rect(zi.x-X,zi.y-X,E,E):e.rect(zi.x-X,zi.y-X,E,E)),ph(El,"south")&&(Ph&&Fb?nm>wh&&e.rect(Qc.x-X,Qc.y-X,E,E):e.rect(Qc.x-X,Qc.y-X,E,E)),ph(El,"west")&&(Fb&&Oo?Um>wh&&e.rect(fp.x-X,fp.y-X,E,E):e.rect(fp.x-X,fp.y-X,E,E)),ph(El,"east")&&(Ph&&bh?Um>wh&&e.rect(Ai.x-X,Ai.y-X,E,E):e.rect(Ai.x-X,Ai.y-X,E,E))}}else nm>wh&&(e.rect(zi.x-X,zi.y-X,E,E),e.rect(Qc.x-X,Qc.y-X,E,E)),Um>wh&&(e.rect(Ai.x-X,Ai.y-X,E,E),e.rect(fp.x-X,fp.y-X,E,E)),e.rect(zq.x-X,zq.y-X,E,E),e.rect(Ql.x-X,Ql.y-X,E,E),e.rect(bf.x-X,bf.y-X,E,E),e.rect(pg.x-X,pg.y-X,E,E)}if(S>0){var xs=G.$23l=Nd(zi,0,2*-E,w);e.moveTo(xs.x+X,xs.y),e.arc(xs.x,xs.y,X,0,v,!1)}e.fill(),e.stroke(),G.$40l&&G.$44l(e,m,w);var Ch,Ap,ap=J.getLeftTopHelpers(),kh=J.getRightTopHelpers(),jr=J.getLeftBottomHelpers(),Sm=J.getRightBottomHelpers(),th=J.getEdgeHelpers(),uo=J.getEditHelperSize(),wp=uo/2,Lk=function(g,j,b,C){"leftTop"===j?(Ch=m.x*O-uo-X-("h"===C?b*(uo+X):0)-1,Ap=m.y*O-uo-X-("v"===C?b*(uo+X):0)-1):"rightTop"===j?(Ch=(m.x+m.width)*O+X+("h"===C?b*(uo+X):0)+1,Ap=m.y*O-uo-X-("v"===C?b*(uo+X):0)-1):"leftBottom"===j?(Ch=m.x*O-uo-X-("h"===C?b*(uo+X):0)-1,Ap=(m.y+m.height)*O+X+("v"===C?b*(uo+X):0)+1):"rightBottom"===j&&(Ch=(m.x+m.width)*O+X+("h"===C?b*(uo+X):0)+1,Ap=(m.y+m.height)*O+X+("v"===C?b*(uo+X):0)+1);var E=Ch+wp,D=Ap+wp,K=(m.x+m.width/2)*O,p=(m.y+m.height/2)*O,$=Nd({x:K,y:p},E-K,D-p,w);if("host"===g){if(f>0)return G.$77l(e,w,$),!0}else if("edge"===g){if(V>0)return G.$80l(e,w,$),!0}else if("remove"===g){if(d>0)return lr&&1===lr.length&&lr[0]instanceof k?G.$81l(e,w,{x:K+uo/2+5,y:p}):G.$81l(e,w,$),!0}else if("parent"===g){if(R>0)return lr&&1===lr.length&&lr[0]instanceof k?G.$76l(e,w,{x:K-uo/2-5,y:p}):G.$76l(e,w,$),!0}else if("elevation"===g){if(sd>0)return G.$85l(e,w,$),!0}else if("tall"===g){if(zh>0)return G.$86l(e,w,$),!0}else if("source"===g||"target"===g){var h=lr[0],Q=J.getDataUI(h),s=ri(Q,!0),o=s[0],z=s[1];if(Kj&&"source"===g)return G.$84l(e,m,o,!0,h.isLooped(),j,b,C),!0;if(sh&&"target"===g)return G.$84l(e,m,z,!1,h.isLooped(),j,b,C),!0}};if(ap&&ap.length>0){var Vd=0;ap.forEach(function(r){Lk(r,"leftTop",Vd,J.getLeftTopHelpersAlign()||"h")&&Vd++})}if(kh&&kh.length>0){var Vd=0;kh.forEach(function(M){Lk(M,"rightTop",Vd,J.getRightTopHelpersAlign()||"h")&&Vd++})}if(jr&&jr.length>0){var Vd=0;jr.forEach(function(d){Lk(d,"leftBottom",Vd,J.getLeftBottomHelpersAlign()||"h")&&Vd++})}if(Sm&&Sm.length>0){var Vd=0;Sm.forEach(function(W){Lk(W,"rightBottom",Vd,J.getRightBottomHelpersAlign()||"h")&&Vd++})}if(th&&th.length>0&&((Kj||sh)&&lr&&1===lr.length&&lr[0]instanceof k?!0:!1)){var Vd=0;th.forEach(function($){Lk($,"edge",Vd,"h")&&Vd++})}if(G.$72l){var ob,ab=G.$67l,Zq=G.$68l,wo=G.$69l,Qb=(G.$71l,G.$70l),Lg=G.$82l,_e=G.$83l;if(1===ab?ob=Zq:2===ab?ob=wo:3===ab?ob=Qb:5===ab?ob=Lg:6===ab&&(ob=_e),ob){var rm=J.lp(G.$72l),Ll=J.getDataAt(G.$72l);if(Ll&&Ll instanceof I){var $c,re,An;if(G.$73l=Ll,1===ab)if(Ll instanceof p.Grid)$c=G.$75l=Ym(Ll,rm);else if(Ll instanceof p.Shape){An=G.$74l=Wg(Ll,rm);var zr=Ll.getPoints();if(An){var Jr=An.attachIndex,Bp=ql(Ll,J.getDataUI(Ll),Jr)+1,qk=Bp+1>=zr.size()?0:Bp+1,Mr=zr.get(Bp),li=zr.get(qk),Nf=Ll.p(),Hh=Ll.getRotation();Mr=Nd(Nf,Mr.x-Nf.x,Mr.y-Nf.y,Hh),li=Nd(Nf,li.x-Nf.x,li.y-Nf.y,Hh),e.beginPath(),e.strokeStyle=H,e.lineWidth=h,e.moveTo(Mr.x*O,Mr.y*O),e.lineTo(li.x*O,li.y*O),e.stroke()}}$c?re=$c.rect:(re=y.clone(J.getDataUIBounds(Ll)),y.grow(re,2)),e.beginPath(),e.rect(re.x*O,re.y*O,re.width*O,re.height*O),e.strokeStyle=1===ab||4===ab||6===ab?P:l,e.lineWidth=2,e.setLineDash&&e.setLineDash([8,8]),e.stroke()}else delete G.$73l;rm.x=rm.x*O,rm.y=rm.y*O;var em=_d(ob.x,ob.y,rm.x,rm.y),hh=Nd(ob,rm.x-ob.x,rm.y-ob.y,-em),xc=hh.x-ob.x;e.save(),e.translate(ob.x,ob.y),e.rotate(em),u.width=xc,u.height=40;var Di=l;(1===ab||4===ab||6===ab)&&(Di=P),u.comps[0].gradientColor=Di,y.drawImage(e,u,0,-20,xc,40),e.restore()}}}if(i.each(function(N){var K=J.getDataUI(N);if(K){var D,r,k=K._55O,x=K._78o;if(k&&k._43O&&N instanceof M?(D=k.$15l,r=N.getSegments(),r&&r.size()||(r=ck(D)),N.isClosePath()&&r.indexOf(5)<0&&(r=new j(r._as),r.add(5))):k&&x&&k._43O&&(D=N.s("edge.points"),r=N.s("edge.segments"),D=dk(K,D),r&&r.size()||(r=ck(D)),D&&(D=D._as)),D&&r){var m=0,A=r.size(),w=G._hoverSegmentIndex;D=D.slice(0);for(var n=0;n<D.length;n++)D[n]=Xb(D[n],O);e.beginPath(),e.strokeStyle=g,e.lineWidth=1,m=0;for(var n=0;A>n;n++){var V=r.get(n);if(1===V||2===V)m++;else if(3===V){var u=D[m-1],B=D[m],c=D[m+1];e.moveTo(u.x,u.y),e.lineTo(B.x,B.y),e.lineTo(c.x,c.y),m+=2}else if(4===V){var u=D[m-1],S=D[m],P=D[m+1],c=D[m+2];e.moveTo(u.x,u.y),e.lineTo(S.x,S.y),e.moveTo(P.x,P.y),e.lineTo(c.x,c.y),m+=3}}if(e.stroke(),s===N||$===N&&"points"===$.s("edge.type")){e.beginPath(),m=0,e.strokeStyle=H,e.lineWidth=h;for(var n=0;A>n;n++){var V=r.get(n);if(1===V||2===V){if(w===n){var u=D[m-1],c=D[m];e.moveTo(u.x,u.y),e.lineTo(c.x,c.y);break}m++}else if(3===V){if(w===n){var u=D[m-1],B=D[m],c=D[m+1];e.moveTo(u.x,u.y),e.quadraticCurveTo(B.x,B.y,c.x,c.y);break}m+=2}else if(4===V){if(w===n){var u=D[m-1],S=D[m],P=D[m+1],c=D[m+2];e.moveTo(u.x,u.y),e.bezierCurveTo(S.x,S.y,P.x,P.y,c.x,c.y);break}m+=3}else if(5===V&&w===n){var u=D[m-1],c=D[0];e.moveTo(u.x,u.y),e.lineTo(c.x,c.y);break}}e.stroke()}e.beginPath(),m=0,e.strokeStyle=F,e.lineWidth=1,e.fillStyle=_;for(var n=0;A>n;n++){var V=r.get(n);if(1===V||2===V){var c=D[m];e.moveTo(c.x+X,c.y),e.arc(c.x,c.y,X,0,v,!0),m++}else if(3===V){var c=D[m+1];e.moveTo(c.x+X,c.y),e.arc(c.x,c.y,X,0,v,!0),m+=2}else if(4===V){var c=D[m+2];e.moveTo(c.x+X,c.y),e.arc(c.x,c.y,X,0,v,!0),m+=3}}e.fill(),e.stroke(),e.beginPath(),m=0,e.strokeStyle=z,e.lineWidth=1,e.fillStyle=t;for(var n=0;A>n;n++){var V=r.get(n);if(1===V||2===V)m++;else if(3===V){var B=D[m];e.moveTo(B.x+X,B.y),e.arc(B.x,B.y,X,0,v,!0),m+=2}else if(4===V){var S=D[m],P=D[m+1];e.moveTo(S.x+X,S.y),e.arc(S.x,S.y,X,0,v,!0),e.moveTo(P.x+X,P.y),e.arc(P.x,P.y,X,0,v,!0),m+=3}}if(e.fill(),e.stroke(),e.beginPath(),m=0,e.strokeStyle=L,e.lineWidth=2,(s===N||$===N)&&G.$9l!=b){var c=D[G.$9l];e.moveTo(c.x+X,c.y),e.arc(c.x,c.y,X,0,v,!0),e.stroke()}}}}),G.$87l&&J.sm().contains(G.$87l)){var jq,jg=G.$87l,Wp=G.$88l,uo=J.getEditHelperSize(),wp=uo/2;if(J.isHelperEditable(jg,"pointElevation"))if(jg instanceof M){var Vk=jg.getPosition();jq=y.clone(jg.getPoints().get(Wp)),jq=Nd({x:Vk.x,y:Vk.y},jq.x-Vk.x,jq.y-Vk.y,jg.getRotation()),jq.x*=O,jq.y*=O,e.translate(jq.x,jq.y),y.drawImage(e,y.getImage("xeditinteractor_elevationIcon"),wp,-wp,uo,uo),e.translate(-jq.x,-jq.y),G._pointElevationHelperPoint={x:jq.x+uo,y:jq.y}}else if(jg instanceof k){var Qi=dk(J.getDataUI(jg),jg.s("edge.points")),jq=y.clone(Qi.get(Wp));jq.x*=O,jq.y*=O,e.translate(jq.x,jq.y),y.drawImage(e,y.getImage("xeditinteractor_elevationIcon"),wp,-wp,uo,uo),e.translate(-jq.x,-jq.y),G._pointElevationHelperPoint={x:jq.x+uo,y:jq.y}}}e.restore(),G.$5l=0}},$89l:function(x,Y,_,z){x.save();var j=this,P=j.gv,$=P.getEditHelperSize(),f=$/2;x.beginPath(),x.translate(_.x,_.y),x.rotate(Y),y.drawImage(x,z,-f,-f,$,$),x.restore()},$85l:function(J,t,S){var x=this;x.$90l=S,x.$89l(J,t,S,y.getImage("xeditinteractor_elevationIcon"))},$86l:function(T,D,d){var m=this;m.$91l=d,m.$89l(T,D,d,y.getImage("xeditinteractor_tallIcon"))},$77l:function(H,Z,q){var W=this;W.$68l=q,W.$89l(H,Z,q,y.getImage("xeditinteractor_hostIcon"))},$80l:function(P,n,x){var C=this;C.$70l=x,C.$89l(P,n,x,y.getImage("xeditinteractor_edgeIcon"))},$81l:function(q,F,$){var C=this;C.$71l=$,C.$89l(q,F,$,y.getImage("xeditinteractor_removeIcon"))},$76l:function(Q,I,g){var j=this;j.$69l=g,j.$89l(Q,I,g,y.getImage("xeditinteractor_parentIcon"))},$84l:function(u,D,N,Z,E){var S,c=this,J=c.gv,d=J.getZoom(),q=J.getEditHelperSize(),X=q/2;N.x*=d,N.y*=d,E&&(Z?N.x-=X+5:N.x+=X+5),N.y-=q-2,Z?(c.$82l=N,S=y.getImage("xeditinteractor_sourceIcon")):(c.$83l=N,S=y.getImage("xeditinteractor_targetIcon")),u.beginPath(),u.translate(N.x,N.y),y.drawImage(u,S,-X,-X,q,q),u.translate(-N.x,-N.y)},$44l:function(k,G,v){k.save();var Q=this.gv.getZoom(),i=T(n(G.width,2)+n(G.height,2))/2*Q+10,r=i,B=r+8,z=r+18,Y=v,U=G.x+G.width/2,f=G.y+G.height/2;k.translate(U*Q,f*Q),k.beginPath(),k.strokeStyle="rgb(150, 150, 150)";for(var O=0,P=0,h=0,u=0,X=0,t=0;360>t;t++)O=t*$/180,0===t%5&&(P=c(O)*r,h=V(O)*r,u=c(O)*B,X=V(O)*B,k.moveTo(P,h),k.lineTo(u,X)),0===t%45&&(P=c(O)*r,h=V(O)*r,u=c(O)*z,X=V(O)*z,k.moveTo(P,h),k.lineTo(u,X));k.stroke(),k.beginPath(),k.rotate(-d),k.beginPath(),k.fillStyle="rgba(255, 0, 0, 0.1)",k.strokeStyle="rgb(157, 157, 157)",k.moveTo(0,0),k.arc(0,0,z,0,v,!1),k.fill(),k.beginPath(),k.moveTo(0+z,0),k.arc(0,0,z,0,v,!1),k.stroke(),k.rotate(d),k.font="bold 12px Verdana, Arial";var p=20*V(Y),K=20*c(Y),L=E(180*Y/$)+"°";k.textAlign="center",k.textBaseline="middle",k.beginPath();var m=k.measureText("365.°").width;k.fillStyle="white",k.rect(p-m/2,-K-10,m,20),k.fill(),k.beginPath(),k.fillStyle="rgb(79,79,79)",k.fillText(L,p,-K),k.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);