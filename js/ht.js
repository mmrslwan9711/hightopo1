!function(c,j,_){"use strict";function U(v,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function");v.prototype=j.create(M&&M.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),M&&vg(v,M)}function W(N){var C=j.prototype.toString.call(N);return"Array]"===C.substring(C.length-6)}function N(o,b,j,p,H,$){b=b||[],j=j||[],p=p||[];try{b.push(o);var d=Function.apply(0,b);return j[j.length]="return "+d,Function.apply(0,j).apply(0,p)}catch(E){return $&&$(E),H}}function O(N){var b={};return{get:function(r){if(b[r]!==_)return b[r];var U;switch(r){case"WEBGL_depth_texture":U=N.getExtension("WEBGL_depth_texture")||N.getExtension("MOZ_WEBGL_depth_texture")||N.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":U=N.getExtension("EXT_texture_filter_anisotropic")||N.getExtension("MOZ_EXT_texture_filter_anisotropic")||N.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":U=N.getExtension("WEBGL_compressed_texture_s3tc")||N.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||N.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":U=N.getExtension("WEBGL_compressed_texture_pvrtc")||N.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":U=N.getExtension("WEBGL_compressed_texture_etc1");break;default:U=N.getExtension(r)}return b[r]=U,U}}}function G(l,g,W){function w(){if(D!==_)return D;var W=g.get("EXT_texture_filter_anisotropic");return D=null!==W?l.getParameter(W.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function d(e){if("highp"===e){if(l.getShaderPrecisionFormat(l.VERTEX_SHADER,l.HIGH_FLOAT).precision>0&&l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&l.getShaderPrecisionFormat(l.VERTEX_SHADER,l.MEDIUM_FLOAT).precision>0&&l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var D;W=W||{};var B="undefined"!=typeof WebGL2RenderingContext&&l instanceof WebGL2RenderingContext,j=W.precision!==_?W.precision:"highp",e=d(j);e!==j&&(console.warn("WebGL:",j,"not supported, using",e,"instead."),j=e);var O=W.logarithmicDepthBuffer===!0,M=l.getParameter(l.MAX_TEXTURE_IMAGE_UNITS),p=l.getParameter(l.MAX_VERTEX_TEXTURE_IMAGE_UNITS),L=l.getParameter(l.MAX_TEXTURE_SIZE),z=l.getParameter(l.MAX_CUBE_MAP_TEXTURE_SIZE),F=l.getParameter(l.MAX_VERTEX_ATTRIBS),H=l.getParameter(l.MAX_VERTEX_UNIFORM_VECTORS),Z=l.getParameter(l.MAX_VARYING_VECTORS),J=l.getParameter(l.MAX_FRAGMENT_UNIFORM_VECTORS),k=p>0,N=B||!!g.get("OES_texture_float"),I=(B||!!g.get("OES_element_index_uint"))&&"undefined"!=typeof Uint32Array,c=k&&N,o=B?l.getParameter(l.MAX_SAMPLES):0;return{getMaxAnisotropy:w,getMaxPrecision:d,precision:j,logarithmicDepthBuffer:O,maxTextures:M,maxVertexTextures:p,maxTextureSize:L,maxCubemapSize:z,maxAttributes:F,maxVertexUniforms:H,maxVaryings:Z,maxFragmentUniforms:J,vertexTextures:k,floatFragmentTextures:N,elementTypeUint:I,floatVertexTextures:c,maxSamples:o}}function q(G,F){return G.z!==F.z?F.z-G.z:G.id-F.id}var e="ht";if(!c[e]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),c.performance&&c.performance.now||function(){var E=Date.now();c.performance||(c.performance={}),c.performance.now=function(){return Date.now()-E}}();for(var L=Date.now(),N=16,d=["ms","moz","webkit","o"],F=0;F<d.length&&!c.requestAnimationFrame;++F)c.requestAnimationFrame=c[d[F]+"RequestAnimationFrame"],c.cancelAnimationFrame=c[d[F]+"CancelAnimationFrame"]||c[d[F]+"CancelRequestAnimationFrame"];c.requestAnimationFrame||(c.requestAnimationFrame=function(u){var m=Date.now(),B=N+L-m;return 0>B&&(B=0),L=m,c.setTimeout(function(){L=Date.now(),u(performance.now())},B)}),c.cancelAnimationFrame||(c.cancelAnimationFrame=function($){return c.clearTimeout($)}),j.assign===_&&(j.assign=function(E){if(E===_||null===E)throw new TypeError("Cannot convert undefined or null to object");for(var B=j(E),O=1;O<arguments.length;O++){var N=arguments[O];if(N!==_&&null!==N)for(var g in N)j.prototype.hasOwnProperty.call(N,g)&&(B[g]=N[g])}return B}),c.btoa===_&&(c.btoa=function(I){for(var u,V,Q=String(I),$=0,j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";Q.charAt(0|$)||(j="=",$%1);c+=j.charAt(63&u>>8-8*($%1))){if(V=Q.charCodeAt($+=.75),V>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");u=u<<8|V}return c})}();var n,r,y,t,Z=c.location,K=Z&&c.document,I=null,R=_,A=c[e]={},T=c[e+"config"],z=A.Default=T&&T.Default||{},s=A.Style=T&&T.Style||{},C=A.Attr=T&&T.Attr||{},u=function(){return!0},v=function(){return!1},x=function(n){return n},o=function(g){return!g},Y=A.Color=T&&T.Color||{},V=A.IsGetter=T&&T.IsGetter||{};!function(){var p=!1;try{var Q=j.defineProperty({},"passive",{get:function(){return p=!0,_}});Z&&(y=n=Z)&&c.addEventListener("test",Q,Q),Z&&(t=r=Z)&&c.removeEventListener("test",Q,Q)}catch(D){p=!1}z.passiveSupported=p}();var X,F,S,J,P=z.passiveSupported,H=z.eventListenerOptionsFalse=P?{passive:!1,capture:!1}:!1,m=z.eventListenerOptionsTrue=P?{passive:!1,capture:!0}:!0,p=function(s,i,Q,I){s.addEventListener(i,Q,I?m:H)},g=function(N,u,O,M){N.removeEventListener(u,O,M?m:H)},Q=Math,b=Q.round,k=Q.floor,L=Q.ceil,w=Q.sqrt,i=Q.max,a=Q.min,f=Q.abs,l=Q.cos,E=Q.acos,d=Q.sin,D=Q.pow,B=Q.asin,M=Q.exp,h=Q.PI,$=2*h,Rg=h/2,Bl=Q.tan,id=Q.atan2,wk=Q.random,Rj=Q.log,Am=function(n,z,u){return Math.max(z,Math.min(u,n))},qd=D(2,1),Lr=!1,Fq=c.parseInt||global.parseInt,ol="2022-02-15",bn=Z&&(c.navigator?c.navigator.platform.indexOf("Win")>-1:!1),cc=function(l){return l*l},Nq=Z&&c.setTimeout,np=Z&&c.clearTimeout,pd=Z&&(c.navigator?c.navigator.userAgent.toLowerCase():""),Lk=function(t){return t.test(pd)},gj=Lk(/msie/),jn=Lk(/msie/)||Lk(/trident/),Ek=Lk(/msie 10/),ob=Lk(/edge/),zc=Lk(/firefox/),vp=Lk(/mac/),Xh=Lk(/mscAndroid/),to=z.isTouchable===_?bn?!1:K?"ontouchend"in K:!1:z.isTouchable,hl="default",hm="single",rj="multiple",Pd="front",rm="back",iq="left",bq="right",wg="top",wn="bottom",Cj="center",Mj="eye",el="middle",Tm="east",zp="west",vs="north",ne="none",pn="px",us="absolute",so="border",yk="triangle",qk="rect",Zj="circle",wb="cylinder",eo="shape",vn="items",Rh="normal",Oe="remove",gs="clear",fe="width",dj="height",ze="ingroup",es="check",Qn="uncheck",Gn="radio",Fm="radioOn",dr="radioOff",Wq="points",zl="values",mp="series",nr="body",rc="label",vb="label2",Zf="note",gi="note2",lq="icons",Dh="labelFont",Zc="labelColor",Mg="labelSelectColor",Vk="note.expanded",Ph="note2.expanded",up="edge.expanded",Wl="edge.points",hs="edge.type",Yn="rotation",mr="hidden",Xn="visible",zo="tuv",tq="no",Jf="draw",Ab="select",On="currentSubGraph",Nf="selectBackground",Vn="autoMakeVisible",$q="autoHideScrollBar",$k="scrollBarColor",Hb="scrollBarSize",zg="indent",Mr="rowHeight",xo="columnLineColor",qm="rowLineColor",cp="columnLineVisible",ch="rowLineVisible",Jo="visibleFunc",ye="expandIcon",kq="collapseIcon",Jp="checkMode",hn="sortFunc",ug="editable",Vh="batchEditable",bc="tristate",de="asc",gn="desc",se="position",Zp="__",Ee="elevation",ur="children",Wm="translateX",mg="translateY",Vi="dataModel",qg="maxSize",Bh="enc",be="state",eq=Bh+"o"+"de",hc="shape3d",fd="shape3d.resolution",er="shape3d.visible",xq="shape3d.from.visible",pf="shape3d.to.visible",Sm="shape3d.top.visible",Ig="shape3d.bottom.visible",ao="repeat.uv.length",Uj="serializeValue",Ug="deserializeValue",og="centerUniform",ub="uniform",ql="rgba(255,255,255,0)",cn="style",yo="attr",Rk="field",mh="string",mc="boolean",is="color",En="int",sh="number",rh="ew-resize",Vq="ns-resize",yn="pointer",nf="auto",Bj="mousedown",vf="mousemove",Qf="mouseup",Yg="mouseout",Zn="touchstart",Wi="touchmove",ws="touchend",Ld="keydown",an="keyup",Cf=["DOMMouseScroll","mousewheel"],Vc=zc?Cf[0]:Cf[1],rp=Zp+e+Zp+eq,ep=[Zn,Wi,ws],ul=[Bj,vf,Qf,Yg,Vc,"wheel","mouseenter","mouseleave","mouseover"],xs=[Ld,an,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],Ye=to?ep.concat(xs):ul.concat(xs),pm=I,sq=I,hg=I,kn=I,ig=!0,Tp=Qf.length,kf=function(){hg&&(np(hg.timeout),hg=I)},cm=function(){hg&&ai(hg.e,hg.info)};c.addEventListener&&(R=Z)&&(to||(p(c,Yg,function(){kf()}),p(c,Vc,function(){Tk()})),p(c,an,function(B){91===B.keyCode?Yk={}:delete Yk[B.keyCode]},!0),p(c,Ld,function(Z){Yk[Z.keyCode]=!0},!0),p(c,"blur",function(){Yk={}}));var xe,Rc,Fl,Yr=0,nn=I,xr=function(l,_){var p=Nq(function(){delete nn[p],Ze(nn)&&(nn=I),l()},_);return p},ik=I,So=I,ls={},Qj={},Ll={},Pi={},ve={},Yk={},Dj={},Td={},Yb={},nm={},Ul=/.json$/,Rb=/\.(json|bin)$/,lo=/^data:image\/svg\+xml/,gh={},fo=[],sd={},uq=I,Ve=I,jb=function(){},Bs=function(){throw"Oops!"},Np=[0,0,0],Uf={x:0,y:0,width:0,height:0},Lj=I,Vp=I,xg=I,Hm=function(T,k){Qj[T]=k,k&&k.comps&&!k.uuid&&(k.uuid=A.Math.generateUUID()),ac[T]&&(k.cacheRule=ac[T],delete ac[T])},Hk=function(q){Vp&&!q._72O&&(xg||(xg={}),xg[q._72O=Nr()]=q),xe!=I?am()<.05&&J&&!Rc&&(Ql=kf):Ql=Je},nq=function(d,N,E,Q){Vp||(Vp={});var H=Vp[d];if(H){if(H.url===N)return;H.image?(H.image.onload=jb,H.image.onerror=jb):H.request&&(H.request.onload=jb,H.request.onerror=jb)}if(Ul.test(N)){var U=new ld;if(Vp[d]={request:U,url:N},N=z.beforeLoadURL(N,d),N.data){var M=z.parse(N.data);Xc(d,M),z.handleImageLoaded(d,M)}else{U.onload=function(){if(200===this.status||0===this.status){var F=z.parse(U.getResponseText());Xc(d,F),z.handleImageLoaded(d,F)}else Xc(d,z.handleUnfoundImage(d,N)||I)},U.onerror=function(){Xc(d,z.handleUnfoundImage(d,N)||I)};var f={};f.url=encodeURI(N),f.sync=!1,U.send(f)}}else{var M=new Image;Vp[d]={image:M,url:N},/^data:image/.test(N)||(N=z.beforeLoadURL(N,d),N=z.appendTimeStamp(N),N=encodeURI(N),M.crossOrigin=z.crossOrigin),z.convertImageSrc(N,function(D){jn&&(N.toLowerCase().indexOf(".svg")>0||lo.test(N))?(K.body.appendChild(M),M.style.visibility="hidden",M.onload=function(){Nq(function(){if(E&&(M.width=E),Q&&(M.height=Q),!M.width||!M.height){var q=M.width||M.clientWidth,h=M.height||M.clientHeight;M.width=q,M.height=h}z.handleImageLoaded(d,M),Xc(d,M),K.body.removeChild(M),M.style.visibility=""},180)},M.onerror=function(){Xc(d,z.handleUnfoundImage(d,N)||I),K.body.removeChild(M),M.style.visibility=""}):(M.onload=function(){E&&(M.width=E),Q&&(M.height=Q),z.handleImageLoaded(d,M),Xc(d,M)},M.onerror=function(){Xc(d,z.handleUnfoundImage(d,N)||I)}),M.src=D})}},Xc=function(F,c){if(Hm(F,c),delete Vp[F],Ze(Vp)&&(Vp=I,xg)){for(var q in xg){var W=xg[q];W._2O&&W._2O[F]&&(W.deleteTexture(F),delete W._2O[F]),W.invalidateAll&&W.invalidateAll(_,"imageLoaded",F),W.redraw&&W.redraw(),W.iv(),c&&c.layoutAttach&&gg(W.dm)&&W.dm().updateLayoutAttach(F),delete W._72O}xg=I}if(c&&xg)for(var q in xg){var W=xg[q];W.invalidateAll&&W.invalidateAll(_,"imageLoading",F),W.redraw&&W.redraw(),W.iv(),c.layoutAttach&&gg(W.dm)&&W.dm().updateLayoutAttach(F)}},Jd=function(){return Rj=Q&&Date,function(){return c.performance&&c.performance.now?c.performance.now():Date.now()}}(),Lm=function(R,i,K){return{width:R,height:i,comps:gc(K)?K:[K]}},Oo=function(l,S){return{type:Zj,rect:[l,S,1.6,1.6],borderWidth:1,borderColor:Gp,gradient:uo,gradientColor:hf,background:Gp}},Yf=function(G,t){return Lm(16,16,{type:yk,rect:[4,4,10,8],background:G,rotation:t?1.57:3.14})},sf=function(Y,X){return Lm(16,16,{type:yk,rect:[4,4,8,7],background:Y,rotation:X?3.14:0})},Im=function(O){var G=O._orientation;return"horizontal"===G||"h"===G},xm=function(_,Q){var p=I||4,V=I||1,S=I||1;0>p?p=0:p>.25&&(p=.25);var x,j,B,H,a,k,R,D=.5,w=[],q=[],Y=[],t=$/S,o=$/V,J=D-p;for(j=0;V>=j;j++)for(H=-h+j*o,k=l(H),a=d(H),x=0;S>=x;x++)B=x*t,R=J+p*k,w.push(l(B)*R,a*p,-d(B)*R),(F=[_,Q])&&q.push(x/S,1-j/V);for(j=0;V>j;j++){var W=j*(S+1),T=(j+1)*(S+1);for(x=0;S>x;x++)Y.push(W+x,T+x+1,T+x,W+x,W+x+1,T+x+1),Vo.z=qc.z=[_,Q]}},kh=function(N){var n=2,P=0;for(var B in N)B.length===n&&Fq(B,32)===Zi&&(uq=Ve=N[B]),P++;return P},rd=function(R,o,E,O){return E||(E=to?5:3,E/=O||1),{x:R-E,y:o-E,width:2*E,height:2*E}},yr=function(P,q,V,d){var x=this;q||(q=to?5:3,V=20,d=20);var T={x:P,y:q,width:V,height:d};if(V)for(var m=0;V>m;m++)if(3===V)d=20;else for(var A=0;d>A;A++)x=c?c:V;var B={x:h,y:2*h};if(An(T,B)){var a=dj[0]+wg[0]+gs[1]+de.length,u=mr[0]+bc[0]+gs[1]+nr.length;Sn[Mj]=[x[a],x[u]],x[a]=om[Mj],x[u]=om[hc]}},yf=function(w){return(/ble$/.test(w)||/ed$/.test(w)||V[w]?"is":"get")+w.charAt(0).toUpperCase()+w.slice(1)},om=function(F){return"set"+F.charAt(0).toUpperCase()+F.slice(1)},Fp=function(t){return typeof t===mh||t instanceof String},Cp=function(X){return typeof X===sh},Je=function(c){return typeof c===mc},qf=function(m){return m&&"object"==typeof m},gg=function(u){return"function"==typeof u},gc=function(c){return c instanceof Array},vq=function(h){return h instanceof Gc},Mp=function(o){return gc(o)?new Gc(o):o},Fg=function(k){return k instanceof jr},Rn=function(P){return P instanceof Mf},Re=function(t){return t instanceof oq},os=function(P,x){if(!(P instanceof A.Group))return!1;if(!x)return P.isExpanded();var u=x.getDataUI(P);return u&&u._88I?!0:!1},kl=function(i){return i instanceof dp},xd=function($){return $&&"IFRAME"===$.tagName},wd=function(a){return a==I||z.numberDigits==I?a:parseFloat(a.toFixed(z.numberDigits))},Gf=function(D,t,i){var o,r=t.length;if(i)for(var m=0;i>m;m++)if(3===r)D.push(t[0]),D.push(t[1]),D.push(t[2]);else for(o=0;r>o;o++)D.push(t[o]);else if(3===r)D.push(t[0]),D.push(t[1]),D.push(t[2]);else for(o=0;r>o;o++)D.push(t[o])},Zq=function(L){return L?qf(L)?L:{}:!1},Xi=function(Y,W,A){var G,p=qf(Y)?Y:Y.prototype;for(G in W)A&&G in p?p[G]===_&&console.warn("class",p,"has own undefined property",G,", keep exist!"):p[G]=W[G];return Y},Sr=function(Q,D){if(!("wheelDelta"in D)){var h=D.deltaMode;D.wheelDelta=h===D.DOM_DELTA_PIXEL?-D.deltaY:h===D.DOM_DELTA_LINE?40*-D.deltaY:120*-D.deltaY}Q.handle_mousewheel(D)},$m=function(N){return String.fromCharCode(N)},Cq=function(s){for(var u,W=0,N="";W<s.length;W++)u=s[s.length-1-W],"%"===u?u="'":"a"===u?u='"':"]"===u&&(u="\\"),N+=$m(u.charCodeAt(0)-1);return N},nk=function(G,t,M){G.superClass.constructor.apply(t,M)},Ze=function(L){for(var i in L)return!1;return!0},ks=function(d){return d?0===d.length:!0},Ck=function(){var Q="";return[Qn[0],qm[0],rc[0]].forEach(function(e){Q+=om(e).slice(3)}),ub=K&&K[Q]||og,function(E,a){return E===a?!0:E.x===a.x&&E.y===a.y&&E.width===a.width&&E.height===a.height}}(),ki=function(u,D,m){return D>u?D:u>m?m:u},Oh=function(q){return 0>q?-1:q>0?1:0},am=function(){var U=1e4*d(Tp++);return U-k(U)},tj=function(E,t,G){return ip(E.x,E.y,t.x,t.y,G.x,G.y,G.x+G.width,G.y,!0)||ip(E.x,E.y,t.x,t.y,G.x+G.width,G.y,G.x+G.width,G.y+G.height,!0)||ip(E.x,E.y,t.x,t.y,G.x+G.width,G.y+G.height,G.x,G.y+G.height,!0)||ip(E.x,E.y,t.x,t.y,G.x,G.y+G.height,G.x,G.y,!0)},ip=function(p,h,y,v,G,R,Z,b,A){var j=(Z-G)*(h-R)-(b-R)*(p-G),C=(b-R)*(y-p)-(Z-G)*(v-h);if(0!==C){var P=j/C,q=p+P*(y-p),n=h+P*(v-h);return A&&(q+Nm<a(p,y)||q-Nm>i(p,y)||q+Nm<a(G,Z)||q-Nm>i(G,Z)||n+Nm<a(h,v)||n-Nm>i(h,v)||n+Nm<a(R,b)||n-Nm>i(R,b))?I:[q,n]}return I},nb=function(L,g,J){if(L&&J)if(g){if(g===cn)return L.getStyle(J);if(g===yo)return L.getAttr(J);if(g===Rk)return L[J]}else if(J=yf(J),L[J])return L[J]();return _},gm=function(w,o,U,F){if(w&&U)if(o){if(o===cn)w.s(U,F);else if(o===yo)w.a(U,F);else if(o===Rk){var Z=w[U];w[U]=F,w.fp("f:"+U,Z,F)}}else U=om(U),w[U]&&w[U](F)},ke=function(u,i,E){var K=100*Math.max(u.width,u.height);return i&&"top"!==i?"bottom"===i?{x:u.x-K,y:u.y-K,width:u.width+2*K,height:u.height*E+K}:"right"===i?{x:u.x-K,y:u.y-K,width:u.width*E+K,height:u.height+2*K}:"left"===i?{x:u.x+u.width*(1-E),y:u.y-K,width:u.width*E+K,height:u.height+2*K}:void 0:{x:u.x-K,y:u.y+u.height*(1-E),width:u.width+2*K,height:u.height*E+K}},Cg=function(P,o,w,t,x){o&&Eq(P,w,t,1,x,o)},jm=function(i,P,h,Q){var u=1-i;return u*u*P+2*i*u*h+i*i*Q},Vo=function(F,z,b,d,A){var q=1-F;return q*q*q*z+3*q*q*F*b+3*q*F*F*d+F*F*F*A},Pg=function(T){var Y,F,O,w,e=0;return T.forEach(function(m){if(Y=m.length,Y>0)for(F=m[0],w=1;Y>w;w++)O=m[w],e+=Hd(F,O),F=O}),e},jg=function(O,I,X){var x="__"+O,b=function(o){("mousedown"===O||"mouseup"===O||"touchstart"===O||"touchend"===O)&&we(o),X.disabled||X["handle_"+O](o)};X[x]||(X[x]=b,p(I,O,b))},gp=function(V,j,S){var w="__"+V,o=S[w];o&&(g(j,V,o),delete S[w])},Yo=function(J,B){var F="_"+B;J[yf(B)]=function(){return this[F]},J[om(B)]=function(X){var f=this[F];this[F]=X,this.fp(B,f,X)}},ck=function(h){return j.create(h)},uk=function(O){if(!O.element){var $,j;($=O.textField)?j=jq(xt.TextField,$):($=O.textArea)?j=jq(xt.TextArea,$):($=O.button)?j=jq(xt.Button,$):($=O.comboBox)?j=jq(xt.ComboBox,$):($=O.checkBox)?j=jq(xt.CheckBox,$):($=O.radioButton)?j=jq(xt.RadioButton,$):($=O.slider)?j=jq(xt.Slider,$):($=O.colorPicker)?j=jq(xt.ColorPicker,$):($=O.image)&&(j=jq(xt.Image,$)),j&&(O.element=j)}},nh=function(j,$){var T=_k(j);return T._ht=$,T},Qp=c.top===c?c.top:c||c.document,_k=function(f,u){var l=K.createElement("div"),h=l.style;return l.tabIndex=-1,l.onkeydown=um,h.msTouchAction=ne,Rp(l,I,0),to&&h.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",I),f&&(h.overflow=mr),u&&Ik(u,l),l},th=function(u,v){var X=K.createElement("canvas"),H=X.style;return H.msTouchAction=ne,v||(H.pointerEvents=ne),Rp(X,I,0),u&&Ik(u,X),X},Rp=function(v,I,d){var o=v.style;o.border=I?I+" solid 1px":0,o.outline=0,o.padding=d?"0 "+d+pn:0,oe(v)},oe=function(w){var Z=w.style;Z.position=us,Z.margin=0,Z.setProperty("box-sizing","border-box",I),Z.setProperty("-moz-box-sizing","border-box",I)},Pq=function(Y,N,o,f){f||(f=Ch),N!=I&&(Y.width=N*f,Y.style.width=N+pn),o!=I&&(Y.height=o*f,Y.style.height=o+pn)},Ik=function(Z,U,_){Z.appendChild(U),_&&(U.style.position=us)},sl=function(a,A){A.split||(A+="");for(var j,t=A.split("\n"),z=0,R=t.length,U=0;R>U;U++){var _=me(a.font,t[U]);_.width>z&&(z=_.width),j||(j=_.height)}return a.ss=t,{width:z,height:j*R}},Fo=function(){var v=K?th().getContext("2d"):I;return function(n,B,c,P,q,g){var R=n.split("\n"),S=[];return P||(P=0),v.font=c,v.textBaseline=wg,R.forEach(function(h){for(var f=0,e=1,H=0,M=h.length;M>=e;e++){var j=h.substring(f,e),s=q?v.measureText(h[e]):me(c,j);q&&(H+=s.fontBoundingBoxDescent);var b=q?H+(j.length-1)*g:s.width+(j.length-1)*P;b>B&&(e-1===f?(S.push(h.substring(f,e)),f=e):(S.push(h.substring(f,e-1)),f=e-1,e--),H=0)}f!==e-1&&S.push(h.substring(f,e))}),S}}(),Jq=function(E,d,Q,Y,M,R,C,b){E.font=Q;var L=E.measureText(d);E.beginPath(),E.strokeStyle=Y,E.lineWidth=1,"underline"===b?(E.moveTo(M-C/2,R+L.actualBoundingBoxDescent+1),E.lineTo(M+C/2,R+L.actualBoundingBoxDescent+1)):"strikethrough"===b?(E.moveTo(M-C/2,R),E.lineTo(M+C/2,R)):"overline"===b&&(E.moveTo(M-C/2,R-L.fontBoundingBoxAscent),E.lineTo(M+C/2,R-L.fontBoundingBoxAscent)),E.stroke()},tl=function(J,k,A,s,O,X,q,n,r,w,G){var B=O.x,H=O.y,C=O.width,g=O.height;if(k!=I){var S=me(A,k),F={};r&&(S.width+=(k.length-1)*r),F.y=q&&q!==el?q===wg?H+S.height/2:H+g-S.height/2:H+g/2,F.x=X&&X!==iq?X===bq?B+C-S.width/2:B+C/2:B+S.width/2,ok(J,k,F,A,s,r,w,G),n&&Jq(J,k,A,s,F.x,F.y,S.width,n)}},sn=function(V,N,P,x,H,G,K,q,O,M){var e=N.length;if(1===e){var _=N[0];if(ok(V,_,P,x,H,q,O,M),K){var T=me(x,_);Jq(V,_,x,H,P.x+P.width/2,P.y+P.height/2,T.width,K)}}else for(var p=P.height/e,z={x:P.x,y:P.y,width:P.width,height:p},L=0;L<N.length;L++){if(G)tl(V,N[L],x,H,z,G,null,K,q,O,M);else if(ok(V,N[L],z,x,H,q,O,M),K){var T=me(x,N[L]);Jq(V,N[L],x,H,z.x+z.width/2,z.y+z.height/2,T.width,K)}z.y+=p}},ok=function(k,r,O,N,W,S,J,c){k.font=N?N:fl,k.fillStyle=W?W:yb,k.textAlign=Cj,k.textBaseline=el;var s,w;O?O.width===_?(s=O.x,w=O.y):(s=O.x+O.width/2,w=O.y+O.height/2):(s=0,w=0);var x=J&&c;if(x&&(k.strokeStyle=c,k.lineWidth=J),S){var i=me(N,r);s-=(i.width+S*(r.length-1))/2;for(var A=(r+"").length,E=0;A>E;E++){var X=r[E],u=k.measureText(X);x&&k.strokeText(X,b(s+(u.width+4)/2),b(w)),k.fillText(X,b(s+(u.width+4)/2),b(w)),s+=u.width+S}}else x&&k.strokeText(r,b(s),b(w)),k.fillText(r,b(s),b(w))},qr=function(A){A.getView&&(A=A.getView());var p=A.offsetWidth||A.scrollWidth;return!p&&A.style.width&&(p=Fq(A.style.width)),p},zi=function(N){N.getView&&(N=N.getView());var m=N.offsetHeight||N.scrollHeight;return!m&&N.style.height&&(m=Fq(N.style.height)),m},vr=function(R,K,n){var N=K[0].toUpperCase()+K.substring(1,K.length);R["webkit"+N]=n,R["moz"+N]=n,R["ms"+N]=n,R["o"+N]=n,R[K]=n},Sd=function(){var Q=function(D){um(D),D.stopPropagation()},l=function(S){um(S)},o=[Zn,Ld,Bj];return function(Y,c){var n=_k(),L=n.style;return L.backgroundColor=z.disabledBackground,Y&&(L.backgroundImage="url("+Y+")",L.backgroundPosition="50% 50%",L.backgroundRepeat="no-repeat no-repeat"),c===!1?o.forEach(function(M){p(n,M,l)}):o.forEach(function(I){p(n,I,Q)}),n}}(),wr=function(J){var m=J.getContext("2d");return m.save(),m.lineCap=cj,m.lineJoin=tg,m},Ql=function(Q,U,y,q){Fi(Q,U*Ch,y*Ch),q*=Ch,1!==q&&Q.scale(q,q)},Fi=function(s,U,H){s.translate(U,H)},Gd=function(O,a){a&&O.rotate(a)},Dm=function(h,a,r){a===_&&(a=1),r===_&&(r=1),(1!==a||1!==r)&&h.scale(a,r)},zr=!1,M=Qp[es[1]+Wm[0]],cf=function(r){var o=K.activeElement;if(K.activeElement!==r){o&&o.forceOnblur&&o.forceOnblur();for(var f=[],E=r.parentNode;E;)f.push([E,E.scrollLeft,E.scrollTop]),E=E.parentNode;if(!zr){var B=[],C=[];try{for(var m=c.parent,e=c;m!==e;)B.push([m,m.scrollX,m.scrollY]),e=m,m=c.parent;var t=c.frameElement;if(t)for(var g=t.parentNode;g;)C.push([g,g.scrollLeft,g.scrollTop]),g=g.parentNode}catch(W){zr=!0}}if(to)r.focus();else{var M=Mb(),Z=M.target;r.focus(),Z.scrollLeft=M.left,Z.scrollTop=M.top}f.forEach(function(B){B[0].scrollLeft=B[1],B[0].scrollTop=B[2]}),zr||(B.forEach(function(B){B[0].scrollTo(B[1],B[2])}),C.forEach(function(s){s[0].scrollLeft=s[1],s[0].scrollTop=s[2]}))}},Nb=function(I){return I&&I.getView?I.getView():I},zb=function(w,L,s,x,M){if(2===arguments.length&&(s=L.y,x=L.width,M=L.height,L=L.x),w.isSelfViewEvent)w.setX(L),w.setY(s),w.setWidth(x),w.setHeight(M);else{var V=Nb(w),Z=V.style;if((K.fullscreenElement||K.mozFullScreenElement||K.webkitFullscreenElement||K.msFullscreenElement)!==V)L!==_&&(Z.left=L+pn),s!==_&&(Z.top=s+pn),x!==_&&(Z.width=x+pn),M!==_&&(Z.height=M+pn);else{var G=z.getWindowInfo();Z.left=(L=G.left)+pn,Z.top=(s=G.top)+pn,Z.width=(x=G.width)+pn,Z.height=(M=G.height)+pn}w.endEditing&&!to&&w.endEditing(),w.redraw&&w.redraw(),w.invalidate&&w.invalidate(),w.onLayouted&&w.onLayouted(L,s,x,M),w.fireViewEvent&&w.fireViewEvent("layout")}},$b=function(f){if(!f.touches)return f;var V=f.touches[0];return V?V:f.changedTouches[0]},qo=function(D){return Pm(D)?$b(D).target:D.target},Pm=function(B){return B&&"object"==typeof B&&"touches"in B},Vl=function(V){z.popup&&z.popup.close(),z.popup=V},Lq=I,Hq=function(y){Lq.handleWindowTouchMove(y)},uc=function(w){Lq.handleWindowTouchEnd(w),g(c,Wi,Hq),g(c,ws,uc),g(c,"blur",uc),Lq=I},fc=function(n){Lq.handleWindowMouseMove(n)},yp=function(m){Lq.handleWindowMouseUp(m),g(c,vf,fc),g(c,Qf,yp),g(c,"blur",yp),Lq=I},jf=function(T){return 1===hq(T)},wp=function(w,z){return z?z.keyCode===w:Yk[w]},Kf=function(X){return Ro(X)&&wp(65,X)},yq=function(N){return wp(46,N)||wp(8,N)},Rf=function(u){return function(G){return G?G.keyCode===u:Yk[u]}},Zi=573,mo=[65,83,68,87,37,38,39,40,32,13,27],pb=Rf(mo[0]),mb=Rf(mo[1]),mi=Rf(mo[2]),_n=Rf(mo[3]),li=Rf(mo[4]),mq=Rf(mo[5]),ar=Rf(mo[6]),si=Rf(mo[7]),Ui=Rf(mo[8]),dc=Rf(mo[9]),Li=Rf(mo[10]),on={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},ss=[2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,5,5,5,5,5,19,167],Xj=I,Wg=I,ys=function(U,g){Xj||(Xj=th()),Pq(Xj,U,g,1);var L=wr(Xj);return L.clearRect(0,0,U,g),L},cb=function(c,T,I){if(T&&c){if("override"===I)return T;if("override_rgb"===I){var N=Tj(T);return c=Yc(c),"rgba("+b(255*N[0])+","+b(255*N[1])+","+b(255*N[2])+","+c[3]/255+")"}if("override_a"===I){var N=Tj(T);return c=Yc(c),"rgba("+c[0]+","+c[1]+","+c[2]+","+N[3]+")"}if("multiply_destinationAtop"===I){var e=Tl(Tj(c)),o=e[3],k=Tl(Tj(T)),G=k[3],E=Tl(e),F=E[3],C=e.map(function(h,G){return h*k[G]}),v=1-o,l=1-G,D=l*o+G;return e=e.map(function(A,Y){return(G*v*k[Y]+G*o*C[Y]+l*o*A)/D}),o=D,v=1-o,e=e.map(function(L,N){return(F*E[N]*v+o*L*F)/F}),o=F,"rgba("+b(255*e[0])+","+b(255*e[1])+","+b(255*e[2])+","+o+")"}var N=Tj(T);return c=Yc(c),"rgba("+b(c[0]*N[0])+","+b(c[1]*N[1])+","+b(c[2]*N[2])+","+c[3]/255*N[3]+")"}return c},Yc=function(){var e,K={};for(var r in c){var h=rj.length;if(r.length==h&&r[0]===rj[2]&&r[1]===ne[1]&&r[4]===rj[3]&&r[5]===rj[4]&&r.substr(h-2)===ne[1]+ne[2]){var Q=c[r];for(var F in Q)F.length===h&&F.substr(0,3)===bq[3]+Oe[3]+Ab[0]&&F.substr(h-2)===rj[0]+Zf[3]&&(Cf=Q[F])}}return function(U){var Z,f=K[U];return f||(e||(e=th(),Pq(e,1,1,1)),Z=e.getContext("2d"),Z.clearRect(0,0,1,1),Eq(Z,0,0,1,1,U),f=Z.getImageData(0,0,1,1).data,f=K[U]=[f[0],f[1],f[2],f[3]]),f}}(),Tj=function(z){if(!Fp(z))return z;var w=Yc(z);return w.CA||(w.CA=[w[0]/255,w[1]/255,w[2]/255,w[3]/255]),w.CA},ir=function(p,Q,k,F,B){var a=th();a.width=k,a.height=F;var d=a.getContext("2d");d.drawImage(p,0,0,k,F);try{for(var W=d.getImageData(0,0,k,F),O=W.data,z=0,V=O.length;V>z;z+=4){var C=O[z+0],Y=O[z+1],m=O[z+2],i=O[z+3];"override_a"===B?O[z+3]=255*Q[3]:"override_rgb"===B?(O[z+0]=255*Q[0],O[z+1]=255*Q[1],O[z+2]=255*Q[2]):"override"===B?(O[z+0]=255*Q[0],O[z+1]=255*Q[1],O[z+2]=255*Q[2],O[z+3]=255*Q[3]):(O[z+0]=Q[0]*C,O[z+1]=Q[1]*Y,O[z+2]=Q[2]*m,O[z+3]=Q[3]*i)}d.putImageData(W,0,0)}catch(o){return p}return a},Sn=function(e,z,i){return z&&(z="miter"===i?8*z+20:z+1,e&&oh(e,z)),z},Ln=function(X,s){if(s){var z=new Xl(s),P=X.width/2,x=X.height/2,j=Mc([z.tf(-P,-x),z.tf(P,-x),z.tf(P,x),z.tf(-P,x)]);return j.x+=X.x+P,j.y+=X.y+x,j}return X},ro=function(P,e,n,x,O,Q,U,E){x*=Math.PI/180;var c={x:Math.cos(x)*(P.x-U.x)/2+Math.sin(x)*(P.y-U.y)/2,y:-Math.sin(x)*(P.x-U.x)/2+Math.cos(x)*(P.y-U.y)/2},K=Math.pow(c.x,2)/Math.pow(e,2)+Math.pow(c.y,2)/Math.pow(n,2);K>1&&(e*=Math.sqrt(K),n*=Math.sqrt(K));var _=(O==Q?-1:1)*Math.sqrt((Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(c.y,2)-Math.pow(n,2)*Math.pow(c.x,2))/(Math.pow(e,2)*Math.pow(c.y,2)+Math.pow(n,2)*Math.pow(c.x,2)));isNaN(_)&&(_=0);var F={x:_*e*c.y/n,y:_*-n*c.x/e},k={x:(P.x+U.x)/2+Math.cos(x)*F.x-Math.sin(x)*F.y,y:(P.y+U.y)/2+Math.sin(x)*F.x+Math.cos(x)*F.y},V=function(x){return Math.sqrt(Math.pow(x[0],2)+Math.pow(x[1],2))},X=function(b,r){return(b[0]*r[0]+b[1]*r[1])/(V(b)*V(r))},z=function(W,r){return(W[0]*r[1]<W[1]*r[0]?-1:1)*Math.acos(X(W,r))},q=z([1,0],[(c.x-F.x)/e,(c.y-F.y)/n]),u=[(c.x-F.x)/e,(c.y-F.y)/n],$=[(-c.x-F.x)/e,(-c.y-F.y)/n],j=z(u,$);X(u,$)<=-1&&(j=Math.PI),X(u,$)>=1&&(j=0);var X=e>n?e:n,m=e>n?1:e/n,t=e>n?n/e:1;if(null==E){var L={x:0,y:0,width:0,height:0};oh(L,X),L.x*=m,L.width*=m,L.y*=t,L.height*=t;var l=new Xl(x);return L=Mc([l.tf(L.x,L.y),l.tf(L.x+L.width,L.y),l.tf(L.x+L.width,L.y+L.height),l.tf(L.x,L.y+L.height)]),L.x+=k.x,L.y+=k.y,[{x:L.x,y:L.y},{x:L.x+L.width,y:L.y},{x:L.x+L.width,y:L.y+L.height},{x:L.x,y:L.y+L.height}]}E.translate(k.x,k.y),E.rotate(x),E.scale(m,t),E.arc(0,0,X,q,q+j,1-Q),E.scale(1/m,1/t),E.rotate(-x),E.translate(-k.x,-k.y)},Oq=function(y,x){y&&y.beginPath();for(var l,d,F,D=[],O=function(C){for(var Q,o=/(\-{0,1}[\d\.]+)/gi,n=[];Q=o.exec(C);)n.push(parseFloat(Q[0]));return n},c=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,_={x:0,y:0};l=c.exec(x);){var r=l[0],M=r.substr(0,1);if("M"===M||"m"===M){for(var S=O(r),h=0;h<S.length;h+=2){var j=S[h],k=S[h+1];"m"===M&&(j+=_.x,k+=_.y),y&&y.moveTo(j,k),D.push({x:j,y:k}),_.x=j,_.y=k}d=F=null}else if("H"===M||"h"===M){for(var S=O(r),h=0;h<S.length;h+=1){var j=S[h];"h"===M&&(j+=_.x),y&&y.lineTo(j,_.y),D.push({x:j,y:_.y}),_.x=j}d=F=null}else if("C"===M||"c"===M){for(var S=O(r),h=0;h<S.length;h+=6){var T=S[h],Y=S[h+1],o=S[h+2],U=S[h+3],j=S[h+4],k=S[h+5];"c"===M&&(T+=_.x,Y+=_.y,o+=_.x,U+=_.y,j+=_.x,k+=_.y),y&&y.bezierCurveTo(T,Y,o,U,j,k),D.push({x:T,y:Y}),D.push({x:o,y:U}),D.push({x:j,y:k}),_.x=j,_.y=k}d=[T,Y,o,U,j,k],F=null}else if("S"===M||"s"===M){for(var S=O(r),h=0;h<S.length;h+=4){var T,Y;d?(T=2*d[4]-d[2],Y=2*d[5]-d[3]):(T=_.x,Y=_.y);var o=S[h],U=S[h+1],j=S[h+2],k=S[h+3];"s"===M&&(o+=_.x,U+=_.y,j+=_.x,k+=_.y),y&&y.bezierCurveTo(T,Y,o,U,j,k),D.push({x:T,y:Y}),D.push({x:o,y:U}),D.push({x:j,y:k}),_.x=j,_.y=k}d=[T,Y,o,U,j,k],F=null}else if("Q"===M||"q"===M){for(var S=O(r),h=0;h<S.length;h+=4){var T=S[h],Y=S[h+1],j=S[h+2],k=S[h+3];"q"===M&&(T+=_.x,Y+=_.y,j+=_.x,k+=_.y),y&&y.quadraticCurveTo(T,Y,j,k),D.push({x:T,y:Y}),D.push({x:j,y:k}),_.x=j,_.y=k}d=null,F=[T,Y,j,k]}else if("T"===M||"t"===M){for(var S=O(r),h=0;h<S.length;h+=2){var T,Y;F?(T=2*F[2]-F[0],Y=2*F[3]-F[1]):(T=_.x,Y=_.y);var j=S[h],k=S[h+1];"t"===M&&(j+=_.x,k+=_.y),y&&y.quadraticCurveTo(T,Y,j,k),D.push({x:T,y:Y}),D.push({x:j,y:k}),_.x=j,_.y=k}d=null,F=[T,Y,j,k]}else if("V"===M||"v"===M){for(var S=O(r),h=0;h<S.length;h+=1){var k=S[h];"v"===M&&(k+=_.y),y&&y.lineTo(_.x,k),D.push({x:_.x,y:k}),_.y=k}d=F=null}else if("L"===M||"l"===M){for(var S=O(r),h=0;h<S.length;h+=2){var j=S[h],k=S[h+1];"l"===M&&(j+=_.x,k+=_.y),y&&y.lineTo(j,k),D.push({x:j,y:k}),_.x=j,_.y=k}d=F=null}else if("A"===M||"a"===M){for(var S=O(r),h=0;h<S.length;h+=7){var K=S[h],g=S[h+1],$=S[h+2],n=S[h+3],p=S[h+4],j=S[h+5],k=S[h+6];"a"===M&&(j+=_.x,k+=_.y);var t=ro(_,K,g,$,n,p,{x:j,y:k},y);t&&(D=D.concat(t)),_.x=j,_.y=k}d=F=null}var R=r.substr(r.length-1);("z"===R||"Z"===R)&&y&&y.closePath()}return D},kk=function(H,N,t,f,U){var O,w=N[0];if(H.save(),gc(N))if(w&&1===w.length){var p,m="L"===N[0],k=N.length;m?(H.transform(N[5],N[6],N[7],N[8],N[9],N[10]),O=H.createLinearGradient(N[1],N[2],N[3],N[4]),p=11):(H.transform(N[7],N[8],N[9],N[10],N[11],N[12]),O=H.createRadialGradient(N[1],N[2],N[3],N[4],N[5],N[6]),p=13);for(var h=H.compGray;k>p;){var X=N[p+1];X=t(X),O.addColorStop(N[p],h?z.toGrayColor(X):X),p+=2}}else{var p,m="linear"===w,_=U.x,i=U.y,J=U.width,A=U.height,k=N.length,h=H.compGray;if(m)O=H.createLinearGradient(_+J*N[1],i+A*N[2],_+J*N[3],i+A*N[4]),p=5;else{var W=Math.min(J,A),l=N[1]*J+_,E=N[2]*A+i,Q=N[3]*W;O=H.createRadialGradient(l,E,0,l,E,Q),p=4}for(;k>p;){var X=N[p+1];X=t(X),O.addColorStop(N[p],h?z.toGrayColor(X):X),p+=2}}else O=N;return f?H.strokeStyle=O:H.fillStyle=O,O},qc=function(){function e(Q,$){var U=Q.length,y=Q[0];if(Fp(Q)||y&&1!==y.length)return Q;for(var F=new Array(U),H=0;U>H;H++)F[H]=Q[H];var K,X,Z,Y,g,I,v,O,d,h,R,_,x,t="L"===F[0];return K=t?5:7,X=F[K],Z=F[K+1],Y=F[K+2],g=F[K+3],I=F[K+4],v=F[K+5],O=$[0],d=$[1],h=$[2],R=$[3],_=$[4],x=$[5],F[K]=O*X+h*Z,F[K+1]=d*X+R*Z,F[K+2]=O*Y+h*g,F[K+3]=d*Y+R*g,F[K+4]=O*I+h*v+_,F[K+5]=d*I+R*v+x,F}return function(q,f){var a;(a=q.s("shape.gradient.pack"))&&q.s("shape.gradient.pack",e(a,f)),(a=q.s("shape.border.gradient.pack"))&&q.s("shape.border.gradient.pack",e(a,f))}}(),Wb=function(v,N,x,e){var n=!1;if(v.beginPath?v.beginPath():n=!0,vq(N)&&(N=N._as),vq(x)&&(x=x._as),x&&x.length){for(var t,p,X,h,f=0,r=0,c=x.length;c>r;r++)t=x[r],1===t?(p=N[f++],v.moveTo(p.x,n?-p.y:p.y)):2===t?(p=N[f++],v.lineTo(p.x,n?-p.y:p.y)):3===t?(p=N[f++],X=N[f++],v.quadraticCurveTo(p.x,n?-p.y:p.y,X.x,n?-X.y:X.y)):4===t?(p=N[f++],X=N[f++],h=N[f++],v.bezierCurveTo(p.x,n?-p.y:p.y,X.x,n?-X.y:X.y,h.x,n?-h.y:h.y)):5===t&&v.closePath();e&&5!==t&&v.closePath()}else{var o,Y,k,b=N.length;if(b>0){for(o=N[0],v.moveTo(o.x,n?-o.y:o.y),Y=1;b>Y;Y++)k=N[Y],v.lineTo(k.x,n?-k.y:k.y);e&&v.closePath()}}},rb=function(g,M,m,t){if(vq(g)&&(g=g._as),vq(M)&&(M=M._as),M&&M.length){m=m||wi;for(var r,U,z,$,W,p,j,i,T=[],Z=I,G=0,H=0,N=M.length;N>H;H++)if(r=M[H],1===r)T.push(Z=[]),Z.push(g[G++]);else if(2===r)Z.push(g[G++]);else if(3===r){for(U=Z[Z.length-1],z=g[G++],$=g[G++],p=1;m>p;p++)j=jm(p/m,U.x,z.x,$.x),i=jm(p/m,U.y,z.y,$.y),Z.push({x:j,y:i,b:!0});Z.push($)}else if(4===r){for(U=Z[Z.length-1],z=g[G++],$=g[G++],W=g[G++],p=1;m>p;p++)j=Vo(p/m,U.x,z.x,$.x,W.x),i=Vo(p/m,U.y,z.y,$.y,W.y),Z.push({x:j,y:i,b:!0});Z.push(W)}else 5===r&&Z.push(Z[0]);return t&&5!==r&&Z&&Z.length>2&&Z.push(Z[0]),T}return t&&g.length>2&&(g=g.slice(),g.push(g[0])),g?[g]:[]},gb=function(k,i,Y,G,P,E){var b,V,U,Z=Yc(i),n=G,s=Z[0],j=Z[1],m=Z[2];if(Y){var Q=Yc(Y);b=Q[0]-s,V=Q[1]-j,U=Q[2]-m}else b=255-s,V=255-j,U=255-m;for(E||(E=G>10?1:.5,E=1>P?a(E/P,2):E),k.save(),k.shadowOffsetX=0,k.shadowOffsetY=0,k.shadowBlur=0,k.shadowColor=0;(G-=E)>0;){var H=1-G/n,X=s+b*H,y=j+V*H,d=m+U*H;
X=a(L(X),255),y=a(L(y),255),d=a(L(d),255),k.strokeStyle="rgb("+X+","+y+","+d+")",k.lineWidth=G,k.stroke()}k.restore()},Dq=function(){if(ig&&R){var S=R+""||de;Xh=S.indexOf(mr.substr(0,2))>0&&S.indexOf(wg+wg.substr(1,1))>1?!0:!1}var X={};return function(j,p){var l=j+"-"+p,k=X[l];if(k)return k;var m,I,r,b=Yc(j);return 0>p?(p=(100+p)/100,m=L(b[0]*p),I=L(b[1]*p),r=L(b[2]*p)):(p/=100,m=b[0],I=b[1],r=b[2],m+=(255-m)*p,I+=(255-I)*p,r+=(255-r)*p,m=a(L(m),255),I=a(L(I),255),r=a(L(r),255)),X[l]="rgb("+m+","+I+","+r+")"}}(),Eq=function(T,S,q,g,Z,Y){Y&&(T.fillStyle=Y),T.beginPath(),T.rect(S,q,g,Z),T.fill()},Op=function(R,T,x,U,p,d,G){R.beginPath(),wh[T](R,x.x,x.y,x.width,x.height,U,p,d,G)},Vm=function(x,n,R,O,Y){var d=wh[R];x.fillStyle=d?d(x,n,O?O:hf,Y.x,Y.y,Y.width,Y.height):n},Fh=function(z,m,k,j,E,s){z.fillStyle=To(z,m,k,j,E,s)},Ie=function(J,g,K,o,b,k){J.strokeStyle=To(J,g,K,o,b,k)},To=function(f,T,v,M,c,w){var O;try{if(!T.tagName&&T.comps){T._cacheImage_||(T._cacheImage_={});var m;m="override"===M?"colors_override":"override_rgb"===M?"colors_override_rgb":"override_a"===M?"colors_override_a":"colors",T._cacheImage_[m]||(T._cacheImage_[m]={__count__:0});var K=T._cacheImage_[m][v];K||(T._cacheImage_[m].__count__>z.imageCacheThreshold&&(T._cacheImage_[m]={__count__:0}),K=A.Default.toCanvas(T,bi(T),Eg(T),null,c,w,v,null,M),T._cacheImage_[m][v]=K,T._cacheImage_[m].__count__++),T=K}O=f.createPattern(T,"repeat")}catch(e){O="black"}return O},fr=function(A){var t,J,m=[],u=0,Y=A.length;for(t=0;65>t;t++)m[t]=t;for(t=0;65>t;t++)u=(u+m[t]+A.charCodeAt(t%Y))%65,J=m[t],m[t]=m[u],m[u]=J;for(t=0;65>t;t++)m[t]=dg[m[t]];return m.join("")},kd=function(f){for(var Z=8+ym.randomInt(8),O=dg[8*ym.randomInt(8)+(Z-8)],w="",p=0;Z>p;p++)w+=dg[ym.randomInt(64)];var j=fr(w+e+Zp+eq);return O+w+Bf.encode(f,j)},rl=function(x){var m=x[0],N=dg.indexOf(m);if(0>N)return"";N=8+(7&N);var M=x.slice(1,1+N),O=fr(M+e+Zp+eq);return Bf.decode(x,O,1+N)},_f=function(b,O,o,y,p,R,k){b.save(),b.translate(O,o),b.scale(1,k/R),b.arc(0,0,R,y,p),b.restore()},Pk=function(r,p,Y,_,y,D,g,F){var t,C,k,z,K,Q,N,j,V,J,o;if(f(y)>2*h&&(y=2*h),K=L(f(y)/(h/4)),t=y/K,C=-t,k=-_,K>0){Q=p+l(_)*D,N=Y+d(-_)*g,F?r.lineTo(Q,N):r.moveTo(Q,N);for(var H=0;K>H;H++)k+=C,z=k-C/2,j=p+l(k)*D,V=Y+d(k)*g,J=p+l(z)*(D/l(C/2)),o=Y+d(z)*(g/l(C/2)),r.quadraticCurveTo(J,o,j,V)}},_c=function(T,s,u,y,w,R,N,t,q){6===arguments.length&&(gc(R)?(t=R[1],q=R[2],N=R[3],R=R[0]):(N=R,t=R,q=R));var O=s+y,A=u+w,z=w>y?2*y:2*w;R=z>R?R:z,N=z>N?N:z,t=z>t?t:z,q=z>q?q:z,T.moveTo(s+y/2,u),T.arcTo(O,u,O,A,N),T.arcTo(O,A,s,A,q),T.arcTo(s,A,s,u,t),T.arcTo(s,u,O,u,R),T.lineTo(s+y/2,u)},ko=function(g,q,J,T,E,e,p){q&&(J=b(J),T=b(T),p||(p=1),g.fillStyle=q,g.beginPath(),g.rect(J,T,p,e),g.rect(J,T,E,p),e-p>0&&g.rect(J,T+e-p,E,p),E-p>0&&g.rect(J+E-p,T,p,e),g.fill())},Gk=function(P,b,S,K){var $=K.x,W=K.y,u=K.width,q=K.height;if(!(!b||!S||0>=u||0>=q)){var p,G=tk(b),m=df(b),w=S>0;1===S||-1===S?(P.fillStyle=w?G:m,P.beginPath(),P.rect($,W,1,q),P.rect($,W,u,1),P.fill(),P.fillStyle=w?m:G,P.beginPath(),P.rect($,W+q-1,u,1),P.rect($+u-1,W,1,q),P.fill()):(S=a(f(S),a(u/2,q/2)),p=P.createLinearGradient($,W,$+S,W),p.addColorStop(0,w?G:m),p.addColorStop(1,b),P.fillStyle=p,P.beginPath(),P.moveTo($,W),P.lineTo($+S,W+S),P.lineTo($+S,W+q-S),P.lineTo($,W+q),P.lineTo($,W),P.fill(),p=P.createLinearGradient($,W,$,W+S),p.addColorStop(0,w?G:m),p.addColorStop(1,b),P.fillStyle=p,P.beginPath(),P.moveTo($,W),P.lineTo($+S,W+S),P.lineTo($+u-S,W+S),P.lineTo($+u,W),P.lineTo($,W),P.fill(),p=P.createLinearGradient($,W+q,$,W+q-S),p.addColorStop(0,w?m:G),p.addColorStop(1,b),P.fillStyle=p,P.beginPath(),P.moveTo($,W+q),P.lineTo($+S,W+q-S),P.lineTo($+u-S,W+q-S),P.lineTo($+u,W+q),P.lineTo($,W+q),P.fill(),p=P.createLinearGradient($+u,W,$+u-S,W),p.addColorStop(0,w?m:G),p.addColorStop(1,b),P.fillStyle=p,P.beginPath(),P.moveTo($+u,W),P.lineTo($+u-S,W+S),P.lineTo($+u-S,W+q-S),P.lineTo($+u,W+q),P.lineTo($+u,W),P.fill())}},Ci=function(P,F,A,R,f,Y,T){var e=P.createLinearGradient(R,f,Y,T);return e.addColorStop(0,A),e.addColorStop(1,F),e},Fr=function(k,e,D,h,t,p,Y){var Z=k.createLinearGradient(h,t,p,Y);return Z.addColorStop(0,e),Z.addColorStop(.5,D),Z.addColorStop(1,e),Z},hi=function(W,E,v,i,U,H,F){var b=W.createLinearGradient(i,U,H,F);return b.addColorStop(0,E),b.addColorStop(1/3,v),b.addColorStop(2/3,E),b.addColorStop(1,v),b},Ue=function(U,_,K,S,y,o,X,q,C){var I=U.createRadialGradient(S+o*q,y+X*C,a(o,X)/24,S+o/2,y+X/2,i(o,X)/2);return I.addColorStop(0,K),I.addColorStop(1,_),I},wl=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],wh={polygon:function(v,y,R,x,m,Y,P,j){(Y==I||3>Y)&&(Y=6),P==I&&(P=0),j==I&&(j=!0);var D,r=a(x,m),F=r/2,$=new gr(y+x/2,R+m/2),U=new gr,G=0,s=2*h/Y,i=new gr(F,F);if(j===!1&&i.multiply({x:x/r,y:m/r}),0===P)for(D=0;Y>D;D++)U.set(l(G),d(G)).multiply(i).add($),0===D?v.moveTo(U.x,U.y):v.lineTo(U.x,U.y),G+=s;else{var t=[];for(D=0;2>D;D++)t.push(new gr(l(G),d(G)).multiply(i).add($)),G+=s;var O=t.shift(),u=t[0];for(O.add(u).divideScalar(2),v.moveTo(O.x,O.y),D=0;Y>D;D++)t.push(new gr(l(G),d(G)).multiply(i).add($)),G+=s,O=t.shift(),u=t[0],v.arcTo(O.x,O.y,u.x,u.y,P)}v.closePath()},arc:function(e,E,T,Q,o,x,r,c,U){x==I&&(x=h),r==I&&(r=$),c==I&&(c=!0);var j=E+Q/2,J=T+o/2;c&&e.moveTo(j,J),U?_f(e,j,J,x,r,Q/2,o/2):e.arc(j,J,a(Q,o)/2,x,r),c&&e.closePath()},rect:function(g,C,b,T,t){g.rect(C,b,T,t)},circle:function(N,V,J,H,x){N.arc(V+H/2,J+x/2,a(H,x)/2,0,$,!0)},oval:function(C,e,w,T,u){_f(C,e+T/2,w+u/2,0,$,T/2,u/2)},roundRect:function(w,b,D,v,h,E){E==I&&(E=a(a(v,h)/4,8)),_c(w,b,D,v,h,E),w.closePath()},star:function(W,J,y,t,G){var h=2*t,e=2*G,C=J+t/2,m=y+G/2;W.moveTo(C-h/4,m-e/12),W.lineTo(J+.306*t,y+.579*G),W.lineTo(C-h/6,m+e/4),W.lineTo(J+t/2,y+.733*G),W.lineTo(C+h/6,m+e/4),W.lineTo(J+.693*t,y+.579*G),W.lineTo(C+h/4,m-e/12),W.lineTo(J+.611*t,y+.332*G),W.lineTo(C+0,m-e/4),W.lineTo(J+.388*t,y+.332*G),W.closePath()},pentagram:function(_,g,R,X,h){var W=.5*h,A=g+.5*X,S=R+W,s=.5257311121191336*X;s>W&&(s=W);var N=wl,C=0;for(_.moveTo(A+s*N[C++],S+s*N[C++]);20>C;)_.lineTo(A+s*N[C++],S+s*N[C++]);_.closePath()},triangle:function(f,e,_,I,X){f.moveTo(e+I/2,_),f.lineTo(e+I,_+X),f.lineTo(e,_+X),f.closePath()},hexagon:function(t,z,x,f,j){t.moveTo(z,x+j/2),t.lineTo(z+f/4,x+j),t.lineTo(z+3*f/4,+x+j),t.lineTo(z+f,x+j/2),t.lineTo(z+3*f/4,x),t.lineTo(z+f/4,x),t.closePath()},pentagon:function(T,i,F,w,f){var N=2*w,x=2*f,P=i+w/2,g=F+f/2;T.moveTo(P-N/4,g-x/12),T.lineTo(P-N/6,g+x/4),T.lineTo(P+N/6,g+x/4),T.lineTo(P+N/4,g-x/12),T.lineTo(P+0,g-x/4),T.closePath()},diamond:function(p,R,X,P,T){p.moveTo(R+P/2,X),p.lineTo(R,X+T/2),p.lineTo(R+P/2,X+T),p.lineTo(R+P,X+T/2),p.closePath()},rightTriangle:function(B,g,U,E,a){B.moveTo(g,U),B.lineTo(g+E,U+a),B.lineTo(g,U+a),B.closePath()},parallelogram:function(z,_,y,t,X){var B=t/4;z.moveTo(_+B,y),z.lineTo(_+t,y),z.lineTo(_+t-B,y+X),z.lineTo(_,y+X),z.closePath()},trapezoid:function(C,M,e,K,Y){var o=K/4;C.moveTo(M+o,e),C.lineTo(M+K-o,e),C.lineTo(M+K,e+Y),C.lineTo(M,e+Y),C.closePath()},"linear.southwest":function(s,l,o,u,W,y,f){return Ci(s,l,o,u,W+f,u+y,W)},"linear.southeast":function(a,c,A,G,O,j,k){return Ci(a,c,A,G+j,O+k,G,O)},"linear.northwest":function(j,u,T,E,n,J,e){return Ci(j,u,T,E,n,E+J,n+e)},"linear.northeast":function(w,U,j,n,M,F,C){return Ci(w,U,j,n+F,M,n,M+C)},"linear.north":function(t,n,s,q,L,y,l){return Ci(t,n,s,q,L,q,L+l)},"linear.south":function(S,T,x,_,e,t,P){return Ci(S,T,x,_,e+P,_,e)},"linear.west":function(W,d,O,s,z,D){return Ci(W,d,O,s,z,s+D,z)},"linear.east":function(Q,b,v,e,o,Z){return Ci(Q,b,v,e+Z,o,e,o)},"radial.center":function(x,y,P,N,z,M,Q){return Ue(x,y,P,N,z,M,Q,.5,.5)},"radial.southwest":function(H,g,f,m,x,I,k){return Ue(H,g,f,m,x,I,k,.25,.75)},"radial.southeast":function(d,y,u,R,X,i,f){return Ue(d,y,u,R,X,i,f,.75,.75)},"radial.northwest":function(d,Q,c,V,N,q,v){return Ue(d,Q,c,V,N,q,v,.25,.25)},"radial.northeast":function(q,r,k,g,L,i,a){return Ue(q,r,k,g,L,i,a,.75,.25)},"radial.north":function(V,G,g,m,o,f,R){return Ue(V,G,g,m,o,f,R,.5,.25)},"radial.south":function(l,F,e,w,f,s,u){return Ue(l,F,e,w,f,s,u,.5,.75)},"radial.west":function(p,f,_,e,G,Y,m){return Ue(p,f,_,e,G,Y,m,.25,.5)},"radial.east":function(q,r,n,h,l,W,o){return Ue(q,r,n,h,l,W,o,.75,.5)},"spread.horizontal":function(k,p,x,h,s,w){return Fr(k,p,x,h,s,h+w,s)},"spread.vertical":function(N,A,w,L,R,W,y){return Fr(N,A,w,L,R,L,R+y)},"spread.diagonal":function(Y,p,f,t,$,k,H){return Fr(Y,p,f,t+k,$,t,$+H)},"spread.antidiagonal":function(h,U,o,z,P,J,E){return Fr(h,U,o,z,P,z+J,P+E)},"spread.north":function(j,A,g,x,C,$,Z){return hi(j,A,g,x,C-Z/4,x,C+Z+Z/4)},"spread.south":function(b,G,r,C,P,c,p){return hi(b,r,G,C,P-p/4,C,P+p+p/4)},"spread.west":function(c,j,G,D,E,M){return hi(c,j,G,D-M/4,E,D+M+M/4,E)},"spread.east":function(T,h,U,y,F,r){return hi(T,U,h,y-r/4,F,y+r+r/4,F)}},ff=function(Y,s,C){return new Xl(Y).tf(s,C)},xn=function(U){var t=U.touches[0],_=U.touches[1],C=t.clientX,A=t.clientY,V=_.clientX,z=_.clientY;return w((C-V)*(C-V)+(A-z)*(A-z))},Gi=function(T){var I=T.touches[0],f=T.touches[1],r=I.clientX,F=I.clientY,B=f.clientX,c=f.clientY;return{x:(r+B)/2,y:(F+c)/2}},sr=(function(){for(var g=0,v=gn.split(""),l=0;l<v.length;l++)g=10*Fq(v[l])+g;return xm(c[Zi.toString(8*l)+rc.substr(l)+3],c[Zi.toString(8*l)+rc.substr(l)+4]),g}(),function(_,b,G){for(var F=0;F<G.size();F++){var J=G.get(F);_.co(J)&&b.add(J)}for(F=0;F<G.size();F++)J=G.get(F),sr(_,b,J._children)}),pr=function(b,Z,O){for(var P=0;P<O.size();P++){var u=O.get(O.size()-1-P);b.co(u)&&Z.add(u)}for(P=0;P<O.size();P++)u=O.get(P),pr(b,Z,u._children)},sg=function(S,Q,$){for(var r=!1,K=0;K<$.size();K++){var Y=$.get(K);S.co(Y)?r&&Q.add(Y):r=1}for(K=0;K<$.size();K++)Y=$.get(K),sg(S,Q,Y._children)},Kk=function(b,K,v){for(var s=!1,H=0;H<v.size();H++){var G=v.get(v.size()-1-H);b.co(G)?s&&K.add(G):s=!0}for(H=0;H<v.size();H++)G=v.get(H),Kk(b,K,G._children)},ed=z.moveDatas=function(K,V,F,W){var m=W==I;if(0!==V||0!==F||!m&&0!==W){var x=!0,D=[];if(K.forEach(function(l){x&&(l._69O||Re(l)||kl(l))&&(x=!1)}),x)D=K;else{var O={},X={};K.forEach(function(e){O[e._id]=!0});var e={},s=function(o){var t=o._id;return O[t]?(D.push(o),e[t]=!0):e[t]=!1},u=function(b){var o=b._id;if(X[o])return s(b);var W=e[o];if(W!==_)return W;var p=b._parent;if(p&&(kl(p)||Re(p))&&u(p))return e[o]=!0;var a=b._host;return a&&(X[o]=o,W=u(a),X[o]=_,W)?e[o]=!0:s(b)};K.forEach(function(A){u(A)})}D.forEach(function(X){if(Fg(X))m?X.translate(V,F):X.translate3d(V,F,W);else{var p=X.s(Wl);if(!p||p.isEmpty())return;var D=new Gc;p.each(function(o){o=Tl(o),m?(o.x+=V,o.y+=F):(o.x+=V,o.y+=W,o.e==I?o.e=F:o.e+=F),D.add(o)}),X.s(Wl,D)}})}},Oc=function(){function i(k,B){return B===k.substring(0,B.length)?!0:!1}function N(K){return parseFloat(K)||0}function n($,s){if(s==_&&(s=new gq),i($,"matrix3d")){var U=$.substring(9,$.length-1).split(",");U=U.map(N),s.fromArray(U)}else if(i($,"matrix")){var U=$.substring(7,$.length-1).split(",");U=U.map(N),s.el[0]=U[0],s.el[1]=U[1],s.el[2]=0,s.el[3]=0,s.el[4]=U[2],s.el[5]=U[3],s.el[6]=0,s.el[7]=0,s.el[8]=0,s.el[9]=0,s.el[10]=1,s.el[11]=0,s.el[12]=U[4],s.el[13]=U[5],s.el[14]=0,s.el[15]=1}return s}function S(G,k){k==_&&(k=new ti);var n=G.split(/\s+/);return n=n.map(N),k.set(n[0]||0,n[1]||0,n[2]||0),k}var Z,d,P,D,s,o=function(a,C){Z||(Z=new gq,d=new ti,P=new gq,D=new gq,s=new gq),C==_&&(C=new gq);var M=getComputedStyle(a);M.transform&&"none"!==M.transform&&(n(M.transform,Z),S(M.transformOrigin,d),D.setPosition(d),d.negate(),s.setPosition(d),(jn||"preserve-3d"!==M.transformStyle)&&(Z.el[8]=0,Z.el[9]=0,Z.el[10]=1,Z.el[11]=0),C.multiplyMatrices(s,C),C.multiplyMatrices(Z,C),C.multiplyMatrices(D,C)),!jn&&M.perspective&&"none"!==M.perspective&&(P.el[11]=-1/N(M.perspective),S(M.perspectiveOrigin,d),D.setPosition(d),d.negate(),s.setPosition(d),C.multiplyMatrices(s,C),C.multiplyMatrices(P,C),C.multiplyMatrices(D,C));for(var U=a.offsetParent,t=a.offsetLeft,V=a.offsetTop,O=a.parentElement;O&&O!==U;){var W=getComputedStyle(O);if("none"!==W.transform||"none"!==W.perspective)break;O=O.parentElement}return O==_&&a!==a.ownerDocument.documentElement&&"fixed"!==M.position&&(O=a.ownerDocument.documentElement),U!=_&&U!==O&&(t-=O.offsetLeft,V-=O.offsetTop),d.set(t,V,0),D.setPosition(d),C.multiplyMatrices(D,C),O&&o(O,C),C};return function(e,_){var Y=e.parentElement;if(Y){var i=Y.updateAppendMatrix;if(i){delete Y.updateAppendMatrix;var w=new gq;o(Y,w);var b=new gq;b.getInverse(w),Y._matrixAppend=b,Y._maxrixPreAppend=w}return _?Y._matrixAppend:Y._maxrixPreAppend}}}(),tn=function(P,L){for(;P&&!P.hasOwnProperty(L);)P=j.getPrototypeOf(P);return P&&j.getOwnPropertyDescriptor(P,L)},Oj=j.getPrototypeOf?function(S,v,u){var B=tn(v,u);B&&j.defineProperty(S,u,B)}:function(T,e,s){T[s]=e[s]},Wj={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},ni=function(){var d={1:function(r,x){return{x:r.x-x.width/2,y:r.y-x.height/2}},2:function(v,M){return{x:v.x+M.width/2,y:v.y-M.height/2}},3:function(H,T){return{x:H.x+H.width/2,y:H.y-T.height/2}},4:function(v,p){return{x:v.x+v.width-p.width/2,y:v.y-p.height/2}},5:function(J,q){return{x:J.x+J.width+q.width/2,y:J.y-q.height/2}},6:function(C){return{x:C.x,y:C.y}},7:function(R){return{x:R.x+R.width/2,y:R.y}},8:function(O){return{x:O.x+O.width,y:O.y}},9:function(J,m){return{x:J.x-m.width/2,y:J.y+m.height/2}},10:function(H,v){return{x:H.x+v.width/2,y:H.y+v.height/2}},11:function(h,g){return{x:h.x+h.width/2,y:h.y+g.height/2}},12:function(B,A){return{x:B.x-A.width/2+B.width,y:B.y+A.height/2}},13:function(a,l){return{x:a.x+a.width+l.width/2,y:a.y+l.height/2}},14:function(p,c){return{x:p.x-c.width/2,y:p.y+p.height/2}},15:function(U){return{x:U.x,y:U.y+U.height/2}},16:function(E,W){return{x:E.x+W.width/2,y:E.y+E.height/2}},17:function(f){return{x:f.x+f.width/2,y:f.y+f.height/2}},18:function(w,h){return{x:w.x+w.width-h.width/2,y:w.y+w.height/2}},19:function(V){return{x:V.x+V.width,y:V.y+V.height/2}},20:function(P,l){return{x:P.x+P.width+l.width/2,y:P.y+P.height/2}},21:function(W,g){return{x:W.x-g.width/2,y:W.y+W.height-g.height/2}},22:function(d,F){return{x:d.x+F.width/2,y:d.y+d.height-F.height/2}},23:function(a,Z){return{x:a.x+a.width/2,y:a.y+a.height-Z.height/2}},24:function(b,T){return{x:b.x+b.width-T.width/2,y:b.y+b.height-T.height/2}},25:function(Z,q){return{x:Z.x+Z.width+q.width/2,y:Z.y+Z.height-q.height/2}},26:function(U){return{x:U.x,y:U.y+U.height}},27:function(I){return{x:I.x+I.width/2,y:I.y+I.height}},28:function(j){return{x:j.x+j.width,y:j.y+j.height}},29:function(c,H){return{x:c.x-H.width/2,y:c.y+c.height+H.height/2}},30:function(r,s){return{x:r.x+s.width/2,y:r.y+r.height+s.height/2}},31:function(d,f){return{x:d.x+d.width/2,y:d.y+d.height+f.height/2}},32:function(S,O){return{x:S.x+S.width-O.width/2,y:S.y+S.height+O.height/2}},33:function(L,c){return{x:L.x+L.width+c.width/2,y:L.y+L.height+c.height/2}},34:function(T,S){return{x:T.x,y:T.y-S.height/2}},35:function(d,X){return{x:d.x+d.width,y:d.y-X.height/2}},36:function(P,Y){return{x:P.x,y:P.y+P.height+Y.height/2}},37:function(C,d){return{x:C.x+C.width,y:C.y+C.height+d.height/2}},38:function(O,m){return{x:O.x+O.width/4,y:O.y-m.height/2}},39:function(E,u){return{x:E.x+3*E.width/4,y:E.y-u.height/2}},40:function(c){return{x:c.x+c.width/4,y:c.y}},41:function(Q){return{x:Q.x+3*Q.width/4,y:Q.y}},42:function(V,c){return{x:V.x+V.width/4,y:V.y+c.height/2}},43:function(N,B){return{x:N.x+3*N.width/4,y:N.y+B.height/2}},44:function(Z,R){return{x:Z.x+Z.width/2,y:Z.y+Z.height/2-R.height/2}},45:function(j){return{x:j.x+j.width/4,y:j.y+j.height/2}},46:function(Y,s){return{x:Y.x+Y.width/2-s.width/2,y:Y.y+Y.height/2}},47:function(O,n){return{x:O.x+O.width/2+n.width/2,y:O.y+O.height/2}},48:function(E){return{x:E.x+3*E.width/4,y:E.y+E.height/2}},49:function(q,Q){return{x:q.x+q.width/2,y:q.y+q.height/2+Q.height/2}},50:function(q,V){return{x:q.x+q.width/4,y:q.y+q.height-V.height/2}},51:function(H,Y){return{x:H.x+3*H.width/4,y:H.y+H.height-Y.height/2}},52:function(F){return{x:F.x+F.width/4,y:F.y+F.height}},53:function(L){return{x:L.x+3*L.width/4,y:L.y+L.height}},54:function(q,g){return{x:q.x+q.width/4,y:q.y+q.height+g.height/2}},55:function(R,r){return{x:R.x+3*R.width/4,y:R.y+R.height+r.height/2}}};return kh(c)?function(P,F,s){return d[P](F,s?s:Uf)}:void 0}();Xi(Y,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#FFF",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var hd=Y.reverse,Gl=Y.transparent,rs=Y.rectSelectBackground,Ij=Y.dash,fk=Y.titleBackground,or=Y.titleIconBackground,cg=Y.headerBackground,Rd=Y.headerIconBackground,Si=Y.headerSeparator,Pn=Y.headerLine,zh=Y.contentIconBackground,Bo=Y.contentLine,Hn=(Y.widgetIconHighlight,Y.widgetIconBorder),Gp=(Y.widgetIconGradient,Y.imageBackground),hf=Y.imageGradient,lf=Y.highlight,Xd=Y.label,ce=Y.labelSelect;if(ol&&!c.shutAlert1){var Yl=new Date,Qc=ol.split("-"),Fj=new Date(Yl.getFullYear(),Yl.getMonth(),Yl.getDate()),ol=new Date(Fq(Qc[0],10),Fq(Qc[1],10)-1,Fq(Qc[2],10)),tb=Fj.getTime(),Sp=ol.getTime(),Ff=e+"_try",Qh=c.alert;try{var jd=c.localStorage;if(jd&&Qh)if(Sp>tb&&1728e6>Sp-tb){var Pc=(Sp-tb)/864e5;jd&&jd[Ff]!=Pc&&(jd[Ff]=Pc,c.htWillExpire?Qh(c.htWillExpire.replace("{{day}}",Pc)):Qh("HT for Web free trial license will expire in "+Pc+" days, please apply for a new license!"))}else tb>=Sp&&(c.htExpired?Qh(c.htExpired):Qh("Your free trial of HT for Web has expired!")),jd&&delete jd[Ff]}catch(wc){}}Math.sign===_&&(Math.sign=function(U){return 0>U?-1:U>0?1:+U});var dg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Bf={encode:function(N,m){var s,p,D,x,Y,U,b,z="",l=0;for(N=unescape(encodeURIComponent(N));l<N.length;)s=N.charCodeAt(l++),p=N.charCodeAt(l++),D=N.charCodeAt(l++),x=s>>2,Y=(3&s)<<4|p>>4,U=(15&p)<<2|D>>6,b=63&D,isNaN(p)?U=b=64:isNaN(D)&&(b=64),z=z+m.charAt(x)+m.charAt(Y)+m.charAt(U)+m.charAt(b);return z},decode:function(M,b,K){for(var X,I,Q,U,A,o,x,c="",r=K||0;r<M.length;)U=b.indexOf(M.charAt(r++)),A=b.indexOf(M.charAt(r++)),o=b.indexOf(M.charAt(r++)),x=b.indexOf(M.charAt(r++)),X=U<<2|A>>4,I=(15&A)<<4|o>>2,Q=(3&o)<<6|x,c+=String.fromCharCode(X),64!=o&&(c+=String.fromCharCode(I)),64!=x&&(c+=String.fromCharCode(Q));return c=decodeURIComponent(escape(c))},_utf8_encode:function(S){S=S.replace(/\r\n/g,"\n");for(var U="",n=0;n<S.length;n++){var a=S.charCodeAt(n);128>a?U+=String.fromCharCode(a):a>127&&2048>a?(U+=String.fromCharCode(192|a>>6),U+=String.fromCharCode(128|63&a)):(U+=String.fromCharCode(224|a>>12),U+=String.fromCharCode(128|63&a>>6),U+=String.fromCharCode(128|63&a))}return U},_utf8_decode:function(M){for(var K="",O=0,m=0,J=0,_=0;O<M.length;)m=M.charCodeAt(O),128>m?(K+=String.fromCharCode(m),O++):m>191&&224>m?(J=M.charCodeAt(O+1),K+=String.fromCharCode((31&m)<<6|63&J),O+=2):(J=M.charCodeAt(O+1),_=M.charCodeAt(O+2),K+=String.fromCharCode((15&m)<<12|(63&J)<<6|63&_),O+=3);return K}},sj=[],Uh=[],ym=A.Math={generateUUID:function(){for(var V=[],T=0;256>T;T++)V[T]=(16>T?"0":"")+T.toString(16).toUpperCase();return function(){var C=0|4294967295*Math.random(),a=0|4294967295*Math.random(),U=0|4294967295*Math.random(),i=0|4294967295*Math.random();return V[255&C]+V[255&C>>8]+V[255&C>>16]+V[255&C>>24]+"-"+V[255&a]+V[255&a>>8]+"-"+V[64|15&a>>16]+V[255&a>>24]+"-"+V[128|63&U]+V[255&U>>8]+"-"+V[255&U>>16]+V[255&U>>24]+V[255&i]+V[255&i>>8]+V[255&i>>16]+V[255&i>>24]}}(),clamp:function(d,c,_){return Math.max(c,Math.min(_,d))},fequal:function(P,V,u){return null==u&&(u=1e-8),Math.abs(P-V)<u},generateIncreasingID:function(){var g=0;return function(){return++g}}(),encodeBase64:function(U,x){return Bf.encode(U,x||dg)},decodeBase64:function(s,Y){return Bf.decode(s,Y||dg)},randomArray:function(W,s){s=s||W.length;for(var X=s-1;X>0;X--){var Q=Math.floor(Math.random()*(X+1)),K=W[X];W[X]=W[Q],W[Q]=K}return W},randomInt:function(S,s){return s===_&&(s=S,S=0),S+Math.floor(Math.random()*(s-S))},randomFloat:function(p,s){return s===_&&(s=p,p=0),p+Math.random()*(s-p)},isPOT:function(H){return H>0&&0===(H-1&H)},nearestPOT:function(C){if(!C)return 1;var e=C;e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e++;var t=e>>1;return C-t>e-C?e:t},requestMatrix4:function(){return sj.length>0?sj.pop():new ym.Matrix4},releaseMatrix4:function(Q){sj.push(Q)},requestVector3:function(){return Uh.length>0?Uh.pop():new ym.Vector3},releaseVector3:function(i){Uh.push(i)}},ab=A.Matrix=A.Math.Matrix2d=function(f,h,a,Q,M){this.setFromTransform(f,h,a,Q,M)},Xl=ab;ab.prototype={},ab.prototype.constructor=ab,ab.prototype.set=function(r,y,t,f,k,P){return this.a=r,this.b=y,this.c=t,this.d=f,this.tx=k,this.ty=P,this},ab.prototype.setFromTransform=function(k,x,V,J,Q){var o=this;if(k===_)return o.a=1,o.b=0,o.c=0,o.d=1,o.tx=0,o.ty=0,void 0;var N,w;return k?(N=d(k),w=l(k)):(N=0,w=1),J=J||1,Q=Q||1,o.a=w*J,o.b=N*J,o.c=-N*Q,o.d=w*Q,o.tx=x||0,o.ty=V||0,o},ab.prototype.apply=function(p,X){X=X||new gr;var W=p.x,b=p.y;return X.x=this.a*W+this.c*b+this.tx,X.y=this.b*W+this.d*b+this.ty,X},ab.prototype.applyInverse=function(s,k){k=k||new gr;var Q=1/(this.a*this.d+this.c*-this.b),R=s.x,O=s.y;return k.x=this.d*Q*R+-this.c*Q*O+(this.ty*this.c-this.tx*this.d)*Q,k.y=this.a*Q*O+-this.b*Q*R+(-this.ty*this.a+this.tx*this.b)*Q,k},ab.prototype.translate=function(L,s){return this.tx+=L,this.ty+=s,this},ab.prototype.scale=function(I,c){return this.a*=I,this.d*=c,this.c*=I,this.b*=c,this.tx*=I,this.ty*=c,this},ab.prototype.rotate=function(E){var T=Math.cos(E),W=Math.sin(E),m=this.a,h=this.c,u=this.tx;return this.a=m*T-this.b*W,this.b=m*W+this.b*T,this.c=h*T-this.d*W,this.d=h*W+this.d*T,this.tx=u*T-this.ty*W,this.ty=u*W+this.ty*T,this},ab.prototype.appendTranslate=function(A,I){return this.tx+=this.a*A+this.c*I,this.ty+=this.b*A+this.d*I,this},ab.prototype.appendScale=function(a,u){return this.a*=a,this.d*=u,this.c*=u,this.b*=a,this},ab.prototype.appendRotate=function(d){if(!d)return this;var U=Math.cos(d),S=Math.sin(d),z=this.a,v=this.b;return this.a=z*U+this.c*S,this.b=v*U+this.d*S,this.c=-z*S+this.c*U,this.d=-v*S+this.d*U,this},ab.prototype.append=function(J){var K=this.a,$=this.b,T=this.c,i=this.d;return this.a=J.a*K+J.b*T,this.b=J.a*$+J.b*i,this.c=J.c*K+J.d*T,this.d=J.c*$+J.d*i,this.tx=J.tx*K+J.ty*T+this.tx,this.ty=J.tx*$+J.ty*i+this.ty,this},ab.prototype.setTransform=function(e,K,M,o,r,T,F,G,j){var W,C,U,O,_,t,A,J,v,k;return _=Math.sin(F),t=Math.cos(F),A=Math.cos(j),J=Math.sin(j),v=-Math.sin(G),k=Math.cos(G),W=t*r,C=_*r,U=-_*T,O=t*T,this.a=A*W+J*U,this.b=A*C+J*O,this.c=v*W+k*U,this.d=v*C+k*O,this.tx=e+(M*W+o*U),this.ty=K+(M*C+o*O),this},ab.prototype.prepend=function(s){var z=this.tx;if(1!==s.a||0!==s.b||0!==s.c||1!==s.d){var C=this.a,R=this.c;this.a=C*s.a+this.b*s.c,this.b=C*s.b+this.b*s.d,this.c=R*s.a+this.d*s.c,this.d=R*s.b+this.d*s.d}return this.tx=z*s.a+this.ty*s.c+s.tx,this.ty=z*s.b+this.ty*s.d+s.ty,this},ab.prototype.transform=ab.prototype.prepend,ab.prototype.invert=function(){var h=this.a,f=this.b,c=this.c,p=this.d,U=this.tx,g=h*p-f*c;return this.a=p/g,this.b=-f/g,this.c=-c/g,this.d=h/g,this.tx=(c*this.ty-p*U)/g,this.ty=-(h*this.ty-f*U)/g,this},ab.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},ab.prototype.clone=function(){var r=new ab;return r.a=this.a,r.b=this.b,r.c=this.c,r.d=this.d,r.tx=this.tx,r.ty=this.ty,r},ab.prototype.copy=function(f){return f.a=this.a,f.b=this.b,f.c=this.c,f.d=this.d,f.tx=this.tx,f.ty=this.ty,f},ab.prototype.tf=function(R,c){1===arguments.length&&(c=R.y,R=R.x);var Q=this;return{x:Q.a*R+Q.c*c+Q.tx,y:Q.b*R+Q.d*c+Q.ty}},ab.prototype.toArray=function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]},ab.prototype.fromArray=function(l){return this.a=l[0],this.b=l[1],this.c=l[2],this.d=l[3],this.tx=l[4],this.ty=l[5],this},ab.prototype.toArray9=function(){return[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1]},ab.prototype.tfi=function(G,I){1===arguments.length&&(I=G.y,G=G.x);var W=this,J=1/(W.a*W.d+W.c*-W.b);return{x:W.d*J*G+-W.c*J*I+(W.ty*W.c-W.tx*W.d)*J,y:W.a*J*I+-W.b*J*G+(-W.ty*W.a+W.tx*W.b)*J}},ab.IDENTITY=new ab,ab.TEMP_MATRIX=new ab;var Uk=A.Math.Quaternion=function(H,E,y,S){this.set(H,E,y,S)};j.assign(Uk.prototype,{set:function(A,Z,D,E){var T=this;return T._x=A||0,T._y=Z||0,T._z=D||0,T._w=E!==_?E:1,T},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(M){var g=this;return g._x=M._x,g._y=M._y,g._z=M._z,g._w=M._w,g},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var z=this.length();return 0===z?(this._x=0,this._y=0,this._z=0,this._w=1):(z=1/z,this._x=this._x*z,this._y=this._y*z,this._z=this._z*z,this._w=this._w*z),this},fromArray:function(O,l){l===_&&(l=0);var r=this;return r._x=O[l],r._y=O[l+1],r._z=O[l+2],r._w=O[l+3],this},slerp:function(G,H){if(0===H)return this;if(1===H)return this.copy(G);var T=this._x,u=this._y,D=this._z,d=this._w,q=d*G._w+T*G._x+u*G._y+D*G._z;if(0>q?(this._w=-G._w,this._x=-G._x,this._y=-G._y,this._z=-G._z,q=-q):this.copy(G),q>=1)return this._w=d,this._x=T,this._y=u,this._z=D,this;var h=Math.sqrt(1-q*q);if(Math.abs(h)<.001)return this._w=.5*(d+this._w),this._x=.5*(T+this._x),this._y=.5*(u+this._y),this._z=.5*(D+this._z),this;var $=Math.atan2(h,q),g=Math.sin((1-H)*$)/h,y=Math.sin(H*$)/h;return this._w=d*g+this._w*y,this._x=T*g+this._x*y,this._y=u*g+this._y*y,this._z=D*g+this._z*y,this},setFromAxisAngle:function(j,R){var Q=R/2,g=Math.sin(Q);return this._x=j.x*g,this._y=j.y*g,this._z=j.z*g,this._w=Math.cos(Q),this},setFromEuler:function(P){var h=P._x,T=P._y,Y=P._z,v=P._order,$=Math.cos,p=Math.sin,G=$(h/2),V=$(T/2),d=$(Y/2),y=p(h/2),z=p(T/2),M=p(Y/2);return"XYZ"===v?(this._x=y*V*d+G*z*M,this._y=G*z*d-y*V*M,this._z=G*V*M+y*z*d,this._w=G*V*d-y*z*M):"YXZ"===v?(this._x=y*V*d+G*z*M,this._y=G*z*d-y*V*M,this._z=G*V*M-y*z*d,this._w=G*V*d+y*z*M):"ZXY"===v?(this._x=y*V*d-G*z*M,this._y=G*z*d+y*V*M,this._z=G*V*M+y*z*d,this._w=G*V*d-y*z*M):"ZYX"===v?(this._x=y*V*d-G*z*M,this._y=G*z*d+y*V*M,this._z=G*V*M-y*z*d,this._w=G*V*d+y*z*M):"YZX"===v?(this._x=y*V*d+G*z*M,this._y=G*z*d+y*V*M,this._z=G*V*M-y*z*d,this._w=G*V*d-y*z*M):"XZY"===v&&(this._x=y*V*d-G*z*M,this._y=G*z*d-y*V*M,this._z=G*V*M+y*z*d,this._w=G*V*d+y*z*M),this},setFromRotationMatrix:function(d){var K,n=d.el,q=n[0],P=n[4],O=n[8],D=n[1],i=n[5],x=n[9],e=n[2],J=n[6],g=n[10],L=q+i+g;return L>0?(K=.5/Math.sqrt(L+1),this._w=.25/K,this._x=(J-x)*K,this._y=(O-e)*K,this._z=(D-P)*K):q>i&&q>g?(K=2*Math.sqrt(1+q-i-g),this._w=(J-x)/K,this._x=.25*K,this._y=(P+D)/K,this._z=(O+e)/K):i>g?(K=2*Math.sqrt(1+i-q-g),this._w=(O-e)/K,this._x=(P+D)/K,this._y=.25*K,this._z=(x+J)/K):(K=2*Math.sqrt(1+g-q-i),this._w=(D-P)/K,this._x=(O+e)/K,this._y=(x+J)/K,this._z=.25*K),this},setFromToVectors:function(){var X,T;return function(r,o){return X===_&&(X=new ti),T=r.dot(o)+1,1e-7>T?(T=0,Math.abs(r.x)>Math.abs(r.z)?X.set(-r.y,r.x,0):X.set(0,-r.z,r.y)):X.crossVectors(r,o),this._x=X.x,this._y=X.y,this._z=X.z,this._w=T,this.normalize()}}(),setFromUnitVectors:function(){var n,k,w=1e-6;return function(G,U){return n===_&&(n=new ti),k=G.dot(U)+1,w>k?(k=0,Math.abs(G.x)>Math.abs(G.z)?n.set(-G.y,G.x,0):n.set(0,-G.z,G.y)):n.crossVectors(G,U),this._x=n.x,this._y=n.y,this._z=n.z,this._w=k,this.normalize()}}(),multiply:function(o){return this.multiplyQuaternions(this,o)},premultiply:function(M){return this.multiplyQuaternions(M,this)},multiplyQuaternions:function(n,b){var E=n._x,J=n._y,Q=n._z,m=n._w,Y=b._x,C=b._y,H=b._z,z=b._w;return this._x=E*z+m*Y+J*H-Q*C,this._y=J*z+m*C+Q*Y-E*H,this._z=Q*z+m*H+E*C-J*Y,this._w=m*z-E*Y-J*C-Q*H,this},toArray:function(Q,K){return Q||(Q=[]),K=K||0,Q[K]=this._x,Q[K+1]=this._y,Q[K+2]=this._z,Q[K+3]=this._w,Q}});var El=A.Math.Vector4=function(z,e,E,B){this.x=z||0,this.y=e||0,this.z=E||0,this.w=B!==_?B:1};j.assign(El.prototype,{isVector4:!0,set:function(k,v,B,M){return this.x=k,this.y=v,this.z=B,this.w=M,this},setScalar:function(J){return this.x=J,this.y=J,this.z=J,this.w=J,this},setX:function(I){return this.x=I,this},setY:function(y){return this.y=y,this},setZ:function($){return this.z=$,this},setW:function(N){return this.w=N,this},setComponent:function(B,e){switch(B){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+B)}return this},getComponent:function(O){switch(O){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+O)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(c){return this.x=c.x,this.y=c.y,this.z=c.z,this.w=c.w!==_?c.w:1,this},add:function(K,f){return f!==_?this.addVectors(K,f):(this.x+=K.x,this.y+=K.y,this.z+=K.z,this.w+=K.w,this)},addScalar:function(d){return this.x+=d,this.y+=d,this.z+=d,this.w+=d,this},addVectors:function(v,u){return this.x=v.x+u.x,this.y=v.y+u.y,this.z=v.z+u.z,this.w=v.w+u.w,this},addScaledVector:function(J,$){return this.x+=J.x*$,this.y+=J.y*$,this.z+=J.z*$,this.w+=J.w*$,this},sub:function(S,O){return O!==_?this.subVectors(S,O):(this.x-=S.x,this.y-=S.y,this.z-=S.z,this.w-=S.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(Z,F){return this.x=Z.x-F.x,this.y=Z.y-F.y,this.z=Z.z-F.z,this.w=Z.w-F.w,this},multiplyScalar:function(S){return this.x*=S,this.y*=S,this.z*=S,this.w*=S,this},applyMatrix4:function(D){var p=this.x,k=this.y,R=this.z,U=this.w,l=D.el;return this.x=l[0]*p+l[4]*k+l[8]*R+l[12]*U,this.y=l[1]*p+l[5]*k+l[9]*R+l[13]*U,this.z=l[2]*p+l[6]*k+l[10]*R+l[14]*U,this.w=l[3]*p+l[7]*k+l[11]*R+l[15]*U,this},divideScalar:function(p){return this.multiplyScalar(1/p)},setAxisAngleFromQuaternion:function(Y){this.w=2*Math.acos(Y.w);var V=Math.sqrt(1-Y.w*Y.w);return 1e-4>V?(this.x=1,this.y=0,this.z=0):(this.x=Y.x/V,this.y=Y.y/V,this.z=Y.z/V),this},setAxisAngleFromRotationMatrix:function(c){var m,y,A,b,Q=.01,F=.1,J=c.el,O=J[0],u=J[4],T=J[8],g=J[1],V=J[5],P=J[9],e=J[2],G=J[6],r=J[10];if(Math.abs(u-g)<Q&&Math.abs(T-e)<Q&&Math.abs(P-G)<Q){if(Math.abs(u+g)<F&&Math.abs(T+e)<F&&Math.abs(P+G)<F&&Math.abs(O+V+r-3)<F)return this.set(1,0,0,0),this;m=Math.PI;var p=(O+1)/2,M=(V+1)/2,R=(r+1)/2,q=(u+g)/4,X=(T+e)/4,v=(P+G)/4;return p>M&&p>R?Q>p?(y=0,A=.707106781,b=.707106781):(y=Math.sqrt(p),A=q/y,b=X/y):M>R?Q>M?(y=.707106781,A=0,b=.707106781):(A=Math.sqrt(M),y=q/A,b=v/A):Q>R?(y=.707106781,A=.707106781,b=0):(b=Math.sqrt(R),y=X/b,A=v/b),this.set(y,A,b,m),this}var j=Math.sqrt((G-P)*(G-P)+(T-e)*(T-e)+(g-u)*(g-u));return Math.abs(j)<.001&&(j=1),this.x=(G-P)/j,this.y=(T-e)/j,this.z=(g-u)/j,this.w=Math.acos((O+V+r-1)/2),this
},min:function(L){return this.x=Math.min(this.x,L.x),this.y=Math.min(this.y,L.y),this.z=Math.min(this.z,L.z),this.w=Math.min(this.w,L.w),this},max:function(R){return this.x=Math.max(this.x,R.x),this.y=Math.max(this.y,R.y),this.z=Math.max(this.z,R.z),this.w=Math.max(this.w,R.w),this},clamp:function(U,d){return this.x=Math.max(U.x,Math.min(d.x,this.x)),this.y=Math.max(U.y,Math.min(d.y,this.y)),this.z=Math.max(U.z,Math.min(d.z,this.z)),this.w=Math.max(U.w,Math.min(d.w,this.w)),this},clampScalar:function(){var E,S;return function(A,q){return E===_&&(E=new El,S=new El),E.set(A,A,A,A),S.set(q,q,q,q),this.clamp(E,S)}}(),clampLength:function(N,w){var R=this.length();return this.divideScalar(R||1).multiplyScalar(Math.max(N,Math.min(w,R)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(C){return this.x*C.x+this.y*C.y+this.z*C.z+this.w*C.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(f){return this.normalize().multiplyScalar(f)},lerp:function(r,T){return this.x+=(r.x-this.x)*T,this.y+=(r.y-this.y)*T,this.z+=(r.z-this.z)*T,this.w+=(r.w-this.w)*T,this},lerpVectors:function(A,k,_){return this.subVectors(k,A).multiplyScalar(_).add(A)},equals:function(m){return m.x===this.x&&m.y===this.y&&m.z===this.z&&m.w===this.w},fromArray:function(B,w){return w===_&&(w=0),this.x=B[w],this.y=B[w+1],this.z=B[w+2],this.w=B[w+3],this},toArray:function(c,C){return c===_&&(c=[]),C===_&&(C=0),c[C]=this.x,c[C+1]=this.y,c[C+2]=this.z,c[C+3]=this.w,c},fromBufferAttribute:function(V,y){return this.x=V.getX(y),this.y=V.getY(y),this.z=V.getZ(y),this.w=V.getW(y),this}});var ti=A.Math.Vector3=function(W,P,s){W===_?(this.x=0,this.y=0,this.z=0):"object"==typeof W?this.copy(W):this.set(W,P==_?W:P,s==_?W:s)},Eb=A.Math.Vector3;j.assign(ti.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(j,q,O){return this.x=j,this.y=q,this.z=O,this},equals:function(D){return D&&this.x===D.x&&this.y===D.y&&this.z===D.z},setScalar:function(M){return this.x=M,this.y=M,this.z=M,this},setX:function(R){return this.x=R,this},setY:function(T){return this.y=T,this},setZ:function(E){return this.z=E,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(o){return o.x===_?(this.x=o[0],this.y=o[1],this.z=o[2]):(this.x=o.x,this.y=o.y,this.z=o.z||0),this},add:function(X){return this.x+=X.x,this.y+=X.y,this.z+=X.z,this},addScalar:function(m){return this.x+=m,this.y+=m,this.z+=m,this},addVectors:function(_,Y){return this.x=_.x+Y.x,this.y=_.y+Y.y,this.z=_.z+Y.z,this},addScaledVector:function(U,D){return this.x+=U.x*D,this.y+=U.y*D,this.z+=U.z*D,this},sub:function(F){return this.x-=F.x,this.y-=F.y,this.z-=F.z,this},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(M,b){return this.x=M.x-b.x,this.y=M.y-b.y,this.z=M.z-b.z,this},divide:function(w){return this.x/=w.x,this.y/=w.y,this.z/=w.z,this},multiply:function(o){return this.x*=o.x,this.y*=o.y,this.z*=o.z,this},multiplyScalar:function(I){return this.x*=I,this.y*=I,this.z*=I,this},divideScalar:function(f){if(0!==f){var m=1/f;this.x*=m,this.y*=m,this.z*=m}else this.x=0,this.y=0,this.z=0;return this},distanceTo:function(L){return Math.sqrt(this.distanceToSquared(L))},distanceToSquared:function(F){var S=this.x-F.x,r=this.y-F.y,p=this.z-F.z;return S*S+r*r+p*p},distanceToSquared2:function(x){var X=this.x-x[0],q=this.y-x[1],i=this.z-x[2];return X*X+q*q+i*i},divideVectors:function(i,n){return this.x=i.x/n.x,this.y=i.y/n.y,this.z=i.z/n.z,this},multiplyVectors:function(l,$){return this.x=l.x*$.x,this.y=l.y*$.y,this.z=l.z*$.z,this},transformDirection:function(o){var F=this.x,_=this.y,W=this.z,n=o.el;return this.x=n[0]*F+n[4]*_+n[8]*W,this.y=n[1]*F+n[5]*_+n[9]*W,this.z=n[2]*F+n[6]*_+n[10]*W,this.normalize()},applyAxisAngle:function(){var K=new Uk;return function(e,c){return this.applyQuaternion(K.setFromAxisAngle(e,c))}}(),applyEuler:function(){var C=new Uk;return function(m){return this.applyQuaternion(C.setFromEuler(m))}}(),applyQuaternion:function(m){var G=this.x,T=this.y,y=this.z,b=m._x,Q=m._y,l=m._z,c=m._w,B=c*G+Q*y-l*T,a=c*T+l*G-b*y,z=c*y+b*T-Q*G,w=-b*G-Q*T-l*y;return this.x=B*c+w*-b+a*-l-z*-Q,this.y=a*c+w*-Q+z*-b-B*-l,this.z=z*c+w*-l+B*-Q-a*-b,this},applyMatrix4:function(y){var D=this.x,c=this.y,E=this.z,a=y.el,I=1/(a[3]*D+a[7]*c+a[11]*E+a[15]);return this.x=(a[0]*D+a[4]*c+a[8]*E+a[12])*I,this.y=(a[1]*D+a[5]*c+a[9]*E+a[13])*I,this.z=(a[2]*D+a[6]*c+a[10]*E+a[14])*I,this},applyMatrix3:function(L){var D=this.x,P=this.y,x=this.z,y=L.el;return this.x=y[0]*D+y[3]*P+y[6]*x,this.y=y[1]*D+y[4]*P+y[7]*x,this.z=y[2]*D+y[5]*P+y[8]*x,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var R=new ti;return function(c){return this.sub(R.copy(c).multiplyScalar(2*this.dot(c)))}}(),dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var O=this.length();return O?this.multiplyScalar(1/O):this},setLength:function(z){return this.normalize().multiplyScalar(z)},fromArray:function(b,u){return u===_&&(u=0),this.x=b[u],this.y=b[u+1],this.z=b[u+2],this},toArray:function(G,o){return G===_&&(G=[0,0,0]),o===_&&(o=0),G[o]=this.x,G[o+1]=this.y,G[o+2]=this.z,G},cross:function(U){return this.crossVectors(this,U)},angleTo:function(h){var S=this.dot(h)/Math.sqrt(this.lengthSq()*h.lengthSq());return S>1||-1>S?0:Math.acos(S)},lerp:function(D,j){return this.x+=(D.x-this.x)*j,this.y+=(D.y-this.y)*j,this.z+=(D.z-this.z)*j,this},lerpVectors:function(x,A,t){return this.subVectors(A,x).multiplyScalar(t).add(x)},crossVectors:function(p,G){var z=p.x,O=p.y,S=p.z,s=G.x,_=G.y,Y=G.z;return this.x=O*Y-S*_,this.y=S*s-z*Y,this.z=z*_-O*s,this},min:function(S){return this.x=Math.min(this.x,S.x),this.y=Math.min(this.y,S.y),this.z=Math.min(this.z,S.z),this},max:function(V){return this.x=Math.max(this.x,V.x),this.y=Math.max(this.y,V.y),this.z=Math.max(this.z,V.z),this},setFromMatrixPosition:function(H){return this.setFromMatrixColumn(H,3)},setFromMatrixScale:function(a){var u=this.setFromMatrixColumn(a,0).length(),J=this.setFromMatrixColumn(a,1).length(),Z=this.setFromMatrixColumn(a,2).length();return this.x=u,this.y=J,this.z=Z,this},setFromMatrixColumn:function(d,Q){return this.fromArray(d.el,4*Q)}}),ti.UP=new ti(0,1,0),ti.AxisX=new ti(1,0,0),ti.AxisY=new ti(0,1,0),ti.AxisZ=new ti(0,0,1);var gr=A.Math.Vector2=function(l,O,r){"object"==typeof l&&(l.x!=_?(O=l.y,r=l.e,l=l.x):(r=l[2],O=l[1],l=l[0])),this.set(l||0,O||0,r)};gr.prototype={},gr.prototype.constructor=gr;var Xp=gr;j.defineProperties(gr.prototype,{width:{get:function(){return this.x},set:function(P){this.x=P}},height:{get:function(){return this.y},set:function(Q){this.y=Q}}}),gr.prototype.clone=function(){return new gr(this.x,this.y,this.e)},gr.prototype.copy=function(w){return this.set(w.x,w.y,w.e),this},gr.prototype.equals=function(N){return N.x===this.x&&N.y===this.y&&N.e===this.e},gr.prototype.set=function(i,Q,m){return this.x=i||0,this.y=Q||(0!==Q?this.x:0),m!=_&&(this.e=m),this},gr.prototype.setScalar=function(x){return this.x=x,this.y=x,this.e=x,this},gr.prototype.setX=function(R){return this.x=R||0,this},gr.prototype.setY=function(w){return this.y=w||0,this},gr.prototype.setE=function(L){return this.e=L||0,this},gr.prototype.add=function(k){return this.x+=k.x,this.y+=k.y,this},gr.prototype.addVectors=function(V,L){return this.x=V.x+L.x,this.y=V.y+L.y,this},gr.prototype.addScalar=function(E){return this.x+=E,this.y+=E,this},gr.prototype.addScaledVector=function(Q,w){return this.x+=Q.x*w,this.y+=Q.y*w,this},gr.prototype.sub=function(A){return this.x-=A.x,this.y-=A.y,this},gr.prototype.subScalar=function(A){return this.x-=A,this.y-=A,this},gr.prototype.subVectors=function(v,M){return this.x=v.x-M.x,this.y=v.y-M.y,this},gr.prototype.multiply=function(a){return this.x*=a.x,this.y*=a.y,this},gr.prototype.multiplyScalar=function(I){return this.x*=I,this.y*=I,this},gr.prototype.divide=function(P){return this.x/=P.x,this.y/=P.y,this},gr.prototype.divideScalar=function(j){return this.multiplyScalar(1/j)},gr.prototype.min=function(M){return this.x=Math.min(this.x,M.x),this.y=Math.min(this.y,M.y),this},gr.prototype.max=function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},gr.prototype.fromArray=function(D,c){return c===_&&(c=0),this.x=D[c],this.y=D[c+1],this},gr.prototype.clamp=function(G,P){return this.x=Math.max(G.x,Math.min(P.x,this.x)),this.y=Math.max(G.y,Math.min(P.y,this.y)),this},gr.prototype.clampScalar=function(){var X,B;return function(k,y){return X===_&&(X=new gr,B=new gr),X.set(k,k),B.set(y,y),this.clamp(X,B)}}(),gr.prototype.clampLength=function(z,m){var p=this.length();return this.multiplyScalar(Math.max(z,Math.min(m,p))/p)},gr.prototype.dot=function(W){return this.x*W.x+this.y*W.y},gr.prototype.cross=function(j){return this.x*j.y-this.y*j.x},gr.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},gr.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},gr.prototype.normalize=function(){return this.divideScalar(this.length())},gr.prototype.angle=function(){var K=Math.atan2(this.y,this.x);return 0>K&&(K+=2*Math.PI),K},gr.prototype.distanceTo=function(F){return Math.sqrt(this.distanceToSquared(F))},gr.prototype.distanceToSquared=function(H){var O=this.x-H.x,d=this.y-H.y;return O*O+d*d},gr.prototype.isNearEnough=function(p){return this.distanceToSquared(p)<1e-8},gr.prototype.setLength=function(G){var u=this.length();return u?this.multiplyScalar(G/u):this},gr.prototype.lerp=function(i,U){return this.x+=(i.x-this.x)*U,this.y+=(i.y-this.y)*U,"number"==typeof i.e&&"number"==typeof this.e&&(this.e+=(i.e-this.e)*U),this},gr.prototype.lerpVectors=function(b,O,z){return this.subVectors(O,b).multiplyScalar(z).add(b)},gr.prototype.rotateAround=function(B,f){var z=B?B.x:0,O=B?B.y:0,q=Math.cos(f),M=Math.sin(f),i=this.x-z,J=this.y-O;return this.x=i*q-J*M+z,this.y=i*M+J*q+O,this};var Sh=A.Math.Matrix3=function(){this.el=[1,0,0,0,1,0,0,0,1]};j.assign(Sh.prototype,{isMatrix3:!0,set:function(E,R,r,D,n,O,y,e,w){var L=this.el;return L[0]=E,L[1]=D,L[2]=y,L[3]=R,L[4]=n,L[5]=e,L[6]=r,L[7]=O,L[8]=w,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function($){var W=this.el,r=$.el;return W[0]=r[0],W[1]=r[1],W[2]=r[2],W[3]=r[3],W[4]=r[4],W[5]=r[5],W[6]=r[6],W[7]=r[7],W[8]=r[8],this},setFromMatrix4:function(r){var E=r.el;return this.set(E[0],E[4],E[8],E[1],E[5],E[9],E[2],E[6],E[10]),this},applyToBufferAttribute:function(){var b=new ti;return function(x){for(var M=0,K=x.count;K>M;M++)b.x=x.getX(M),b.y=x.getY(M),b.z=x.getZ(M),b.applyMatrix3(this),x.setXYZ(M,b.x,b.y,b.z);return x}}(),multiply:function(Z){return this.multiplyMatrices(this,Z)},premultiply:function(E){return this.multiplyMatrices(E,this)},multiplyMatrices:function(Q,k){var Y=Q.el,M=k.el,w=this.el,V=Y[0],J=Y[3],q=Y[6],b=Y[1],g=Y[4],$=Y[7],L=Y[2],c=Y[5],v=Y[8],n=M[0],T=M[3],l=M[6],A=M[1],h=M[4],j=M[7],u=M[2],i=M[5],S=M[8];return w[0]=V*n+J*A+q*u,w[3]=V*T+J*h+q*i,w[6]=V*l+J*j+q*S,w[1]=b*n+g*A+$*u,w[4]=b*T+g*h+$*i,w[7]=b*l+g*j+$*S,w[2]=L*n+c*A+v*u,w[5]=L*T+c*h+v*i,w[8]=L*l+c*j+v*S,this},multiplyScalar:function(W){var s=this.el;return s[0]*=W,s[3]*=W,s[6]*=W,s[1]*=W,s[4]*=W,s[7]*=W,s[2]*=W,s[5]*=W,s[8]*=W,this},determinant:function(){var e=this.el,F=e[0],y=e[1],A=e[2],X=e[3],x=e[4],r=e[5],N=e[6],n=e[7],b=e[8];return F*x*b-F*r*n-y*X*b+y*r*N+A*X*n-A*x*N},getInverse:function(E){var o=E.el,I=this.el,H=o[0],z=o[1],P=o[2],Y=o[3],y=o[4],A=o[5],w=o[6],Q=o[7],d=o[8],v=d*y-A*Q,$=A*w-d*Y,u=Q*Y-y*w,p=H*v+z*$+P*u;if(0===p)return this.identity();var j=1/p;return I[0]=v*j,I[1]=(P*Q-d*z)*j,I[2]=(A*z-P*y)*j,I[3]=$*j,I[4]=(d*H-P*w)*j,I[5]=(P*Y-A*H)*j,I[6]=u*j,I[7]=(z*w-Q*H)*j,I[8]=(y*H-z*Y)*j,this},transpose:function(){var z,Z=this.el;return z=Z[1],Z[1]=Z[3],Z[3]=z,z=Z[2],Z[2]=Z[6],Z[6]=z,z=Z[5],Z[5]=Z[7],Z[7]=z,this},getNormalMatrix:function(R){return this.setFromMatrix4(R).getInverse(this).transpose()},transposeIntoArray:function(B){var q=this.el;return B[0]=q[0],B[1]=q[3],B[2]=q[6],B[3]=q[1],B[4]=q[4],B[5]=q[7],B[6]=q[2],B[7]=q[5],B[8]=q[8],this},setUvTransform:function(O,m,R,B,N,e,g){var W=Math.cos(N),d=Math.sin(N);this.set(R*W,R*d,-R*(W*e+d*g)+e+O,-B*d,B*W,-B*(-d*e+W*g)+g+m,0,0,1)},scale:function(f,K){var R=this.el;return R[0]*=f,R[3]*=f,R[6]*=f,R[1]*=K,R[4]*=K,R[7]*=K,this},rotate:function(T){var R=Math.cos(T),H=Math.sin(T),k=this.el,f=k[0],Z=k[3],D=k[6],A=k[1],P=k[4],Q=k[7];return k[0]=R*f+H*A,k[3]=R*Z+H*P,k[6]=R*D+H*Q,k[1]=-H*f+R*A,k[4]=-H*Z+R*P,k[7]=-H*D+R*Q,this},translate:function(O,l){var E=this.el;return E[0]+=O*E[2],E[3]+=O*E[5],E[6]+=O*E[8],E[1]+=l*E[2],E[4]+=l*E[5],E[7]+=l*E[8],this},equals:function(C){for(var e=this.el,Z=C.el,U=0;9>U;U++)if(e[U]!==Z[U])return!1;return!0},fromArray:function(n,l){l===_&&(l=0);for(var I=0;9>I;I++)this.el[I]=n[I+l];return this},toArray:function(k,X){k===_&&(k=[]),X===_&&(X=0);var f=this.el;return k[X]=f[0],k[X+1]=f[1],k[X+2]=f[2],k[X+3]=f[3],k[X+4]=f[4],k[X+5]=f[5],k[X+6]=f[6],k[X+7]=f[7],k[X+8]=f[8],k}});var Wd=A.Math.Plane=function(I,D){this.normal=I!==_?I:new ti(1,0,0),this.constant=D!==_?D:0};j.assign(Wd.prototype,{set:function(h,e){return this.normal.copy(h),this.constant=e,this},setComponents:function(Y,I,j,z){return this.normal.set(Y,I,j),this.constant=z,this},setFromNormalAndCoplanarPoint:function(D,N){return this.normal.copy(D),this.constant=-N.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new ti,o=new ti;return function(O,e,_){var Z=t.subVectors(_,e).cross(o.subVectors(O,e)).normalize();return this.setFromNormalAndCoplanarPoint(Z,O),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(U){return this.normal.copy(U.normal),this.constant=U.constant,this},normalize:function(){var A=1/this.normal.length();return this.normal.multiplyScalar(A),this.constant*=A,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(H){return this.normal.dot(H)+this.constant},distanceToSphere:function(Z){return this.distanceToPoint(Z.center)-Z.radius},projectPoint:function(R,G){return G===_&&(G=new ti),G.copy(this.normal).multiplyScalar(-this.distanceToPoint(R)).add(R)},intersectLine:function(){var n=new ti;return function(C,I){I===_&&(I=new ti);var S=C.delta(n),D=this.normal.dot(S);if(0===D)return 0===this.distanceToPoint(C.start)?I.copy(C.start):_;var H=-(C.start.dot(this.normal)+this.constant)/D;return 0>H||H>1?_:I.copy(S).multiplyScalar(H).add(C.start)}}(),intersectsLine:function(C){var D=this.distanceToPoint(C.start),r=this.distanceToPoint(C.end);return 0>D&&r>0||0>r&&D>0},intersectsBox:function(d){return d.intersectsPlane(this)},intersectsSphere:function(c){return c.intersectsPlane(this)},coplanarPoint:function(X){return X===_&&(X=new ti),X.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var E=new ti,e=new Sh;return function(m,T){var J=T||e.getNormalMatrix(m),L=this.coplanarPoint(E).applyMatrix4(m),t=this.normal.applyMatrix3(J).normalize();return this.constant=-L.dot(t),this}}(),translate:function(d){return this.constant-=d.dot(this.normal),this},equals:function(a){return a.normal.equals(this.normal)&&a.constant===this.constant}});var Hl=A.Math.Ray=function(u,f){this.origin=u!==_?u.clone():new ti,this.direction=f!==_?f.clone():new ti};j.assign(Hl.prototype,{set:function(v,U){return this.origin.copy(v),this.direction.copy(U),this},clone:function(){return(new this.constructor).copy(this)},copy:function(H){return this.origin.copy(H.origin),this.direction.copy(H.direction),this.maxHitLen=H.maxHitLen,this},at:function(o,N){var F=N||new ti;return F.copy(this.direction).multiplyScalar(o).add(this.origin)},setMaxHitLength:function(D){this.maxHitLen=D},lookAt:function(G){return this.direction.copy(G).sub(this.origin).normalize(),this},applyMatrix4:function(d){var a=this.maxHitLen;if(a){var G=this.direction.clone().multiplyScalar(a).add(this.origin);G.applyMatrix4(d)}return this.origin.applyMatrix4(d),this.direction.transformDirection(d),a&&(this.maxHitLen=this.origin.distanceTo(G)),this},distanceToPlane:function(P){var I=P.normal.dot(this.direction);if(0===I)return 0===P.distanceToPoint(this.origin)?0:null;var b=-(this.origin.dot(P.normal)+P.constant)/I;return b>=0?b:null},intersectPlane:function(q,I){var M=this.distanceToPlane(q);return null===M?null:this.at(M,I)},intersectSphere:function(){var b=new ti;return function(i,Y){b.subVectors(i.center,this.origin);var O=b.dot(this.direction),A=b.dot(b)-O*O,X=i.radius*i.radius;if(A>X)return null;var Z=Math.sqrt(X-A),y=O-Z,w=O+Z;return 0>y&&0>w?null:0>y?this.at(w,Y):this.at(y,Y)}}(),intersectEllipsoid:function(){var B=new ti,m=new ti;return function(t,N){B.subVectors(t.center,this.origin),B.divide(t.radius),m.divideVectors(this.direction,t.radius);var W=m.lengthSq(),g=B.dot(m),V=B.dot(B)*W-g*g;if(V>W)return null;var A=Math.sqrt(W-V),l=(g-A)/W,n=(g+A)/W;return 0>l&&0>n?null:0>l?this.at(n,N):this.at(l,N)}}(),intersectBox:function(V,r){var t,g,m,L,A,y,Z=1/this.direction.x,o=1/this.direction.y,c=1/this.direction.z,R=this.origin;if(Z>=0?(t=(V.min.x-R.x)*Z,g=(V.max.x-R.x)*Z):(t=(V.max.x-R.x)*Z,g=(V.min.x-R.x)*Z),o>=0?(m=(V.min.y-R.y)*o,L=(V.max.y-R.y)*o):(m=(V.max.y-R.y)*o,L=(V.min.y-R.y)*o),t>L||m>g)return null;if((m>t||t!==t)&&(t=m),(g>L||g!==g)&&(g=L),c>=0?(A=(V.min.z-R.z)*c,y=(V.max.z-R.z)*c):(A=(V.max.z-R.z)*c,y=(V.min.z-R.z)*c),t>y||A>g)return null;if((A>t||t!==t)&&(t=A),(g>y||g!==g)&&(g=y),0>g)return null;var s=t>=0?t:g,W=this.maxHitLen;return W&&s>W?null:this.at(s,r)},intersectTriangle:function(){var v=new ti,X=new ti,D=new ti,V=new ti;return function(M,U,y,u,F){X.subVectors(U,M),D.subVectors(y,M),V.crossVectors(X,D);var $,Q=this.direction.dot(V);if(Q>0){if(u)return null;$=1}else{if(!(0>Q))return null;$=-1,Q=-Q}v.subVectors(this.origin,M);var e=$*this.direction.dot(D.crossVectors(v,D));if(0>e)return null;var J=$*this.direction.dot(X.cross(v));if(0>J||e+J>Q)return null;var s=-$*v.dot(V);if(0>s)return null;var h=s/Q,Y=this.maxHitLen;return Y&&h>Y?null:this.at(h,F)}}()});var Sb=A.Math.Box3=function(x,v){this.min=x!==_?x:new ti(1/0,1/0,1/0),this.max=v!==_?v:new ti(-1/0,-1/0,-1/0)};j.assign(Sb.prototype,{set:function(d,F){return this.min.copy(d),this.max.copy(F),this},setFromArray:function(l){for(var M=1/0,a=1/0,S=1/0,O=-1/0,H=-1/0,f=-1/0,V=0,y=l.length;y>V;V+=3){var P=l[V],e=l[V+1],T=l[V+2];M>P&&(M=P),a>e&&(a=e),S>T&&(S=T),P>O&&(O=P),e>H&&(H=e),T>f&&(f=T)}return this.min.set(M,a,S),this.max.set(O,H,f),this},setFromPoints:function(G){this.makeEmpty();for(var N=0,c=G.length;c>N;N++)this.expandByPoint(G[N]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(q){return q.max.x<this.min.x||q.min.x>this.max.x||q.max.y<this.min.y||q.min.y>this.max.y||q.max.z<this.min.z||q.min.z>this.max.z?!1:!0},copy:function(L){return this.min.copy(L.min),this.max.copy(L.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(j){return this.min.min(j),this.max.max(j),this},expandByBox:function(r){return this.min.min(r.min),this.max.max(r.max),this},applyMatrix4:function(){var x=[new ti,new ti,new ti,new ti,new ti,new ti,new ti,new ti];return function(o){return this.isEmpty()?this:(x[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(o),x[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(o),x[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(o),x[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(o),x[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(o),x[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(o),x[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(o),x[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(o),this.setFromPoints(x),this)}}()});var Ih=A.Math.Sphere=function(D,G){this.center=D!==_?D:new ti,this.radius=G!==_?G:0};j.assign(Ih.prototype,{set:function(P,J){return this.center.copy(P),this.radius=J,this},setFromPoints:function(){var H=new Sb;return function(t,d){var N=this.center;d!==_?N.copy(d):H.setFromPoints(t).getCenter(N);for(var C=0,$=0,y=t.length;y>$;$++)C=Math.max(C,N.distanceToSquared(t[$]));return this.radius=Math.sqrt(C),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(s){return s.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(b){return b.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var N=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=N*N},intersectsBox:function(B){return B.intersectsSphere(this)},intersectsPlane:function(V){return Math.abs(V.distanceToPoint(this.center))<=this.radius},clampPoint:function(h,S){var E=this.center.distanceToSquared(h);return S===_&&(S=new ti),S.copy(h),E>this.radius*this.radius&&(S.sub(this.center).normalize(),S.multiplyScalar(this.radius).add(this.center)),S},getBoundingBox:function($){return $===_&&($=new Sb),$.set(this.center,this.center),$.expandByScalar(this.radius),$},applyMatrix4:function(i){return this.center.applyMatrix4(i),this.radius=this.radius*i.getMaxScaleOnAxis(),this},translate:function(m){return this.center.add(m),this},equals:function(X){return X.center.equals(this.center)&&X.radius===this.radius}});var $i=A.Math.Frustum=function(O,c,p,s,Z,R){this.planes=[O!==_?O:new Wd,c!==_?c:new Wd,p!==_?p:new Wd,s!==_?s:new Wd,Z!==_?Z:new Wd,R!==_?R:new Wd]};j.assign($i.prototype,{set:function(d,R,C,u,o,c){var k=this.planes;return k[0].copy(d),k[1].copy(R),k[2].copy(C),k[3].copy(u),k[4].copy(o),k[5].copy(c),this},clone:function(){return(new this.constructor).copy(this)},copy:function(n){for(var a=this.planes,N=0;6>N;N++)a[N].copy(n.planes[N]);return this},setFromMatrix:function(K){var h=this.planes,A=K.el,k=A[0],H=A[1],x=A[2],W=A[3],r=A[4],M=A[5],_=A[6],J=A[7],v=A[8],y=A[9],Q=A[10],g=A[11],w=A[12],$=A[13],z=A[14],p=A[15];return h[0].setComponents(W-k,J-r,g-v,p-w).normalize(),h[1].setComponents(W+k,J+r,g+v,p+w).normalize(),h[2].setComponents(W+H,J+M,g+y,p+$).normalize(),h[3].setComponents(W-H,J-M,g-y,p-$).normalize(),h[4].setComponents(W-x,J-_,g-Q,p-z).normalize(),h[5].setComponents(W+x,J+_,g+Q,p+z).normalize(),this},intersectsObject:function(){var u=new Ih;return function(v){var q=v.geometry;return null===q.boundingSphere&&q.computeBoundingSphere(),u.copy(q.boundingSphere).applyMatrix4(v.matrixWorld),this.intersectsSphere(u)}}(),intersectsSprite:function(){var V=new Ih;return function(t){return V.center.set(0,0,0),V.radius=.7071067811865476,V.applyMatrix4(t.matrixWorld),this.intersectsSphere(V)}}(),intersectsSphere:function(b){for(var V=this.planes,G=b.center,A=-b.radius,B=0;6>B;B++){var M=V[B].distanceToPoint(G);if(A>M)return!1}return!0},intersectsBox:function(){var q=new ti;return function(I){for(var T=this.planes,R=0;6>R;R++){var z=T[R];if(q.x=z.normal.x>0?I.max.x:I.min.x,q.y=z.normal.y>0?I.max.y:I.min.y,q.z=z.normal.z>0?I.max.z:I.min.z,z.distanceToPoint(q)<0)return!1}return!0}}(),containsPoint:function(T){for(var f=this.planes,K=0;6>K;K++)if(f[K].distanceToPoint(T)<0)return!1;return!0}});var gq=A.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};j.assign(gq.prototype,{set:function(C,B,V,M,d,W,H,p,u,f,g,x,r,o,P,Y){var j=this.el;return j[0]=C,j[4]=B,j[8]=V,j[12]=M,j[1]=d,j[5]=W,j[9]=H,j[13]=p,j[2]=u,j[6]=f,j[10]=g,j[14]=x,j[3]=r,j[7]=o,j[11]=P,j[15]=Y,this},clone:function(){return(new gq).fromArray(this.el)},fromArray:function(I,K){K===_&&(K=0);for(var U=this.el,E=0;16>E;E++)U[E]=I[E+K];return this},getElements:function(){return this.el},scale:function(l){var T=this.el,p=l.x,z=l.y,v=l.z;return T[0]*=p,T[4]*=z,T[8]*=v,T[1]*=p,T[5]*=z,T[9]*=v,T[2]*=p,T[6]*=z,T[10]*=v,T[3]*=p,T[7]*=z,T[11]*=v,this},makeRotationFromEuler:function(v){var j=this.el,t=v._x,G=v._y,L=v._z,$=v._order,i=Math.cos(t),P=Math.sin(t),x=Math.cos(G),T=Math.sin(G),d=Math.cos(L),r=Math.sin(L);if("XYZ"===$){var A=i*d,z=i*r,H=P*d,k=P*r;j[0]=x*d,j[4]=-x*r,j[8]=T,j[1]=z+H*T,j[5]=A-k*T,j[9]=-P*x,j[2]=k-A*T,j[6]=H+z*T,j[10]=i*x}else if("YXZ"===$){var N=x*d,F=x*r,n=T*d,I=T*r;j[0]=N+I*P,j[4]=n*P-F,j[8]=i*T,j[1]=i*r,j[5]=i*d,j[9]=-P,j[2]=F*P-n,j[6]=I+N*P,j[10]=i*x}else if("ZXY"===$){var N=x*d,F=x*r,n=T*d,I=T*r;j[0]=N-I*P,j[4]=-i*r,j[8]=n+F*P,j[1]=F+n*P,j[5]=i*d,j[9]=I-N*P,j[2]=-i*T,j[6]=P,j[10]=i*x}else if("ZYX"===$){var A=i*d,z=i*r,H=P*d,k=P*r;j[0]=x*d,j[4]=H*T-z,j[8]=A*T+k,j[1]=x*r,j[5]=k*T+A,j[9]=z*T-H,j[2]=-T,j[6]=P*x,j[10]=i*x}else if("YZX"===$){var W=i*x,M=i*T,D=P*x,E=P*T;j[0]=x*d,j[4]=E-W*r,j[8]=D*r+M,j[1]=r,j[5]=i*d,j[9]=-P*d,j[2]=-T*d,j[6]=M*r+D,j[10]=W-E*r}else if("XZY"===$){var W=i*x,M=i*T,D=P*x,E=P*T;j[0]=x*d,j[4]=-r,j[8]=T*d,j[1]=W*r+E,j[5]=i*d,j[9]=M*r-D,j[2]=D*r-M,j[6]=P*d,j[10]=E*r+W}return j[3]=0,j[7]=0,j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,this},makeRotationFromQuaternion:function(b){var y=this.el,P=b._x,D=b._y,K=b._z,C=b._w,M=P+P,n=D+D,Y=K+K,a=P*M,m=P*n,I=P*Y,L=D*n,_=D*Y,f=K*Y,i=C*M,F=C*n,H=C*Y;return y[0]=1-(L+f),y[4]=m-H,y[8]=I+F,y[1]=m+H,y[5]=1-(a+f),y[9]=_-i,y[2]=I-F,y[6]=_+i,y[10]=1-(a+L),y[3]=0,y[7]=0,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(z){var S=this.el,c=z.el,F=c[0],f=c[1],M=c[2],X=c[3],C=c[4],j=c[5],K=c[6],a=c[7],G=c[8],m=c[9],Q=c[10],$=c[11],x=c[12],s=c[13],h=c[14],w=c[15],b=m*h*a-s*Q*a+s*K*$-j*h*$-m*K*w+j*Q*w,J=x*Q*a-G*h*a-x*K*$+C*h*$+G*K*w-C*Q*w,i=G*s*a-x*m*a+x*j*$-C*s*$-G*j*w+C*m*w,B=x*m*K-G*s*K-x*j*Q+C*s*Q+G*j*h-C*m*h,E=F*b+f*J+M*i+X*B;if(0===E)return this.identity();var t=1/E;return S[0]=b*t,S[1]=(s*Q*X-m*h*X-s*M*$+f*h*$+m*M*w-f*Q*w)*t,S[2]=(j*h*X-s*K*X+s*M*a-f*h*a-j*M*w+f*K*w)*t,S[3]=(m*K*X-j*Q*X-m*M*a+f*Q*a+j*M*$-f*K*$)*t,S[4]=J*t,S[5]=(G*h*X-x*Q*X+x*M*$-F*h*$-G*M*w+F*Q*w)*t,S[6]=(x*K*X-C*h*X-x*M*a+F*h*a+C*M*w-F*K*w)*t,S[7]=(C*Q*X-G*K*X+G*M*a-F*Q*a-C*M*$+F*K*$)*t,S[8]=i*t,S[9]=(x*m*X-G*s*X-x*f*$+F*s*$+G*f*w-F*m*w)*t,S[10]=(C*s*X-x*j*X+x*f*a-F*s*a-C*f*w+F*j*w)*t,S[11]=(G*j*X-C*m*X-G*f*a+F*m*a+C*f*$-F*j*$)*t,S[12]=B*t,S[13]=(G*s*M-x*m*M+x*f*Q-F*s*Q-G*f*h+F*m*h)*t,S[14]=(x*j*M-C*s*M-x*f*K+F*s*K+C*f*h-F*j*h)*t,S[15]=(C*m*M-G*j*M+G*f*K-F*m*K-C*f*Q+F*j*Q)*t,this},makeRotationAxis:function(E,H){var d=Math.cos(H),f=Math.sin(H),R=1-d,K=E.x,U=E.y,L=E.z,g=R*K,N=R*U;return this.set(g*K+d,g*U-f*L,g*L+f*U,0,g*U+f*L,N*U+d,N*L-f*K,0,g*L-f*U,N*L+f*K,R*L*L+d,0,0,0,0,1),this},multiply:function(a){return this.multiplyMatrices(this,a)},premultiply:function(q){return this.multiplyMatrices(q,this)},multiplyMatrices:function(m,G){var r=m.el,n=G.el,N=this.el,_=r[0],i=r[4],M=r[8],q=r[12],C=r[1],I=r[5],X=r[9],T=r[13],b=r[2],K=r[6],c=r[10],E=r[14],d=r[3],l=r[7],D=r[11],$=r[15],o=n[0],A=n[4],j=n[8],f=n[12],g=n[1],V=n[5],p=n[9],B=n[13],H=n[2],t=n[6],w=n[10],O=n[14],F=n[3],h=n[7],U=n[11],Q=n[15];return N[0]=_*o+i*g+M*H+q*F,N[4]=_*A+i*V+M*t+q*h,N[8]=_*j+i*p+M*w+q*U,N[12]=_*f+i*B+M*O+q*Q,N[1]=C*o+I*g+X*H+T*F,N[5]=C*A+I*V+X*t+T*h,N[9]=C*j+I*p+X*w+T*U,N[13]=C*f+I*B+X*O+T*Q,N[2]=b*o+K*g+c*H+E*F,N[6]=b*A+K*V+c*t+E*h,N[10]=b*j+K*p+c*w+E*U,N[14]=b*f+K*B+c*O+E*Q,N[3]=d*o+l*g+D*H+$*F,N[7]=d*A+l*V+D*t+$*h,N[11]=d*j+l*p+D*w+$*U,N[15]=d*f+l*B+D*O+$*Q,this},lookAt:function(){var c=new ti;return function(W,K,y){return c.subVectors(W,K),this.lookAtDirection(c,y)}}(),lookAtDirection:function(){var H=new ti,m=new ti,v=new ti;return function(c,t){t||(t=ti.UP);var h=this.el;return v.copy(c),0===v.lengthSq()&&(v.z=1),v.normalize(),H.crossVectors(t,v),0===H.lengthSq()&&(1===Math.abs(t.z)?v.x+=1e-4:v.z+=1e-4,v.normalize(),H.crossVectors(t,v)),H.normalize(),m.crossVectors(v,H),h[0]=H.x,h[4]=m.x,h[8]=v.x,h[1]=H.y,h[5]=m.y,h[9]=v.y,h[2]=H.z,h[6]=m.z,h[10]=v.z,this}}(),extractScale:function(){var Z;return function(l){Z===_&&(Z=new ti),l===_&&(l=new ti);var f=Z.setFromMatrixColumn(this,0).length(),E=Z.setFromMatrixColumn(this,1).length(),B=Z.setFromMatrixColumn(this,2).length();return l.set(f,E,B),l}}(),extractRotation:function(){var p;return function(Q){p===_&&(p=new ti),Q===_&&(Q=new gq);var s=this.el,D=Q.el,z=1/p.setFromMatrixColumn(Q,0).length(),r=1/p.setFromMatrixColumn(Q,1).length(),l=1/p.setFromMatrixColumn(Q,2).length();return s[0]=D[0]*z,s[1]=D[1]*z,s[2]=D[2]*z,s[4]=D[4]*r,s[5]=D[5]*r,s[6]=D[6]*r,s[8]=D[8]*l,s[9]=D[9]*l,s[10]=D[10]*l,this}}(),multiplyScalar:function(N){var U=this.el;return U[0]*=N,U[4]*=N,U[8]*=N,U[12]*=N,U[1]*=N,U[5]*=N,U[9]*=N,U[13]*=N,U[2]*=N,U[6]*=N,U[10]*=N,U[14]*=N,U[3]*=N,U[7]*=N,U[11]*=N,U[15]*=N,this},getPosition:function(x){return x===_&&(x=new ti),x.setFromMatrixColumn(this,3)},setPosition:function(B){var m=this.el;return m[12]=B.x,m[13]=B.y,m[14]=B.z,this},toArray:function(D,o){D===_&&(D=[]),o===_&&(o=0);var N=this.el;return D[o]=N[0],D[o+1]=N[1],D[o+2]=N[2],D[o+3]=N[3],D[o+4]=N[4],D[o+5]=N[5],D[o+6]=N[6],D[o+7]=N[7],D[o+8]=N[8],D[o+9]=N[9],D[o+10]=N[10],D[o+11]=N[11],D[o+12]=N[12],D[o+13]=N[13],D[o+14]=N[14],D[o+15]=N[15],D},determinant:function(){var s=this.el,f=s[0],H=s[4],O=s[8],Z=s[12],k=s[1],B=s[5],c=s[9],l=s[13],v=s[2],D=s[6],b=s[10],U=s[14],X=s[3],Q=s[7],n=s[11],g=s[15];return X*(+Z*c*D-O*l*D-Z*B*b+H*l*b+O*B*U-H*c*U)+Q*(+f*c*U-f*l*b+Z*k*b-O*k*U+O*l*v-Z*c*v)+n*(+f*l*D-f*B*U-Z*k*D+H*k*U+Z*B*v-H*l*v)+g*(-O*B*v-f*c*D+f*B*b+O*k*D-H*k*b+H*c*v)},copy:function(S){var H=this.el,U=S.el;return H[0]=U[0],H[1]=U[1],H[2]=U[2],H[3]=U[3],H[4]=U[4],H[5]=U[5],H[6]=U[6],H[7]=U[7],H[8]=U[8],H[9]=U[9],H[10]=U[10],H[11]=U[11],H[12]=U[12],H[13]=U[13],H[14]=U[14],H[15]=U[15],this},compose:function(X,V,x){var K=this.el,f=V._x,W=V._y,w=V._z,A=V._w,E=f+f,Y=W+W,G=w+w,I=f*E,d=f*Y,U=f*G,k=W*Y,N=W*G,e=w*G,a=A*E,v=A*Y,c=A*G,M=x.x,P=x.y,r=x.z;return K[0]=(1-(k+e))*M,K[1]=(d+c)*M,K[2]=(U-v)*M,K[3]=0,K[4]=(d-c)*P,K[5]=(1-(I+e))*P,K[6]=(N+a)*P,K[7]=0,K[8]=(U+v)*r,K[9]=(N-a)*r,K[10]=(1-(I+k))*r,K[11]=0,K[12]=X.x,K[13]=X.y,K[14]=X.z,K[15]=1,this},decompose:function(){var r=new ti,D=new gq;return function(U,b,l){var Z=this.el,a=r.set(Z[0],Z[1],Z[2]).length(),h=r.set(Z[4],Z[5],Z[6]).length(),z=r.set(Z[8],Z[9],Z[10]).length(),F=this.determinant();0>F&&(a=-a),U.x=Z[12],U.y=Z[13],U.z=Z[14],D.copy(this);var J=1/a,c=1/h,m=1/z;return D.el[0]*=J,D.el[1]*=J,D.el[2]*=J,D.el[4]*=c,D.el[5]*=c,D.el[6]*=c,D.el[8]*=m,D.el[9]*=m,D.el[10]*=m,b.setFromRotationMatrix(D),l.x=a,l.y=h,l.z=z,this}}()});var uf=A.Math.Triangle=function(v,w,i){this.a=v!==_?v:new ti,this.b=w!==_?w:new ti,this.c=i!==_?i:new ti};j.assign(uf,{barycoordFromPoint:function(){var T=new ti,s=new ti,X=new ti;return function(A,M,U,l,C){T.subVectors(l,M),s.subVectors(U,M),X.subVectors(A,M);var O=T.dot(T),o=T.dot(s),Y=T.dot(X),I=s.dot(s),u=s.dot(X),m=O*I-o*o,t=C||new ti;if(0===m)return t.set(-2,-1,-1);var S=1/m,j=(I*Y-o*u)*S,K=(O*u-o*Y)*S;
return t.set(1-j-K,K,j)}}(),uvIntersection:function(){var K=new ti;return function(S,Q,I,r,O,H,c){return uf.barycoordFromPoint(S,Q,I,r,K),O.multiplyScalar(K.x),H.multiplyScalar(K.y),c.multiplyScalar(K.z),O.add(H).add(c),O.clone()}}()});var bd=A.Math.Euler=function(X,W,c,F,Q){this.set(X,W,c,F,Q)};bd.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],bd.DefaultOrder="XYZ",bd.ReverseOrder=function(){var h={xyz:"ZYX",xzy:"YZX",yxz:"ZXY",yzx:"XZY",zxy:"YXZ",zyx:"XYZ"};return function(g){return h[g]}}(),j.defineProperties(bd.prototype,{x:{get:function(){return this._x},set:function(v){this._x=v,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(N){this._y=N,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(E){this._z=E,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(w){this._order=w,this.onChangeCallback()}}}),j.assign(bd.prototype,{set:function(U,N,m,I,r){return gc(U)&&(r=m,I=N,m=U[2],N=U[1],U=U[0]),I?r&&(I=bd.ReverseOrder(I)):I="ZYX",this._x=U||0,this._y=N||0,this._z=m||0,this._order=I||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(B,Z,j){var X=A.Math.clamp,o=B.el||B,Q=o[0],y=o[4],l=o[8],p=o[1],I=o[5],h=o[9],q=o[2],i=o[6],U=o[10];return Z=Z||this._order,"XYZ"===Z?(this._y=Math.asin(X(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-h,U),this._z=Math.atan2(-y,Q)):(this._x=Math.atan2(i,I),this._z=0)):"YXZ"===Z?(this._x=Math.asin(-X(h,-1,1)),Math.abs(h)<.99999?(this._y=Math.atan2(l,U),this._z=Math.atan2(p,I)):(this._y=Math.atan2(-q,Q),this._z=0)):"ZXY"===Z?(this._x=Math.asin(X(i,-1,1)),Math.abs(i)<.99999?(this._y=Math.atan2(-q,U),this._z=Math.atan2(-y,I)):(this._y=0,this._z=Math.atan2(p,Q))):"ZYX"===Z?(this._y=Math.asin(-X(q,-1,1)),Math.abs(q)<.99999?(this._x=Math.atan2(i,U),this._z=Math.atan2(p,Q)):(this._x=0,this._z=Math.atan2(-y,I))):"YZX"===Z?(this._z=Math.asin(X(p,-1,1)),Math.abs(p)<.99999?(this._x=Math.atan2(-h,I),this._y=Math.atan2(-q,Q)):(this._x=0,this._y=Math.atan2(l,U))):"XZY"===Z?(this._z=Math.asin(-X(y,-1,1)),Math.abs(y)<.99999?(this._x=Math.atan2(i,I),this._y=Math.atan2(l,Q)):(this._x=Math.atan2(-h,U),this._y=0)):console.warn("unsupported order: "+Z),this._order=Z,j!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var y=new gq;return function(H,N,g){return y.makeRotationFromQuaternion(H),this.setFromRotationMatrix(y,N,g)}}(),setFromVector3:function(L,I){return this.set(L.x,L.y,L.z,I||this._order)},reorder:function(){var I=new Uk;return function(d){return I.setFromEuler(this),this.setFromQuaternion(I,d)}}(),equals:function(R){return R._x===this._x&&R._y===this._y&&R._z===this._z&&R._order===this._order},fromArray:function(m){return this._x=m[0],this._y=m[1],this._z=m[2],m[3]!==_&&(this._order=m[3]),this.onChangeCallback(),this},toArray:function(Z,x){return Z===_&&(Z=[]),x===_&&(x=0),Z[x]=this._x,Z[x+1]=this._y,Z[x+2]=this._z,Z[x+3]=this._order,Z},toVector3:function(W){return W?W.set(this._x,this._y,this._z):new ti(this._x,this._y,this._z)},onChange:function(D){return this.onChangeCallback=D,this},onChangeCallback:function(){}});var sm={ms_ac:function(q,E){for(var s=E.ms_ac,B=0;B<s.length;B++)Yo(q,s[B])},ms_listener:function(f){f.addListeners=function(){var b=this,g=Ye;z.mockTouch&&(g=ep.concat(ul).concat(xs)),b.__events__=g;for(var O=0,F=g.length;F>O;O++){var j=g[O];"wheel"===j&&!b.handle_wheel&&b.handle_mousewheel&&(b.handle_wheel=function(A){Sr(b,A)}),b["handle_"+j]&&jg(j,b.getView(),b)}},f.removeListeners=function(){var i=this,o=i.__events__;if(o){i.__events__=_;for(var O=0,D=o.length;D>O;O++)i["handle_"+o[O]]&&gp(o[O],i.getView(),i)}}},ms_fire:function(w){w.mp=function(p,t,a){this.addPropertyChangeListener(p,t,a)},w.ump=function(k,W){this.removePropertyChangeListener(k,W)},w.fp=function(c,m,K,e,X){return this.firePropertyChange(c,m,K,e,X)},w.addPropertyChangeListener=function(U,P,B){var w=this;w._62I||(w._62I=new jc),w._62I.add(U,P,B)},w.removePropertyChangeListener=function(y,$){this._62I&&this._62I.remove(y,$)},w.firePropertyChange=function(U,i,f,k,d){if(k){if(k(i,f))return!1}else if(i===f)return!1;var z=this,a=d||{};return a.property=U,a.oldValue=i,a.newValue=f,a.source=z,a.data=z,z._62I&&z._62I.fire(a),z.onPropertyChanged&&z.onPropertyChanged(a),!0}},ms_attr:function(P){P.a=function(P,f){var Q=this;if(2===arguments.length)Q.setAttr(P,f);else{if(!qf(P))return Q.getAttr(P);for(var i in P)Q.setAttr(i,P[i])}return Q},P.getAttr=function(M,g){if(g===_&&(g=1),this._attrObject&&M in this._attrObject)return this._attrObject[M];if(this.getImage){var b=this.getImage();if(Fp(b)&&(b=Qj[b]),qf(b)&&"dataBindings"in b)for(var c=b.dataBindings,w=c.length-1;w>=0;w--){var S=c[w];if(S.attr===M){if("defaultValue"in S)return S.defaultValue;break}}}return g?C[M]:_},P.setAttr=function(W,v){var Q=this;Q._attrObject||(Q._attrObject={});var $=Q._attrObject[W];v===_?delete Q._attrObject[W]:Q._attrObject[W]=v,Q.fp&&Q.fp("a:"+W,$,v)&&Q.onAttrChanged&&Q.onAttrChanged(W,$,v)},P.getSerializableAttrs=function(){var v,k={};for(v in this._attrObject)k[v]=1;return k}},ms_bnb:function(H){H.getBodyColor=function(B){return B.s("body.color")},H.getBorderColor=function(q){return q.s("border.color")}},_51o:function(E){E.mi=function(b,T,K){this.addInteractorListener(b,T,K)},E.umi=function(K,E){this.removeInteractorListener(K,E)},E.fi=function(c){this.fireInteractorEvent(c)},E.addInteractorListener=function(w,f,D){var E=this;E._63I||(E._63I=new jc),E._63I.add(w,f,D)},E.removeInteractorListener=function(V,j){this._63I&&this._63I.remove(V,j)},E.fireInteractorEvent=function(g){this._63I&&this._63I.fire(g)},E.setInteractors=function(l){var X=this,R=X._interactors;R&&R.each(function(z){z.tearDown()}),gc(l)&&(l=new Gc(l)),X._interactors=l,l&&l.each(function(y){y.setUp()}),X.fp("interactors",R,l),X.invalidateSelection()},E.getInteractors=function(){return this._interactors}},_49o:function(F){F._44O=I,F._45O=I,F.getTopPainters=function(){return this._44O},F.getBottomPainters=function(){return this._45O},F.addTopPainter=function(h){var D=this;D._44O||(D._44O=new Gc),D._44O.contains(h)||(D._44O.add(h),D.redraw&&D.redraw())},F.removeTopPainter=function(z){var V=this;V._44O&&(V._44O.remove(z),V.redraw&&V.redraw())},F.addBottomPainter=function(s){var I=this;I._45O||(I._45O=new Gc),I._45O.contains(s)||(I._45O.add(s),I.redraw&&I.redraw())},F.removeBottomPainter=function(R){var Q=this;Q._45O&&(Q._45O.remove(R),Q.redraw&&Q.redraw())},F._93db=function(B,d){var C=this;C._45O&&C._45O.each(function(j){j.draw?j.draw(B,d):j.call(C,B,d)})},F._92db=function(z,V){var d=this;d._44O&&d._44O.each(function(n){n.draw?n.draw(z,V):n.call(d,z,V)})}},ms_sm:function(l){l.sm=function(){return this.getSelectionModel()},l.setSelectableFunc=function(X){this.sm().setFilterFunc(X)},l.getSelectableFunc=function(){return this.sm().getFilterFunc()},l.getSelectionModel=function(){var w=this;return w._selectionModel?w._selectionModel:w.dm().sm()},l.isSelectionModelShared=function(){return!this._selectionModel},l.setSelectionModelShared=function(n){var r=this,G=r.sm(),y=!r._selectionModel,W=r.handleSelectionChange,s=r.dm();y!==n&&(r.invalidateSelection&&r.invalidateSelection(),n?(s.sm().ms(W,r),r._selectionModel.ums(W,r),r._selectionModel.dispose(),r._selectionModel=I):(s.sm().ums(W,r),r._selectionModel=new Om(s),r._selectionModel.ms(W,r)),r.onSelectionModelSharedChanged(),r.fp("selectionModelShared",y,n),r.fireViewEvent({kind:"selectionModelSharedChange",oldValue:y,newValue:n,oldSelectionModel:G,newSelectionModel:r.sm()}))},l.onSelectionModelSharedChanged=function(){var Z=this;Z.redraw(),Z.invalidateSelection&&Z.invalidateSelection()},l.removeSelection=function(){var X=this.dm();X.beginTransaction(),this.sm().toSelection().each(X.remove,X),X.endTransaction()},l.selectAll=function(){var T=this;T.sm().ss(T.dm().toDatas(function(O){return T.isVisible(O)&&T.isSelectable(O)}))},l.isSelected=function(y){return this.sm().co(y)},l.isSelectedById=function(P){var i=this.dm().getDataById(P);return i?this.isSelected(i):!1},l.isSelectable=function(p){return this.sm().isSelectable(p)}},ms_tx:function(i){i._64I=0,i._65O=0,i.isScrollable=function(){return this.getWidth()<this._64I},i._40o=function(){return this.isScrollable()},i.getLogicalPoint=function(g){return Qe(g,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},i.tx=function(a){return a===_?this.getTranslateX():(this.setTranslateX(a),void 0)},i.getTranslateX=function(){return this._65O},i.setTranslateX=function(M){var x=this,g=x.getWidth()-x._64I;g>M&&(M=g),M>0&&(M=0),M=b(M);var w=x._65O;x._65O=M,x.fp(Wm,w,M)}},ms_ty:function(J){J._23Q=0,J._66O=0,J._41o=function(){return this.getHeight()<this._23Q},J.getLogicalPoint=function(P){return Qe(P,this._canvas||this._view,this.tx?this.tx():0,this.ty())},J.ty=function(B){return B===_?this.getTranslateY():(this.setTranslateY(B),void 0)},J.getTranslateY=function(){return this._66O},J.setTranslateY=function(E){var P=this,q=P.getHeight()-P._23Q;q>E&&(E=q),E>0&&(E=0),E=b(E);var g=P._66O;P._66O=E,P.fp(mg,g,E)}},ms_txy:function(p){p._65O=0,p._66O=0,p.tx=function(t){return t===_?this.getTranslateX():(this.setTranslateX(t),void 0)},p.ty=function(R){return R===_?this.getTranslateY():(this.setTranslateY(R),void 0)},p.onTranslateEnded=function(){},p.setTranslate=function(C,V,U){var M=this;if(U=Zq(U)){M._65I&&M._65I.stop(!0);var I=M.tx(),O=M.ty();U.action=function(L){M.setTranslate(I+(C-I)*L,O+(V-O)*L)},U._37o=function(){delete M._66I,delete M._65I,M.onTranslateEnded()},M._66I=1,M._65I=un(U)}else M.tx(C),M.ty(V)},p.getTranslateX=function(){return this._65O},p.setTranslateX=function(E){var V=this;E=V.adjustTranslateX(E);var z=V._65O;V._65O=E,V.fp(Wm,z,E)},p.getTranslateY=function(){return this._66O},p.setTranslateY=function(f){var o=this;f=o.adjustTranslateY(f);var t=o._66O;o._66O=f,o.fp(mg,t,f)},p.adjustTranslateX=function(s){return b(s)},p.adjustTranslateY=function(y){return b(y)},p.translate=function(f,n,d){this.setTranslate(this.tx()+f,this.ty()+n,d)},p.getLogicalPoint=function(D){var o=this;return Qe(D,this._canvas||o._view,o.tx(),o.ty())}},ms_dm:function(F){F.dm=function(E){return E?(this.setDataModel(E),void 0):this.getDataModel()},F.getDataModel=function(){return this._dataModel}},ms_lp:function(G){G.lp=function(Q){return this.getLogicalPoint(Q)}},ms_v:function(h){h._disabled=!1,h.setDisabled=function(Z,V){var R=this,r=R._disabled;r!==Z&&(r&&(Hj(R._63O),delete R._63O),Z&&(Ik(R._view,R._63O=Sd(V)),R.iv()),R._disabled=Z,R.fp("disabled",r,Z))},h.isDisabled=function(){return this._disabled},h.getDisabledDiv=function(){return this._63O},h.getView=function(){return this._view},h.addToDOM=function(u){var x=this,Z=x.getView(),X=Z.style;u=u||K.body,u.appendChild(Z),X.left="0",X.right="0",X.top="0",X.bottom="0",p(c,"resize",function(){x.iv()}),x.iv()},h.setCursor=function(M){"default"===M&&(M=this._defaultCursor||M);var t=this.getView().style;t.cursor=M,t.cursor="-webkit-"+M,t.cursor="-moz-"+M},h.getWidth=function(){return this._view.clientWidth},h.getHeight=function(){return this._view.clientHeight},h.setWidth=function(g){var l=this;l._view.style.width=g+pn,l.iv(),l.fp&&l.fp(fe,I,g)},h.setHeight=function(a){var J=this;J._view.style.height=a+pn,J.iv(),J.fp&&J.fp(dj,I,a)},h.setFocus=function(e){var h=this,s=h._currentEditor;return e&&s&&(s.getView&&(s=s.getView()),s.contains(e.target))?!1:(cf(h._view),h.endEditing&&h.endEditing(),h.fireViewEvent("focus"),!0)},h.iv=function(J){this.invalidate(J)},h.invalidate=function(h){var J=this;J._68I||(J._68I=1,Km(J.validate,J,I,h),J.onInvalidated&&J.onInvalidated(),J.fireViewEvent("invalidate"))},h.validate=function(){var i=this,h=i._view;if(i._68I&&(delete i._68I,h.parentNode))if(0===h.offsetWidth&&0===h.offsetHeight&&i._67I!==I)i._67I===_&&(i._67I=z.reinvalidateCount),i._67I>0?i._67I--:i._67I=I,i.iv();else{i.fireViewEvent("beginValidate"),i.validateImpl(),i.onValidated&&i.onValidated(),i.fireViewEvent("validate");var e=i._63O;e&&(h.lastChild!==e&&(Hj(e),Ik(h,e)),zb(e,0,0,i.getWidth(),i.getHeight())),Hk(i),Hh(i),gf(i)}},h.layout=function(t,O,k,n){1===arguments.length?zb(this,t):zb(this,t,O,k,n)},h.addViewListener=function(k,d,I){var J=this;J._67O||(J._67O=new jc),J._67O.add(k,d,I)},h.removeViewListener=function(E,N){this._67O.remove(E,N)},h.fireViewEvent=function(p){var T=this;T._67O&&(Fp(p)&&(p={kind:p}),T._67O.fire(p)),z.viewListener&&z.viewListener(T,p)}},ms_tip:function(y){y.setToolTipEnabled=function(I){var N=this;I?to||N._13o||(N.enableToolTip(),N.fp("toolTipEnabled",!1,!0)):N._13o&&(N.disableToolTip(),N.fp("toolTipEnabled",!0,!1))},y.isToolTipEnabled=function(){return!!this._13o},y.enableToolTip=function(){var c=this;if(!to&&!c._13o){c._13o=function(K){var $=c.getToolTip(K);$!=I?(z.toolTipContinual&&z.isToolTipShowing()?ai(K,$):(Tk(),hg={timeout:Nq(cm,yl),e:K,info:$}),kn={e:K,view:c}):Tk()};var M=c.getView();p(M,vf,c._13o),p(M,"mouseleave",z.hideToolTip)}},y.disableToolTip=function(){var V=this;if(V._13o){var o=V.getView();g(o,vf,V._13o),g(o,"mouseleave",z.hideToolTip),delete V._13o}},y.getToolTip=function(M){var k=this;if(k.getDataAt){var F=k.getDataAt(M);return F?F.getToolTip():I}return k.getValue?k.getValue():void 0}},_52o:function(q){q._zoom=1,q._29I=Uf,q.zoomIn=function(l,T){this.setZoom(this._zoom*cr,l,T)},q.zoomOut=function($,G){this.setZoom(this._zoom/cr,$,G)},q.zoomReset=function(F,y){this.setZoom(1,F,y)},q.scrollZoomIn=function(S){this.setZoom(this._zoom*jl,I,S)},q.scrollZoomOut=function(H){this.setZoom(this._zoom/jl,I,H)},q.pinchZoomIn=function(b){this.setZoom(this._zoom*Tc,I,b)},q.pinchZoomOut=function($){this.setZoom(this._zoom/Tc,I,$)},q.adjustZoom=function(B){return Ei>B?Ei:B>Sf?Sf:B},q.getZoom=function(){return this._zoom},q.setZoom=function(U,B,C){var l=this;if(B=Zq(B)){l._14o&&l._14o.stop(!0);var N=l._zoom;B.action=function(g){l._96O(N+(U-N)*g,C)},B._37o=function(){delete l._zooming,delete l._14o,l.onZoomEnded()},l._zooming=1,l._14o=un(B)}else l._96O(U,C)},q._96O=function(M,h){var L=this;if(M=L.adjustZoom(M),M!==L._zoom){L.validate();var V=L._29I,X=L._zoom;0!==V.width&&0!==V.height&&(h=h?h:{x:V.x+V.width/2,y:V.y+V.height/2},L.tx((h.x-V.x)*X-h.x*M),L.ty((h.y-V.y)*X-h.y*M)),L._zoom=M,L.fp("zoom",X,M)}}},ms_edge:function(X){X._2I=function(R){var X=this;X._44I||(X._44I=new Gc),X._42I||(X._42I=new Gc),X._44I.add(R),X._42I.add(R),X._20I()},X._4I=function(Z){var M=this;M._44I||(M._44I=new Gc),M._43I||(M._43I=new Gc),M._44I.add(Z),M._43I.add(Z),M._20I()},X._16I=function(P){var H=this;H._44I.remove(P),H._42I.remove(P),H._44I.isEmpty()&&delete H._44I,H._42I.isEmpty()&&delete H._42I,H._20I()},X._18I=function(j){var z=this;z._44I.remove(j),z._43I.remove(j),z._44I.isEmpty()&&delete z._44I,z._43I.isEmpty()&&delete z._43I,z._20I()},X._20I=function(){var B=this;if(delete B._45I,!B._44I||B._44I.isEmpty())return delete B._70O,void 0;var e;B._44I.each(function(a){a.isLooped()&&(e||(e={}),e[a._id]||(B._45I||(B._45I=new Gc),B._45I.add(a),e[a._id]=a))}),e?(B._70O=new Gc,B._44I.each(function(v){e[v._id]?"A"===e[v._id]||(e[v._id]="A",B._70O.add(v)):B._70O.add(v)})):B._70O=B._44I},X.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},X.getSourceAgentEdges=function(){return this._46I},X.getTargetAgentEdges=function(){return this._47I},X._1I=function(t){var U=this;U._46I||(U._46I=new Gc),U._48I||(U._48I=new Gc),U._46I.add(t),U._48I.add(t),U._19I()},X._3I=function(i){var V=this;V._47I||(V._47I=new Gc),V._48I||(V._48I=new Gc),V._47I.add(i),V._48I.add(i),V._19I()},X._15I=function(H){var t=this;t._46I.remove(H),t._48I.remove(H),t._46I.isEmpty()&&delete t._46I,t._48I.isEmpty()&&delete t._48I,t._19I()},X._17I=function(p){var k=this;k._47I.remove(p),k._48I.remove(p),k._47I.isEmpty()&&delete k._47I,k._48I.isEmpty()&&delete k._48I,k._19I()},X._19I=function(){var n=this;delete n._49I;var P=n._48I;if(P&&!P.isEmpty()){var A={};P.each(function(G){A[G._id]?n._49I||(n._49I=new Gc):A[G._id]=G}),n._49I?P.each(function(Q){A[Q._id]&&(n._49I.add(Q),delete A[Q._id])}):n._49I=P}},X.getLoopedEdges=function(){return this._45I},X.getEdges=function(){return this._70O},X.getAgentEdges=function(){return this._49I},X.getSourceEdges=function(){return this._42I},X.getTargetEdges=function(){return this._43I},X._8I=function(){this._70O&&this._70O.each(function(K){K._7I()})}}};Xi(z,{getVersion:function(){return"7.2.6-dev11"}},!0),Xi(z,{numberDigits:5,crossOrigin:"",baseZIndex:_,isTouchable:to,mockTouch:!0,devicePixelRatio:c.devicePixelRatio?c.devicePixelRatio:c.screen?c.screen.deviceXDPI/c.screen.logicalXDPI:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:Y.disabledBackground,forceHierarchicalSerialization:!0,extractBatchTranslation:!1,extractShapeTranslation:!1,envmapProbeMinWaitTime:300,envmapProbeMaxWaitTime:25e3,EnvmapTextureSize:1024,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Lq},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,textExtraWidth:4,encodeStringKey:null,doubleClickSpeed:500,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(w){return w*w},labelColor:Xd,labelSelectColor:ce,labelFont:"12px arial, sans-serif",widgetIndent:to?30:20,widgetRowHeight:to?30:20,widgetHeaderHeight:to?32:22,widgetTitleHeight:to?34:24,scrollBarColor:Gl,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:to?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:tj,intersectionLineLine:ip,isEnter:dc,isEsc:Li,isDelete:yq,isSpace:Ui,isLeft:li,isUp:mq,isRight:ar,isDown:si,isTouchEvent:Pm,getTarget:qo,isString:Fp,isNumber:Cp,isBoolean:Je,isArray:gc,isSelectAll:Kf,isFunction:gg,isObject:qf,getPropertyValue:nb,setPropertyValue:gm,addMethod:Xi,createGradient:function(I,x,h,m,t,Q,e,M){var z=wh[x];return z(I,h,m,t,Q,e,M)},appendToScreen:function(L){L=L.getView?L.getView():L,(K.fullscreenElement||K.mozFullScreenElement||K.webkitFullscreenElement||K.msFullscreenElement||K.body).appendChild(L)},encodeString:function(I){return A.Math.encodeBase64(I,z.encodeStringKey)},decodeString:function(l){return A.Math.decodeBase64(l,z.encodeStringKey)},findView:function(U){var i=function(y,U){var h=U._ht;h&&y.push(h);var e=U.children,Q=e.length;if(Q)for(var F=0;Q>F;F++)i(y,e[F])},x=[];i(x,K.body);var Z=function(i,H){for(var o="2d"===H?Ic.GraphView:Ac.Graph3dView,r=0,e=i.length;e>r;r++)if(i[r]instanceof o)return x[r];return null};return"all"===U?x:"2d"===U?Z(x,"2d"):"3d"===U?Z(x,"3d"):Z(x,"3d")||Z(x,"2d")},toggleFullscreen:function(Y){var W=Y.getView();if(K.fullscreenElement||K.mozFullScreenElement||K.webkitFullscreenElement||K.msFullscreenElement)K.exitFullscreen?K.exitFullscreen():K.msExitFullscreen?K.msExitFullscreen():K.mozCancelFullScreen?K.mozCancelFullScreen():K.webkitExitFullscreen&&K.webkitExitFullscreen();else{var s=!0;if(Y.isSelfViewEvent){var B=Y.getX(),g=Y.getY(),U=Y.getWidth(),N=Y.getHeight(),c=W.style.background,j=W.style.backgroundColor;c||j||(W.style.backgroundColor="white"),W.requestFullscreen?W.requestFullscreen():W.msRequestFullscreen?W.msRequestFullscreen():W.mozRequestFullScreen?W.mozRequestFullScreen():W.webkitRequestFullscreen&&W.webkitRequestFullscreen();var m=setInterval(function(){if(W!==(K.fullscreenElement||K.mozFullScreenElement||K.webkitFullscreenElement||K.msFullscreenElement))clearInterval(m),Y.setX(B),Y.setY(g),Y.setWidth(U),Y.setHeight(N),Y._fullscreen=!1,W.style.oldBackgroundColor=j,Y.iv();else{var V=A.Default.getWindowInfo();(s||V.width!==Y.getWidth()||V.height!==Y.getHeight())&&(Y.setX(V.left),Y.setY(V.top),Y.setWidth(V.width),Y.setHeight(V.height),Y._fullscreen=!0,Y.iv(),s=!1)}},500)}else{var x=W.style.left,t=W.style.top,U=W.style.width,N=W.style.height,c=W.style.background,j=W.style.backgroundColor;c||j||(W.style.backgroundColor="white"),W.requestFullscreen?W.requestFullscreen():W.msRequestFullscreen?W.msRequestFullscreen():W.mozRequestFullScreen?W.mozRequestFullScreen():W.webkitRequestFullscreen&&W.webkitRequestFullscreen();var m=setInterval(function(){if(W!==(K.fullscreenElement||K.mozFullScreenElement||K.webkitFullscreenElement||K.msFullscreenElement))clearInterval(m),W.style.left=x,W.style.top=t,W.style.width=U,W.style.height=N,W.style.oldBackgroundColor=j,Y.iv();else{var L=A.Default.getWindowInfo();(s||L.width!==Y.getWidth()||L.height!==Y.getHeight())&&(zb(Y),s=!1)}},500)}}},appendTimeStamp:function(E){return E},setCompType:function(K,X){Fp(X)&&X.substr(0,12)==rp&&(X=z.parse(X)),gg(X)||qf(X)?Dj[K]=X:Sg(K)},getCompType:function(J){var f=Dj[J];return f===_&&Ul.test(J)&&Sg(J),f},getCompTypeMap:function(){return Dj},drawCompType:function(m,y,O,o,P,Q){m(y,O,o,P,Q)},numberListener:function(){var c={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(M){var I=M.keyCode;c[I]||65===I&&z.isCtrlDown(M)||86===I&&z.isCtrlDown(M)||67===I&&z.isCtrlDown(M)||88===I&&z.isCtrlDown(M)||I>=35&&40>=I||(M.shiftKey||48>I||I>57)&&(96>I||I>105)&&M.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(W){var t=W.target.tagName;("DIV"===t||"CANVAS"===t)&&!(z.ignoreKeyCodes.indexOf(W.keyCode)>=0)&&("keydown"!==W.type||li(W)||ar(W)||mq(W)||si(W)||yq(W)||65===W.keyCode&&(W.metaKey||W.ctrlKey))&&W.cancelable===!0&&(W.preventDefault(),W.preventManipulation&&W.preventManipulation())},getWindowInfo:function(){var X=K.documentElement,E=X&&(X.scrollLeft||X.scrollTop)?X:K.body;return{target:E,left:E.scrollLeft,top:E.scrollTop,width:c.innerWidth||E.clientWidth,height:c.innerHeight||E.clientHeight}},isDragging:function(){return!!Lq},isLeftButton:function(e){return Pm(e)?!0:0===e.button},isMiddleButton:function(M){return Pm(M)?!1:M&&(1===M.button||4&(M.buttons||0))},isRightButton:function(K){return Pm(K)?!1:K&&(2===K.button||2&(K.buttons||0))},isInput:function(J){if(!J)return!1;var p=J.tagName;return"INPUT"===p||"TEXTAREA"===p||"SELECT"===p},getTouchCount:function(e){return Pm(e)?e.touches.length:1},isDoubleClick:function(){function G(M){M.details=0,M.timeout=null,M.lastPoint=null}var u={};return ik=new Rj,So=ik.getTime(),function(C){if(hq(C)>1)return!1;var j=C.button==I?"":C.button,b=C.type+j,Q=b+"_isDoubleClick",P=u[b];if(P||(P=u[b]={details:0,timeout:null,lastPoint:null}),C[Q]===_){C[Q]=!0;var V=Xe(C);P.timeout&&(np(P.timeout),P.timeout=null);var h=Pm(C)?z.doubleTouchRange:z.doubleClickRange;P.lastPoint&&Hd(P.lastPoint,V)>h&&G(P),P.lastPoint=V,P.details++,P.timeout=Nq(function(){G(this)}.bind(P),z.doubleClickSpeed)}return 2===P.details}}(),isShiftDown:function(N){return N?N.shiftKey:Yk["16"]},isCtrlDown:function(m){return m?vp?m.metaKey:m.ctrlKey:vp?Yk["91"]:Yk["17"]},getClientPoint:function(r){return Pm(r)&&(r=$b(r)),{x:r.clientX,y:r.clientY}},isMouseEvent:function(T){return T instanceof MouseEvent||0===T.type.indexOf("mouse")},getTargetElement:function(Q){var b,V=$l(Q);if(b=z.isMouseEvent(Q)||!K.elementFromPoint?Q.target:K.elementFromPoint(V.x,V.y),jn&&K.elementFromPoint){for(var R=[],B=[];"none"===b.style.pointerEvents;)R.push(b),B.push(b.style.display||""),b.style.display="none",b=K.elementFromPoint(V.x,V.y);R.forEach(function(P,U){P.style.display=B[U]})}return b},getPagePoint:function(y){return Pm(y)&&(y=$b(y)),{x:y.pageX,y:y.pageY}},createObject:function(I,z){var n=new I;for(var x in z){var O=z[x];if(gg(O))n[x]=O;else if(0===x.indexOf("s:"))n.s(x.substr(2),z[x]);else if(0===x.indexOf("a:"))n.a(x.substr(2),z[x]);else{var l=om(x),O=z[x];n[l]?(n[l](O),"setToolTip"===l&&n.enableToolTip&&n.enableToolTip()):n[x]=O}}return n},setImage:function(a,k,L,w){var j=arguments.length;4===j?nq(a,w,k,L):2===j?Fp(k)?k.substr(0,12)==rp?Hm(a,z.parse(k)):nq(a,k):Hm(a,k):1===j&&nq(a,a)},getImage:function(X,U,a){var E;if(X==I)return I;if(qf(X)?E=X:(E=Qj[X],X&&E===_&&(Vp&&Vp[X]||nq(X,X))),U&&E&&E.tagName){var H;H="override"===a?"colors_override":"override_rgb"===a?"colors_override_rgb":"override_a"===a?"colors_override_a":"colors",E[H]||(E[H]={__count__:0});var f=E[H][U];return f||(E[H].__count__>z.imageCacheThreshold&&(E[H]={__count__:0}),f=ir(E,Tj(U),E.width,E.height,a),E[H][U]=f,E[H].__count__++),f}return E},isImageComplete:function(A,B,H){var w=Gj(A);if(!w)return!1;if(w.tagName)return w.complete;for(var o,A,g,q=w.comps,l=!0,r=0,C=q.length;C>r;r++)if(o=q[r],g=o.type,"image"===o.type){A=o.name,A&&A.func&&(A=ui(A,B));var k=$c(A,B,H);if(!k){l=!1;break}}else if(Ul.test(g)&&z.getCompType(g)===_){l=!1,Sg(g);break}return l},getId:function(){var P=1;return function(){return++P}}(),callLater:function(Q,F,h,Y){var m=function(){Q.apply(F,h)};return Y?Nq(m,Y):c.requestAnimationFrame(m)},cancelLater:function(T,I){I?np(T):c.cancelAnimationFrame(T)},clone:function(r){if(null==r||"object"!=typeof r)return r;if(r instanceof Date){var f=new Date;return f.setTime(r.getTime()),f}if(r instanceof Array){for(var f=[],q=0,L=r.length;L>q;q++)f[q]=Tl(r[q]);return f}if(r instanceof Gc){for(var f=new Gc,q=0,L=r.length;L>q;q++)f.set(q,Tl(r.get(q)));return f}if(r instanceof Nj)return r;if(r instanceof Tf){var f=new Tf;return f.deserialize(r.serialize()),f}if(r instanceof j){var f={};for(var J in r)r.hasOwnProperty(J)&&(f[J]=Tl(r[J]));return f}return r},callWhenLoaded:function(s,c){c=c||100;var z=xr(s,c);nn||(nn={}),nn[z]={tick:z,cb:s,delay:c}},beforeLoadURL:function(A,L){if(nn){var C={};for(var L in nn){var v=nn[L];np(v.tick);var p=xr(v.cb,v.delay);C[p]={tick:p,delay:v.delay,cb:v.cb}}nn=C}return z.convertURL?z.convertURL(A,L):A},convertURL:function(F){return F},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return z.getImage("default_blank")},resizeImage:function($,A,V,F){V||(V=A),F||(F=th());var H=F.getContext("2d");return Pq(F,A,V,1),H.drawImage($,0,0,A,V),F},resizeImagePOT:function(o,w,v){if(!o||!o.tagName)return o;var _=o.width,g=o.height;if(!_||!g)return o;if(ym.isPOT(_)&&ym.isPOT(g)&&(!w||_===g))return o;var O,A;return w?A=O=ym.nearestPOT(Math.min(_,g)):(O=ym.nearestPOT(_),A=ym.nearestPOT(g)),z.resizeImage(o,O,A,v)},sortFunc:function(c,w){if(c===w)return 0;if(c==I&&w!=I)return 1;if(c!=I&&w==I)return-1;if(c==I&&w==I)return 0;var q,g=typeof c,U=typeof w;return g===mh&&U===mh?q=c.localeCompare(w):g===sh&&U===sh&&(q=c-w),q===_&&(q=(""+c).localeCompare(""+w)),q>0?1:0>q?-1:0},getClassMap:function(){return ls},getClass:function(y){if(Fp(y)){var e,m=ls[y];if(!m){e=y.split("."),m=c;for(var C=0;C<e.length;C++)m=m[e[C]];ls[y]=m}return m}return y},def:function(U,I,E){var S,w,a,i=function(){};if(i.prototype=I.prototype,S=new i,Fp(U)){if(ls[U])throw"'"+U+"' already defined";a=_b(U),S.getClassName=function(){return U}}else a=U;if(S.constructor=a,S.getClass=function(){return a},S.getSuperClass=function(){return I},E)for(w in E)sm[w]&&sm.hasOwnProperty(w)?sm[w](S,E):Oj(S,E,w);a.prototype=S,a.superClass=I.prototype},startAnim:function(){var m=function(j){j.duration&&(j.startTime=Jd()),j.timeId=Km(j.tick,I,I,j.interval)};return function(N){return N=Tl(N),N.easing=N.easing||z.animEasing,N.duration||N.frames||(N.duration=z.animDuration),N.t=0,N.duration?N.interval=0:(N.frame=0,N.interval=N.interval||10),N.tick=function(){if(N.duration){var C=(Jd()-N.startTime)/N.duration;if(C>1&&(C=1),N.t=C,N.action(N.easing(C),C),!N.isRunning())return;1===C?N.stop():N._isPaused||(N.timeId=Km(N.tick))}else{if(N.frame++,C=N.t=N.frame/N.frames,N.action(N.easing(C),C),!N.isRunning())return;N.frame<N.frames?N._isPaused||(N.timeId=Km(N.tick,I,I,N.interval)):N.stop()}},N.resume=function(){N._isPaused&&(delete N._isPaused,N.duration?N.t<1&&(N.startTime=Jd()-N.duration*N.t,N.timeId=Km(N.tick)):N.frame<N.frames&&(N.timeId=Km(N.tick,I,I,N.interval)))},N.pause=function(){ei(N.timeId,!N.duration),N._isPaused=!0},N.isPaused=function(){return this._isPaused},N.stop=function(A){N.isRunning()&&(ei(N.timeId,!N.duration),delete N.timeId,N.duration?N.t<1&&A&&(N.t=1,N.action(N.easing(1),1)):N.frame<N.frames&&A&&(N.frame=N.frames,N.action(N.easing(1),1)),N._37o&&N._37o(),N.finishFunc&&N.finishFunc())},N.isRunning=function(){return N.timeId!=I},N.delay?Km(m,I,[N],N.delay):m(N),N}}(),getTextSize:function(){var x={},U=K?th().getContext("2d"):I;return function(m,B){U.font=m?m:fl;var E=x[U.font];return E||(E=2*U.measureText("e").width+4,x[U.font]=E),{width:U.measureText(B).width+z.textExtraWidth,height:E}}}(),drawText:function(z,J,M,n,p,O,d,q,j,H,k){if(J!=I){var L=me(M,J),N={};N.y=H&&H!==el?H===wg?O+L.height/2:O+q-L.height/2:O+q/2,N.x=j&&j!==iq?j===bq?p+d-L.width/2:p+d/2:p+L.width/2,ok(z,J,N,M,n),k&&Jq(z,J,M,n,N.x,N.y,L.width,k)}},getDistance:function(p,h){var C=p.length;return h?3===C?w(cc(p[0]-h[0])+cc(p[1]-h[1])+cc(p[2]-h[2])):2===C?w(cc(p[0]-h[0])+cc(p[1]-h[1])):p.z===_?w(cc(h.x-p.x)+cc(h.y-p.y)):w(cc(h.x-p.x)+cc(h.y-p.y)+cc(h.z-p.z)):3===C?w(cc(p[0])+cc(p[1])+cc(p[2])):2===C?w(cc(p[0])+cc(p[1])):void 0},brighter:function(e,B){return 0>B&&(B=-B),Dq(e,B?B:40)},darker:function(J,O){return O>0&&(O=-O),Dq(J,O?O:-40)},unionPoint:function(h,K){if(!h)return I;if(2===arguments.length)return h&&K?{x:a(h.x,K.x),y:a(h.y,K.y),width:f(h.x-K.x),height:f(h.y-K.y)}:I;var Y=h;if(Y._as&&(Y=Y._as),Y.length===_)return I;var r=Y.length;if(0>=r)return I;for(var g=1,w=Y[0],S={x:w.x,y:w.y,width:0,height:0};r>g;g++){w=Y[g];var x=a(S.x,w.x),A=i(S.x+S.width,w.x),c=a(S.y,w.y),W=i(S.y+S.height,w.y);S.x=x,S.y=c,S.width=A-x,S.height=W-c}return S},unionRect:function(F,b){if(F&&!b)return Tl(F);if(!F&&b)return Tl(b);if(F&&b){var V={x:a(F.x,b.x),y:a(F.y,b.y)};return V.width=i(F.x+F.width,b.x+b.width)-V.x,V.height=i(F.y+F.height,b.y+b.height)-V.y,V}return I},containsPoint:function(Z,u,V,q){if(q!=I&&1!==q){var Q=Z.x+Z.width/2,X=Z.y+Z.height/2;Z={x:Q-Z.width/2*q,y:X-Z.height/2*q,width:Z.width*q,height:Z.height*q}}if(V){var v=Z.width/2,o=Z.height/2,t=d(-V),R=l(-V),k=u.x-Z.x-v,J=u.y-Z.y-o;return u={x:R*k-t*J,y:t*k+R*J},An({x:-v,y:-o,width:Z.width,height:Z.height},u)}return!(!Z||u.x<Z.x||u.y<Z.y||u.x>Z.x+Z.width||u.y>Z.y+Z.height)},containsRect:function(j,Z){if(!j||!Z)return!1;var w=Z.x,T=Z.y,U=Z.width,J=Z.height,C=j.width,G=j.height;if(0>(C|G|U|J))return!1;var V=j.x,D=j.y;if(V>w||D>T)return!1;if(C+=V,U+=w,w>=U){if(C>=V||U>C)return!1}else if(C>=V&&U>C)return!1;if(G+=D,J+=T,T>=J){if(G>=D||J>G)return!1}else if(G>=D&&J>G)return!1;return!0},intersectsRect:function(i,K){if(!i||!K)return!1;var u=K.width,G=K.height,C=i.width,F=i.height;if(0>=C||0>=F||0>=u||0>=G)return!1;var W=K.x,f=K.y,_=i.x,s=i.y;return C+=_,F+=s,u+=W,G+=f,C>W&&F>f&&u>_&&G>s},intersection:function(J,a){if(!J||!a)return I;var A=a.x,x=a.y,F=J.x,N=J.y,k=A,z=x,Y=F,C=N;return k+=a.width,z+=a.height,Y+=J.width,C+=J.height,F>A&&(A=F),N>x&&(x=N),k>Y&&(k=Y),z>C&&(z=C),k-=A,z-=x,0>=k||0>=z?I:{x:A,y:x,width:k,height:z}},grow:function(i,T,F){F===_&&(F=T),i.x-=T,i.y-=F,i.width=i.width+2*T,i.height=i.height+2*F},getScreenPoint:function(r,R,k,o,K,h,f){var m=k.getBoundingClientRect(),T=r*(h||1)-k.scrollLeft+(o||0),b=R*(f||1)-k.scrollTop+(K||0),u=Oc(k,!1);if(u){var n=new ti(T,b,0);return n.applyMatrix4(u),console.log(n),{x:n.x,y:n.y}}return{x:T+m.left,y:b+m.top}},getLogicalPoint:function(S,g,K,J,j,U){var T,G,H=g.getBoundingClientRect();S.target?(Ro(S)?vp?Yk["91"]=!0:Yk["17"]=!0:vp?Yk["91"]=!1:Yk["17"]=!1,Yk["16"]=Io(S)?!0:!1,S=Pm(S)?$b(S):S,T=S.clientX,G=S.clientY):(T=S.x,G=S.y);var X=Oc(g,!0);if(X){var m=new ti(T,G,0);m.applyMatrix4(X);do{if(Math.abs(m.z)<=1e-6)break;var D=new ti(T,G,1);if(D.applyMatrix4(matrix),Math.abs(D.z)<=1e-6){m=D;break}if(D.sub(m),Math.abs(D.z)<=1e-6)break;m.addScaledVector(D,-m.z/D.z)}while(!1);return{x:(m.x+g.scrollLeft-(K||0))/(j||1),y:(m.y+g.scrollTop-(J||0))/(U||1)}}return{x:(T-H.left+g.scrollLeft-(K||0))/(j||1),y:(G-H.top+g.scrollTop-(J||0))/(U||1)}},removeHTML:function(){var e;return function(r){return r&&r.getView&&(r=r.getView()),r&&r.parentNode?e===r?!0:(e=r,r.parentNode.removeChild(r),e=I,!0):!1
}}(),getToolTipDiv:function(){if(!pm){pm=_k(),sq=_k();var O=pm.style;z.baseZIndex!=I&&(O.zIndex=Fq(z.baseZIndex)+3+""),O.whiteSpace="nowrap",O.color=z.toolTipLabelColor,O.background=z.toolTipBackground,O.font=z.toolTipLabelFont,O.padding="5px",O.boxShadow="0px 0px 3px "+z.toolTipShadowColor}return pm},isToolTipShowing:function(){return pm&&pm.parentNode?!0:sq&&sq.parentNode?!0:!1},updateToolTipContent:function(K,E){if(z.isToolTipShowing()&&(E||(E=kn&&kn.view),K===_&&E&&kn.e&&(K=E.getToolTip(kn.e)),K!=I)){var Y;K.html?(K=K.html,Y=sq):Y=pm,Y.innerHTML=K}},hideToolTip:function(){if(z.isToolTipShowing()){Hj(pm),Hj(sq),kf();var y=kn&&kn.view;y&&y.onHideToolTip&&y.onHideToolTip(),kn=I}},showToolTip:function(h,s,R){if(!h||s==I)return Tk(),void 0;z.getToolTipDiv();var D,o;if(s.html?(s=s.html,D=sq,Hj(pm)):(D=pm,Hj(sq)),o=D.style,D.innerHTML=s,D.parentNode||A.Default.appendToScreen(D),h.target){h=$l(h);var l=Mb(),q=h.x,W=h.y,r=to?60:12;if(to){var e=D.getBoundingClientRect();o.left=q-e.width/2+pn,o.top=W-e.height-r<l.top?W+r+pn:W-e.height-r+pn}else{o.left=q+r+pn,o.top=W+r+pn;var e=D.getBoundingClientRect();e.left+e.width>l.width&&(o.left=q-r-e.width+pn),e.top+e.height>l.height&&(o.top=W-r-e.height+pn),e.left<0&&(o.left=q+r+pn),e.top<0&&(o.top=W+r+pn)}}else o.left=h.x+pn,o.top=h.y+pn;kf(),R===_?R=kn&&kn.view:kn={e:h,view:R},R&&R.onShowToolTip&&R.onShowToolTip()},startDragging:function(A,h,C){C==_&&(C=!0),A!==Lq&&(Lq?C&&(Pm(h)?Lq.handleWindowTouchEnd(h):Lq.handleWindowMouseUp(h)):Pm(h)?(p(c,Wi,Hq),p(c,ws,uc),p(c,"blur",uc)):(p(c,vf,fc),p(c,Qf,yp),p(c,"blur",yp)),Lq=A)},getImageMap:function(){return Qj},toBoundaries:function(q,I,B,T){var i=[];return rb(q,I,B,T).forEach(function(M){var k=[];M.forEach(function(o){k.push(o.x,o.y)}),i.push(k)}),i},getCurrentKeyCodeMap:function(){return Yk},drawCenterImage:function(_,X,f,j,G,M,A,I){!G&&M&&M.isSelfViewEvent&&(G=M);var i=bi(X,G,M),y=Eg(X,G,M);jp(_,X,b(f-i/2),b(j-y/2),i,y,G,M,A,I)},drawStretchImage:function(_,o,Y,M,m,g,S,y,h,D,p,l){!y&&h&&h.isSelfViewEvent&&(y=h);var w,v=bi(o,y,h,g),G=Eg(o,y,h,S);"uniform"===Y?(w=a(g/v,S/G),v*=w,G*=w,M+=b((g-v)/2),m+=b((S-G)/2),g=v,S=G):"centerUniform"===Y&&((v>g||G>S)&&(w=a(g/v,S/G),v*=w,G*=w),M+=b((g-v)/2),m+=b((S-G)/2),g=v,S=G);var x=_.interactiveInfo;if(x){var L;if(L="center"===Y?{x:M+g/2-v/2,y:m+S/2-G/2,width:v,height:G}:{x:M,y:m,width:g,height:S},x.rect){var n=x.compInfos,k=n.length;k&&(n[k-1].rect.image=o)}else x.rect=L}if("center"===Y){var $=p!==!1&&(v>g||G>S);$&&(_.save(),_.beginPath(),_.rect(M,m,g,S),_.clip()),jp(_,o,M+g/2-v/2,m+S/2-G/2,v,G,y,h,D,l),$&&_.restore()}else jp(_,o,M,m,g,S,y,h,D,l)},toCanvas:function(n,g,F,p,L,R,K,h,j){n=Gj(n,K),g=g||bi(n,L),F=F||Eg(n,L);var D=th(),$=wr(D);return h?(Pq(D,g,F,h),$.scale(h,h)):Pq(D,g,F,1),cq($,n,p,0,0,g,F,L,R,K,j),n&&n.clampToEdge&&(D.clampToEdge=n.clampToEdge),$.restore(),D},toGrayColor:function(Z){if(!Z)return Z;var w=Yc(Z),C=b(.299*w[0]+.587*w[1]+.114*w[2]);return"rgba("+C+","+C+","+C+","+w[3]/255+")"},createGradientImage:function(e,T,E,t){for(var K=["L",0,0,e,0,1,0,0,1,0,0],Z=0,c=Math.min(T.length,E.length);c>Z;Z++)K.push(E[Z],T[Z]);var z=A.Default.toCanvas({width:e,height:e,clampToEdge:!0,comps:[{type:"shape",rotation:t||0,points:[0,0,e,0,e,e,0,e],background:"#ffffff",gradientPack:K}]});return z},createElement:function(a,t,q,B){var f=K.createElement(a);return Rp(f,t||Y.widgetBorder,2),f.style.font=q?q:fl,B!=I&&(f.value=B),z.onElementCreated&&z.onElementCreated(f),f},containedInView:function(Y,D){var l=Nb(D).getBoundingClientRect();return An({x:l.left,y:l.top,width:l.width,height:l.height},Xe(Y))},isIsolating:function(){return Yr>0},setIsolating:function(M){M?Yr++:Yr--},getMSMap:function(){return sm},stringify:function(f,L,x){var O=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var P=Tf.prototype.toJSON;Tf.prototype.toJSON=function(){return"__ht__dataModel"+this.serialize(0)},L=x?0:L==I?2:L;var k=JSON.stringify(f,function(c,g){return"function"==typeof g?"__ht__"+(g.__ht__||g.toString()):Cp(g)?wd(g):g instanceof A.List?"__ht__list"+(g.__ht__list||z.stringify(g._as)):g},L);return Date.prototype.toJSON=O,Tf.prototype.toJSON=P,x&&(k=rp+kd(k)),k},parse:function(o,S){return Fp(o)?o.substr(0,12)!=rp||(o=rl(o.substr(12)),Fp(o))?(S=S||{},JSON.parse(o,function(q,Q){if(Fp(Q))if(S.ignoreFunction||"__ht__function"!=Q.substr(0,14)){if(!S.ignoreDate&&"__ht__date"==Q.substr(0,10))return new Date(Fq(Q.substr(10)));if("__ht__list"===Q.substr(0,10))return new Gc(z.parse(Q.substr(10)));if(!S.ignoreDataModel&&"__ht__dataModel"===Q.substr(0,15)){var m=new Tf;return m.deserialize(z.parse(Q.substr(15))),m}}else{var o=Q.indexOf("{")+1,v=Q.lastIndexOf("}"),e=Q.indexOf("(")+1,O=Q.indexOf(")");if(o&&v&&e&&O)try{var W=new Function(Q.substring(e,O),Q.substring(o,v));return W.__ht__=Q.substr(6),W}catch(G){throw console.info("=== SyntaxError ===\n",Q),G}}return Q})):o:o},loadJS:function(A,W){W&&A.push(W);var X=A.shift();if(gc(X))A=X.contact(A),z.loadJS(A);else if(gg(X))X(),z.loadJS(A);else if(Fp(X)){var O=K.createElement("script");O.onload=function(){z.loadJS(A)},O.setAttribute("src",X),K.getElementsByTagName("head")[0].appendChild(O)}else A.length&&z.loadJS(A)},extendClass:function(k,F){var H=k.prototype;for(var X in F)sm[X]&&sm.hasOwnProperty(X)?sm[X](H,F):H[X]=F[X]},toRoundedCorner:function(){function e(G,j,z){G.x=j.x,G.y=j.e||z,G.z=j.y}var S=new ti,o=new ti,K=new ti,C=new ti;return function(g,M){var Y,$=0;g.getPoints&&($=g.getElevation(),g=g.getPoints()),Y=g instanceof Gc?g:new Gc(g);var I=Y.size();if(0>=M)return{points:Y};var R=new Gc,d=new Gc,p=Y.get(0);e(S,p,$),R.add(p),d.add(1);for(var f=1;I>f;f++)if(I>f+1){var z=Y.get(f),U=Y.get(f+1);e(o,z,$),e(K,U,$),C.subVectors(S,o).setLength(Math.min(.99*C.length(),M)).add(o),z.e!==_||p.e!==_?R.add({x:C.x,y:C.z,e:C.y}):R.add({x:C.x,y:C.z}),R.add(z),C.subVectors(K,o).setLength(Math.min(.99*C.length(),M)).add(o),z.e!==_||U.e!==_?R.add(p={x:C.x,y:C.z,e:C.y}):R.add(p={x:C.x,y:C.z}),S.copy(C),d.addAll([2,3])}else R.add(Y.get(f)),d.add(2);return{points:R,segments:d}}}(),toColorData:Yc,setCanvas:Pq,createDiv:_k,createDisabledDiv:Sd,createView:nh,createCanvas:th,appendChild:Ik,initContext:wr,checkLoadingImage:Hk,translateAndScale:Ql,layout:zb,getPosition:ni,drawPoints:Wb,drawRoundRect:_c,drawBorder:ko,setFocus:cf,getter:yf,setter:om,isEmptyObject:Ze,cameraPriority:function(){var s={skybox:0,main:1e4,top:1e7,infinity:1/0};return j.seal(j.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return s.skybox},set:function(O){if(O>=s.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");s.skybox=Number(O)}},main:{configurable:!1,enumerable:!1,get:function(){return s.main},set:function(B){if(B<=s.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(B>=s.top)throw new RangeError("Main camera must have lower priority than the top camera.");s.main=Number(B)}},top:{configurable:!1,enumerable:!1,get:function(){return s.top},set:function(k){if(k<=s.main)throw new RangeError("Top camera must have higher priority than the main camera.");s.top=Number(k)}}}))}()},!0),Xi(V,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var If=z.disabledOpacity,yl=z.toolTipDelay,Ch=z.devicePixelRatio,Un=z.autoMakeVisible,vc=z.autoHideScrollBar,uo=z.imageGradient,ai=z.showToolTip,Tk=z.hideToolTip,Ib=z.dashPattern,cj=z.lineCap,tg=z.lineJoin,yb=z.labelColor,Ji=z.labelSelectColor,fl=z.labelFont,as=z.widgetIndent,em=z.widgetRowHeight,wm=z.widgetHeaderHeight,Bb=z.widgetTitleHeight,Xq=z.scrollBarColor,Eh=z.scrollBarSize,zk=z.scrollBarTimeout,gl=z.scrollBarMinLength,_e=z.scrollBarInteractiveSize,cr=z.zoomIncrement,jl=z.scrollZoomIncrement,Tc=z.pinchZoomIncrement,Sf=z.zoomMax,Ei=z.zoomMin,jq=z.createObject,um=z.preventDefault,Se=z.setImage,Gj=z.getImage,$c=z.isImageComplete,Te=z.drawCenterImage,cq=z.drawStretchImage,Nr=z.getId,Km=z.callLater,ei=z.cancelLater,zm=z.sortFunc,Tl=z.clone,_b=z.getClass,un=z.startAnim,tk=z.brighter,df=z.darker,Pr=z.drawText,me=z.getTextSize,Uo=z.isLeftButton,fh=z.isMiddleButton,xh=z.isRightButton,hq=z.getTouchCount,we=z.isDoubleClick,Io=z.isShiftDown,Ro=z.isCtrlDown,Xe=z.getClientPoint,$l=z.getPagePoint,Hd=z.getDistance,Mc=z.unionPoint,xf=z.unionRect,An=z.containsPoint,td=z.containsRect,Fn=z.intersectsRect,al=z.intersection,Mb=z.getWindowInfo,oh=z.grow,Qe=z.getLogicalPoint,pp=z.getScreenPoint,Fd=z.startDragging,Hj=z.removeHTML,mk=z.createElement,wi=z.segmentResolution,Tq=z.shapeResolution,Dd=z.shapeSide,Ag=z.def,Og=function(g,U,Y){Ag(e+"."+g,U,Y)},yh=function(z,h){z.childNodes.forEach(function(w){h(w),yh(w,h)})};Xi(z,{toolTipLabelColor:yb,toolTipLabelFont:fl,toolTipBackground:Y.toolTipBackground,toolTipShadowColor:Gl,debugTipLabelFont:fl,debugTipLabelColor:yb,debugTipBackground:Y.toolTipBackground,drawBreakableText:sn,setDevicePixelRatio:function(U){Ch=z.devicePixelRatio="number"==typeof U?U:c.screen?c.screen.deviceXDPI/c.screen.logicalXDPI:1,yh(K.body,function(D){var V=D._ht;V&&V._canvas&&(Pq(V._canvas,V.getWidth(),V.getHeight()),V.redraw?V.redraw():V.iv())})},getPosition3dGap:function(){return Up()}},!0);var Nm=1e-6,Xg="undefined"!=typeof Uint16Array?Uint16Array:Array,_p="undefined"!=typeof Float32Array?Float32Array:Array,_d=function(s,e,V){var p=[s[0]-e[0],s[1]-e[1],s[2]-e[2]];if(V){var M=Hd(p);M>0&&(p[0]/=M,p[1]/=M,p[2]/=M)}return p},ad=function(){var J="charCodeAt",Z=2*(2*us.length+1);for(var d in c)if(d===e+iq[0]+(pn.length+2)){var w=c[d];if(!w)break;for(var q=w.length,R=0;q>R;R++)if(w[R][J](0)===Z&&w[R+1]!=I&&w[R+1]===pn[0]&&w[R+2]!=I&&w[R+2][J](0)===Z){for(var t=R+3;q>t;t++)if(w[t][J](0)===Z){if(0==w[t+1])for(var B,x=t+2;q>x;x++){if(w[x][J](0)===Z){0==w[x-1]&&B&&(gj=B.substr(0,B.length-1));break}B==I?B=w[x]:B+=w[x]}break}break}break}return function(P){return[-P[0],-P[1],-P[2]]}}(),Id=function(V,v){return 3===V.length?V[0]*v[0]+V[1]*v[1]+V[2]*v[2]:V[0]*v[0]+V[1]*v[1]},dq=function(){var c=new Array(16);return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},Jm=dq(),yj=function(a){var n=new Array(16);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3],n[4]=a[4],n[5]=a[5],n[6]=a[6],n[7]=a[7],n[8]=a[8],n[9]=a[9],n[10]=a[10],n[11]=a[11],n[12]=a[12],n[13]=a[13],n[14]=a[14],n[15]=a[15],n},Lh=function(M,c){return M[0]=c[0],M[1]=c[1],M[2]=c[2],M[3]=c[3],M[4]=c[4],M[5]=c[5],M[6]=c[6],M[7]=c[7],M[8]=c[8],M[9]=c[9],M[10]=c[10],M[11]=c[11],M[12]=c[12],M[13]=c[13],M[14]=c[14],M[15]=c[15],M},Dp=function(y){return y[0]=1,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=1,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=1,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},xl=function(K,c){var y=K[0],k=K[1],m=K[2];return K[0]=c[0]*y+c[4]*k+c[8]*m+c[12],K[1]=c[1]*y+c[5]*k+c[9]*m+c[13],K[2]=c[2]*y+c[6]*k+c[10]*m+c[14],K},Fb=function(L,k){var e=L[0],s=L[1],d=L[2],P=L[3];return L[0]=k[0]*e+k[4]*s+k[8]*d+k[12]*P,L[1]=k[1]*e+k[5]*s+k[9]*d+k[13]*P,L[2]=k[2]*e+k[6]*s+k[10]*d+k[14]*P,L[3]=k[3]*e+k[7]*s+k[11]*d+k[15]*P,L},$e=function(){var K,k,b,Y,e=$m(mo[1]+mo[7]),C=$m(mo[0]+mo[3]-mo[10]),f=$m(mo[8]+2),o=function(){return k=b.charAt(K),K+=1,k},P=function(){var O="";if(k===f)for(;o();){if(k===f)return o(),O;O+=k}else o()},$=function(){for(;k&&" ">=k;)o()},m=function(){var Q,N={};if(k===e){if(o(),$(),k===C)return o(),N;for(;k;){if(Q=P(),$(),o(),N[Q]=Y(),$(),k===C)return o(),N;o(),$()}}};return Y=function(){switch($(),k){case e:return m();default:return P()}},function(W){if(J={},W){var r;if(b=W,K=0,k=" ",r=Y(),$(),!k)return r}}}(),re=function(G,W){if(W){var c=d(W),C=l(W),A=G[4],U=G[5],b=G[6],i=G[7],M=G[8],Q=G[9],e=G[10],u=G[11];G[4]=A*C+M*c,G[5]=U*C+Q*c,G[6]=b*C+e*c,G[7]=i*C+u*c,G[8]=M*C-A*c,G[9]=Q*C-U*c,G[10]=e*C-b*c,G[11]=u*C-i*c}},Bi=function(s,q){if(q){var L=d(q),E=l(q),j=s[0],a=s[1],Z=s[2],J=s[3],Y=s[8],g=s[9],X=s[10],T=s[11];s[0]=j*E-Y*L,s[1]=a*E-g*L,s[2]=Z*E-X*L,s[3]=J*E-T*L,s[8]=j*L+Y*E,s[9]=a*L+g*E,s[10]=Z*L+X*E,s[11]=J*L+T*E}},Kr=function(i,$){if($){var w=d($),t=l($),p=i[0],q=i[1],_=i[2],F=i[3],b=i[4],x=i[5],n=i[6],S=i[7];i[0]=p*t+b*w,i[1]=q*t+x*w,i[2]=_*t+n*w,i[3]=F*t+S*w,i[4]=b*t-p*w,i[5]=x*t-q*w,i[6]=n*t-_*w,i[7]=S*t-F*w}},Gq=function(n,h,U){return dd(I,U===!1?I:n.getFinalScale3d(),n.getFinalRotation3d(),n.getRotationMode(),n.p3(),I,h)},dd=function(U,o,I,K,l,V,w){return V||(V=dq()),l&&oi(V,l),Vd(V,I,K),w&&Vb(V,V,w),o&&yi(V,o),U&&Vb(V,V,U),V},Nh=function(U,k,X){k=Fq(k),X=Fq(X);var j=this;j.g=U,j._84O=k,j._85O=X,j._70I=!0,j.F=0,j._83O=k+X,j.pen={x:0,y:0}},vm="lineDashOffset",Jr="setLineDash",pj=function(N){for(var c in N)1===c.length&&(vm=N[c]);return c?1:0},zn=function(y,w,T){return ks(w)?y:y[Jr]?(y[Jr](w),T&&(y.lineDashOffset=T),y):new Nh(y,w[0],w.length>1?w[1]:w[0])},Hc=function(G,$){!ks($)&&G[Jr]&&(G[Jr](fo),G.lineDashOffset=0)};Ag(Nh,j,{_69I:6,moveTo:function(Z,n){var l=this,m=l.pen;m.x=Z,m.y=n,l.g.moveTo(Z,n),l.start||(l.start={x:Z,y:n})},lineTo:function(S,C){var o=this,T=o.pen,N=S-T.x,H=C-T.y,Y=id(H,N),v=l(Y),$=d(Y),I=o._23O(T.x,T.y,S,C),p=o._85O,Q=o._84O,c=o._83O;if(o.F){if(o.F>I)return o._70I?o._72I(S,C):o.moveTo(S,C),o.F-=I,void 0;if(o._70I?o._72I(T.x+v*o.F,T.y+$*o.F):o.moveTo(T.x+v*o.F,T.y+$*o.F),I-=o.F,o.F=0,o._70I=!o._70I,!I)return}var X=k(I/c);if(X){for(var x=v*Q,U=$*Q,O=v*p,i=$*p,A=0;X>A;A++)o._70I?(o._72I(T.x+x,T.y+U),o.moveTo(T.x+O,T.y+i)):(o.moveTo(T.x+O,T.y+i),o._72I(T.x+x,T.y+U));I-=c*X}o._70I?I>Q?(o._72I(T.x+v*Q,T.y+$*Q),o.moveTo(S,C),o.F=p-(I-Q),o._70I=!1):(o._72I(S,C),I===Q?(o.F=0,o._70I=!o._70I):(o.F=Q-I,o.moveTo(S,C))):I>p?(o.moveTo(T.x+v*p,T.y+$*p),o._72I(S,C),o.F=Q-(I-p),o._70I=!0):(o.moveTo(S,C),I===p?(o.F=0,o._70I=!o._70I):o.F=p-I)},quadraticCurveTo:function(n,a,h,w){var v,I=this,g=I.pen,G=g.x,e=g.y,M=I._22O(G,e,n,a,h,w),p=0,P=0,q=I._85O,r=I._84O;if(I.F){if(I.F>M)return I._70I?I._71I(n,a,h,w):I.moveTo(h,w),I.F-=M,void 0;if(p=I.F/M,v=I._20O(G,e,n,a,h,w,p),I._70I?I._71I(v[2],v[3],v[4],v[5]):I.moveTo(v[4],v[5]),I.F=0,I._70I=!I._70I,!M)return}var _=M-M*p,t=k(_/I._83O),o=r/M,N=q/M;if(t)for(var H=0;t>H;H++)I._70I?(P=p+o,v=I._21O(G,e,n,a,h,w,p,P),I._71I(v[2],v[3],v[4],v[5]),p=P,P=p+N,v=I._21O(G,e,n,a,h,w,p,P),I.moveTo(v[4],v[5])):(P=p+N,v=I._21O(G,e,n,a,h,w,p,P),I.moveTo(v[4],v[5]),p=P,P=p+o,v=I._21O(G,e,n,a,h,w,p,P),I._71I(v[2],v[3],v[4],v[5])),p=P;_=M-M*p,I._70I?_>r?(P=p+o,v=I._21O(G,e,n,a,h,w,p,P),I._71I(v[2],v[3],v[4],v[5]),I.moveTo(h,w),I.F=q-(_-r),I._70I=!1):(v=I._19O(G,e,n,a,h,w,p),I._71I(v[2],v[3],v[4],v[5]),M===r?(I.F=0,I._70I=!I._70I):(I.F=r-_,I.moveTo(h,w))):_>q?(P=p+N,v=I._21O(G,e,n,a,h,w,p,P),I.moveTo(v[4],v[5]),v=I._19O(G,e,n,a,h,w,P),I._71I(v[2],v[3],v[4],v[5]),I.F=r-(_-q),I._70I=!0):(I.moveTo(h,w),_===q?(I.F=0,I._70I=!I._70I):I.F=q-_)},bezierCurveTo:function(){var A=arguments;this.pen={x:A[4],y:A[5]},this.g.bezierCurveTo(A[0],A[1],A[2],A[3],A[4],A[5])},arc:function(Z,D,o,B,K,f){f||(B=-B,K=-K),Pk(this,Z,D,B,K-B,o,o,!1)},rect:function(N,w,d,B){var Y=this;Y.pen={x:N,y:w},Y.moveTo(N,w),Y.lineTo(N,w+B),Y.lineTo(N+d,w+B),Y.lineTo(N+d,w),Y.lineTo(N,w)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(A,t,L,U){var C=L-A,h=U-t;return w(C*C+h*h)},_22O:function(k,u,M,w,Q,f,A){for(var b,y,c,$,W,J,C,d=0,U=k,L=u,D=A>0?A:this._69I,x=1;D>=x;x++)c=x/D,$=1-c,W=$*$,J=2*c*$,C=c*c,b=W*k+J*M+C*Q,y=W*u+J*w+C*f,d+=this._23O(U,L,b,y),U=b,L=y;return d},_21O:function(i,_,z,y,k,u,p,P){var x=this;if(0===p)return x._20O(i,_,z,y,k,u,P);if(1===P)return x._19O(i,_,z,y,k,u,p);var V=x._20O(i,_,z,y,k,u,P);return V.push(p/P),x._19O.apply(x,V)},_20O:function(h,M,B,V,x,X,Y){if(1!==Y){var j=B+(x-B)*Y,E=V+(X-V)*Y;B=h+(B-h)*Y,V=M+(V-M)*Y,x=B+(j-B)*Y,X=V+(E-V)*Y}return[h,M,B,V,x,X]},_19O:function(W,B,y,u,N,k,K){if(1!==K){var f=W+(y-W)*K,F=B+(u-B)*K;y+=(N-y)*K,u+=(k-u)*K,W=f+(y-f)*K,B=F+(u-F)*K}return[W,B,y,u,N,k]},_72I:function(F,T){var u=this.pen;(F!==u.x||T!==u.y)&&(u.x=F,u.y=T,this.g.lineTo(F,T))},_71I:function(X,R,q,U){var P=this.pen;(X!==q||R!==U||q!==P.x||U!==P.y)&&(P.x=q,P.y=U,this.g.quadraticCurveTo(X,R,q,U))}}),sm.ms_quickVisible=function(q){q._4BQ=!1,q._4CQ=function(c){var d=c._4EQ;return d!==_?d:d=c._4EQ=this._4FQ(c)},q._4DQ=function(m){if(!m)return this.dm().each(function(L){L._4EQ=_}),void 0;m._4EQ=_;var e=this;if(m instanceof dp||Re(m)||m instanceof vh||m.ISubGraph)m.eachChild(function(r){e.invalidateQuickVisible(r)});else if(m.getEdges){var I=m.getEdges();I&&I.each(function(D){e.invalidateQuickVisible(D)})}},q.enableQuickVisibleMode=function(){this._4BQ||(this._4BQ=!0,this._4FQ=this.isVisible,this.isVisible=this._4CQ,this.invalidateQuickVisible=this._4DQ)},q.disableQuickVisibleMode=function(){this._4BQ&&(this._4BQ=!1,this.isVisible=this._4FQ,this.invalidateQuickVisible=jb)},q.isQuickVisibleMode=function(){return this._4BQ},q.invalidateQuickVisible=jb},Lr=wk()+1,qd&&c.console&&Lr&&!0&&(c.navigator&&c.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?c.console.log.apply(console,["Hightopo - Version："+A.Default.getVersion()+" - %cTrial：http://hightopo.com/request.html","color: #f00;"]):c.console.log("Hightopo - Version："+A.Default.getVersion()+" - Trial：http://hightopo.com/request.html"));var Iq=I,br=I,Hh=z.checkLoadingCompType=function(y){Iq&&!y._72O_&&(br||(br={}),br[y._72O_=Nr()]=y)},Sg=function(P,q){if(q||(q=P),q&&(Iq||(Iq={}),!Iq[P])){var l=new ld;if(Iq[q]={request:l,url:q},q=z.beforeLoadURL(q,P),q.data){var a=z.parse(q.data);js(P,a),z.handleCompTypeLoaded(P,a)}else{l.onload=function(){if(200===this.status||0===this.status){var e=z.parse(l.getResponseText());js(P,e),z.handleCompTypeLoaded(P,e)}else js(P,I)},l.onerror=function(){js(P,I)};var O={};O.url=encodeURI(q),O.sync=!1,l.send(O)}}},js=function(K,J){if(Dj[K]=J,delete Iq[K],Ze(Iq)&&(Iq=I,br)){for(var U in br){var c=br[U];c.invalidateAll&&c.invalidateAll(_,"compTypeLoaded",K),c.redraw&&c.redraw(),c.iv(),delete c._72O_}br=I}if(J&&br)for(var U in br){var c=br[U];c.invalidateAll&&c.invalidateAll(_,"compTypeLoading",K),c.redraw&&c.redraw(),c.iv()}},Ok=Y.chart,Mo="",Ri=!0,aj=z.compStack=[],Co=/^style@/,Ed=/^attr@/,ud=/^field@/,Pj={x:.5,y:.5},ps=function(){Ri=!0},ns=function(){return Ri},bi=function(i,b,T,n){if(!i)return 0;if(ui(i.fitSize,b,T)&&n)return n;var g=ui(i.width,b,T);return null==g?20:g},Eg=function(_,L,E,K){if(!_)return 0;if(ui(_.fitSize,L,E)&&K)return K;var M=ui(_.height,L,E);return null==M?20:M},ui=function(t,R,l){if(!t||!t.func)return t;var j,F=t.func,Z=t.value;return j=gg(F)?l&&l.vectorDataBindingDisabled&&!t.isSafeFunc?Z:F(R,l):R instanceof Nj||(A.ui?R instanceof A.ui.View:0)?Ed.test(F)?R.a(Mo+F.slice(5)):Co.test(F)?R.s(Mo+F.slice(6)):ud.test(F)?R[F.slice(6)]:R[F]?R[F](l):Z:Z,Z!==_&&j==I?Z:j},jp=z.drawImage=function(){var R,P,h,J,k,y,r=3,H=6,L=function(a,A){a.getValue&&a.getValue.compType===A||(a.getValue=function(N){var r=D(a,N);if(r===_&&A.properties){var l=A.properties[N];l&&(r=l.defaultValue)}return r},a.getColor=function(L,r){return r===!0?W(L):W(a.getValue(L))},a.getValue.compType=A)},D=function(A,J,E){var C,L=!1;if(A.prefix&&P instanceof Nj){var q=P.a(Mo+J);q!==_&&(L=!0,C=q)}return C===_&&(C=A[J]),C&&C.func&&(L=!0,C=ui(C,P,h)),E&&(C=E(C),L||(A[J]=C)),C},W=function(f,t){var j;return j=t?D(f,t):f,R&&R.compGray&&j?z.toGrayColor(j):k&&j?cb(j,k,y):j},N=function(L){if(gc(L)){for(var _=new Gc,q=L.length,t=0;q>t;t+=2)_.add({x:L[t],y:L[t+1]});L=_}return L},m=function(p){var u=D(p,"anchorX"),X=D(p,"anchorY");if(u!==_||X!==_)return{x:u===_?Pj.x:u,y:X===_?Pj.y:X};var Q=D(p,"type"),P=D(p,"name");if("image"!==Q||!P)return Pj;var V=Gj(P);return V&&V.anchorX!==_&&V.anchorY!==_?{x:V.anchorX,y:V.anchorY}:Pj},V=function(w,p){var r=D(w,qk),b=m(w);if(gc(r)){var U=r.length,t=D(w,"relative"),f=p.width,Q=p.height;if(4===U)r={x:r[0],y:r[1],width:r[2],height:r[3]},t&&(r.x*=f,r.y*=Q,r.width*=f,r.height*=Q);else if(3===U){var n=r[0];r={width:r[1],height:r[2]},t&&(r.width*=f,r.height*=Q),"object"==typeof n?n.length&&(n={x:n[0],y:n[1]}):n=ni(n,p,r),r.x=n.x-r.width*b.x,r.y=n.y-r.height*b.y}r.x+=D(w,"offsetX")||0,r.y+=D(w,"offsetY")||0,!t&&p.fitSize&&(r=M(w,r,p))}return r},M=function(j,r,o){if(r){var g,C,K,_={x:r.x,y:r.y,width:r.width,height:r.height},n=m(j),x=D(j,"layoutH"),N=D(j,"layoutV"),F=1,Q=1,Y=0,p=0,L=1,R=1;switch(x){case"left":break;case"right":_.x+=o.width-o.rw;break;case"center":_.x+=.5*(o.width-o.rw);break;case"scale":case"leftright":default:g=D(j,Yn)||0,g&&(Y=Math.abs(p=Math.sin(g)),L=Math.abs(R=Math.cos(g))),"leftright"!==x?(F+=L*(o.widthScale-1),Q+=Y*(o.widthScale-1)):(F+=_.width?L*(o.width-o.rw)/_.width:0,Q+=_.height?Y*(o.width-o.rw)/_.height:0,C=-Math.min(-n.x*R+n.y*p,-n.x*R-(1-n.y)*p,(1-n.x)*R+n.y*p,(1-n.x)*R-(1-n.y)*p))}switch(N){case"top":break;case"bottom":_.y+=o.height-o.rh;break;case"center":_.y+=.5*(o.height-o.rh);break;case"scale":case"topbottom":default:g==I&&(g=D(j,Yn),g&&(Y=Math.abs(p=Math.sin(g)),L=Math.abs(R=Math.cos(g)))),"topbottom"!==N?(F+=Y*(o.heightScale-1),Q+=L*(o.heightScale-1)):(F+=_.width?Y*(o.height-o.rh)/_.width:0,Q+=_.height?L*(o.height-o.rh)/_.height:0,K=-Math.min(-n.x*p-n.y*R,-n.x*p+(1-n.y)*R,(1-n.x)*p-n.y*R,(1-n.x)*p+(1-n.y)*R))}return(1!==F||1!==Q)&&("scale"!==x&&x?"leftright"===x&&(_.x+=_.width*(1-F)*n.x+C*(o.width-o.rw)):_.x+=_.x*(o.widthScale-1)+n.x*_.width*(o.widthScale-F),"scale"!==N&&N?"topbottom"===N&&(_.y+=_.height*(1-Q)*n.y+K*(o.height-o.rh)):_.y+=_.y*(o.heightScale-1)+n.y*_.height*(o.heightScale-Q),_.width*=F,_.height*=Q),_.width<0&&(_.width=0),_.height<0&&(_.height=0),_}},s=function(Q){return gc(Q)?new Gc(Q):Q},S=function(s,z,y,k,P,J,l){var u=R.interactiveInfo,c=s.transform;if(c)return R.save(),R.setTransform(c.a,c.b,c.c,c.d,c.tx,c.ty),u&&u.compInfos.push({comp:s,rect:z,matrix:c.clone(),prefix:Mo,refRect:u.refRect}),!0;P===_&&(P=1),J===_&&(J=1);var p=D(s,"clipPercentage"),o=Ck(y,z);if(o&&!k&&1===P&&1===J&&p==_)return u&&u.compInfos.push({comp:s,rect:z,matrix:u.matrix.clone(),prefix:Mo,refRect:u.refRect}),!1;l=l||Pj;var g=z.x+z.width*l.x,G=z.y+z.height*l.y,C=y.x+y.width*l.x,U=y.y+y.height*l.y,A=y.width?P*(z.width/y.width):1,T=y.height?J*(z.height/y.height):1;if(R.save(),u&&(u.matrix.appendTranslate(g,G).appendRotate(k).appendScale(A,T).appendTranslate(-C,-U),u.compInfos.push({comp:s,rect:z,matrix:u.matrix.clone(),prefix:Mo,refRect:u.refRect})),Fi(R,g,G),Gd(R,k||0),Dm(R,A,T),Fi(R,-C,-U),p!=_){var w=ke(y,D(s,"clipDirection"),p);R.beginPath(),R.rect(w.x,w.y,w.width,w.height),R.clip()}return!0},K=function(){R.restore()},F=function(U,C,b){var _=D(U,"path"),o=D(U,Yn),t=D(U,"scaleX"),A=D(U,"scaleY"),T=m(U),n=I,Z=Oq(null,_);if(b||(b=U.unionRect,b||(b=Mc(Z),U.path.func||(U.unionRect=b)),n=b),b){n||(n=U.unionRect,n||(n=Mc(Z),U.path.func||(U.unionRect=n)));var z=S(U,b,n,o,t,A,T),x=D(U,"borderPattern"),$=zn(R,x),H=W(U,"background"),c=W(U,"borderColor"),g=D(U,"borderWidth"),V=D(U,"gradient"),L=W(U,"gradientColor"),h=D(U,"border3d"),r=W(U,"border3dColor"),E=D(U,"border3dAccuracy"),O=R.lineJoin,y=R.lineCap;R.lineJoin=D(U,"borderJoin")||tg,R.lineCap=D(U,"borderCap")||cj,H?(Vm(R,H,V,L,n),Oq(R,_),R.fill(),$!==R&&Oq(R,_)):Oq(R,_);var F=D(U,"borderWidthAbsolute");if(F&&(R.save(),R.setTransform(1,0,0,1,0,0)),g&&c&&(R.lineWidth=g,R.strokeStyle=c,R.stroke(),h&&gb(R,c,r,g,J,E)),Hc(R,x),D(U,"dash")){var Y=D(U,"dashWidth")||g;if(Y>0){x=D(U,"dashPattern")||Ib;var $=zn(R,x,D(U,"dashOffset")),N=W(U,"dashColor")||W(Ij);$!==R&&Oq(R,_),R.strokeStyle=N,R.lineWidth=Y,R.stroke(),D(U,"dash3d")&&gb(R,N,W(U,"dash3dColor"),Y,J,D(U,"dash3dAccuracy")),Hc(R,x)}}F&&R.restore(),C===qk&&Gk(R,H,D(U,"depth"),n),R.lineJoin=O,R.lineCap=y,z&&K()}},p=function(Q,r,o,F){var A=D(Q,Wq,N),e=D(Q,Yn),n=m(Q);if(A&&F.fitSize){var v=new Gc,b=Mc(A),x=M(Q,b,F),T=b.x+n.x*b.width,V=b.y+n.y*b.height,Z=x.x+n.x*x.width,g=x.y+n.y*x.height,i=b.width?x.width/b.width:1,X=b.height?x.height/b.height:1;A.each(function(o){v.add({x:Z+(o.x-T)*i,y:g+(o.y-V)*X})}),A=v,Q.unionRect=null}var f=D(Q,"scaleX"),c=D(Q,"scaleY"),Y=r===eo,a=I;if(!o&&Y&&(o=Q.unionRect,o||(o=Mc(A),Q.points.func||(Q.unionRect=o)),a=o),o){Y?a||(a=Q.unionRect,a||(a=Mc(A),Q.points.func||(Q.unionRect=a))):a=o;var q,O,E,u,L=S(Q,o,a,e,f,c,n),C=D(Q,"borderPattern"),z=zn(R,C),B=W(Q,"background"),w=Gj(D(Q,"repeatImage"),k,y),t=D(Q,"gradientPack"),U=D(Q,"borderGradientPack"),G=W(Q,"borderColor"),p=D(Q,"borderWidth"),d=Gj(D(Q,"borderRepeatImage"),k,y),$=D(Q,"segments",s),l=D(Q,"gradient"),j=W(Q,"gradientColor"),H=D(Q,"border3d"),ep=W(Q,"border3dColor"),Rn=D(Q,"border3dAccuracy"),Xg=D(Q,"closePath"),hb=D(Q,"fillRule")||"nonzero",oc=R.lineJoin,Md=R.lineCap;if(R.lineJoin=D(Q,"borderJoin")||tg,R.lineCap=D(Q,"borderCap")||cj,Y)if(B||w||t){var vj=D(Q,"fillClipPercentage");if(vj!=_){var Mg=ke(a,D(Q,"fillClipDirection"),vj);R.save(),R.beginPath(),R.rect(Mg.x,Mg.y,Mg.width,Mg.height),R.clip()}Wb(R,A,$,Xg),t?kk(R,t,W,!1,o):w?Fh(R,w,k,y,P,h):Vm(R,B,l,j,a),R.fill(hb),t&&R.restore(),vj!=_&&R.restore(),z!==R&&Wb(z,A,$,Xg)}else Wb(z,A,$,Xg);else if("roundRect"===r?q=D(Q,"cornerRadius"):"polygon"===r?(q=D(Q,"polygonSide"),O=D(Q,"cornerRadius")):"arc"===r&&(q=D(Q,"arcFrom"),O=D(Q,"arcTo"),E=D(Q,"arcClose"),u=D(Q,"arcOval")),B||w||t){var vj=D(Q,"fillClipPercentage");if(vj!=_){var Mg=ke(a,D(Q,"fillClipDirection"),vj);R.save(),R.beginPath(),R.rect(Mg.x,Mg.y,Mg.width,Mg.height),R.clip()}Op(R,r,a,q,O,E,u),t?kk(R,t,W,!1,o):w?Fh(R,w,k,y,P,h):Vm(R,B,l,j,a),R.fill(hb),t&&R.restore(),vj!=_&&R.restore(),R!==z&&Op(z,r,a,q,O,E,u)}else Op(z,r,a,q,O,E,u);var wd=D(Q,"borderWidthAbsolute");if(wd&&(R.save(),R.setTransform(1,0,0,1,0,0)),p&&(G||d||U)&&(R.lineWidth=p,U?kk(R,U,W,!0,o):d?Ie(R,d,k,y,P,h):R.strokeStyle=G,R.stroke(),U&&R.restore(),H&&gb(R,G,ep,p,J,Rn)),Hc(R,C),D(Q,"dash")){var Pq=D(Q,"dashWidth")||p;if(Pq>0){C=D(Q,"dashPattern")||Ib;var z=zn(R,C,D(Q,"dashOffset")),$p=W(Q,"dashColor")||W(Ij);z!==R&&(Y?Wb(z,A,$,Xg):Op(z,r,a,q,O,E,u)),R.strokeStyle=$p,R.lineWidth=Pq,R.stroke(),D(Q,"dash3d")&&gb(R,$p,W(Q,"dash3dColor"),Pq,J,D(Q,"dash3dAccuracy")),Hc(R,C)}}wd&&R.restore(),r===qk&&Gk(R,B,D(Q,"depth"),a),R.lineJoin=oc,R.lineCap=Md,L&&K()}},e=function(H,m){var c=k||D(H,is),S=y||D(H,"blendMode"),N=D(H,"name"),x=Gj(N,c,S);x&&x.cacheRule!=I&&(x=cl(R,x,D(H,"stretch"),m.width,m.height,P,h,c)),x?cq(R,x,D(H,"stretch"),m.x,m.y,m.width,m.height,P,h,c,null,S):Ri=!1},v=function(O,$){var L=D(O,"text");if(L!=I){L+="";var n,E=D(O,"gradientPack"),u=D(O,"gradient"),Q=W(O,"gradientColor"),Z=D(O,"font"),a=D(O,"vertical"),J=D(O,"verticalGap")||0,p=D(O,"align"),k=D(O,"vAlign"),N=D(O,"decoration"),d=D(O,"letterGap")||0,y=D(O,"wrap"),v=D(O,"borderWidth"),K=D(O,"borderColor");if(E?(n=kk(R,E,W,!1,$),R.restore()):n=W(O,is),!E&&u&&(n=z.createGradient(R,u,n||z.labelColor,Q||Y.imageGradient,$.x,$.y,$.width,$.height)),v&&gc(K)&&(K=kk(R,K,W,!1,$),R.restore()),a){null==J&&(J=1);var l,c,H,w=[],X=[];l=y?Fo(L,$.height,Z,d,a,J):[L],R.textBaseline=wg,R.font=Z,l.forEach(function(y){for(var h=y.length,c=0,Z=(h-1)*J,f=0;h>f;f++){var t=R.measureText(y[f]);w.push(t),Z+=t.fontBoundingBoxDescent,c=i(c,t.width)}X.push({width:c,height:Z})});var C=(l.length-1)*d;X.forEach(function(A){C+=A.width}),c=p&&p!==iq?p===bq?$.x+$.width-C:$.x+($.width-C)/2:$.x;var M=0;l.forEach(function(P,S){var W=X[S],h=P.length;H=k&&k!==el?k===wg?$.y:$.y+$.height-W.height:$.y+($.height-W.height)/2;for(var i=0;h>i;i++){var U=P[i],e=w[M];tl(R,U,Z,n,{x:c,y:H,width:W.width,height:e.fontBoundingBoxDescent},Cj,k,N,d,v,K),H+=e.fontBoundingBoxDescent+J,M++}c+=W.width+d})}else{var l=y?Fo(L,$.width,Z,d,a,J):L.split("\n"),g=l.length;if(g>1){var _=me(Z,L),f=_.height,t=g*f+J*(g-1),h=Tl($);return k&&k!==el?k===wn&&(h.y=$.y+$.height-t):h.y=$.y+($.height-t)/2,h.height=t,sn(R,l,h,Z,n,p||iq,N,d,v,K),void 0}tl(R,L,Z,n,$,p,k,N,d,v,K)}}},X=function(z,l){ko(R,W(z,is),l.x,l.y,l.width,l.height,D(z,"width"))},Q=function(W,Z){var L=D(W,zl),X=0;if(L&&(L.forEach(function(M){X+=M}),X>0)){for(var S=D(W,"colors")||Ok,m=D(W,"startAngle")||0,Y=D(W,"hollow"),B=D(W,rc),T=D(W,Dh),n=D(W,Zc),_=B?new Gc:I,b=Z.x,z=Z.y,U=Z.width,A=Z.height,x=b+U/2,k=z+A/2,N=a(U,A)/2,F=0,e=0;e<L.length;e++){var f=L[e],M=$*f/X,i=m+M;if(R.fillStyle=S[F++],F===S.length&&(F=0),R.beginPath(),Y){var H=x+l(m)*N/2,g=k+d(m)*N/2,E=x+l(i)*N,V=k+d(i)*N;R.moveTo(H,g),R.arc(x,k,N/2,m,i,!1),R.lineTo(E,V),R.arc(x,k,N,i,m,!0)}else R.moveTo(x,k),R.arc(x,k,N,i,m,!0);_&&(M=(m+i)/2,_.add({text:gg(B)?B(f,e,X,P):f,x:x+.75*l(M)*N,y:k+.75*d(M)*N})),R.closePath(),R.fill(),m=i}_&&_.each(function(c){Pr(R,c.text,T,n,c.x,c.y,0,0,Cj)})}},t=function(W,Q){var K=D(W,mp);if(K&&K.length>0){var l=K.length,v=D(W,rc),q=D(W,Dh),x=D(W,Zc),O=v?new Gc:I,o=D(W,"minValue")||0,Y=D(W,"maxValue");if(Y==I&&(Y=0,K.forEach(function(O){D(O,zl).forEach(function(z){Y=i(Y,z)})})),o===Y)return;for(var J=Q.height/(Y-o),m=Q.y+Y*J,p=D(K[0],zl).length,M=Q.width/(3*p+1),w=2*M/l,s=0,e=0;l>e;e++)for(var f=K[e],F=D(f,is),S=D(f,"colors"),Z=D(f,zl),U=0;p>U;U++){S?R.fillStyle=S[U]:F?R.fillStyle=F:(R.fillStyle=Ok[s++],s===Ok.length&&(s=0));var u=Z[U],$=u*J,L=Q.x+(1+3*U)*M+e*w;if(Eq(R,L,m-$,w,$),O){var b=gg(v)?v(u,U,f,P):u,y=me(q,b).height;O.add({x:L,y:m-$-y,width:w,height:y,text:b})}}O&&O.each(function(g){Pr(R,g.text,q,x,g.x,g.y,g.width,g.height,Cj)})}},E=function(d,Q){var e=D(d,mp);if(e&&e.length>0){var N=e.length,Y=D(e[0],zl).length,K=Q.width/(3*Y+1),h=0,_=D(d,"maxValue"),u=D(d,rc),S=D(d,Dh),k=D(d,Zc),c=u?new Gc:I;if(_==I){_=0;for(var g=0;Y>g;g++){for(var E=0,W=0;N>W;W++)E+=D(e[W],zl)[g];_=i(_,E)}}if(_>0){for(var g=0;Y>g;g++)for(var M=Q.y+Q.height,W=0;N>W;W++){var G=e[W],b=D(G,is),x=D(G,zl)[g],j=x/_*Q.height;b?R.fillStyle=b:(R.fillStyle=Ok[h++],h===Ok.length&&(h=0)),M-=j;var H={x:Q.x+(1+3*g)*K,y:M,width:2*K,height:j};Eq(R,H.x,H.y,H.width,H.height),c&&(H.text=gg(u)?u(x,g,G,P):x,c.add(H))}c&&c.each(function(Q){Pr(R,Q.text,S,k,Q.x,Q.y,Q.width,Q.height,Cj)})}}},w=function(c,H){var M=D(c,mp);if(M&&M.length>0){for(var Y=M.length,p=D(M[0],zl).length,N=H.width/(3*p+1),b=0,l=D(c,rc),A=D(c,Dh),K=D(c,Zc),X=l?new Gc:I,E=0;p>E;E++){for(var h=0,G=0;Y>G;G++)h+=D(M[G],zl)[E];if(h>0){var $=H.y+H.height;for(G=0;Y>G;G++){var s=M[G],g=D(s,is),o=D(s,zl)[E],L=o/h*H.height;g?R.fillStyle=g:(R.fillStyle=Ok[b++],b===Ok.length&&(b=0)),$-=L;var V={x:H.x+(1+3*E)*N,y:$,width:2*N,height:L};Eq(R,V.x,V.y,V.width,V.height),X&&(V.text=gg(l)?l(o,E,s,P):o,X.add(V))}}}X&&X.each(function(l){Pr(R,l.text,A,K,l.x,l.y,l.width,l.height,Cj)})}},n=function(Q,_){var x=D(Q,mp);if(x&&x.length>0){var g=x.length,f=D(Q,"minValue")||0,m=D(Q,"maxValue");if(m==I&&(m=0,x.forEach(function(g){D(g,zl).forEach(function(Z){m=i(m,Z)})})),f===m)return;for(var r=_.height/(m-f),j=_.y+m*r,W=D(x[0],zl).length,Y=_.width/(3*W+1),y=0,N=D(Q,"lineWidth")||2,L=D(Q,"line3d"),a=D(Q,"linePoint"),S=D(Q,rc),b=D(Q,Dh),t=D(Q,Zc),B=0;g>B;B++){var v=x[B],l=D(v,is),A=D(v,zl);l?R.strokeStyle=l:(l=R.strokeStyle=Ok[y++],y===Ok.length&&(y=0)),R.beginPath();for(var F=0;W>F;F++){var p=_.x+(2+3*F)*Y,w=j-A[F]*r;0===F?R.moveTo(p,w):R.lineTo(p,w)}if(R.lineWidth=N,R.stroke(),L&&gb(R,l,I,N,J),a||S){var M,h=N/2+2;for(F=0;W>F;F++){var Z=A[F];if(p=_.x+(2+3*F)*Y,w=j-Z*r,gg(a)?a(R,p,w,l,F,v,P):a&&(R.fillStyle=l,R.beginPath(),R.arc(p,w,h,0,$,!0),R.fill()),gg(S)?M=S(Z,F,v,P):S&&(M=Z),M){var s=me(b,M).height,C=R.shadowBlur;if(C){var z=R.shadowOffsetX,e=R.shadowOffsetY,U=R.shadowColor;R.shadowOffsetX=0,R.shadowOffsetY=0,R.shadowBlur=0,R.shadowColor=I}Pr(R,M,b,t,p,w-s-h+2,0,s,Cj),C&&(R.shadowOffsetX=z,R.shadowOffsetY=e,R.shadowBlur=C,R.shadowColor=U)}}}}}},U=function(D){R=D[0],P=D[1],h=D[2],J=D[3],k=D[4],y=D[5]},q=function(){return[R,P,h,J,k,y]},B=function(m,y){var V;h&&h.getDrawableState?V=h.getDrawableState(P):h&&h.getState?V=h.getState(P):(V=P instanceof Nj?P.s(be):null,(V===_||null===V)&&(V=D(m,be)));var R=D(y,be);return R!==_&&null!==R&&R!==V?!1:D(y,Xn)},o={border:X,image:e,text:v,pieChart:Q,columnChart:t,stackedColumnChart:E,percentageColumnChart:w,lineChart:n};return function(x,v,G,b,d,E,e,g,i,f){if(v&&d&&E){var X=q();R=x,P=e,h=g,!P&&h&&h.isSelfViewEvent&&(P=h),J=h?h._zoom?h._zoom:1:1,k=i,y=f;var C=d,O=E;if(Jb()){var t,Q,Z,T,l,M;0===R[qg]?Jb[0]&&(t=!0):t=!0,R.texureImage2D?Jb[1]&&(Q=!0):Q=!0,R.texureImage3D?Jb[2]&&(Z=!0):Z=!0,R.drawDNDState?Jb[3]&&(l=!0):l=!0,A[Hb[1]+Vn[0]+hs[1]]?Jb[Vn[0]]&&(M=!0):M=!0,Ve.widget[0]?Jb[4]&&(T=!0):T=!0,t&&Q&&Z&&T&&l&&M&&(C=G,O=b)
}if(v.tagName)return Fp(gj)&&!c[gj]||R.drawImage(v,C,O,d,E),U(X),void 0;if(0==D(v,"visible"))return U(X),void 0;k||(k=ui(v.color,P,h)),f||(y=ui(v.blendMode,P,h)),Fp(gj)&&!c[gj]&&(d=C,E=O);var u=bi(v,P,h,d),j=Eg(v,P,h,E),a={x:0,y:0,width:u,height:j,fitSize:D(v,"fitSize")},Y=D(v,"clip"),n=D(v,"opacity");if(a.fitSize){var w=a.rw=ui(v.width,P,h)||20;a.widthScale=u/w;var $=a.rh=ui(v.height,P,h)||20;a.heightScale=j/$}if(R.save(),R.interactiveInfo){var pd=R.interactiveInfo.matrix,rs=pd.clone();pd.appendTranslate(C,O).appendScale(d/u,E/j),R.interactiveInfo.refRect=a}Fi(R,C,O),(u!==d||j!==E)&&R.scale(d/u,E/j),Y&&(gg(Y)?Y(R,u,j,P,h,v):(R.beginPath(),R.rect(0,0,u,j),R.clip())),n!=I&&(R.globalAlpha*=n),D(v,"comps").forEach(function(b){if(b.prefix){var O=Mo,i=ui(b.prefix,P,h);i&&(Mo=Mo+i+".")}if(0==B(v,b))return b.prefix&&(Mo=O),void 0;if(aj.splice(0,0,b),R.interactiveInfo)var u=R.interactiveInfo.matrix.clone();var C=D(b,"opacity"),Q=D(b,"shadow"),n=D(b,"type"),d=D(b,"refRect")||a,c=V(b,d);if(C!=I){var w=R.globalAlpha;R.globalAlpha*=C}if(Q){var k=J*z.devicePixelRatio,U=R.shadowOffsetX,G=R.shadowOffsetY,y=R.shadowBlur,f=R.shadowColor,M=D(b,"shadowOffsetX"),Y=D(b,"shadowOffsetY"),x=D(b,"shadowBlur"),j=W(b,"shadowColor");R.shadowOffsetX=(M==I?r:M)*k,R.shadowOffsetY=(Y==I?r:Y)*k,R.shadowBlur=(x==I?H:x)*k,R.shadowColor=j||W(lf)}if("save"===n)R.save();else if("endClip"===n||"restore"===n)R.restore();else if("clip"===n)R.save(),Wb(R,D(b,"points",N),D(b,"segments",s),!0),R.clip();else if(wh[n]){if(c=c||{x:0,y:0,width:d.width,height:d.height},p(b,n,c,d),b.prefix&&0===b.prefix.indexOf("ui.")&&h&&A.ui&&h instanceof A.ui.View){h._vectorCompInfo||(h._vectorCompInfo=[]);for(var q=!1,E=0;E<h._vectorCompInfo.length;E++){var $=h._vectorCompInfo[E];if(b.prefix===$.comp.prefix&&e===$.data){h._vectorCompInfo[E]={comp:b,type:n,rect:c,compRefRect:d,data:e,image:v,transform:R.getTransform()},q=!0;break}}q||h._vectorCompInfo.push({comp:b,type:n,rect:c,compRefRect:d,data:e,image:v,transform:R.getTransform()})}}else if(n===eo)p(b,n,c,d);else if("SVGPath"===n)F(b,n,c);else{c=c||{x:0,y:0,width:d.width,height:d.height};var l=D(b,Yn),t=D(b,"scaleX"),T=D(b,"scaleY"),g=m(b),X=S(b,c,c,l,t,T,g);if(gg(n))L(b,n),z.drawCompType(n,R,c,b,P,h);else if(z.getCompType(n)){var Z=z.getCompType(n),zn=Z.func||Z;L(b,Z),z.drawCompType(zn,R,c,b,P,h)}else o[n]?o[n](b,c):z.getCompType(n)===_&&Ul.test(n)&&(Sg(n),Ri=!1);X&&K()}Q&&(R.shadowOffsetX=U,R.shadowOffsetY=G,R.shadowBlur=y,R.shadowColor=f),C!=I&&(R.globalAlpha=w),R.interactiveInfo&&(R.interactiveInfo.matrix=u),b.prefix&&(Mo=O),aj.splice(0,1)}),R.interactiveInfo&&(R.interactiveInfo.matrix=rs),R.restore(),U(X)}}}();z.getCurrentComp=function(){return aj[0]},z.getParentComp=function(){return aj[1]},z.getInternal=function(){return{isEnter:dc,isEsc:Li,isSpace:Ui,isLeft:li,isUp:mq,isRight:ar,isDown:si,addMethod:Xi,superCall:nk,toPointsArray:rb,translateAndScale:Ql,appendArray:Gf,createWorldMatrix:dd,vec3TransformMat4:xl,setCanvas:Pq,createDiv:_k,createView:nh,createCanvas:th,createImage:Lm,initContext:wr,layout:zb,fillRect:Eq,Mat:Xl,drawBorder:ko,isString:Fp,setBorder:Rp,getPropertyValue:nb,setPropertyValue:gm,drawVerticalLine:Cg,draw3DRect:Gk,getPinchDist:xn,isSameRect:Ck,getPosition:ni,intersectionLineRect:tj,getNodeRect:Sc,getEdgeAgentPosition:rk,getEdgeHostPosition:Or,getImageWidth:bi,getImageHeight:Eg,initItemElement:uk,drawPoints:Wb,createG2:zn,closePopup:Vl,isH:Im,createAnim:Zq,createNormalMatrix:qj,toColorArray:Tj,createNormals:Sl,toFloatArray:pq,glMV:$n,glPop:Lg,batchShape:Qg,createNodeMatrix:Gq,getShapeModel:bg,getFaceInfo:Ym,transformAppend:Od,drawFaceInfo:lb,glUploadData:Pp,glUploadElementData:Ce,glDrawArray:bj,glDrawElement:cd,glBindTexture:rf,pickValueToColor:Ks,to3dPointsArray:Aq,setGLDebugMode:function(g){Qk=g},cube:function(){return{vs:Vf,is:ap,uv:lm}},ui:function(){return{DataUI:Em,NodeUI:Me,EdgeUI:Do,GroupUI:Lf,ShapeUI:Zm,GridUI:mm,Data3dUI:$s,Node3dUI:_s,Shape3dUI:ct}},getInternalVersion:function(){return"U2FsdGVkX18iJ8p2Rq8BgPYNvD4yWGTqG9PSbq+e2HA="},getDragger:function(){return Lq},addMSMap:function(s){Xi(sm,s)},k:X,overrideTimerFunc:function(j,q){Km=A.Default.callLater=j,ei=A.Default.cancelLater=q},canEnterEditDetailMode:Ge,addEventListener:p,removeEventListener:g}},function(m){function H(l,H){l!=I&&(H==I&&mh!=typeof l?this._54O(l,256):this._54O(l,H))}function O(){return new H(I)}function C(U,V,Y,q,s,x){for(;--x>=0;){var o=V*this[U++]+Y[q]+s;s=k(o/67108864),Y[q++]=67108863&o}return s}function B(h,c,a,C,V,u){for(var j=32767&c,$=c>>15;--u>=0;){var W=32767&this[h],O=this[h++]>>15,P=$*W+O*j;W=j*W+((32767&P)<<15)+a[C]+(1073741823&V),V=(W>>>30)+(P>>>15)+$*O+(V>>>30),a[C++]=1073741823&W}return V}function z(C,d,b,$,L,f){for(var l=16383&d,G=d>>14;--f>=0;){var U=16383&this[C],M=this[C++]>>14,z=G*U+M*l;U=l*U+((16383&z)<<14)+b[$]+L,L=(U>>28)+(z>>14)+G*M,b[$++]=268435455&U}return L}function R(j){return Mn.charAt(j)}function Y(G,d){var c=Xi[G.charCodeAt(d)];return c==I?-1:c}function v(k){for(var I=this.t-1;I>=0;--I)k[I]=this[I];k.t=this.t,k.s=this.s}function b(s){this.t=1,this.s=0>s?-1:0,s>0?this[0]=s:-1>s?this[0]=s+this.DV:this.t=0}function g(R){var N=O();return N._58O(R),N}function T(q,o){var v,l=this;if(16==o)v=4;else if(8==o)v=3;else if(256==o)v=8;else if(2==o)v=1;else if(32==o)v=5;else{if(4!=o)return l.fromRadix(q,o),void 0;v=2}l.t=0,l.s=0;for(var W=q.length,x=!1,k=0;--W>=0;){var g=8==v?255&q[W]:Y(q,W);0>g?"-"==q.charAt(W)&&(x=!0):(x=!1,0==k?l[l.t++]=g:k+v>l.DB?(l[l.t-1]|=(g&(1<<l.DB-k)-1)<<k,l[l.t++]=g>>l.DB-k):l[l.t-1]|=g<<k,k+=v,k>=l.DB&&(k-=l.DB))}8==v&&0!=(128&q[0])&&(l.s=-1,k>0&&(l[l.t-1]|=(1<<l.DB-k)-1<<k)),l._57O(),x&&H.ZERO._78O(l,l)}function t(){for(var o=this,O=o.s&o.DM;o.t>0&&o[o.t-1]==O;)--o.t}function J(S){var d=this;if(d.s<0)return"-"+d._85O()[El](S);var L;if(16==S)L=4;else if(8==S)L=3;else if(2==S)L=1;else if(32==S)L=5;else{if(4!=S)return d.toRadix(S);L=2}var P,N=(1<<L)-1,n=!1,E="",y=d.t,F=d.DB-y*d.DB%L;if(y-->0)for(F<d.DB&&(P=d[y]>>F)>0&&(n=!0,E=R(P));y>=0;)L>F?(P=(d[y]&(1<<F)-1)<<L-F,P|=d[--y]>>(F+=d.DB-L)):(P=d[y]>>(F-=L)&N,0>=F&&(F+=d.DB,--y)),P>0&&(n=!0),n&&(E+=R(P));return n?E:"0"}function Z(){var t=O();return H.ZERO._78O(this,t),t}function o(){return this.s<0?this._85O():this}function c(h){var H=this,y=H.s-h.s;if(0!=y)return y;var v=H.t;if(y=v-h.t,0!=y)return H.s<0?-y:y;for(;--v>=0;)if(0!=(y=H[v]-h[v]))return y;return 0}function E(O){var v,o=1;return 0!=(v=O>>>16)&&(O=v,o+=16),0!=(v=O>>8)&&(O=v,o+=8),0!=(v=O>>4)&&(O=v,o+=4),0!=(v=O>>2)&&(O=v,o+=2),0!=(v=O>>1)&&(O=v,o+=1),o}function f(){var Z=this;return Z.t<=0?0:Z.DB*(Z.t-1)+E(Z[Z.t-1]^Z.s&Z.DM)}function x(H,T){var c;for(c=this.t-1;c>=0;--c)T[c+H]=this[c];for(c=H-1;c>=0;--c)T[c]=0;T.t=this.t+H,T.s=this.s}function M(r,F){for(var g=r;g<this.t;++g)F[g-r]=this[g];F.t=i(this.t-r,0),F.s=this.s}function P(s,I){var C,e=this,P=s%e.DB,$=e.DB-P,R=(1<<$)-1,M=k(s/e.DB),w=e.s<<P&e.DM;for(C=e.t-1;C>=0;--C)I[C+M+1]=e[C]>>$|w,w=(e[C]&R)<<P;for(C=M-1;C>=0;--C)I[C]=0;I[M]=w,I.t=e.t+M+1,I.s=e.s,I._57O()}function y(Q,M){var X=this;M.s=X.s;var N=k(Q/X.DB);if(N>=X.t)return M.t=0,void 0;var U=Q%X.DB,y=X.DB-U,S=(1<<U)-1;M[0]=X[N]>>U;for(var K=N+1;K<X.t;++K)M[K-N-1]|=(X[K]&S)<<y,M[K-N]=X[K]>>U;U>0&&(M[X.t-N-1]|=(X.s&S)<<y),M.t=X.t-N,M._57O()}function Q(m,s){for(var b=this,L=0,y=0,U=a(m.t,b.t);U>L;)y+=b[L]-m[L],s[L++]=y&b.DM,y>>=b.DB;if(m.t<b.t){for(y-=m.s;L<b.t;)y+=b[L],s[L++]=y&b.DM,y>>=b.DB;y+=b.s}else{for(y+=b.s;L<m.t;)y-=m[L],s[L++]=y&b.DM,y>>=b.DB;y-=m.s}s.s=0>y?-1:0,-1>y?s[L++]=b.DV+y:y>0&&(s[L++]=y),s.t=L,s._57O()}function s(T,u){var o=this.abs(),e=T.abs(),p=o.t;for(u.t=p+e.t;--p>=0;)u[p]=0;for(p=0;p<e.t;++p)u[p+o.t]=o.am(0,e[p],u,p,0,o.t);u.s=0,u._57O(),this.s!=T.s&&H.ZERO._78O(u,u)}function q(p){for(var X=this.abs(),J=p.t=2*X.t;--J>=0;)p[J]=0;for(J=0;J<X.t-1;++J){var I=X.am(J,X[J],p,2*J,0,1);(p[J+X.t]+=X.am(J+1,2*X[J],p,2*J+1,I,X.t-J-1))>=X.DV&&(p[J+X.t]-=X.DV,p[J+X.t+1]=1)}p.t>0&&(p[p.t-1]+=X.am(J,X[J],p,2*J,0,1)),p.s=0,p._57O()}function U(n,J,x){var c=n.abs(),h=this;if(!(c.t<=0)){var b=h.abs();if(b.t<c.t)return J!=I&&J._58O(0),x!=I&&h._77O(x),void 0;x==I&&(x=O());var L=O(),e=h.s,N=n.s,C=h.DB-E(c[c.t-1]);C>0?(c._44O(C,L),b._44O(C,x)):(c._77O(L),b._77O(x));var r=L.t,t=L[r-1];if(0!=t){var F=t*(1<<h.F1)+(r>1?L[r-2]>>h.F2:0),v=h.FV/F,o=(1<<h.F1)/F,B=1<<h.F2,R=x.t,Z=R-r,W=J==I?O():J;for(L._59O(Z,W),x._52O(W)>=0&&(x[x.t++]=1,x._78O(W,x)),H.ONE._59O(r,W),W._78O(L,L);L.t<r;)L[L.t++]=0;for(;--Z>=0;){var y=x[--R]==t?h.DM:k(x[R]*v+(x[R-1]+B)*o);if((x[R]+=L.am(0,y,x,Z,0,r))<y)for(L._59O(Z,W),x._78O(W,x);x[R]<--y;)x._78O(W,x)}J!=I&&(x._45O(r,J),e!=N&&H.ZERO._78O(J,J)),x.t=r,x._57O(),C>0&&x._46O(C,x),0>e&&H.ZERO._78O(x,x)}}}function p(o){var a=O();return this.abs()._49O(o,I,a),this.s<0&&a._52O(H.ZERO)>0&&o._78O(a,a),a}function N(b){this.m=b}function n(M){return M.s<0||M._52O(this.m)>=0?M.mod(this.m):M}function u(o){return o}function V(e){e._49O(this.m,I,e)}function F(X,c,W){X._47O(c,W),this._74O(W)}function W(I,l){I._48O(l),this._74O(l)}function _(){if(this.t<1)return 0;var N=this[0];if(0==(1&N))return 0;var P=3&N;return P=15&P*(2-(15&N)*P),P=255&P*(2-(255&N)*P),P=65535&P*(2-(65535&(65535&N)*P)),P=P*(2-N*P%this.DV)%this.DV,P>0?this.DV-P:-P}function A(J){var o=this;o.m=J,o.mp=J._50O(),o.mpl=32767&o.mp,o.mph=o.mp>>15,o.um=(1<<J.DB-15)-1,o.mt2=2*J.t}function j(y){var f=O();return y.abs()._59O(this.m.t,f),f._49O(this.m,I,f),y.s<0&&f._52O(H.ZERO)>0&&this.m._78O(f,f),f}function r(K){var F=O();return K._77O(F),this._74O(F),F}function G(Z){for(var b=this;Z.t<=b.mt2;)Z[Z.t++]=0;for(var q=0;q<b.m.t;++q){var C=32767&Z[q],n=C*b.mpl+((C*b.mph+(Z[q]>>15)*b.mpl&b.um)<<15)&Z.DM;for(C=q+b.m.t,Z[C]+=b.m.am(0,n,Z,q,0,b.m.t);Z[C]>=Z.DV;)Z[C]-=Z.DV,Z[++C]++}Z._57O(),Z._45O(b.m.t,Z),Z._52O(b.m)>=0&&Z._78O(b.m,Z)}function K(g,c){g._48O(c),this._74O(c)}function h(I,T,f){I._47O(T,f),this._74O(f)}function Nj(){return 0==(this.t>0?1&this[0]:this.s)}function Ji(o,I){if(o>4294967295||1>o)return H.ONE;var u=O(),v=O(),$=I._73O(this),K=E(o)-1;for($._77O(u);--K>=0;)if(I._76O(u,v),(o&1<<K)>0)I._75O(v,$,u);else{var r=u;u=v,v=r}return I.revert(u)}function Ar(J,W){var I;return I=256>J||W._51O()?new N(W):new A(W),this.exp(J,I)}function Ak(){var j=this;if(j.s<0){if(1==j.t)return j[0]-j.DV;if(0==j.t)return-1}else{if(1==j.t)return j[0];if(0==j.t)return 0}return(j[1]&(1<<32-j.DB)-1)<<j.DB|j[0]}function Zf(P,f){return new H(P,f)}function Rr(){var C=this;C.n=I,C.e=0,C.d=I,C.p=I,C.q=I,C.dmp1=I,C.dmq1=I,C._10A=I}function Db(P){return P._53O(this.e,this.n)}function En(s){var l,t,C,X="",L=0;for(l=0;l<s.length&&s.charAt(l)!=il;++l)C=Ah.indexOf(s.charAt(l)),0>C||(0==L?(X+=R(C>>2),t=3&C,L=1):1==L?(X+=R(t<<2|C>>4),t=15&C,L=2):2==L?(X+=R(t),X+=R(C>>2),t=3&C,L=3):(X+=R(t<<2|C>>4),X+=R(15&C),L=0));return 1==L&&(X+=R(t<<2)),X}function eo(I){var c=I.split(""),H=En(I);return c.forEach(function(i){var k=i.length;k>0&&H&&(xe+=Fq(i))}),H}function Yc(X,R){var q=jf._4O.Util._56O(X,"ss"),v={},p=0;return v.v=q==R,v.t=1,v.s=0>p?-1:0,Rc=v.v,p>0?v[0]=p:-1>p?v[0]=p+v.DV:v.t=0,[q,v]}function Jl(Y){var F=38,E=Y.substring(0,F);if(E&&30==E.indexOf("05000420")){var c=["ss",Y.substring(F)];return c}return[]}function qi(W,k){k=k.replace(ud,""),k=k.replace(/[ \n]+/g,"");var h=Zf(k,16);if(h._55O()>this.n._55O())return 0;var E=this._37O(h),F=E[El](16).replace(/^1f+00/,""),N=Jl(F);if(0==N.length)return!1;for(var j,v,A,i=.5,Z=Dd,I=[0,.5,.75,.875,.9375],Q=[],U=[],R=[],T=$/Z,c=N[1],Y=Yc(W,c)[0],O=0,f=0;O<I.length;O++){var C=0===O%2?0:.5;for(j=0;Z>=j;j++)v=(j+C)*T,A=1-I[O],Q.push(l(v)*i*A,-i+2*I[O]*i,-d(v)*i*A),U.push((j+C)/Z,A)}for(O=0;O<I.length-1;O++){var S=O*(Z+1),X=(O+1)*(Z+1);for(j=0;Z>j;j++)R.push(S+j,X+j+1,X+j,S+j,S+j+1,X+j+1)}return R.forEach(function(M){f+=M}),c==Y&&f>10}var hp,ae=0xdeadbeefcafe,ef=15715070==(16777215&ae),El="toString",vr="",kh="nat",sr=function(){};S=m["D"+11182[El](D(2,5))];var dj=H.prototype;tq+=zp.substr(0,1);var Qj=m.navigator?m.navigator.appName:"";ef&&"Microsoft Internet Explorer"==Qj?(dj.am=B,hp=30):ef&&"Netscape"!=Qj?(dj.am=C,hp=26):(dj.am=z,hp=28),dj.DB=hp,dj.DM=(1<<hp)-1,dj.DV=1<<hp;var fj=52;dj.FV=D(2,fj),dj.F1=fj-hp,dj.F2=2*hp-fj;var Aj,tp,Mn="0123456789abcdefghijklmnopqrstuvwxyz",Xi=[],Qo=function(l){return String.fromCharCode(l)};for(Aj="0".charCodeAt(0),tp=0;9>=tp;++tp)Xi[Aj++]=tp;for(Aj="a".charCodeAt(0),tp=10;36>tp;++tp)Xi[Aj++]=tp;for(Aj="A".charCodeAt(0),tp=10;36>tp;++tp)Xi[Aj++]=tp;var ts=N.prototype;ts._73O=n,ts.revert=u,ts._74O=V,ts._75O=F,ts._76O=W;var po=A.prototype;po._73O=j,po.revert=r,po._74O=G,po._75O=h,po._76O=K,dj._77O=v,dj._58O=b,dj._54O=T,dj._57O=t,dj._59O=x,dj._45O=M,dj._44O=P,dj._46O=y,dj._78O=Q,dj._47O=s,dj._48O=q,dj._49O=U,dj._50O=_,dj._51O=Nj,dj.exp=Ji,dj.toString=J,dj._85O=Z,dj.abs=o,dj._52O=c,dj._55O=f,dj.mod=p,dj._53O=Ar,H.ZERO=g(0),H.ONE=g(1),dj._86O=Ak;var bh=function(g,c){var i=this;i.isPublic=!0,typeof g!==mh?(i.n=g,i.e=c):g!=I&&c!=I&&g.length>0&&c.length>0&&(i.n=Zf(g,16),i.e=Fq(c,16))};Wg=function(){var Z,K,m=eo(Or),Q=m.substr(0,4),W=m.substr(4,2),l=m.substr(6,2),s=1,c=!s,U=X,b=[],J=Vq.charAt(7);if(S&&(S[El]().indexOf(kh)<0||S[tq][El]().indexOf(kh)<0||!m?Z=I:(m=new S(Q-0,W-s,l-0),K=m.setHours(9),S[tq]()>K?Z=qc[J]:c=!0)),m&&Z&&Z[0]&&Z[L(.5)]&&U){var e=$e(Z[0]),x=$e(Z[1]);for(var q in x)b.push(q);var D,h=0,k=e[b[h]],A=x[b[h++]],u=x[b[h++]],g=x[b[h++]],F=x[b[h++]],i=x[b[h++]],o=x[b[h++]],C=e[b[h]],j=x[b[h++]],p=Qc._27O(U);if(k===A&&p&&j){D=A+u+g+F+i+o;var P=!o||o===Cf;if(!P&&o)for(var r,Y=0,y=o.length;y>Y;Y++)o[Y]===Jo[h]?r===Cf?P=!0:r[0]===Mg[5]&&Cf&&Cf.indexOf(r.substr(1))>=0?P=!0:r=I:(r==I?r=o[Y]:r+=o[Y],Y===y-1&&(r===Cf?P=!0:r[0]===Mg[5]&&Cf&&Cf.indexOf(r.substr(1))>=0&&(P=!0)));D&&p._31O(D,j)&&p._31O(k,C)&&P&&(!i||S[tq]()<i)&&(c=!0)}}return c||(Op=ks),J};var Hn=Rr.prototype;Hn._37O=Db,Hn._38O=bh;var Ah="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",il="=",Um=25,gd=10,Or="ICICFQ==",Lf=Lf||function(Q,v){var D={},T=D._7A={},l=T._6A=function(){function t(){}return{_80O:function(q){t.prototype=this;var Z=new t;return q&&Z._5A(q),Z.hasOwnProperty("_82O")||(Z._82O=function(){Z.$super._82O.apply(this,arguments)}),Z._82O.prototype=Z,Z.$super=this,Z},_3A:function(){var F=this._80O();return F._82O.apply(F,arguments),F},_82O:function(){},_5A:function(M){for(var i in M)M.hasOwnProperty(i)&&(this[i]=M[i]);M.hasOwnProperty(El)&&(this.toString=M.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),c=T._39O=l._80O({_82O:function(K,h){K=this._84O=K||[],this._65O=h!=v?h:4*K.length},toString:function(E){return(E||b).stringify(this)},_89O:function(q){var Q=this._84O,r=q._84O,W=this._65O,P=q._65O;if(this._57O(),W%4)for(var O=0;P>O;O++){var t=255&r[O>>>2]>>>24-8*(O%4);Q[W+O>>>2]|=t<<24-8*((W+O)%4)}else if(r.length>65535)for(var O=0;P>O;O+=4)Q[W+O>>>2]=r[O>>>2];else Q.push.apply(Q,r);return this._65O+=P,this},_57O:function(){var B=this._84O,A=this._65O;B[A>>>2]&=4294967295<<32-8*(A%4),B.length=L(A/4)},_88O:function(){var u=l._88O.call(this);return u._84O=this._84O.slice(0),u},_87O:function(F){for(var i=[],V=0;F>V;V+=4)i.push(0|4294967296*wk);return new c._82O(i,F)}}),n=D._2A={},b=n._69O={stringify:function(p){var Y,$=p._84O,I=p._65O,i=[];for(Y=0;I>Y;Y++){var S=255&$[Y>>>2]>>>24-8*(Y%4);i.push((S>>>4).toString(16)),i.push((15&S).toString(16))}return i.join("")},_68O:function(m){for(var T=m.length,v=[],K=0;T>K;K+=2)v[K>>>3]|=Fq(m.substr(K,2),16)<<24-4*(K%8);return new c._82O(v,T/2)}},R=n._8A={stringify:function(u){var e,R=u._84O,w=u._65O,q=[];for(e=0;w>e;e++){var D=255&R[e>>>2]>>>24-8*(e%4);q.push(Qo(D))}return q.join("")},_68O:function(x){var r,a=x.length,M=[];for(r=0;a>r;r++)M[r>>>2]|=(255&x.charCodeAt(r))<<24-8*(r%4);return new c._82O(M,a)}},P=n._9A={stringify:function(Z){try{return decodeURIComponent(escape(R.stringify(Z)))}catch(S){throw new Error("")}},_68O:function(Q){return R._68O(unescape(encodeURIComponent(Q)))}},Y=T._32O=l._80O({_1A:function(){this._83O=new c._82O,this._23O=0},_33O:function(i){typeof i==mh&&(i=P._68O(i)),this._83O._89O(i),this._23O+=i._65O},_25O:function(I){var R=this._83O,T=R._84O,k=R._65O,r=this._79O,O=4*r,_=k/O;_=I?L(_):i((0|_)-this._22O,0);var z=_*r,m=a(4*z,k);if(z){for(var S=0;z>S;S+=r)this._20O(T,S);var b=T.splice(0,z);R._65O-=m}return new c._82O(b,m)},_88O:function(){var X=l._88O.call(this);return X._83O=this._83O._88O(),X},_22O:0});T._66O=Y._80O({cfg:l._80O(),_82O:function(y){this.cfg=this.cfg._80O(y),this._1A()},_1A:function(){Y._1A.call(this),this._34O()},_81O:function(b){return this._33O(b),this._25O(),this},_72O:function(X){X&&this._33O(X);var N=this._21O();return N},_79O:16,_26O:function(t){return function(z,m){return new t._82O(m)._72O(z)}},_19O:function(U){return function(V,y){return new G._71O._82O(U,y)._72O(V)}}});var G=D._67O={};return D}();!function(){var C=Lf,S=C._7A,T=S._39O,X=S._66O,d=C._67O,G=[],o=[];!function(){function N(m){for(var f=w(m),A=2;f>=A;A++)if(!(m%A))return!1;return!0}function v(r){return 0|4294967296*(r-(0|r))}for(var t=2,B=0;64>B;)N(t)&&(8>B&&(G[B]=v(D(t,.5))),o[B]=v(D(t,1/3)),B++),t++}();var Y=[],B=d._41O=X._80O({_34O:function(){this._64O=new T._82O(G.slice(0))},_20O:function(K,a){for(var D=this._64O._84O,q=D[0],X=D[1],$=D[2],F=D[3],l=D[4],h=D[5],v=D[6],E=D[7],f=0;64>f;f++){if(16>f)Y[f]=0|K[a+f];else{var U=Y[f-15],B=(U<<25|U>>>7)^(U<<14|U>>>18)^U>>>3,P=Y[f-2],d=(P<<15|P>>>17)^(P<<13|P>>>19)^P>>>10;Y[f]=B+Y[f-7]+d+Y[f-16]}var M=l&h^~l&v,n=q&X^q&$^X&$,O=(q<<30|q>>>2)^(q<<19|q>>>13)^(q<<10|q>>>22),C=(l<<26|l>>>6)^(l<<21|l>>>11)^(l<<7|l>>>25),w=E+C+M+o[f]+Y[f],H=O+n;E=v,v=h,h=l,l=0|F+w,F=$,$=X,X=q,q=0|w+H}D[0]=0|D[0]+q,D[1]=0|D[1]+X,D[2]=0|D[2]+$,D[3]=0|D[3]+F,D[4]=0|D[4]+l,D[5]=0|D[5]+h,D[6]=0|D[6]+v,D[7]=0|D[7]+E},_21O:function(){var E=this._83O,Z=E._84O,r=8*this._23O,p=8*E._65O;return Z[p>>>5]|=128<<24-p%32,Z[(p+64>>>9<<4)+14]=k(r/4294967296),Z[(p+64>>>9<<4)+15]=r,E._65O=4*Z.length,this._25O(),this._64O},_88O:function(){var I=X._88O.call(this);return I._64O=this._64O._88O(),I}});C._41O=X._26O(B),C._42O=X._19O(B)}();var ud=new RegExp("");ud.compile("[^0-9a-f]","gi"),Rr._28O=-1,Rr._29O=-2,Hn._31O=qi,Hn._63O=qi,Rr._43O=-2;var uf=new function(){var k=this;k._5O=function(n,G){if("8"!=n.substring(G+2,G+3))return 1;var l=Fq(n.substring(G+3,G+4));return 0==l?-1:l>0&&10>l?l+1:-2},k._13O=function(c,e){var P=k._5O(c,e);return 1>P?"":c.substring(e+2,e+2+2*P)},k._12O=function(f,X){var r=k._13O(f,X);if(""==r)return-1;var O;return O=Fq(r.substring(0,1))<8?new H(r,16):new H(r.substring(2),16),O._86O()},k._6O=function(e,f){var $=k._5O(e,f);return 0>$?$:f+2*($+1)},k._11O=function(o,Y){var a=k._6O(o,Y),P=k._12O(o,Y);return o.substring(a,a+2*P)},k._10O=function(p,a){var T=k._6O(p,a),y=k._12O(p,a);return T+2*y},k._7O=function(y,z){var o=[],x=k._6O(y,z);o.push(x);for(var U=k._12O(y,z),t=x,H=0;;){var O=k._10O(y,t);if(O==I||O-x>=2*U)break;if(H>=200)break;o.push(O),t=O,H++}return o}};if(uf._90O=Qo(gd+24),uf._91O=e+Qo(gd*gd+8),jf==I||!jf)var jf={};jf._4O!=I&&jf._4O||(jf._4O={});var We=jf._4O;jf._4O.Util=new function(){var s=this;s._56O=function(D){var j=new jf._4O._3O;return j._30O(D)},s._4A=function(J){var t=new jf._4O._3O;return t._36O(J)},s._11A=function(x){var g=new We._3O;return g._30O(x)}},jf._4O._3O=function(){var g=this;g._8O=function(t,L){if("ss"==t&&"cj"==L){try{g.md=Lf._67O._41O._3A()}catch(m){sr(vr)}g._24O=function(I){g.md._81O(I)},g._35O=function(f){var M=Lf._2A._69O._68O(f);g.md._81O(M)},g._60O=function(){var S=g.md._72O();return S[El](Lf._2A._69O)},g._30O=function(q){return g._24O(q),g._60O()},g._36O=function(r){return g._35O(r),g._60O()}}},g._24O=function(){sr(vr)},g._35O=function(){sr(vr)},g._60O=function(){sr(vr)},g._30O=function(){sr(vr)},g._36O=function(){sr(vr)},g._8O("ss","cj")},Fl=function(F){var $=Vo[Uj[7]],H=1,k=!1;if(ss.a!=Vo[sh])return ss.a;if(ss.forEach(function(z){H*=z}),F>H){if($&&$[1]&&$[0]){var P=$[0],f=$[1];f=f.split(uf._90O),P=P.split(uf._90O);var q=f[3],Z=P[3],X=f[7],Q=f[11],U=f[15],G=f[19],T=f[23],J=f[27],z=P[7],_=q+X+Q+U+G+T,R=T?!1:!0,N=Z===q;if(T){var m=T&&T.split(om("firefox")[3]);if(m)for(var o=0;o<m.length;o++){var O=m[o];if(O[0]===$q[8]&&(O=O.substring(1)),ub.indexOf(O)>=0){R=!0;break}}}k=N&&Lj()(Z,z)&&Lj()(_,J)&&R&&(!G||G>F),k&&Q.indexOf(vs.length)>=0&&(Fl[vs.length]=vs),k&&Q.indexOf(vs.length+1)>=0&&(Fl[vs.length+1]=vs),k&&Q.indexOf(vs.length+3)>=0&&(Fl[vs.length+3]=vs),k&&Q.indexOf(Ee.length)>=0&&(Fl[Ee.length]=Ee)}k||(Em.prototype._42=cm)}else k=!0,Fl[vs.length]=Fl[vs.length+1]=Fl[vs.length+3]=Fl[Ee.length]=vs;return ss.a=k,k},Um=String.fromCharCode(Um+20);var vp=function(F){return F=F.replace(ud,vr),F=F.replace(/[ \n]+/g,vr)},te="30",hn="06",Sk="02",rs="03",fc=Zf,up=/^1f+00/,Qc=function(){var X;return X={_18O:function(l){var g=l,V=g.replace(/\s+/g,""),X=En(V);return X},_14O:function(_){var M=this._18O(_),v=this._15O(M);return v},_15O:function(H){var C=this._17O(H);if("2a864886f70d010101"==C._61O){var v=this._16O(C.key),T=new Rr;return T._38O(v.n,v.e),T}sr(vr)},_16O:function(V){var U={};V.substr(0,2)!=te&&sr(vr);var j=uf._7O(V,0);return 2!=j.length&&sr(vr),V.substr(j[0],2)!=Sk&&sr(vr),U.n=uf._11O(V,j[0]),V.substr(j[1],2)!=Sk&&sr(vr),U.e=uf._11O(V,j[1]),U},_17O:function(f){var d={};d._40O=I;var a=uf._7O(f,0);2!=a.length&&sr(vr);var B=a[0];f.substr(B,2)!=te&&sr(vr);var s=uf._7O(f,B);return 2!=s.length&&sr(vr),f.substr(s[0],2)!=hn&&sr(vr),d._61O=uf._11O(f,s[0]),f.substr(s[1],2)==hn?d._40O=uf._11O(f,s[1]):f.substr(s[1],2)==te&&(d._40O={},d._40O.p=uf._70O(f,s[1],[0],Sk),d._40O.q=uf._70O(f,s[1],[1],Sk),d._40O.g=uf._70O(f,s[1],[2],Sk)),f.substr(a[1],2)!=rs&&sr(vr),d.key=uf._11O(f,a[1]).substr(2),d}},X._17O?X:I}(),wl=Qc._27O=function(G){return Qc._14O(G)};Lj=function(){return function(l,r){if(l&&r){r=vp(r);var H=fc(r,D(2,4)),O=this;if(!O||!O.n||H._55O()>O.n._55O())return 0;var B=O._37O(H),u=B[El](D(2,4)).replace(up,""),d=Jl(u);if(0==d.length)return!1;var Z=d[0],A=d[1],q=function(U){return jf._4O.Util._56O(U,Z)},i=q(l);return A==i}}.bind(wl(X))};var kl,Bl;return function(){var C=kq.length-ye.length;if(C>0)for(var t=0;C>t;t++)kl=We.Util,Bl=vp}(),gh=function(r,z){z=Bl(z);var j=wl(vm),P=pn.length,$=2*P,q=fc(z,D(P,$)),W=j,h=!0;if(W){var s=W[ne[0]];s&&q._55O()<=s._55O()&&(h=!1)}if(h)return 0;var T=W._37O(q),K=T[El](D(P,$)).replace(up,""),A=Jl(K);if(0==A.length)return!1;var p=A[0],v=A[1],w=kl._11A(r,p);return v==w},Qc}(c,j),Xi(z,{load:function(){var N={},e=function(e){return e?"c_"+(e.sync?"1":"0")+"_"+(e.post?"1":"0")+"_"+(e.responseType||"H")+"_"+(e.mimeType||"H")+"_"+(e.data?JSON.stringify(e.data):"H"):""};return function(u,L,K){var o,d=N[u],P=e(K);return d&&(o=d[P])?(o.push(L),void 0):(N[u]||(d=N[u]={count:0}),o=d[P]=[L],d.count++,z.xhrLoad(u,function(k){delete d[P],d.count--,d.count||delete N[u],o.forEach(function(_){_(k)})},K),void 0)}}(),asyncEach:function(z,k,j){"function"!=typeof j&&(j=Function.prototype);var i=new Array(z.length),J=0,E=!1;z.forEach(function(Q,l){k(Q,function(s,K){return E?void 0:s?(E=!0,j(null)):(i[l]=K,J++,J===z.length?j(i):void 0)})})},xhrLoad:function(M,p,F){var R=!1;gc(M)||(R=!0,M=[M]),F=F||{};var N=F.sync,H=null,q=F.method||"GET";return F.post&&(q="POST"),F.method=q,z.asyncEach(M,function(e,_){var p=new ld;e=z.beforeLoadURL(e),e.data?_(null,e.data):(F.url=encodeURI(e),F.responseType?p.setResponseType(F.responseType):p.setOverrideMimeType(F.mimeType||"text/plain"),p.onload=function(){200===this.status||0===this.status?_(null,p.getResponseText()):_(!0)},p.onerror=function(){_(!0)},p.send(F))},function(e){var S="function"==typeof p;(S||N)&&(H=R&&e?e[0]:e,S&&p(H))}),N?H:void 0}});var vg=j.setPrototypeOf||function(x,$){return x.__proto__=$,x},Ud=j.getPrototypeOf||function(P){return P.__proto__},rr=j.freeze;j.isFrozen;var Zd=function(){var j=function(y){return y};return function(l){return l&&l.length?new Function("o",["return o['",l.join("']['"),"'];"].join("")):j}}(),wo=function(){var L=function(g,t){return g=t};return function(c){return c&&c.length?new Function("o","v",["return o['",c.join("']['"),"'] = v;"].join("")):L}}();!function(){function Y(V){var l=[];if(V)for(var v;(v=h.exec(V))!=_;)l.push(v[1]);return l}function G(K,m){var J=$.exec(m);this._cell=K,this._key=J[1],this._format=J[2],this._style=Y(J[3])}function e(t){for(var C=this._cellList=[],F=this._paramList=[],w=t.split(k),S=0,o=w.length;o>S;++S){var D=w[S];if("{{"!==D)for(var y=D.split(P),Z=0,x=y.length;x>Z;++Z){var b=y[Z];P.test(b)?(F.push(new G(C.length,b)),C.push(_)):b.length>0&&C.push(b)}else C.push("{")}this._formatList=this._cellList.slice(0)}var X={},x={},k=/(\{\{)/,P=/(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/,$=/\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/,h=/\&([\w\.]*)/g;e.prototype._73O=function(l){for(var E=this._paramList.length;E--;){var $=this._paramList[E],Z=l[Fq($._key)+1],g=x[$._format];g&&(Z=g(Z,$._style)),this._formatList[$._cell]=Z}return this._formatList.join("")},e.prototype._map=function(G){for(var g=this._paramList.length;g--;){var r=this._paramList[g],w=G[r._key],y=x[r._format];y&&(w=y(w,r._style)),this._formatList[r._cell]=w}return this._formatList.join("")};var B=function(M){var R=X[M];return R||(X[M]=R=new e(M)),R._73O(arguments)};return B.map=function(h,x){var r=X[h];return r||(X[h]=r=new e(h)),r._map(x)},B.setValueFormat=function(i,_){x[i]=_},B.gc=function(){X.length=0},B.__parsed=X,B}();var Af=function(){function n(i,c,T,O){var Y=i?i.path.slice(0):[];c&&Y.push(c),this.desc=T,this.name=c,this.path=rr(Y),this.getter=Zd(Y),this.setter=wo(Y),this.isLeaf=O,this.parent=i,this.children=[],this.childMap={}}return n.create=function(){function c(F,T,C,W){var a=W(C),E=new n(F,T,C,a);if(!a){for(var i=E.children,e=E.childMap,l=j.keys(C),w=0,Y=l.length;Y>w;++w){var M=l[w],Q=c(E,M,C[M],W);i.push(Q),e[Q.name]=Q}E.children=rr(i),E.childMap=rr(e)}return rr(E),E}return function(z,O){return c(_,_,z,O)}}(),n.prototype.forEach=function(j,F){for(var g=this.children,A=0,I=g.length;I>A;++A){var S=g[A];j(S,F)}},n}(),rr=j.freeze,Xb={main:{mask:1,priority:z.cameraPriority.main,clearDepth:!1,ignore:!1},top:{mask:2,priority:z.cameraPriority.top,ignore:!1}},Nn="main",kg=Xb[Nn].mask,il=function(g,L){g=g||0;var G;if(L in Xb)G=Xb[L].mask;else{if(!(32>lp))throw new Error("Only 31 render layer can be defined.");Xb[L]={mask:1<<lp++,priority:Xb[Nn].priority},G=Xb[L].mask,ej=Yq(j.keys(Xb)),lp=ej.length}return g|=G},im=function(H){var c=0;if("string"==typeof H)c=il(c,H);else for(var s=0,f=H.length;f>s;++s)c=il(c,H[s]);return c},Ne=function(p,x){return p&&x&&p&x},Yq=function(j){return j.sort(function(t,q){return Xb[t].priority-Xb[q].priority})},ej=Yq(j.keys(Xb)),lp=ej.length;Xi(z,{setRenderLayerInfo:function(R,H){if(il(0,R),H){for(var w in H)Xb[R][w]=H[w];H.priority&&(ej=Yq(j.keys(Xb)))}},getRenderLayerInfo:function(E){return Xb[E]}},!0);var Gc=A.List=function(){this._as=[];var z,J,n=arguments.length;if(1===n){var k=arguments[0];if(vq(k)&&(k=k._as),gc(k))for(J=k.length,z=0;J>z;z++)this._as.push(k[z]);else k!=I&&this._as.push(k)}else if(n>1)for(z=0;n>z;z++)this._as.push(arguments[z])};Og("List",j,{forEach:function(Q,R){this.each(Q,R)},push:function(){for(var Q=0;Q<arguments.length;Q++)this.add(arguments[Q])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(M,x){return x===_?this._as.push(M):this._as.splice(x,0,M)},addAll:function(l){vq(l)&&(l=l._as),gc(l)?Gf(this._as,l):this._as.push(l)},get:function(i){return this._as[i]},slice:function(B,$){return new Gc(this._as.slice(B,$))},remove:function(t){var T=this._as.indexOf(t);return T>=0&&T<this._as.length&&this.removeAt(T),T},removeAt:function(J){return this._as.splice(J,1)[0]},set:function(u,w){return this._as[u]=w},clear:function(){return this._as.splice(0,this._as.length)},contains:function(t){return this._as.indexOf(t)>=0},indexOf:function(r){return this._as.indexOf(r)},each:function(T,F){for(var N=0,_=this._as.length;_>N;N++){var L=this._as[N];F?T.call(F,L,N,this):T(L,N,this)}},reverseEach:function(n,L){for(var u=this._as.length-1;u>=0;u--){var s=this._as[u];L?n.call(L,s):n(s)}},getArray:function(){return this._as},toArray:function(t,e){if(t){for(var v,w=[],C=0,S=this._as.length;S>C;C++)v=this._as[C],e?t.call(e,v)&&w.push(v):t(v)&&w.push(v);return w}return this._as.concat()},toList:function(E,v){if(E){for(var u,h=new Gc,d=0,A=this._as.length;A>d;d++)u=this._as[d],v?E.call(v,u)&&h.add(u):E(u)&&h.add(u);return h}return new Gc(this)},reverse:function(){this._as.reverse()},sort:function(e){return this._as.sort(e?e:zm),this},toString:function(){return this._as.toString()}}),j.defineProperties(Gc.prototype,{length:{get:function(){return this._as.length},set:function(f){this._as.length=f}}});var pg=new Gc;Xi(pg,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:jb,each:jb,reverseEach:jb,toArray:function(){return[]},toList:function(){return new Gc},add:Bs,addAll:Bs,set:Bs,remove:Bs,removeAt:Bs,clear:Bs});var jc=A.Notifier=function(){this._f=0};Og("Notifier",j,{contains:function(A,j){if(this._ls)for(var o,p=0,M=this._ls.size();M>p;p++)if(o=this._ls.get(p),A===o.l&&j===o.s)return!0;return!1},add:function(e,F,g){var N=this,a={l:e,s:F,a:g};N._ls||(N._ls=new Gc),N._f?(N._as||(N._as=new Gc),N._as.add(a)):a.a?N._ls.add(a,0):N._ls.add(a)},remove:function(I,D){var F=this;F._ls&&(F._f?(F._rs||(F._rs=new Gc),F._rs.add({l:I,s:D})):F._remove(I,D))},_remove:function(V,N){for(var T,Q=this._ls,J=0,E=Q.size();E>J;J++)if(T=Q.get(J),T.l===V&&T.s===N)return Q.removeAt(J),void 0},fire:function(i){var E=this,s=E._ls;if(E._b=1e4,s){++E._f;try{for(var L,A=0,w=s.size();w>A;A++)L=s.get(A),L.s?L.l.call(L.s,i):L.l(i)}catch(i){Nq(function(){throw i})}finally{if(--E._f)return;if(E._rs){for(w=E._rs.size(),A=0;w>A;A++)L=E._rs.get(A),E._remove(L.l,L.s);delete E._rs}if(E._as){for(w=E._as.size(),A=0;w>A;A++)L=E._as.get(A),L.a?s.add(L,0):s.add(L);delete E._as}}}}});var Nj=A.Data=function(){this._id=Nr()};Og("Data",j,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:I,_parent:I,_children:pg,_childMap:I,_styleMap:I,_layer:"0",_renderLayer:Nn,_renderLayerMask:kg,_adjustChildrenToTop:!1,getRenderLayerMask:function(){return this._renderLayerMask||kg},getRenderLayer:function(){return this._renderLayer||Nn},setRenderLayer:function(r){var v=this,h=il(0,r);v._renderLayerMask=h;var A=v._renderLayer;v._renderLayer=r,v.fp("renderLayer",A,v._renderLayer)},testRenderLayer:function(A){var V=Xb[A];return V&&Ne(this._renderLayerMask,Xb[A].mask)},getUIClass:function(){return I},_22Q:function(){return I},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(x,G){var k=this;if(2===arguments.length)k.setStyle(x,G);else{if(!qf(x))return k.getStyle(x);for(var p in x)k.setStyle(p,x[p])}return k},fp:function(v,B,m,w,z){return this.firePropertyChange(v,B,m,w,z)},firePropertyChange:function(e,G,j,p,Q){if(p){if(p(G,j))return!1}else if(G===j)return!1;var z=this,K=Q||{};return K.property=e,K.oldValue=G,K.newValue=j,K.data=z,z._dataModel&&z._dataModel.handleDataPropertyChange(K),z.onPropertyChanged(K),!0},onPropertyChanged:function(E){var x=this,y=x._parent,f=E.property;if(Re(y)){var M=x.s(ze),C="s:ingroup"===f;(M&&mj[f]||f===C)&&y._81I(),(M||C)&&y.fp("childChange",!0,!1)}kl(y)&&(mj[f]||"elevation"===f||lg[f]||"scaleTall"===f||"tall"===f)&&y.updateFromChildren(),("s:alwaysOnTop"===f||"s:shape3d.alwaysOnTop"===f)&&(E.newValue?this.setRenderLayer("top"):this.setRenderLayer(_))},_21I:function(u){var Q=this;if(u&&Q._dataModel)throw"Remove data from dataModel before adding";Q._dataModel=u},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var W=0,I=this._children.toArray(),H=I.length;H>W;W++)I[W].removeFromDataModel()},getId:function(){return this._id},setId:function(H){this._id=H},getChildren:function(){return this._children},size:function(){return this._children.size()
},toChildren:function(y,L){return this._children.toList(y,L)},eachChild:function(G,e){this._children.each(G,e)},addChild:function(C,O){var j=this;C!==j&&(j._children===pg&&(j._children=new Gc,j._childMap={}),O>=0||(O=j._children.size()),j._childMap[C._id]||j.isDescendantOf(C)||(C._parent&&C._parent.removeChild(C),(0>O||O>j._children.size())&&(O=j._children.size()),j._children.add(C,O),j._childMap[C._id]=C,C.setParent(j),j.onChildAdded(C,O),j.fp(ur,I,C)))},onChildAdded:function(){},removeChild:function(j){var k=this;if(k._childMap&&k._childMap[j._id]){var v=k._children.remove(j);delete k._childMap[j._id],k.fp(ur,j,I),j.setParent(I,v),k.onChildRemoved(j,v)}},onChildRemoved:function(){},getChildAt:function(K){return this._children.get(K)},clearChildren:function(){var I=this;if(!I._children.isEmpty())for(var F=0,f=I._children.toArray(),H=f.length;H>F;F++)I.removeChild(f[F])},getParent:function(){return this._parent},setParent:function(i,D){var C=this;if(!(C._73I||C._parent===i||C===i||i&&i.isDescendantOf(C))){var O,k=C._parent;C._parent=i,C._73I=1,k?(D==I&&(D=k.getChildren().indexOf(C)),k.removeChild(C)):C._dataModel&&D==I&&(D=C._dataModel.getRoots().indexOf(C)),i&&(i.addChild(C),O=i.getChildren().indexOf(C)),delete C._73I,C.fp("parent",k,i,_,{oldIndex:D,newIndex:O}),C.onParentChanged(k,i)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(q){return q?this.isDescendantOf(q)||q.isDescendantOf(this):!1},isParentOf:function(q){return q&&this._childMap?!!this._childMap[q._id]:!1},isDescendantOf:function(k){if(!k||k.isEmpty())return!1;for(var Y=this._parent;Y;){if(k===Y)return!0;Y=Y._parent}return!1},getStyle:function(q,f){f===_&&(f=1);var h=this._styleMap?this._styleMap[q]:_;return h===_&&f?s[q]:h},setStyle:function(W,i){var P=this;P._styleMap||(P._styleMap={});var Y=P._styleMap[W];i===_?delete P._styleMap[W]:P._styleMap[W]=i,P.fp("s:"+W,Y,i)&&P.onStyleChanged(W,Y,i)},onStyleChanged:function(){},iv:function(C){this.invalidate(C)},invalidate:function(l){this.fp(l||"*",!1,!0)},toString:function(){var Q=this;return Q._displayName||Q._name||Q._tag||Q._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(T,F){var $=this,R=$.s(lq);$.beginTransaction(),R||$.s(lq,R={}),F?R[T]=F:delete R[T],$.fp(lq,I,R),$.endTransaction()},removeStyleIcon:function(x){var V=this.s(lq);if(V){var p=V[x];delete V[x],this.fp(lq,I,V)}return p},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(M){var l=this;if(l.hasOwnProperty("_anchor")||l.hasOwnProperty("_anchorElevation")){var h=l.getAnchor3d(),x={x:h.x-.5,y:h.y-.5,z:h.z-.5};oi(M,[-x.x,-x.y,-x.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,renderLayer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var k,Q={};for(k in this._styleMap)Q[k]=1;return Q},getCurrentPrefix:function(){return this._interactPrefix||Mo},ca:function(H,z){var p=this.getCurrentPrefix();return H=p+H,2===arguments.length?this.a(H,z):this.a(H)}});var Tf=A.DataModel=function(){var s=this;s._isDeserializing=0,s._datas=new Gc,s._dataMap={},s._roots=new Gc,s._rootMap={},s._fsDataMap={},s._78O={},s._reflectorMap={},s._36I=new jc,s._35I=new jc,s._serializeNotifier=new jc,s._selectionModel=new Om(s);var E=s._29Q=[],F=s._scheduleCallback=function(){for(var _=Date.now(),l=0;l<E.length;l++){var H=E[l];H.enabled&&_-H.lastTime>H.interval&&(H.beforeAction&&H.beforeAction(),H.action&&s.each(function(V){H.action(V)}),H.afterAction&&H.afterAction(),H.lastTime=_)}E.length&&(s._30Q=c.requestAnimationFrame(F))}};Og("DataModel",j,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmapType","envmap","postProcessingData","init"],_name:_,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:_,_init:_,_envmap:_,_envmapType:_,_postProcessingData:_,sm:function(){return this.getSelectionModel()},mm:function(Q,i,S){this.addDataModelChangeListener(Q,i,S)},umm:function(W,T){this.removeDataModelChangeListener(W,T)},md:function(_,w,B){this.addDataPropertyChangeListener(_,w,B)},umd:function(F,t){this.removeDataPropertyChangeListener(F,t)},mh:function(r,S,X){this.addHierarchyChangeListener(r,S,X)},umh:function(u,W){this.removeHierarchyChangeListener(u,W)},getAttrObject:function(){return this._attrObject},setAttrObject:function(F){return this._attrObject=F},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(l){return this._dataMap[l]},removeDataById:function(O){this.remove(this.getDataById(O))},toDatas:function(g,r){return this._datas.toList(g,r)},each:function(A,h){this._datas.each(A,h)},getDataByTag:function(P){return this._78O[P]},getTagMap:function(){return this._78O},removeDataByTag:function(O){this.remove(this.getDataByTag(O))},add:function(P,G,v){var Z=this,l=P._id,w=P._tag,R=Z._roots;if(Z._dataMap[l])throw"'"+l+"' already exists";w!=I&&(Z._78O[w]=P),Z._dataMap[l]=P,v>=0?Z._datas.add(P,v):Z._datas.add(P),P._parent||(Z._rootMap[l]=P,G>=0?R.add(P,G):R.add(P)),P.s("fullscreen")!==_&&(Z._fsDataMap[l]=P),P.s("shape3d.reflector")&&(Z._reflectorMap[l]=P),P._21I(Z),Z.onAdded(P),Z._36I.fire({kind:"add",data:P,rootsIndex:G,datasIndex:v})},onAdded:function(){},remove:function(k,G){if(k){var Z=this,S=k._id,W=G&&G.keepStructure,Q=G&&G.keepChildren,d=k.getTag();if(k._dataModel===Z){var B=k instanceof dp;B&&z.setIsolating(!0),this.beginTransaction(),W?Z._removingData||(Z._removingData=k):Z.prepareRemove(k),Q||k.toChildren().each(function(T){Z.remove(T,G)},Z),W?Z._removingData===k&&(k._parent&&k._parent.removeChild(k),delete Z._removingData):k._parent&&k._parent.removeChild(k);var m=Z._datas.remove(k);delete Z._dataMap[S],d!=I&&delete Z._78O[d];var u;Z._rootMap[S]&&(delete Z._rootMap[S],u=Z._roots.remove(k)),Z._fsDataMap[S]&&delete Z._fsDataMap[S],Z._reflectorMap[S]&&delete Z._reflectorMap[S],k._21I(I),Z.onRemoved(k),Z._36I.fire({kind:Oe,data:k,rootsIndex:u,datasIndex:m}),this.endTransaction(),B&&z.setIsolating(!1)}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var K=this;if(K._datas.size()){var p=K._historyManager?this.toJSON():_;K._datas.toArray().forEach(function(W){W._21I(I)}),K._datas.clear(),K._dataMap={},K._roots.clear(),K._rootMap={},K._fsDataMap={},K._reflectorMap={},K._78O={},K._36I.fire({kind:gs,json:p})}},contains:function(P){return P&&P._dataModel===this},handleDataPropertyChange:function(r){var t=this,x=r.data,j=r.property;if("parent"===j){var V=x._id,e=t._rootMap,$=t._roots;x._parent?e[V]&&(delete e[V],$.remove(x)):e[V]||(e[V]=x,$.add(x))}else if("tag"===j){var y=r.oldValue,X=r.newValue,P=t._78O;y!=I&&delete P[y],X!=I&&(P[X]=x)}else if("s:fullscreen"===j){var V=x._id,F=t._fsDataMap;r.oldValue!=I&&delete F[V],r.newValue!=I&&(F[V]=x)}else if("s:shape3d.reflector"===j){var V=x._id,U=t._reflectorMap;r.oldValue&&delete U[V],r.newValue&&(U[V]=x)}this.onDataPropertyChanged(x,r),this._35I.fire(r)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(x,y,W){this._36I.add(x,y,W)},removeDataModelChangeListener:function(S,K){this._36I.remove(S,K)},addSerializeListener:function(V,Y,q){this._serializeNotifier.add(V,Y,q)},removeSerializeListener:function(p,v){this._serializeNotifier.remove(p,v)},fireSerializeEvent:function(P){this._serializeNotifier.fire(P)},addDataPropertyChangeListener:function(n,q,u){this._35I.add(n,q,u)},removeDataPropertyChangeListener:function(z,I){this._35I.remove(z,I)},_38I:function(J,o,v){this._37I&&this._37I.fire({data:J,oldIndex:o,newIndex:v})},addHierarchyChangeListener:function(V,G,B){this._37I||(this._37I=new jc),this._37I.add(V,G,B)},removeHierarchyChangeListener:function(p,a){this._37I.remove(p,a)},getSiblings:function(N){var t=N._parent;return t?t._children:this._roots},eachByHierarchical:function(U,x,i){if(x)return this._eachByHierarchical(U,x,i);for(var Q=0,A=this._roots,l=A.size();l>Q;Q++)if(this._eachByHierarchical(U,A.get(Q),i)===!1)return!1;return!0},_eachByHierarchical:function(S,n,$){if($){if(S.call($,n)===!1)return!1}else if(S(n)===!1)return!1;for(var A=n.size(),J=0;A>J;J++)if(this._eachByHierarchical(S,n.getChildAt(J),$)===!1)return!1;return!0},reverseEachByHierarchical:function(n,a,A){if(a)return this._reverseEachByHierarchical(n,a,A);for(var H=this._roots,d=H.size(),F=d-1;F>=0;F--)if(this._reverseEachByHierarchical(n,H.get(F),A)===!1)return!1;return!0},_reverseEachByHierarchical:function(q,M,s){for(var U=M.size(),f=U-1;f>=0;f--)if(this._reverseEachByHierarchical(q,M.getChildAt(f),s)===!1)return!1;if(s){if(q.call(s,M)===!1)return!1}else if(q(M)===!1)return!1;return!0},eachByDepthFirst:function(L,s,A){if(s)return this._11I(L,s,A);for(var t=0,f=this._roots,$=f.size();$>t;t++)if(this._11I(L,f.get(t),A)===!1)return!1;return!0},_11I:function(l,f,Y){for(var c=f.size(),w=0;c>w;w++)if(this._11I(l,f.getChildAt(w),Y)===!1)return!1;if(Y){if(l.call(Y,f)===!1)return!1}else if(l(f)===!1)return!1;return!0},eachByBreadthFirst:function(B,k,A){var N=new Gc;for(k?N.add(k):this._roots.each(N.add,N);N.size()>0;)if(k=N.removeAt(0),k.eachChild(N.add,N),A){if(B.call(A,k)===!1)return!1}else if(B(k)===!1)return!1;return!0},moveTo:function(l,N){var k=this.getSiblings(l),T=k.indexOf(l);T===N||0>T||N>=0&&N<=k.size()&&(k.remove(l),N>k.size()&&N--,k.add(l,N),this._38I(l,T,N))},moveUp:function(u){this.moveTo(u,this.getSiblings(u).indexOf(u)-1)},moveDown:function(J){this.moveTo(J,this.getSiblings(J).indexOf(J)+1)},moveToTop:function(Q){this.moveTo(Q,0)},moveToBottom:function(X){this.moveTo(X,this.getSiblings(X).size())},moveSelectionUp:function(q){this.beginTransaction(),q||(q=this.sm());var w=new Gc;sg(q,w,this._roots),w.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(r){this.beginTransaction(),r||(r=this.sm());var O=new Gc;Kk(r,O,this._roots),O.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(e){this.beginTransaction(),e||(e=this.sm());var S=new Gc;pr(e,S,this._roots),S.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(D){this.beginTransaction(),D||(D=this.sm());var X=new Gc;sr(D,X,this._roots),X.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(N,s,r){var $=this.getDatas();null==r&&(r=$.indexOf(N)),r===s||0>r||s>=0&&s<=$.size()&&($.remove(N),s>$.size()&&s--,$.add(N,s),this._76I(N,r,s))},bringForward:function(u){this.moveToIndex(u,this.getDatas().indexOf(u)+1)},bringToFront:function(n){this.moveToIndex(n,this.size())},sendBackward:function(M){this.moveToIndex(M,this.getDatas().indexOf(M)-1)},sendToBack:function(h){this.moveToIndex(h,0)},bringSelectionForward:function(Y){this.beginTransaction(),Y||(Y=this.sm());for(var $=new Gc,E=this.getDatas(),f=!1,d=0;d<E.size();d++){var G=E.get(E.size()-1-d);Y.contains(G)?f&&$.add(G):f=!0}$.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(N){this.beginTransaction(),N||(N=this.sm());for(var u=new Gc,S=this.getDatas(),Y=0;Y<S.size();Y++){var D=S.get(Y);N.contains(D)&&u.add(D)}u.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(u){this.beginTransaction(),u||(u=this.sm());for(var X=new Gc,p=this.getDatas(),K=!1,L=0;L<p.size();L++){var G=p.get(L);u.contains(G)?K&&X.add(G):K=!0}X.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(T){this.beginTransaction(),T||(T=this.sm());for(var f=new Gc,w=this.getDatas(),g=0;g<w.size();g++){var I=w.get(w.size()-1-g);T.contains(I)&&f.add(I)}f.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(b){var v=this;v.removeScheduleTask(b),b.enabled==I&&(b.enabled=!0),b.interval==I&&(b.interval=10),b.lastTime=Date.now(),v._29Q.push(b),v._30Q==I&&(v._30Q=c.requestAnimationFrame(v._scheduleCallback))},removeScheduleTask:function(u){var R=this,U=R._29Q,Y=U.indexOf(u);Y>=0&&U.splice(Y,1),U.length||R._30Q==I||(c.cancelAnimationFrame(R._30Q),delete R._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(a){this._historyManager||new A.HistoryManager(this),null!=a&&this._historyManager.setMaxHistoryCount(a),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(J){this._historyManager&&this._historyManager.undo(J)},redo:function(W){this._historyManager&&this._historyManager.redo(W)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(b){this._historyManager&&this._historyManager.addHistory(b)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(W){W?this._isDeserializing++:this._isDeserializing--},updateLayoutAttach:function(g){this.each(function(a){a instanceof jr&&a.getImage()===g&&a.updateLayoutAttaches()})},isCubicEnvmap:function(){return!1},setCubicEnvmap:function(){}});var Om=A.SelectionModel=function(R){var E=this;E._68O=rj,E._map={},E._73O=new Gc,E._74I=new jc,E._21I(R)};Og("SelectionModel",j,{ms_fire:1,ms_dm:1,ms:function(u,F,A){this.addSelectionChangeListener(u,F,A)},ums:function(c,h){this.removeSelectionChangeListener(c,h)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===hm},co:function(j){return this._map[j._id]!=I},ss:function(O){this.setSelection(O)},as:function(N){this.appendSelection(N)},rs:function(w){this.removeSelection(w)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(j){var M=this;if(M._68O!==j&&(j===ne||j===hm||j===rj)){M.cs();var y=M._68O;M._68O=j,M.fp("selectionMode",y,j)}},_21I:function(s){var i=this,X=i._dataModel;X!==s&&(X&&(i.cs(),X.umm(i.handleDataModelChange,i)),i._dataModel=s,s.mm(i.handleDataModelChange,i,!0),i.fp(Vi,X,s))},dispose:function(){var x=this;x.cs(),x._dataModel.umm(x.handleDataModelChange,x)},handleDataModelChange:function(X){var R=this;if(X.kind===Oe){var d=X.data;R.co(d)&&(R._73O.remove(d),delete R._map[d._id],R._75I(Oe,new Gc(d)))}else X.kind===gs&&R.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(I){var J=this;if(J._filterFunc!==I){J.cs();var S=J._filterFunc;J._filterFunc=I,J.fp("filterFunc",S,J._filterFunc)}},_75I:function(T,X,w,x){w&&(this._73O.each(function(P){x[P._id]?w.remove(P):w.add(P)}),X=w.toList()),this._74I.fire({kind:T,datas:new Gc(X)})},addSelectionChangeListener:function($,r,Y){this._74I.add($,r,Y)},removeSelectionChangeListener:function(S,D){this._74I.remove(S,D)},_97O:function(H,e){for(var Q,D=this,w=0,T=new Gc(H);w<T.size();w++)Q=T.get(w),(D._filterFunc&&!D._filterFunc(Q)||e&&D.co(Q)||!e&&!D.co(Q)||!D._dataModel.contains(Q))&&(T.removeAt(w),w--);return T},appendSelection:function(l){var y=this;if(y._68O!==ne){var p,t,e=y._73O,X=y._97O(l,!0);X.isEmpty()||(y.sg()&&(p=new Gc(e),t=y._map,e.clear(),y._map={},X=new Gc(X.get(X.size()-1))),X.each(function(a){e.add(a),y._map[a._id]=a}),y._75I("append",X,p,t))}},removeSelection:function(m){var e=this,z=e._97O(m),M=0,j=z.size();if(0!==j){for(;j>M;M++){var L=z.get(M);e._73O.remove(L),delete e._map[L._id]}e._75I(Oe,z)}},toSelection:function(A,l){return this._73O.toList(A,l)},getSelection:function(){return this._73O},each:function(M,W){this._73O.each(M,W)},setSelection:function(h){var u=this,F=u._73O;if(u._68O!==ne&&!(F.isEmpty()&&!h||1===F.size()&&u.ld()===h)){var d=new Gc(F),p=u._map;F.clear(),u._map={};var w=u._97O(h,!0);u.sg()&&w.size()>1&&(w=new Gc(w.get(w.size()-1))),w.each(function(E){F.add(E),u._map[E._id]=E}),u._75I("set",I,d,p)}},clearSelection:function(){var L=this,M=L._73O;if(M.size()>0){var E=M.toList();M.clear(),L._map={},L._75I(gs,E)}},selectAll:function(){var X=this;if(X._68O!==ne){var F,u,L=X._dataModel.toDatas();if(X._filterFunc)for(F=0;F<L.size();F++)u=L.get(F),X._filterFunc(u)||(L.removeAt(F),F--);var N=X._73O,$=new Gc(N),V=X._map;N.clear(),X._map={},X.sg()&&L.size()>1&&(L=new Gc(L.get(L.size()-1)));var g=L.size();for(F=0;g>F;F++)u=L.get(F),N.add(u),X._map[u._id]=u;X._75I("all",I,$,V)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(F){return this._map[F._id]!=I},getLastData:function(){var r=this._73O;return r.size()>0?r.get(r.size()-1):I},getFirstData:function(){var e=this._73O;return e.size()>0?e.get(0):I},isSelectable:function(n){var Z=this;return n&&Z._68O!==ne?Z._filterFunc?Z._filterFunc(n):!0:!1},getTopSelection:function(){var f=this,b=new Gc;return f._73O.each(function(s){for(var S=s.getParent();S;){if(f.contains(S)){s=I;break}S=S.parent}s&&b.add(s)}),b}});var Sc=function(){return yr(0),function(a,J){var m;if(os(J)){var i=a.getDataUI(J);i&&i._88I&&(m=i._88I.rect)}return m?m:J.getRect()}}();Xi(z,{edgeGroupAgentFunc:I,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:Y.rectSelectBorder,graphViewRectSelectBackground:rs,graphViewEditPointSize:to?17:7,graphViewEditPointBorderColor:Y.editPointBorder,graphViewEditPointBackground:Y.editPointBackground,setEdgeType:function(q,S,G){Td[q]=S,nm[q]=G},getEdgeType:function(_){return Td[_]},getEdgeTypeMap:function(){return Td},getNodeRect:Sc},!0);var $h={"layout.h":_,"layout.v":_,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":_,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:_,ingroup:!0,"body.color":_,"2d.gray":!1,fullscreen:_,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:_,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"vector.layoutable":!1,"clip.direction":"top","clip.percentage":_,"select.color":lf,"select.width":1,"select.padding":2,"select.type":qk,"shadow.interactable":!0,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":lf,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":_,"border.width":2,"border.padding":2,"border.type":qk,label:_,"label.font":_,"label.color":yb,"label.background":_,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":_,"label.max":_,"label.opacity":_,"label.scale":1,"label.align":_,"label.selectable":!0,"label.decoration":_,label2:_,"label2.font":_,"label2.color":yb,"label2.background":_,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":_,"label2.max":_,"label2.opacity":_,"label2.scale":1,"label2.align":_,"label2.selectable":!0,"label2.decoration":_,note:_,"note.expanded":!0,"note.font":_,"note.color":Ji,"note.background":lf,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":_,"note.toggleable":!0,"note.border.width":1,"note.border.color":_,"note.opacity":_,"note.scale":1,"note.align":_,note2:_,"note2.expanded":!0,"note2.font":_,"note2.color":Ji,"note2.background":lf,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":_,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":_,"note2.opacity":_,"note2.scale":1,"note2.align":_,"group.type":_,"group.image":_,"group.image.stretch":"fill","group.repeat.image":_,"group.border.repeat.image":_,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":_,"group.title.color":Ji,"group.title.background":Y.groupTitleBackground,"group.title.align":iq,"group.title.orientation":wg,"group.background":Y.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":_,"group.border.color":Gp,"group.border.radius":_,"group.border.cap":cj,"group.border.join":tg,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":I,"group.gradient.color":"#FFF",shape:_,"shape.background":Gp,"shape.repeat.image":_,"shape.border.repeat.image":_,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Gp,"shape.border.3d":!1,"shape.border.3d.color":_,"shape.border.3d.accuracy":_,"shape.border.cap":cj,"shape.border.join":tg,"shape.border.pattern":_,"shape.gradient":I,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":Ib,"shape.dash.offset":0,"shape.dash.color":Ij,"shape.dash.width":_,"shape.dash.3d":!1,"shape.dash.3d.color":_,"shape.dash.3d.accuracy":_,"shape.polygon.side":6,"shape.arc.from":h,"shape.arc.to":$,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":_,"shape.gradient.pack":_,"shape.border.gradient.pack":_,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":_,"shape.foreground":_,"shape.foreground.gradient":I,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":_,"autolayout.gap":_,"autolayout.hgap":_,"autolayout.vgap":_,"edge.type":_,"edge.points":_,"edge.segments":_,"edge.color":Gp,"edge.width":2,"edge.width.absolute":!1,"edge.repeat.image":null,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":_,"edge.3d.accuracy":_,"edge.cap":cj,"edge.join":tg,"edge.source.position":17,"edge.source.anchor.x":_,"edge.source.anchor.y":_,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":_,"edge.target.anchor.y":_,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":_,"edge.dash":!1,"edge.dash.pattern":Ib,"edge.dash.offset":0,"edge.dash.color":Ij,"edge.dash.width":_,"edge.dash.3d":!1,"edge.dash.3d.color":_,"edge.dash.3d.accuracy":_,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":_,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":_,"grid.column.percents":_,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":Y.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":Y.gridCellBorderColor,"grid.block":_,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":Y.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":yb,"text.gradient.pack":_,"text.font":fl,"text.shadow":!1,"text.shadow.color":lf,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,"text.gradient":_,"text.gradient.color":"#FFF","text.decoration":_,"text.vertical":!1,"text.vertical.gap":1,"text.wrap":!1,"text.letter.gap":null,"text.border.color":lf,"text.border.width":0,keepPosition:!0};$h[be]=_,Xi(s,$h,!0),Xi(Tf,{_76I:function(J,K,B){this._39I&&this._39I.fire({data:J,oldIndex:K,newIndex:B})},addIndexChangeListener:function(i,S,d){var D=this;D._39I||(D._39I=new jc),D._39I.add(i,S,d)},removeIndexChangeListener:function(S,Y){this._39I.remove(S,Y)},prepareRemove:function(r){Rn(r)&&(r.setSource(I),r.setTarget(I)),r._70O&&r._70O.toList().each(this.remove,this),r._69O&&r._69O.toList().each(function(n){n.setHost(I)}),r._host&&r.setHost(I)},onAdded:function(r){this.isAutoAdjustIndex()&&this.adjustIndex(r)},onDataPropertyChanged:function(J,D){ag[D.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(J)},isAdjustable:function(A){return Fg(A)||Rn(A)},isAdjustedToBottom:function(K){return Re(K)?K.isExpanded()&&Kg(K):!1},adjustIndex:function(f){var G=this;this.isHierarchicalRendering()||(G.isAdjustedToBottom(f)?(G.sendToBottom(f),f.eachChild(G.adjustIndex,G)):G.sendToTop(f))},sendToTop:function(c){var h=this;if(h.contains(c)&&h.isAdjustable(c)){var w=h._datas;if(c!==w.get(h.size()-1)){var C=w.indexOf(c);w.removeAt(C),w.add(c),h._76I(c,C,h.size()-1)}if(Rn(c)){var P=c._40I;P&&!h.isAdjustedToBottom(P)&&h.sendToTop(P),P=c._41I,P&&!h.isAdjustedToBottom(P)&&h.sendToTop(P)}c._69O&&c._69O.each(function(X){X.isRelatedTo(c)||Fg(c)&&X.isLoopedHostOn(c)||h.sendToTop(X)}),c.ISubGraph||(!Re(c)||c.isExpanded())&&c._adjustChildrenToTop&&c.eachChild(function(Z){Rn(Z)||h.sendToTop(Z)})}},sendToBottom:function(U,b){var l=this;if(U!==b&&l.contains(U)&&l.isAdjustable(U)&&(!b||l.contains(b))){var Y=l._datas,w=Y.remove(U),T=b?l._datas.indexOf(b):0;if(Y.add(U,T),w!==T){l._76I(U,w,T);var R=U._parent;!R||R.ISubGraph||Rn(R)||l.sendToBottom(U._parent,U)}}}}),Xi(sm,{ms_edit:function(x){x._46O=function(e){var Y=this,t=Y.gv.dm(),$=Y._index,G=Y._89I,P=Y._node,z=Y._shape,R=Y._edge,b=Y._77I;P&&G?(this.fi({kind:"endEditRect",event:e,data:P,direction:G}),t.endTransaction()):z&&$>=0?(Y.fi({kind:"endEditPoint",event:e,data:z,index:$}),t.endTransaction()):R&&$>=0?(Y.fi({kind:"endEditPoint",event:e,data:R,index:$}),t.endTransaction()):b&&(Y.fi({kind:"endEditRotation",event:e,data:b}),t.endTransaction())},x._78I=function(l){var s=this;s.autoScroll(l);var B=s.gv.lp(l),w=s._index,R=s._89I,O=s._node,K=s._shape,J=s._edge,v=s._77I;if(O&&R)s._80O(B),s.fi({kind:"betweenEditRect",event:l,data:O,direction:R});else if(K&&w>=0)B.e=K.getPoints().get(w).e,K.setPoint(w,B),s.fi({kind:"betweenEditPoint",event:l,data:K,index:w});else if(J&&w>=0){var T=J.s(Wl);B.e=T.get(w).e,T.set(w,B),J.fp(Wl,I,T),s.fi({kind:"betweenEditPoint",event:l,data:J,index:w})}else if(v){var y=v.p(),Q=v.getScale(),u=Rg+id(B.y-y.y,B.x-y.x);Q.y<0&&(u+=h),f(u)<.04&&(u=0),v.setRotation(u),s.fi({kind:"betweenEditRotation",event:l,data:v})}},x._80O=function(T){var k=this,z=k._node,P=k._rect,U=P.x,O=P.y,I=P.width,f=P.height,J=k._89I,a=k._anchor,R=k._matrix,T=R.tfi(T);"northwest"===J?P=Mc(T,{x:U+I,y:O+f}):J===vs?P=Mc({x:U,y:T.y},{x:U+I,y:O+f}):"northeast"===J?P=Mc({x:U,y:T.y},{x:T.x,y:O+f}):J===zp?P=Mc({x:T.x,y:O},{x:U+I,y:O+f}):J===Tm?P=Mc({x:U,y:O},{x:T.x,y:O+f}):"southwest"===J?P=Mc({x:T.x,y:O},{x:U+I,y:T.y}):"south"===J?P=Mc({x:U,y:O},{x:U+I,y:T.y}):"southeast"===J&&(P=Mc({x:U,y:O},T)),z.setPosition(R.tf(P.x+P.width*a.x,P.y+P.height*a.y)),z.setWidth(P.width),z.setHeight(P.height)},x._80I=function(V,v,f,m){var g=this,Z=g.gv._zoom,S=(g.gv.getEditPointSize()+2)/Z;return An({x:v-S/2,y:f-S/2,width:S,height:S},V)?(g._89I!==m&&(g._89I=m),!0):!1},x._79I=function(U,B,L){var M=this,F=M.gv,H=B?F.getDataUI(B):I,W=H?H._55O:I;if(W){var v,E,T,c,e=F._zoom,Y=(F.getEditPointSize()+2)/e,p=F.lp(U);if(Fg(B)){if(W._56O&&Fg(B)&&(E=W._98o,An({x:E.x-Y/2,y:E.y-Y/2,width:Y,height:Y},p)))return M._77I=B,L&&M.fi({kind:"beginEditRotation",event:U,data:B}),M.setCursor("crosshair"),!0;if(W._43O&&B instanceof Mi)for(T=B.getPoints(),v=T.size()-1;v>=0;v--)if(E=T.get(v),An({x:E.x-Y/2,y:E.y-Y/2,width:Y,height:Y},p))return M._index=v,M._shape=B,L&&M.fi({kind:"beginEditPoint",event:U,data:B,index:v}),M.setCursor("crosshair"),!0;if(W._42O)for(var G=B.getEditControlPoints(),n=["northwest",-1,-1,zp,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Tm,1,0,"northeast",1,-1,vs,0,-1],v=0,c=G.length;c>v;v++){var r=n[3*v],N=G[v];if(M._80I(p,N.x,N.y,r)){M._node=B;var i=B.getWidth(),R=B.getHeight(),Z=B.getAnchor();M._rect={x:-i*Z.x,y:-R*Z.y,width:i,height:R},M._anchor=Z,M._matrix=B.getMatrix();var $=B.getRotation(),z=l($),g=d($),q=n[3*v+1]*Oh(B.getScale().x),a=n[3*v+2]*Oh(B.getScale().y),x=Math.atan2(-g*q-z*a,z*q-g*a),j=(Math.round(x/(Math.PI/4))+8)%8,t=[rh,"nesw-resize",Vq,"nwse-resize",rh,"nesw-resize",Vq,"nwse-resize"][j];return M.setCursor(t),L&&M.fi({kind:"beginEditRect",event:U,data:B,direction:M._89I}),!0}}}if(W._43O&&Rn(B)&&B.s(hs)===Wq&&(T=B.s(Wl)))for(v=T.size()-1;v>=0;v--)if(E=T.get(v),An({x:E.x-Y/2,y:E.y-Y/2,width:Y,height:Y},p))return M._index=v,M._edge=B,L&&M.fi({kind:"beginEditPoint",event:U,data:B,index:v}),M.setCursor("crosshair"),!0}return!1}},ms_gv:function(B){B._currentSubGraph=I,B._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},B.upSubGraph=function(){this.setCurrentSubGraph(Jj(this._currentSubGraph))},B.isVisible=function(X){var _=this;if(Jj(X)!==_._currentSubGraph)return!1;if(Rn(X)){var i=X._40I,r=X._41I;if(!i||!r)return!1;if(!(X.s("edge.independent")||_.isVisible(i)&&_.isVisible(r)))return!1;if(X.isEdgeGroupHidden())return!1}else for(var k=X._parent;k&&!k.ISubGraph;){if(Re(k)&&(!k.isExpanded()||!_.isVisible(k)))return!1;k=k._parent}if(X._parent instanceof dp&&!_.isVisible(X._parent))return!1;if(X._refGraph instanceof vh&&!_.isVisible(X._refGraph))return!1;if(_ instanceof Jc){if(!X.s("3d.visible"))return!1}else{var u=_.getLayersInfo();if(u){var H=u[X._layer];if(H&&H.visible===!1)return!1}if(!X.s("2d.visible"))return!1}return _._visibleFunc?_._visibleFunc(X):!0},B.handleSelectionChange=function(x){var H=this;x.datas.each(function(d){H.invalidateData(d);var i=d._parent;Re(i)&&Fg(d)&&d.s(ze)&&(H.invalidateData(i),i._49I&&i._49I.each(function(n){H.invalidateData(n)}))}),H.onSelectionChanged(x)},B.onSelectionChanged=function(K){var v=this,w=v.sm();if(1===w.size()&&("set"===K.kind||"append"===K.kind)){var D=w.ld();v.isAutoMakeVisible()&&v.makeVisible(D),v.adjustIndex&&v._dataModel.isAutoAdjustIndex()&&v.adjustIndex(D)}},B.makeVisible=function(t){if(t){var F=this,Q=F.getDataUI?F.getDataUI(t):F.getData3dUI(t);if(Q){var m=t,R=Jj(t);for(R!==F._currentSubGraph&&F.setCurrentSubGraph(R);(m=m._parent)&&m!==R;)Re(m)&&m.setExpanded(!0);F._23I=t,F.iv()}}},B.getLabel=function(w){var e=w.getStyle(rc);return e===_?w.getName():e},B.getLabelBackground=function(t){return t.getStyle("label.background")},B.getLabelColor=function(i){return i.getStyle("label.color")},B.getLabel2=function(I){return I.getStyle("label2")},B.getLabel2Background=function(e){return e.getStyle("label2.background")},B.getLabel2Color=function(n){return n.getStyle("label2.color")},B.getNote=function(R){return R.getStyle(Zf)},B.getNoteBackground=function(M){return M.getStyle("note.background")},B.getNote2=function(K){return K.getStyle(gi)},B.getNote2Background=function(b){return b.getStyle("note2.background")},B.handleClick=function(P,M,N){var W=this;M?(W.fi({kind:"clickData",event:P,data:M,part:N}),W.onDataClicked(M,P)):(W.fi({kind:"clickBackground",event:P}),W.onBackgroundClicked(P))},B.handleDoubleClick=function(P,W,j){var Z=this;Uo(P)&&(W?(Z.fi({kind:"doubleClickData",event:P,data:W,part:j}),Z.onDataDoubleClicked(W,P,j),Z.checkDoubleClickOnNote(P,W,j)||Z.checkDoubleClickOnRotation&&Z.checkDoubleClickOnRotation(P,W,j)||(Rn(W)?Z.onEdgeDoubleClicked(W,P,j):W.ISubGraph?Z.onSubGraphDoubleClicked(W,P,j):Re(W)?Z.onGroupDoubleClicked(W,P,j):W.IDoorWindow?Z.onDoorWindowDoubleClicked(W,P,j):W.ICSGBox&&Z.onCSGBoxDoubleClicked(W,P,j))):(Z.fi({kind:"doubleClickBackground",event:P}),Z.onBackgroundDoubleClicked(P)))},B.onSubGraphDoubleClicked=function(e){this.setCurrentSubGraph(e)},B.onEdgeDoubleClicked=function(r,A){this.isEditable(r)||(r.ISubGraph&&!Ro(A)?this.setCurrentSubGraph(r):r.s("edge.toggleable")&&r.toggle())},B._39Q=function(d){return this.isInteractive(d)?this.preventDefaultWhenInteractive(d):!1},B.preventDefaultWhenInteractive=function(E){return E.s("preventDefaultWhenInteractive")},B.onGroupDoubleClicked=function(Y){Y.s("group.toggleable")&&Y.toggle()},B.onDoorWindowDoubleClicked=function(k){k.s("dw.toggleable")&&k.toggle(!0)},B.onCSGBoxDoubleClicked=function(P,c){var C=this;if(C instanceof Jc){var _=C.intersectObject(c,P);
_&&P.s(_.part+".toggleable")&&P.toggleFace(_.part,!0)}},B.onBackgroundClicked=function(){},B.onBackgroundDoubleClicked=function(){this.upSubGraph()},B.onDataClicked=function(){},B.onDataDoubleClicked=function(){},B.onAutoLayoutEnded=function(){},B.onMoveEnded=function(){},B.onPanEnded=function(){},B.onPinchEnded=function(){},B.onRectSelectEnded=function(){},B.onZoomEnded=function(){},B.serialize=function(p){return this.dm().serialize(p)},B.toJSON=function(){return this.dm().toJSON()},B.deserialize=function(S,X){var y=this;X=X instanceof Nj?{rootParent:X}:Je(X)?{setId:X}:gg(X)?{finishFunc:X}:X||{},X.view=y;var T=y.dm();return X.reset&&(T.setAttrObject({}),T.setLayers(_),T.setName(_),T.setAutoAdjustIndex(!0),T.setHierarchicalRendering(!1),T.setBackground(_),T.setInit(_),T.setPostProcessingData(_),T.setEnvmap(_),T.setEnvmapType(_),y.disableToolTip(),y instanceof A.graph.GraphView?(y.setZoomable(z.graphViewZoomable),y.setPannable(z.graphViewPannable),y.setRectSelectable(z.graphViewRectSelectable)):y instanceof A.graph3d.Graph3dView&&(y.shadowMap.resetProperties(),y.setDashDisabled(z.graph3dViewDashDisabled),y.getHighlightHelper().resetProperties(),y.resetHeadlightProperties(),y.resetFogProperties(),y.setBatchInfoMap({}),y.setBatchColorDisabled(z.graph3dViewBatchColorDisabled),y.setBatchBlendDisabled(z.graph3dViewBatchBlendDisabled),y.setBatchBrightnessDisabled(z.graph3dViewBatchBrightnessDisabled),y.setMoveStep(z.graph3dViewMoveStep),y.setRotateStep(z.graph3dViewRotateStep),y.setSortable(z.graph3dViewSortable),y.setSortFunc(_),y.setSkybox(_),Jn(y))),X.__innerHandler__=function(V){if(Je(T.a("toolTipEnable"))&&(T.a("toolTipEnable")?y.enableToolTip():y.disableToolTip()),y instanceof A.graph.GraphView&&(Je(T.a("zoomable"))&&y.setZoomable&&y.setZoomable(T.a("zoomable")),Je(T.a("pannable"))&&y.setPannable&&y.setPannable(T.a("pannable")),Je(T.a("rectSelectable"))&&y.setRectSelectable&&y.setRectSelectable(T.a("rectSelectable")),T.a("fitContent")===!0&&y.fitContent&&y.fitContent(!0,0)),y instanceof A.graph3d.Graph3dView){var q=V.scene;q&&q.shadow!=I&&y.shadowMap.setShadow(q.shadow,q.shadowParams);var p=T.a("sceneContext");p?(p.eye&&y.setEye(p.eye),p.center&&y.setCenter(p.center),Cp(p.far)&&y.setFar(p.far),Cp(p.near)&&y.setNear(p.near)):(Cp(T.a("sceneNear"))&&y.setNear(T.a("sceneNear")),Cp(T.a("sceneFar"))&&y.setFar(T.a("sceneFar")),q&&(q.eye&&y.setEye(q.eye),q.center&&y.setCenter(q.center))),Je(T.a("sceneShadowEnabled"))&&(T.a("sceneShadowEnabled")?y.enableShadow():y.disableShadow()),Cp(T.a("sceneShadowDegreeX"))&&y.setShadowDegreeX(T.a("sceneShadowDegreeX")),Cp(T.a("sceneShadowDegreeZ"))&&y.setShadowDegreeZ(T.a("sceneShadowDegreeZ")),Cp(T.a("sceneShadowIntensity"))&&y.setShadowIntensity(T.a("sceneShadowIntensity")),T.a("sceneShadowQuality")!=I&&y.setShadowQuality(T.a("sceneShadowQuality")),T.a("sceneShadowType")&&y.setShadowType(T.a("sceneShadowType")),Cp(T.a("sceneShadowRadius"))&&y.setShadowRadius(T.a("sceneShadowRadius")),Cp(T.a("sceneShadowBias"))&&y.setShadowBias(T.a("sceneShadowBias")),Je(T.a("sceneDashEnable"))&&y.setDashDisabled(!T.a("sceneDashEnable")),Fp(T.a("sceneHighlightMode"))&&y.setHighlightMode(T.a("sceneHighlightMode")),Cp(T.a("sceneHighlightWidth"))&&y.setHighlightWidth(T.a("sceneHighlightWidth")),T.a("sceneHighlightColor")&&y.setHighlightColor(T.a("sceneHighlightColor")),T.a("sceneHighlightType")&&y.setHighlightType(T.a("sceneHighlightType")),T.a("sceneHighlightGlow")&&y.setHighlightGlow(T.a("sceneHighlightGlow")),T.a("sceneHighlightStrength")&&y.setHighlightStrength(T.a("sceneHighlightStrength")),Je(T.a("sceneHeadlightEnable"))&&y.setHeadlightDisabled(!T.a("sceneHeadlightEnable")),Cp(T.a("sceneHeadlightRange"))&&y.setHeadlightRange(T.a("sceneHeadlightRange")),T.a("sceneHeadlightColor")&&y.setHeadlightColor(T.a("sceneHeadlightColor")),Cp(T.a("sceneHeadlightIntensity"))&&y.setHeadlightIntensity(T.a("sceneHeadlightIntensity")),Cp(T.a("sceneHeadlightAmbientIntensity"))&&y.setHeadlightAmbientIntensity(T.a("sceneHeadlightAmbientIntensity")),Cp(T.a("sceneHeadlightGroup"))&&y.setHeadlightGroup(T.a("sceneHeadlightGroup")),Je(T.a("sceneFogEnable"))&&y.setFogDisabled(!T.a("sceneFogEnable")),T.a("sceneFogMode")&&y.setFogMode(T.a("sceneFogMode")),Cp(T.a("sceneFogDensity"))&&y.setFogDensity(T.a("sceneFogDensity")),T.a("sceneFogColor")&&y.setFogColor(T.a("sceneFogColor")),Cp(T.a("sceneFogNear"))&&y.setFogNear(T.a("sceneFogNear")),Cp(T.a("sceneFogFar"))&&y.setFogFar(T.a("sceneFogFar")),Je(T.a("sceneBatchBrightnessDisabled"))&&y.setBatchBrightnessDisabled(T.a("sceneBatchBrightnessDisabled")),Je(T.a("sceneBatchBlendDisabled"))&&y.setBatchBlendDisabled(T.a("sceneBatchBlendDisabled")),Je(T.a("sceneBatchColorDisabled"))&&y.setBatchColorDisabled(T.a("sceneBatchColorDisabled")),T.a("sceneBatchInfoMap")&&y.setBatchInfoMap(T.a("sceneBatchInfoMap")),Cp(T.a("sceneMoveStep"))&&y.setMoveStep(T.a("sceneMoveStep")),Cp(T.a("sceneRotateStep"))&&y.setRotateStep(T.a("sceneRotateStep")),Je(T.a("sceneSortable"))&&y.setSortable(T.a("sceneSortable")),gg(T.a("sceneSortFunc"))&&y.setSortFunc(T.a("sceneSortFunc"));var X=T.a("sceneSkyboxType")||"sphere";if(X!=I){var K={},h=!1;if("sphere"===X){K.shape3d=X;var m=T.a("sceneSkyboxImage");m&&(K["shape3d.image"]=m,h=!0)}else K.shape3d=_,["front","back","left","right","top","bottom"].forEach(function(c){var l=c+".image",X=c.charAt(0).toUpperCase()+c.slice(1),R=T.a("sceneSkybox"+X+"Image");R&&(K[l]=R,h=!0)});if(h){var N=new jr,l=T.a("sceneSkyboxDiameter");Cp(l)?N.s3(l,l,l):N.s3(20,20,20),K["body.color"]=T.a("sceneSkyboxBodyColor"),K.envmap=T.a("sceneSkyboxEnvmap"),K["envmap.probe"]=T.a("sceneSkyboxEnvmapProbe"),K.roughness=T.a("sceneSkyboxRoughness"),K["shape3d.light"]=K["all.light"]=T.a("sceneSkyboxLight"),K["light.mask"]=T.a("sceneSkyboxLightMask"),K["headlight.ambientIntensity"]=T.a("sceneSkyboxHeadLightAmbientIntensity"),K["texture.wrap"]="clampToEdge",K["3d.clipbox.mask"]=Ak,K["effect.flow.mask"]=Ak,N.s(K),["X","Y","Z"].forEach(function(K){var r=T.a("sceneSkyboxRotation"+K);Cp(r)&&N["setRotation"+K](r)}),y.setSkybox(N)}}}},T.deserialize(S,X.rootParent,X)},B.isDebugTipShowing=function(){return!!this._debugDiv},B.showDebugTip=function(){var f=this,B=f._debugDiv;if(!B){B=f._debugDiv=K.createElement("div"),B.style.position="absolute",B.style.overflow="hidden",B.style.font=z.debugTipLabelFont,B.style.padding="6px",B.style.backgroundColor=z.debugTipBackground,B.style.color=z.debugTipLabelColor;var F=f.getView();f._79O?F.insertBefore(B,f._79O):F.appendChild(B);var r=function(){f.redraw();var w=f._canvas,k="FPS: "+f._fpsInfo.fps+"<br/>"+"Datas: "+f.dm().getDatas().length+(w?"<br/>Size: "+w.width+" * "+w.height:""),_=f.dm()._historyManager;_&&(k+="<br/>Undoes: "+_.getHistories().length+" index: "+_.getHistoryIndex());var i=f.getDebugTip();i&&(k+="<hr>"+i),B.innerHTML=k,f._isDebugging&&requestAnimationFrame(r)};requestAnimationFrame(r),f._isDebugging=!0}},B.hideDebugTip=function(){var j=this,q=j._debugDiv;q&&(delete j._debugDiv,j.getView().removeChild(q),j._isDebugging=!1)},B.updateDOMAppendMatrix=function(){var H=this.getView();H&&(H.updateAppendMatrix=!0)},B.countFrame=function(){if(this._isDebugging){var o=Date.now(),u=this._fpsInfo;o-u.time>1e3?(u.fps=Math.round(1e5*(u.frames+1)/(o-u.time))/100,u.time=o,u.frames=0):u.frames++}}},ms_icons:function(h){h.getRotation=function(o){return o==I?0:o},h._15O=function(){var M=this,a=M.s(lq);if(a){var P=M,U=M.data||M._data,b=M._38o={icons:a,rects:{}};for(var H in a){var V=a[H],S=ui(V.shape3d,U,P);if(!(ui(V.visible,U,P)===!1||ui(V.for3d,U,P)&&!M.I3d||S&&!M.I3d)){var N=S?[S]:ui(V.names,U,P),_=N?N.length:0,t=ui(V.position,U,P)||3,j=ui(V.offsetX,U,P)||0,n=ui(V.offsetY,U,P)||0,q=ui(V.direction,U,P)||Tm,A=ui(V.gap,U,P),X=A!=I?A:1,u=ui(V.rotation,U,P),f=ui(V.keepOrien,U,P),G=ui(V.rotationFixed,U,P)?u:M.getRotation(u,f,t),B=I,O=b.rects[H]=new Array(_);O.rotation=G;for(var h=0;_>h;h++){var E,C,w,r,T=N[h];if(S)w=0,r=0;else{var L=Gj(T);w=ui(V.width,U,P),r=ui(V.height,U,P),w==I&&(w=bi(L,U)),r==I&&(r=Eg(L,U))}if(B?q===Tm?j+=w/2:q===zp?j-=w/2:q===vs?n-=r/2:n+=r/2:B={width:w,height:r},M.I3d){var c=-w/2,v=-r/2;C={width:w,height:r,mat:M._16O(ui(V.autorotate,U,P),t,B,ui(V.face,U,P)||Pd,ui(V.t3,U,P),ui(V.r3,U,P),ui(V.rotationMode,U,P),j,n),vs:new _p([c,-v,0,c,-v-r,0,c+w,-v-r,0,c+w,-v,0])}}else E=M.getPosition(t,j,n,B,ui(V.positionFixed,U,P)),C={x:E.x-w/2,y:E.y-r/2,width:w,height:r},M._68o(C,G);O[h]=C,q===Tm?j+=w/2+X:q===zp?j-=w/2+X:q===vs?n-=r/2+X:n+=r/2+X}}}}}}});var fn={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},lh={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Po={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},ag={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},mj={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},_j={"edge.type":1,"edge.group":1},lg={rotation:1,rotationX:1,rotationZ:1,rotation3d:1},Kn={rotation:1,position:1,width:1,height:1,anchor:1,scale:1,host:1},ak={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Wp={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},sc={shape:1,thickness:1,position:1,anchor:1,scale:1},Jj=function(F){if(!F)return I;if(Rn(F)){var S=F._40I,Y=F._41I;if(!S||!Y)return I;var j=Jj(S),t=Jj(Y);return j===t?j:I}for(var R=F._parent;Rn(R)&&!R.ISubGraph;)R=R._parent;return R?R.ISubGraph?R:Jj(R):I},of=function(B,S,i,E){var c=S.getStyle(i)*E;c&&oh(B,c),c=S.getStyle(i+".left")*E,c&&(B.x-=c,B.width+=c),c=S.getStyle(i+".right")*E,c&&(B.width+=c),c=S.getStyle(i+".top")*E,c&&(B.y-=c,B.height+=c),c=S.getStyle(i+".bottom")*E,c&&(B.height+=c),B.width<0&&(B.width=-B.width,B.x-=B.width),B.height<0&&(B.height=-B.height,B.y-=B.height)},Kg=function(k){for(var Y,S=0,b=k.size();b>S;S++)if(Y=k.getChildAt(S),Fg(Y)&&Kg(Y))return!0;return k.hasAgentEdges()},ek=function(f){if(!f)return I;for(var L=f._parent;Re(L);){if(!Re(L._parent))return L.isExpanded()?f:L;L.isExpanded()||(f=L),L=L._parent}return f},Jh=function(f,v){if(!f||!v)return I;var q,L,G,k=Jj(f),g=Jj(v);if(k!==g){for(;g&&k!==g;)g=Jj(g);if(k===g)return f;q=new Gc,q.add(f,0);for(var j=f._parent;Fg(j)&&!v.isDescendantOf(j);)q.add(j,0),j=j._parent;for(G=q.size(),L=0;G>L;L++){var u=q.get(L);if(Re(u)&&!u.isExpanded())return u;if(u.ISubGraph)return u}return f}return f},fp=function(r){if(r.isLooped())return r._source;var p=ek(r._source),R=ek(r._target);return p===R?r._source:Jh(p,R)},ec=function(C){if(C.isLooped())return C._target;var k=ek(C._source),b=ek(C._target);return k===b?C._target:Jh(b,k)},Or=function(s,l,p){"target"!==p&&(p="source");var b="target"===p?l.getTargetAgent():l.getSourceAgent(),d="edge."+p+".";if(Rn(b)){var i=s.getDataUI(b);i._79o();var U=l.s(d+"index");if(U>=0){var x=sb(i);return x[Math.max(0,Math.min(U,x.length-1))]}var q=l.s(d+"percent")||0;q=Math.max(0,Math.min(q,1));var R=le(i);return Kp(R,100*q)}return rk(s,b,l.s(d+"position"),l.s(d+"offset.x"),l.s(d+"offset.y"),l.s(d+"anchor.x"),l.s(d+"anchor.y"))},rk=function(o,Q,X,Y,U,O,f){if(!Q)return I;var L,K=Q.getRotation?Q.getRotation():0;if(O!==_||f!==_){O=O===_?.5:O,f=f===_?.5:f;var C=Q.getScale();if(K&&!os(Q,o)||C.x<0||C.y<0){var A=Q.getPosition(),c=Q.getWidth(),w=Q.getHeight(),$=Q.getAnchor(),P=new Xl(K,A.x,A.y,C.x,C.y);X=P.tf((O-$.x)*c,(f-$.y)*w)}else L=Sc(o,Q),X={x:L.x+O*L.width,y:L.y+f*L.height}}else X=ni(X,Sc(o,Q));if(K){var Z=l(K),g=d(K),E=Y*Z-U*g;U=Y*g+U*Z,Y=E}return X.x+=Y,X.y+=U,X},Ol=function(G,Z){if(!G||!Z)return I;var O,V,Y,z,k,i;if(G===Z){if(z=G.getLoopedEdges(),!z)return I;z=new Gc(z)}else{if(k=G.getAgentEdges(),i=Z.getAgentEdges(),!k||!i)return I;for(V=k.size(),O=0;V>O;O++)Y=k.get(O),i.contains(Y)&&(z||(z=new Gc),z.add(Y))}if(z)for(O=0;O<z.size();O++)Y=z.get(O),Y.getStyle(hs)===Wq&&(Y._22I(I),z.removeAt(O),O--);return z},xp=function(_,n){var D=Ol(_,n);if(D&&!D.isEmpty()){if(1===D.size())return D.get(0)._22I(I),void 0;var G=new Gc,i=new Gc;D.each(function(B){var f=B.s("edge.group");G.contains(f)||G.add(f)}),G.sort(),G.each(function(F){i.add(new A.EdgeGroup(D.toList(function(z){return F===z.s("edge.group")}),i))}),i.each(function(X){X.each(function(M){M._22I(X)})})}},Ii=function(Q,c,Y){var j=Q._canvas;Q._zoom;var $=Qe(c,j),t=Qe(Y,j);return{x:$.x-t.x,y:$.y-t.y}},Yj=function(c,f){if(f){var j=f.rect,p=f.color,w=f.rotation,h=f.labelWidth,R=f.background,y=f.opacity,B=f.scale,r=B!=I&&1!==B;if(y!=I){var M=c.globalAlpha;c.globalAlpha*=y}if(w||r){c.save();var m=j.x+j.width/2,T=j.y+j.height/2;Fi(c,m,T),w&&Gd(c,w),r&&c.scale(B,B),Fi(c,-m,-T)}if(R&&Eq(c,j.x,j.y,j.width,j.height,R),h){var E=j.width,A=c.createLinearGradient(j.x,j.y,j.x+E,j.y);A.addColorStop(0,p),A.addColorStop(.9,p),A.addColorStop(1,ql),p=A,j.width=h}sn(c,f.ss,j,f.font,p,f.align,f.decoration),h&&(j.width=E),(w||r)&&c.restore(),y!=I&&(c.globalAlpha=M)}},ng=function(O,c){if(c){var j=c.rect,F=j.x,X=j.y,N=j.width,B=j.height,q=c.background,H=c.backgroundImage,E=c.borderWidth,d=c.borderColor,b=c.labelWidth,M=c.opacity,z=c.scale,e=z!=I&&1!==z;if(M!=I){var A=O.globalAlpha;O.globalAlpha*=M}if(e){O.save();var u=j.x+j.width/2,k=j.y+j.height/2;Fi(O,u,k),O.scale(z,z),Fi(O,-u,-k)}if(c.expanded){var l=a(8,N/4),n=X+B-8;if(O.fillStyle=q,O.beginPath(),O.moveTo(F,X),O.lineTo(F,n),O.lineTo(F+N/2,n),O.lineTo(F+N/2,X+B),O.lineTo(F+N/2+l,n),O.lineTo(F+N,n),O.lineTo(F+N,X),O.closePath(),O.fill(),E&&(O.lineWidth=E,O.lineJoin="round",O.lineCap="round",d?(O.strokeStyle=d,O.stroke()):(O.strokeStyle=df(q),O.beginPath(),O.moveTo(F+N,X),O.lineTo(F+N,n),O.lineTo(F+N/2+l,n),O.lineTo(F+N/2,X+B),O.stroke(),O.strokeStyle=tk(q),O.beginPath(),O.moveTo(F+N,X),O.lineTo(F,X),O.lineTo(F,n),O.lineTo(F+N/2,n),O.lineTo(F+N/2,X+B),O.stroke())),H)cq(O,Gj(H),og,j.x,j.y,j.width,j.height-8,c.data,c.view);else{if(j.height-=8,q=c.color,b){var o=N,i=O.createLinearGradient(F,X,F+o,X);i.addColorStop(0,q),i.addColorStop(.9,q),i.addColorStop(1,ql),q=i,j.width=b}sn(O,c.ss,j,c.font,q,c.align),b&&(j.width=o),j.height+=8}}else if(c.icon)jp(O,Gj(c.icon),F,X,N,B,c.data,c.view);else{var p=N/2;E&&(O.lineWidth=E,O.lineJoin="round",O.lineCap="round",O.strokeStyle=d?d:df(q),O.beginPath(),O.arc(F+p,X+p,p,Rg,1.6*h,!0),O.moveTo(F+p,X+B),O.lineTo(F+N-p/5,X+p),O.stroke(),O.strokeStyle=d?d:tk(q),O.beginPath(),O.arc(F+p,X+p,p,1.6*h,Rg,!0),O.moveTo(F+p,X+B),O.lineTo(F+p/5,X+p),O.stroke()),O.fillStyle=q,O.beginPath(),O.arc(F+p,X+p,p,0,$,!0),O.moveTo(F+p,X+B),O.lineTo(F+N-p/5,X+p),O.lineTo(F+p/5,X+p),O.closePath(),O.fill(),O.fillStyle=c.color,O.beginPath(),O.arc(F+p,X+p,p/3,0,$,!0),O.fill()}e&&O.restore(),M!=I&&(O.globalAlpha=A)}},qn=function(f,P){return P>2*f?f:P/2},_l=function(y,g,x,S){if(!y||!g)return 0;var _=id(g.y-y.y,g.x-y.x);return x||(_=g.x<y.x?_+h:_),_+S},Qi=function(g,K,P,L,m,A,c){c&&(g.x>K.x||g.x===K.x&&g.y>K.y)&&(P=Wj[P],m=-m);var H=ni(P,{x:0,y:0,width:Hd(g,K),height:0},A);return H.x+=L,H.y+=m,H=new Xl(id(K.y-g.y,K.x-g.x)).tf(H),H.x+=g.x,H.y+=g.y,H},Bn=function(c,J,m,e,o){if(c._19Q=!0,!m.getEdgeGroup())return e?m.s("edge.gap"):0;if(Rn(m.getSourceAgent())||Rn(m.getTargetAgent()))return 0;var D,Y=0,S=0,s=0;if(m.getEdgeGroup().getSiblings().each(function(q){q.each(function(v){if(J.isVisible(v)&&v.s(hs)==o){var T=v.s("edge.gap");D?(S+=s/2+T/2,s=T):(D=v,s=T),v===m&&(Y=S)}})}),e)return S-Y+s;var g=Y-S/2;return D&&m._40I!==D._40I&&(c._19Q=!1),g},Ge=function(p){var I=p._getValidSelection();if(1===I.length){var j=I[0],O=j instanceof A.Edge;if(j instanceof A.Shape||O){if(O){var t=j.s("edge.type");if(t&&"points"!==t)return}var c=p.gv;if((!c.isPointEditable||c.isPointEditable(j))&&c.isEditable(j))return j}}},Vg=function(){var S=function(J){var c=[];return J.forEach(function(S){c.push({x:S.x,y:S.y}),c.push({x:S.x+S.width,y:S.y+S.height}),c.push({x:S.x+S.width,y:S.y}),c.push({x:S.x,y:S.y+S.height})}),c};return function(Z,g,A){if("oval"===Z){var k=0,o=A.height/A.width,O=o*o,_=A.x+A.width/2,p=A.y+A.height/2,r=S(g);r.forEach(function(G){var g=G.x-_,D=G.y-p,M=g*g+D*D/O;M>k&&(k=M)}),k=w(k);var B=o*k;return{x:_-k,y:p-B,width:2*k,height:2*B}}if("circle"===Z){var D=0,_=A.x+A.width/2,p=A.y+A.height/2,r=S(g);return r.forEach(function(I){var X=I.x-_,c=I.y-p,w=X*X+c*c;w>D&&(D=w)}),D=w(D),{x:_-D,y:p-D,width:2*D,height:2*D}}return"roundRect"===Z?(oh(A,a(A.width,A.height)/16),A):A}}(),Ic=A.graph={},ll=function(F,z,m){Ag(e+".graph."+F,z,m)};A.layout={};var ac={},cl=function(L,p,w,$,o,g,W,M){var X=W._zoom;if(X!==W._cacheZoom&&(W._cacheZoom=X,W._cacheImage={}),X*=Ch,$=Math.ceil($),o=Math.ceil(o),$*X>2048||o*X>2048)return p;var h=[p.uuid,$,o,w].join("_");if(p.cacheRule){var m;m=gg(p.cacheRule)?p.cacheRule(g,W):ui(p.cacheRule,g,W),h+="_"+m}var T,v=1;o>=$&&v>$*X?(T=o/$,$=v/X,o=$*T):$>=o&&v>o*X&&(T=$/o,o=v/X,$=o*T),$=Math.ceil($),o=Math.ceil(o);var k=W._cacheImage[h];if(!k){if(ps(),k=A.Default.toCanvas(p,$,o,w,g,W,M,X),!ns())return p;W._cacheImage[h]=k}return k};Xi(z,{setImageCacheRule:function(Q,j){var w;j||"object"!=typeof Q?(w={},w[Q]=j):w=Q;for(var Z in w){var K=w[Z];Fp(Z)?(Ag=Gj(Z),Ag?Ag.cacheRule=K:ac[Z]=K):Z.cacheRule=K}}});var Ai={comps:[{type:eo,points:[85,50,70,115,100,71,86,107,88,49,57,71,79,110,77,107,90,100,118,75,81,84,51,98,43,48,52,84,52,100,110,65,85,105,74,49,119,105,100,97,121,51,69,61],borderWidth:1,borderColor:I}]};if(Ai[fe]=Ai[dj]=160,c.Image){var Zo=new c.Image;Zo.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",Se("default_blank",Zo)}Se("node_image",Lm(30,30,[{type:qk,rect:[4,5,22,16],gradient:uo,gradientColor:hf,background:Gp},{type:qk,rect:[2,3,26,20],borderWidth:1,borderColor:Gp},{type:qk,rect:[11,23,8,4],background:Gp},{type:qk,rect:[6,27,18,2],background:Gp}])),Se("node_icon",Lm(16,16,[{type:qk,rect:[2,2,12,10],gradient:uo,gradientColor:hf,background:Gp},{type:so,rect:[2,2,12,10],width:1,color:Gp},{type:qk,rect:[6,12,4,2],background:Gp},{type:qk,rect:[4,14,8,1],background:Gp}])),Se("block_icon",Lm(16,16,[{type:so,rect:[1,1,14,14],width:1,color:Gp}])),Se("group_image",Lm(66,39,[{type:qk,rect:[44.3,18,18.1,12.8],gradient:uo,gradientColor:hf,background:Gp},{type:qk,rect:[3.3,17.8,18.1,12.8],gradient:uo,gradientColor:hf,background:Gp},{type:qk,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Gp,gradient:uo,gradientColor:hf,background:Gp},{type:qk,rect:[26.2,29.4,12.8,4.2],background:Gp},{type:qk,rect:[21.3,33.5,22.5,2.3],background:Gp},{type:qk,rect:[5.3,32.7,14.1,2.1],background:Gp},{type:qk,rect:[9,30.4,6.7,2.4],background:Gp},{type:qk,rect:[50,30.7,6.7,2.4],background:Gp},{type:qk,rect:[46.3,33,14.1,2.1],background:Gp}])),Se("group_icon",Lm(16,16,[{type:qk,rect:[4,12,4,2],background:Gp},{type:qk,rect:[2,13,8,1],background:Gp},{type:qk,rect:[12,12,2,1],background:Gp},{type:qk,rect:[11,13,4,1],background:Gp},{type:qk,rect:[10,7,6,5],gradient:uo,gradientColor:hf,background:Gp},{type:qk,rect:[1,2,10,10],gradient:uo,gradientColor:hf,background:Gp},{type:so,rect:[1,2,10,10],width:1,color:Gp}])),Se("refGraph_icon",Lm(16,16,[{type:"shape",borderWidth:1,borderColor:Gp,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Gp,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),Se("edge_icon",Lm(16,16,[{type:qk,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:uo,gradientColor:hf,background:Gp},{type:qk,rect:[10.8,1,4,4],background:Gp},{type:qk,rect:[1,11,4,4],background:Gp}])),Se("subGraph_image",Lm(72,45,[{type:eo,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:uo,gradientColor:hf,background:Gp},{type:qk,rect:[29.6,30.7,3.6,1.8],background:Gp},{type:qk,rect:[28.4,32.3,6,1.2],background:Gp},{type:qk,rect:[37.3,32,10.8,1.8],background:Gp},{type:qk,rect:[39.1,29.9,7.2,2.3],background:Gp},{type:qk,rect:[26.6,23.7,9.6,7.2],gradient:uo,gradientColor:hf,background:Gp},{type:qk,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Gp,gradient:uo,gradientColor:hf,background:Gp}])),Se("subGraph_icon",Lm(17,17,[{type:eo,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:uo,gradientColor:hf,background:Gp}])),Se("shape_icon",Lm(16,16,[{type:eo,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Gp}])),Se("polyline_icon",Lm(16,16,[{type:eo,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Gp},Oo(7.5,.4),Oo(7.5,6.3),Oo(13.6,6.3),Oo(13.6,14),Oo(.7,13.9),Oo(.7,.3)])),Se("grid_icon",Lm(16,16,[{type:qk,rect:[1,1,4,4],background:Gp,gradient:uo,gradientColor:hf},{type:qk,rect:[6,1,4,4],background:Gp,gradient:uo,gradientColor:hf},{type:qk,rect:[11,1,4,4],background:Gp,gradient:uo,gradientColor:hf},{type:qk,rect:[11,6,4,4],background:Gp,gradient:uo,gradientColor:hf},{type:qk,rect:[6,6,4,4],background:Gp,gradient:uo,gradientColor:hf},{type:qk,rect:[1,6,4,4],background:Gp,gradient:uo,gradientColor:hf},{type:qk,rect:[11,11,4,4],background:Gp,gradient:uo,gradientColor:hf},{type:qk,rect:[6,11,4,4],background:Gp,gradient:uo,gradientColor:hf},{type:qk,rect:[1,11,4,4],background:Gp,gradient:uo,gradientColor:hf}])),Se("light_icon",Lm(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Gp},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Gp,gradient:uo,gradientColor:hf,background:{func:function(M){var p=M?M.s(Ml):I;return gc(p)?"rgb("+Fq(255*p[0])+","+Fq(255*p[1])+","+Fq(255*p[2])+")":p||Gp}}}])),Se("text_icon",Lm(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Gp}])),Se("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),Se("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),Se("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),Se("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var fm=function(E,J,y,s,Y,D){var M,i,n,I,R,c,x,d,p,Q,L,l=[];if(Math.abs(s)>2*Math.PI&&(s=2*Math.PI),R=Math.ceil(Math.abs(s)/(Math.PI/4)),M=s/R,i=-M,n=-y,R>0){c=E+Math.cos(y)*Y,x=J+Math.sin(-y)*D,l.push({x:c,y:x});for(var h=0;R>h;h++)n+=i,I=n-i/2,d=E+Math.cos(n)*Y,p=J+Math.sin(n)*D,Q=E+Math.cos(I)*(Y/Math.cos(i/2)),L=J+Math.sin(I)*(D/Math.cos(i/2)),l.push({x:Q,y:L}),l.push({x:d,y:p})}return l},tr=function(C){if(C){var t=C._data;if(t instanceof A.Shape)return{points:t.getPoints(),segments:t.getSegments()};var h;if(t instanceof A.Edge&&(h=C._78o)){var v,E,l=h.type,F=h.points,k=h.segments,n=h.edgeTypeInfo;if(!l||F){var L=h.sourcePoint,X=L.x,i=L.y,O=h.targetPoint,b=O.x,j=O.y;if(l)k?(v=new Gc({x:X,y:i}),v.addAll(F),v.add({x:b,y:j}),E=new Gc(k._as)):(v=new Gc({x:X,y:i}),F.each(function(z){v.add(z)}),v.add({x:b,y:j}));else if(h.looped){v=new Gc(fm(X,i,0,2*Math.PI,h.radius,h.radius)),E=new Gc([1]);for(var o=0;o<(v.size()-1)/2;o++)E.add(3)}else v=new Gc,h.center?(v.add({x:h.c1.x,y:h.c1.y}),v.add({x:X,y:i}),v.add({x:b,y:j}),v.add({x:h.c2.x,y:h.c2.y})):(v.add({x:X,y:i}),v.add({x:b,y:j}))}else n&&(v=new Gc(n.points._as),n.segments&&(E=new Gc(n.segments._as)));return{points:v,segments:E}}}},le=function(D,H,b){if(null==H){var B=tr(D);if(!B)return;H=B.points,b=B.segments}if(H){if(Array.isArray(H)&&(H=new Gc(H)),"number"==typeof H.get(0)){for(var V=new A.List,U=0;U<H.size();U+=2)V.add({x:H.get(U),y:H.get(U+1)});H=V}if(!b){b=[1];for(var Z=H.length-1;Z>0;Z--)b.push(2)}Array.isArray(b)&&(b=new Gc(b));for(var f=rb(H._as,b._as,50),o=f.length,M=[],U=0;o>U;U++){var Y=f[U];Y.length>1&&M.push(Y)}return M}},ml=function(c){for(var v=0,J=c.length-1,h=0;J>h;h++){var m=c[h],O=c[h+1],P=O.x-m.x,e=O.y-m.y;v+=Math.sqrt(P*P+e*e)}return v},Eo=function(W,q){for(var I=0,s=q.length,k=0;s>k;k++){var g=q[k];if(I+=g,I>W)return k}return Math.min(k,s-1)},Kd=function(r,O){for(var s=0,h=0,K=0,T=r.length-1,f=0;T>f;f++){var N=r[f],Q=r[f+1],q=Q.x-N.x,Y=Q.y-N.y;if(K=Math.sqrt(q*q+Y*Y),s+=K,s>O){s-=K,h=f;break}}var j=r[h],V=r[h+1],m=Math.atan2(V.y-j.y,V.x-j.x),U=O-s,Y=Math.sin(m)*U,q=Math.cos(m)*U;return{x:j.x+q,y:j.y+Y}},Kp=function(h,N){if(h){var D;if(0===N)D=h[0][0];else if(100===N)h=h[h.length-1],D=h[h.length-1];else{for(var k=0,Z=[],O=h.length,A=0;O>A;A++){var m=h[A],J=ml(m);k+=J,Z.push(J)}for(var o=k*N/100,g=Eo(o,Z),l=0,U=0;g>U;U++)l+=Z[U];o-=l,D=Kd(h[g],o)}return D}},sb=function(P){var b,J;if(P instanceof Em){var n=tr(P);b=n.points,J=n.segments}else b=arguments[0],J=arguments[1];var C,W,d,s,p=[],q=-1;for(W=0,d=J?J.length:b.length;d>W;W++){if(C=J?J.get(W):1,3===C)s=2;else if(4===C)s=3;else{if(5===C)continue;s=1}q+=s,p.push(b.get(q))}return p},Ub=function($,u,O,t){function H(h){if(h>=0&&1>=h){s=u(h);var U=($.x-s.x)*($.x-s.x)+($.y-s.y)*($.y-s.y);return r>U?(r=U,P=h,!0):!1}}O=O||100,t=t||1e-5;for(var r=1/0,P=0,s=new gr,i=0;O>i;++i)H(i/O);for(var f=1/(2*O);f>t;)H(P-f)||H(P+f)||(f/=2);return P};Xi(z,{_edgeProtectMethod:{getStraightLinePoints:le,calculateLineLength:ml,calcSegmentIndexByDistance:Eo,calculatePointAlongLine:Kd,getPercentPosition:Kp,getRealPointsFromDataUI:sb}});var hb=function(N,$){for(var z=N.vertices,V=0;V<z.length;V++){var D=z[V],F=D.y;D.y=D.z,D.z=-F,$&&(D.y+=$)}},Df=function(l){for(var k,J,y,W,f,o,g=[],U=[],r=[],q=l.faces,B=0,m=0,e=0,K=q.length;K>B;B++,m+=6,e+=9){var t=q[B];1===t.i?(k||(k=[],J=[],y=[]),Tn(t,B,m,e,l,k,y,J)):2===t.i?(W||(W=[],f=[],o=[]),Tn(t,B,m,e,l,W,o,f)):Tn(t,B,m,e,l,g,r,U)}return{vs:g,uv:U,ns:r,top_vs:k,top_uv:J,top_ns:y,bottom_vs:W,bottom_uv:f,bottom_ns:o}},Tn=function(f,u,d,T,o,p,s,W){var m=o.vertices,S=o.faceVertexUvs,l=m[f.a],j=m[f.b],I=m[f.c];p.push(l.x,l.y,l.z,j.x,j.y,j.z,I.x,I.y,I.z);var b,q,N,e=f.vertexNormals;3===e.length?(b=e[0],q=e[1],N=e[2]):b=q=N=f.normal,s.push(b.x,b.y,b.z,q.x,q.y,q.z,N.x,N.y,N.z);var g=S[0][u][0],J=S[0][u][1],x=S[0][u][2];W.push(g.x,g.y,J.x,J.y,x.x,x.y)},pl=function(_){var Q;Q=gc(_)?_:[_];var q,V,X,m,v,r,d,T,L=1/0,x=1/0,A=1/0,J=-1/0,R=-1/0,U=-1/0,D=["vs","top_vs","bottom_vs"];for(q=0,V=Q.length;V>q;q++)for(T=Q[q],X=0,m=D.length;m>X;X++)if(d=T[D[X]])for(v=0,r=d.length;r>v;v+=3)L=a(L,d[v]),x=a(x,d[v+1]),A=a(A,d[v+2]),J=i(J,d[v]),R=i(R,d[v+1]),U=i(U,d[v+2]);var H={min:{x:L,y:x,z:A},max:{x:J,y:R,z:U}};return _.boundingBox=H,H},Lo=function(){function O(l,w){return l.dot(w)>0}function E(d,e,i,Y,_,T,z){for(var D,t,W=[e,i,Y],Q=[_,T,z],m=[],k=W.length,N=!0;k--&&N;){for(var b=W[k],B=Q.length,n=!1;B--;)if(b.equals(Q[B])){Q.splice(B,1),m.push(b),n=!0;break}if(!n){if(D){N=!1;break}D=b}}return N&&2===m.length&&(t=Q[0],R.subVectors(D,m[0]),V.subVectors(t,m[0]),x.subVectors(D,m[1]),R.x*x.y*V.z+x.x*V.y*R.z+V.x*R.y*x.z-V.x*x.y*R.z-V.y*x.z*R.x-V.z*x.x*R.y<1e-6&&(S.subVectors(t,m[1]),o.subVectors(m[1],m[0]),O(o,R)&&O(o,V)&&(o.negate(),O(o,x)&&O(o,S))))?(d.push(m[1].x,m[1].y,m[1].z),d.push(D.x,D.y,D.z),d.push(D.x,D.y,D.z),d.push(m[0].x,m[0].y,m[0].z),d.push(m[0].x,m[0].y,m[0].z),d.push(t.x,t.y,t.z),d.push(t.x,t.y,t.z),d.push(m[1].x,m[1].y,m[1].z),2):(d.push(e.x,e.y,e.z),d.push(i.x,i.y,i.z),d.push(i.x,i.y,i.z),d.push(Y.x,Y.y,Y.z),d.push(Y.x,Y.y,Y.z),d.push(e.x,e.y,e.z),1)}function t(){this._vertexMap={},this._lineMap={},this._lineList=[]}function g(T,t,M,Q,I,R,P){var o=[M,I];T[0]===Q&&o.reverse();var G=[o[0]._key,o[1]._key].join("|"),C=T._triangles[G];C||(T._triangles[G]=C={});var U=[R._key,P._key].join("|");C[U]||(C[U]=[R,P])}function e(l,C,Q){var x=l._planes[Q._key];if(!x)for(var g in l._planes){var M=l._planes[g];if(M._normal.angleTo(Q)<.001){x=M;break}}return x?(x._vertices.indexOf(C)<0&&x._vertices.push(C),void 0):(l._planes[Q._key]={_normal:Q,_vertices:[C]},void 0)}function Z(M,$){return 0===$?"0|0|0":1/0===Math.abs($)?[M.x,M.y,M.z].join("|"):[Math.round(K.angleTo(M)*$),Math.round(s.angleTo(M)*$),Math.round(F.angleTo(M)*$)].join("|")}function Q(Y,g){var z=Y._ctlineModel;if(z||(Y._ctlineModel=z=[]),z[0])return z[0];var $;$=gc(Y)?Y:[Y];var c,T,R,p,_,e,N,G,y,d,f,v,K,U,O,Q,V,s,S,l=["","top_","bottom_"];z=[];var D=[];for(ms($,g,D),c=0,T=D.length;T>c;c++)if(d=D[c])for(Bk(d),R=0,p=l.length;p>R;R++)if(y=d[l[R]+"lvs"])for(V=z.length,s=y.length,z.length=V+s,S=0;s>S;++S,++V)z[V]=y[S];else if(N=d[l[R]+"vs"]){G=d[l[R]+"is"],e=G?G.length:N.length/3;for(var _=0;e-1>_;)G?(f=G[_],v=G[_+1],K=G[_+2],U=G[_+3],O=G[_+4],Q=G[_+5]):(f=_,v=_+1,K=_+2,U=_+3,O=_+4,Q=_+5),M.fromArray(N,3*f),B.fromArray(N,3*v),k.fromArray(N,3*K),A.fromArray(N,3*U),n.fromArray(N,3*O),i.fromArray(N,3*Q),_+=3*E(z,M,B,k,A,n,i);e>_&&(G?(f=G[_],v=G[_+1],K=G[_+2]):(f=_,v=_+1,K=_+2),M.fromArray(N,3*f),B.fromArray(N,3*v),k.fromArray(N,3*K),z.push(M.x,M.y,M.z),z.push(B.x,B.y,B.z),z.push(B.x,B.y,B.z),z.push(k.x,k.y,k.z),z.push(k.x,k.y,k.z),z.push(M.x,M.y,M.z))}return Y._ctlineModel[0]=z,z}function r($,e,E){var r=$._ctlineModel;r||($._ctlineModel=r=[]);var w=r[1];if(w&&w.epsilon===E)return w;w=[],w.epsilon=E;var D;D=gc($)?$:[$];var x,C,l,n,O,R,S,F,U,b,T,j,B=["","top_","bottom_"],g=new t,d=[];for(ms(D,e,d),x=0,C=d.length;C>x;x++)if(U=d[x])for(Bk(U),l=0,n=B.length;n>l;l++)if(S=U[B[l]+"vs"]){F=U[B[l]+"is"],R=F?F.length:S.length/3;for(var O=0,O=0;R>O;O+=3)F?(b=F[O],T=F[O+1],j=F[O+2]):(b=O,T=O+1,j=O+2),g._addTriangle(S,_,b,T,j,E)}return g._toLineVS(w),$._ctlineModel[1]=w,w}function X(P,n,x){var Q=P._ctlineModel;Q||(P._ctlineModel=Q=[]);var H=Q[2];if(H&&H.epsilon===x)return H;H=[],H.epsilon=x;var b;b=gc(P)?P:[P];var Z,B,h,v,k,K,i,V,T,D,A,W,X,z=["","top_","bottom_"],E=new t,N=[];for(ms(b,n,N),Z=0,B=N.length;B>Z;Z++)if(D=N[Z])for(Bk(D),h=0,v=z.length;v>h;h++)if(i=D[z[h]+"vs"]){V=D[z[h]+"is"],T=D[z[h]+"ns"],K=V?V.length:i.length/3;for(var k=0,k=0;K>k;k+=3)V?(A=V[k],W=V[k+1],X=V[k+2]):(A=k,W=k+1,X=k+2),E._addTriangle(i,T,A,W,X,x)}return E._toLineVS(H),P._ctlineModel[2]=H,H}var M=new ti,B=new ti,k=new ti,A=new ti,n=new ti,i=new ti,R=new ti,x=new ti,V=new ti,S=new ti,o=new ti,l=new ti;t.prototype._findVertex=function(h,w){l.fromArray(h,3*w);var J=[l.x,l.y,l.z].join(","),r=this._vertexMap[J];if(!r){var I=l.clone();I._key=J,this._vertexMap[J]=r=I}return r},t.prototype._findLine=function(C,z){var T=[C,z];C._key>z._key&&T.reverse(),T._key=[T[0]._key,T[1]._key].join("|");var I=this._lineMap[T._key];return I||(this._lineMap[T._key]=I=T,T._triangles={},T._planes={},this._lineList.push(T)),I
};var K=new ti(1,0,0),s=new ti(0,1,0),F=new ti(0,0,1),T=new ti,H=new ti;return t.prototype._addTriangle=function(E,Q,G,$,d,c){var p,I,R,Y=this._findVertex(E,G),z=this._findVertex(E,$),O=this._findVertex(E,d),x=this._findLine(Y,z),q=this._findLine(z,O),m=this._findLine(O,Y);Q?(p=(new ti).fromArray(Q,3*G),p._key=Z(p,c),I=(new ti).fromArray(Q,3*$),I._key=Z(I,c),R=(new ti).fromArray(Q,3*d),R._key=Z(R,c),g(x,Y,p,z,I,O,R),g(q,z,I,O,R,Y,p),g(m,O,R,Y,p,z,I)):(H.subVectors(O,z),T.subVectors(z,Y),p=(new ti).crossVectors(T,H),p._key=Z(p,c),e(x,O,p),e(q,Y,p),e(m,z,p))},t.prototype._toLineVS=function(B){for(var t=this._lineList,g=0,R=t.length;R>g;++g){var m=t[g],P=!1;for(var $ in m._triangles)if(1==j.keys(m._triangles[$]).length){B.push(m[0].x,m[0].y,m[0].z,m[1].x,m[1].y,m[1].z),P=!0;break}if(!P)for(var l in m._planes)if(1==m._planes[l]._vertices.length){B.push(m[0].x,m[0].y,m[0].z,m[1].x,m[1].y,m[1].z),P=!0;break}}},[Q,r,X]}(),Um=function(p,y){var C=p._lineModel;if(C)return C;var i;i=gc(p)?p:[p];var z,x,E,F,Z,G,H,S,r,d,A,v,D=["","top_","bottom_"];C=[];var J=[];for(ms(p,y,J),z=0,x=J.length;x>z;z++)if(r=J[z])for(E=0,F=D.length;F>E;E++)if(H=r[D[E]+"vs"]){S=r[D[E]+"is"],G=S?S.length:H.length/3;for(var Z=0;G>Z;Z+=3)S?(d=S[Z],A=S[Z+1],v=S[Z+2]):(d=Z,A=Z+1,v=Z+2),d*=3,A*=3,v*=3,C.push(H[d],H[d+1],H[d+2],H[A],H[A+1],H[A+2],H[A],H[A+1],H[A+2],H[v],H[v+1],H[v+2],H[v],H[v+1],H[v+2],H[d],H[d+1],H[d+2])}return p._lineModel=C,C},Hp=function(s,x,N,B,o,Q,Z,L,g,D){N==I&&(N=!0),B==I&&(B=!0),Z==I&&(Z=1),L==I&&(L=0);var l=new oc;Wb(l,s,x,g),l=l.toShapes();var O=_;return D&&(D.length?O={minX:D[0],minY:D[1],maxX:D[2],maxY:D[3]}:(O={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},l.forEach(function(S){var s=S.getBoundingBox();O.minX=a(s.minX,O.minX),O.minY=a(s.minY,O.minY),O.maxX=i(s.maxX,O.maxX),O.maxY=i(s.maxY,O.maxY)}))),Df(new Cl(l,{top:N,bottom:B,curveSegments:o,amount:Z,repeatUVLength:Q,boundingBox:O},-Z/2+L))},Wr=function(p,z){this.repeatUVLength=p,this._bb=z};Wr.prototype={generateTopUV:function(z,G,r,w,Q,E,X){var m,L,g,u,q=z.vertices,Y=q[w].x,B=q[w].y,b=q[Q].x,R=q[Q].y,A=q[E].x,N=q[E].y,k=this.repeatUVLength;if(k)m=0,L=0,g=k,u=k;else{this._bb||(this._bb=G.getBoundingBox());var t=this._bb;m=t.minX,L=t.minY,g=t.maxX-m,u=t.maxY-L}return X?[new Xp((Y-m)/g,(B-L)/u),new Xp((b-m)/g,(R-L)/u),new Xp((A-m)/g,(N-L)/u)]:[new Xp((Y-m)/g,1-(B-L)/u),new Xp((b-m)/g,1-(R-L)/u),new Xp((A-m)/g,1-(N-L)/u)]},generateBottomUV:function(n,s,d,q,Q,F){return this.generateTopUV(n,s,d,q,Q,F,!0)},generateSideWallUV:function(l,d,L,H,W,A,J,z,Y,O,e,D){if(!this._cl){for(var n,P,u=[],U=0,Z=L.length,_=0;Z>_;_++){n=L[_],P=L[(_+1)%Z];var y=n.x-P.x,F=n.y-P.y,o=w(y*y+F*F);u.push(U),U+=o}for(var _=0;Z>_;_++)u[_]/=U;this._cl=u}var u=this._cl,B=1-Y/O,s=1-(Y+1)/O,x=u[e],K=u[D];return K>x&&(x+=1),[new Xp(x,B),new Xp(K,B),new Xp(K,s),new Xp(x,s)]}};var Rl=function(K,c,r,$,Z,U){this.a=K,this.b=c,this.c=r,this.i=U,this.normal=$ instanceof Eb?$:new Eb,this.vertexNormals=$ instanceof Array?$:[]};Rl.prototype={constructor:Rl};var ho=[-8,14,-3,10,3,12,0,4,-1],Jb=function(){if(Jb[Mj]!=I)return Jb[Mj];for(var l=Sn[Mj],M=ho,U=Nj.prototype.getClassName(),w='"',H=0,L="",T=!1,A=+new(c[U.substr(3,3)+rh[H]]),p=H;p<M.length;p++){var E=M.length-p;L+=p%2===H?M[p]+E+"":M[p]-E+""}for(var p=H;4>p;p++)L+=H;if(L=L*L.length/L.length,A>L){if(l&&l[H]&&l[4/qk.length]){for(var e,q,R,Q,f,D,V,j,Y=l[0],J=l[1],x="",C=0,p=0;p<J.length;p++)J[p]===w?j?(j=!1,0!==C%2&&(e==I?e=x:q==I?q=x:R==I?R=x:Q==I?Q=x:f==I?f=x:D==I?D=x:V==I&&(V=x)),C++,x=""):j=!0:j&&(x+=J[p]);for(var z,y,B,r="",h=0,p=0;p<Y.length;p++)Y[p]===w?z?(z=!1,0!==h%2&&(y==I?y=r:B==I&&(B=r)),h++,r=""):z=!0:z&&(r+=Y[p]);var F=e+q+R+Q+f+D,O=!D||D===Cf;if(!O&&D)for(var S,p=0,k=D.length;k>p;p++)D[p]===hn[4]?S===Cf?O=Mr:S[0]===On[7]&&Cf&&Cf.indexOf(S.substr(1))>=0?O=qm:S=I:(S==I?S=D[p]:S+=D[p],p===k-1&&(S===Cf?O=Mr:S[0]===On[7]&&Cf&&Cf.indexOf(S.substr(1))>=0&&(O=qm)));(T=gh(F,V)&&gh(y,B)&&y===e&&O&&(!f||f>A))&&R.indexOf(Np[0])>=0&&(Jb[Np[0]]=1),T&&R.indexOf(1)>=0&&(Jb[1]=1),T&&R.indexOf(3)>=0&&(Jb[2]=1),T&&R.indexOf(4)>=0&&(Jb[3]=1),T&&R.indexOf(7)>=0&&(Jb[4]=1),T&&R.indexOf(Vi[1])>=0&&(Jb[Vi[1]]=1)}}else T=!0,Jb[Np[0]]=Jb[1]=Jb[2]=Jb[3]=Jb[4]=Jb[Vi[1]]=1;return Jb[Mj]=T,T},ii=function(){},Pf=ii.prototype;Pf.getPointAt=function(S){var C=this.getUtoTmapping(S);return this.getPoint(C)},Pf.getPoints=function(E){E||(E=5);var f,n=[];for(f=0;E>=f;f++)n.push(this.getPoint(f/E));return n},Pf.getSpacedPoints=function(t){t||(t=5);var Y,v=[];for(Y=0;t>=Y;Y++)v.push(this.getPointAt(Y/t));return v},Pf.getLength=function(){var m=this.getLengths();return m[m.length-1]},Pf.getLengths=function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,N,q=[],p=this.getPoint(0),u=0;for(q.push(0),N=1;t>=N;N++)e=this.getPoint(N/t),u+=e.distanceTo(p),q.push(u),p=e;return this.cacheArcLengths=q,q},Pf.getUtoTmapping=function(A,l){var t,Z=this.getLengths(),V=0,E=Z.length;t=l?l:A*Z[E-1];for(var T,Y=0,w=E-1;w>=Y;)if(V=k(Y+(w-Y)/2),T=Z[V]-t,0>T)Y=V+1;else{if(!(T>0)){w=V;break}w=V-1}if(V=w,Z[V]==t){var n=V/(E-1);return n}var d=Z[V],$=Z[V+1],u=$-d,s=(t-d)/u,n=(V+s)/(E-1);return n},Pf.getTangent=function(o){var i=1e-4,F=o-i,y=o+i;0>F&&(F=0),y>1&&(y=1);var r=this.getPoint(F),c=this.getPoint(y),W=c.clone().sub(r);return W.normalize()},Pf.getTangentAt=function(V){var g=this.getUtoTmapping(V);return this.getTangent(g)},ii.create=function(o,a){return o.prototype=ck(ii.prototype),o.prototype.getPoint=a,o};var en=function(){this.curves=[],this.autoClose=!1},qe=en.prototype=ck(Pf);qe.add=function(f){this.curves.push(f)},qe.closePath=function(){var w=this.curves[0].getPoint(0),H=this.curves[this.curves.length-1].getPoint(1);w.equals(H)||this.curves.push(new rn(H,w))},qe.getPoint=function(Y){for(var k,s,e=Y*this.getLength(),z=this.getCurveLengths(),Q=0;Q<z.length;){if(z[Q]>=e){k=z[Q]-e,s=this.curves[Q];var g=1-k/s.getLength();return s.getPointAt(g)}Q++}return null},qe.getLength=function(){var K=this.getCurveLengths();return K[K.length-1]},qe.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var y,S=[],U=0,c=this.curves.length;for(y=0;c>y;y++)U+=this.curves[y].getLength(),S.push(U);return this.cacheLengths=S,S},qe.getTransformedPoints=function(_){return this.getPoints(_)},qe.getBoundingBox=function(){var u,V,j,t,h,o,z=this.getPoints();u=V=Number.NEGATIVE_INFINITY,t=h=Number.POSITIVE_INFINITY;var E,B,K,Z,S=z[0]instanceof Eb;for(Z=S?new Eb:new Xp,B=0,K=z.length;K>B;B++)E=z[B],E.x>u&&(u=E.x),E.x<t&&(t=E.x),E.y>V&&(V=E.y),E.y<h&&(h=E.y),S&&(E.z>j&&(j=E.z),E.z<o&&(o=E.z)),Z.add(E);var v={minX:t,minY:h,maxX:u,maxY:V};return S&&(v.maxZ=j,v.minZ=o),v};var fi=function(P){en.call(this),this.actions=[],P&&this.fromPoints(P)},Hr=fi.prototype=ck(en.prototype),Lb="moveTo",Ip="lineTo",Wk="quadraticCurveTo",ts="bezierCurveTo",_m="arc",yg="ellipse";Hr.fromPoints=function(y){this.moveTo(y[0].x,y[0].y);for(var z=1,A=y.length;A>z;z++)this.lineTo(y[z].x,y[z].y)},Hr.moveTo=function(){var R=Array.prototype.slice.call(arguments);this.actions.push({action:Lb,args:R})},Hr.lineTo=function(M,e){var P=Array.prototype.slice.call(arguments),u=this.actions[this.actions.length-1].args,g=u[u.length-2],I=u[u.length-1],T=new rn(new Xp(g,I),new Xp(M,e));this.curves.push(T),this.actions.push({action:Ip,args:P})},Hr.quadraticCurveTo=function(w,C,h,A){var v=Array.prototype.slice.call(arguments),L=this.actions[this.actions.length-1].args,M=L[L.length-2],K=L[L.length-1],I=new As(new Xp(M,K),new Xp(w,C),new Xp(h,A));this.curves.push(I),this.actions.push({action:Wk,args:v})},Hr.bezierCurveTo=function(P,S,y,A,Z,Y){var m=Array.prototype.slice.call(arguments),s=this.actions[this.actions.length-1].args,v=s[s.length-2],N=s[s.length-1],V=new Fk(new Xp(v,N),new Xp(P,S),new Xp(y,A),new Xp(Z,Y));this.curves.push(V),this.actions.push({action:ts,args:m})},Hr.arc=function(R,p,N,h,f,s){var X=this.actions[this.actions.length-1].args,U=X[X.length-2],C=X[X.length-1];this.absarc(R+U,p+C,N,h,f,s)},Hr.absarc=function(i,P,K,h,F,e){this.absellipse(i,P,K,K,h,F,e)},Hr.ellipse=function(q,m,S,R,i,c,U){var o=this.actions[this.actions.length-1].args,z=o[o.length-2],F=o[o.length-1];this.absellipse(q+z,m+F,S,R,i,c,U)},Hr.absellipse=function(j,N,n,_,v,g,y){var $=Array.prototype.slice.call(arguments),T=new bo(j,N,n,_,v,g,y);this.curves.push(T);var t=T.getPoint(1);$.push(t.x),$.push(t.y),this.actions.push({action:yg,args:$})},Hr.getSpacedPoints=function(w){w||(w=40);for(var k=[],I=0;w>I;I++)k.push(this.getPoint(I/w));return k},Hr.getPoints=function(x,Q){x=x||12;var p,D,N,c,E,O,i,R,T,g,a,A,h,V,P,H,C,t,r=[];for(p=0,D=this.actions.length;D>p;p++)switch(N=this.actions[p],c=N.action,E=N.args,c){case Lb:r.push(new Xp(E[0],E[1]));break;case Ip:r.push(new Xp(E[0],E[1]));break;case Wk:for(O=E[2],i=E[3],g=E[0],a=E[1],r.length>0?(V=r[r.length-1],A=V.x,h=V.y):(V=this.actions[p-1].args,A=V[V.length-2],h=V[V.length-1]),P=1;x>=P;P++)H=P/x,C=Jk.b2(H,A,g,O),t=Jk.b2(H,h,a,i),r.push(new Xp(C,t));break;case ts:for(O=E[4],i=E[5],g=E[0],a=E[1],R=E[2],T=E[3],r.length>0?(V=r[r.length-1],A=V.x,h=V.y):(V=this.actions[p-1].args,A=V[V.length-2],h=V[V.length-1]),P=1;x>=P;P++)H=P/x,C=Jk.b3(H,A,g,R,O),t=Jk.b3(H,h,a,T,i),r.push(new Xp(C,t));break;case _m:var M,v=E[0],e=E[1],J=E[2],W=E[3],I=E[4],F=!!E[5],B=I-W,b=2*x;for(P=1;b>=P;P++)H=P/b,F||(H=1-H),M=W+H*B,C=v+J*l(M),t=e+J*d(M),r.push(new Xp(C,t));break;case yg:var M,v=E[0],e=E[1],$=E[2],Z=E[3],W=E[4],I=E[5],F=!!E[6],B=I-W,b=2*x;for(P=1;b>=P;P++)H=P/b,F||(H=1-H),M=W+H*B,C=v+$*l(M),t=e+Z*d(M),r.push(new Xp(C,t))}var K,Y,X=s["shape3d.point.epsilon"],L=!1;for(D=r.length,p=0,D=r.length;D>p;p++)K=r[p],Y=p===D-1?r[0]:r[p+1],K&&Y&&f(K.x-Y.x)<X&&f(K.y-Y.y)<X&&(L=!0,r[p]=null);if(L){var _=[];for(p=0;D>p;p++)r[p]&&_.push(r[p]);r=_}return Q&&r.push(r[0]),r},Hr.toShapes=function(x,z){function H(X){var E,L,$,g,x,B=[],S=new fi;for(E=0,L=X.length;L>E;E++)$=X[E],x=$.args,g=$.action,g==Lb&&0!=S.actions.length&&(B.push(S),S=new fi),S[g].apply(S,x);return 0!=S.actions.length&&B.push(S),B}function G(b){for(var m=[],s=0,R=b.length;R>s;s++){var r=b[s],P=new oc;P.actions=r.actions,P.curves=r.curves,m.push(P)}return m}function b(e,j){for(var g=1e-10,$=j.length,v=!1,N=$-1,i=0;$>i;N=i++){var P=j[N],B=j[i],Z=B.x-P.x,X=B.y-P.y;if(f(X)>g){if(0>X&&(P=j[i],Z=-Z,B=j[N],X=-X),e.y<P.y||e.y>B.y)continue;if(e.y==P.y){if(e.x==P.x)return!0}else{var R=X*(e.x-P.x)-Z*(e.y-P.y);if(0==R)return!0;if(0>R)continue;v=!v}}else{if(e.y!=P.y)continue;if(B.x<=e.x&&e.x<=P.x||P.x<=e.x&&e.x<=B.x)return!0}}return v}var j=H(this.actions);if(0==j.length)return[];if(z===!0)return G(j);var w,Z,I,v=[];if(1==j.length)return Z=j[0],I=new oc,I.actions=Z.actions,I.curves=Z.curves,v.push(I),v;var B=!Jk.isClockWise(j[0].getPoints());B=x?!B:B;var o,K=[],Y=[],P=[],a=0;Y[a]=_,P[a]=[];var r,d;for(r=0,d=j.length;d>r;r++)Z=j[r],o=Z.getPoints(),w=Jk.isClockWise(o),w=x?!w:w,w?(!B&&Y[a]&&a++,Y[a]={s:new oc,p:o},Y[a].s.actions=Z.actions,Y[a].s.curves=Z.curves,B&&a++,P[a]=[]):P[a].push({h:Z,p:o[0]});if(!Y[0])return G(j);if(Y.length>1){for(var q=!1,W=[],m=0,O=Y.length;O>m;m++)K[m]=[];for(var m=0,O=Y.length;O>m;m++){Y[m];for(var D=P[m],V=0;V<D.length;V++){for(var F=D[V],R=!0,$=0;$<Y.length;$++)b(F.p,Y[$].p)&&(m!=$&&W.push({froms:m,tos:$,hole:V}),R?(R=!1,K[$].push(F)):q=!0);R&&K[m].push(F)}}W.length>0&&(q||(P=K))}var N,X,S;for(r=0,d=Y.length;d>r;r++)for(I=Y[r].s,v.push(I),N=P[r],X=0,S=N.length;S>X;X++)I.holes.push(N[X].h);return v};var oc=function(){fi.apply(this,arguments),this.holes=[]},qi=oc.prototype=ck(Hr);qi.getPointsHoles=function(L){var y,K=this.holes.length,R=[];for(y=0;K>y;y++)R[y]=this.holes[y].getTransformedPoints(L);return R},qi.extractAllPoints=function(V){return{shape:this.getTransformedPoints(V),holes:this.getPointsHoles(V)}},qi.extractPoints=function(W){return this.extractAllPoints(W)};var Jk={triangulateShape:function(t,R){function j(p,O,n){return p.x!=O.x?p.x<O.x?p.x<=n.x&&n.x<=O.x:O.x<=n.x&&n.x<=p.x:p.y<O.y?p.y<=n.y&&n.y<=O.y:O.y<=n.y&&n.y<=p.y}function w(e,s,S,o,l){var N=1e-10,W=s.x-e.x,x=s.y-e.y,t=o.x-S.x,y=o.y-S.y,n=e.x-S.x,w=e.y-S.y,a=x*t-W*y,h=x*n-W*w;if(f(a)>N){var X;if(a>0){if(0>h||h>a)return[];if(X=y*n-t*w,0>X||X>a)return[]}else{if(h>0||a>h)return[];if(X=y*n-t*w,X>0||a>X)return[]}if(0==X)return!l||0!=h&&h!=a?[e]:[];if(X==a)return!l||0!=h&&h!=a?[s]:[];if(0==h)return[S];if(h==a)return[o];var z=X/a;return[{x:e.x+z*W,y:e.y+z*x}]}if(0!=h||y*n!=t*w)return[];var O=0==W&&0==x,U=0==t&&0==y;if(O&&U)return e.x!=S.x||e.y!=S.y?[]:[e];if(O)return j(S,o,e)?[e]:[];if(U)return j(e,s,S)?[S]:[];var _,M,k,C,D,R,Z,p;return 0!=W?(e.x<s.x?(_=e,k=e.x,M=s,C=s.x):(_=s,k=s.x,M=e,C=e.x),S.x<o.x?(D=S,Z=S.x,R=o,p=o.x):(D=o,Z=o.x,R=S,p=S.x)):(e.y<s.y?(_=e,k=e.y,M=s,C=s.y):(_=s,k=s.y,M=e,C=e.y),S.y<o.y?(D=S,Z=S.y,R=o,p=o.y):(D=o,Z=o.y,R=S,p=S.y)),Z>=k?Z>C?[]:C==Z?l?[]:[D]:p>=C?[D,M]:[D,R]:k>p?[]:k==p?l?[]:[_]:p>=C?[_,M]:[_,R]}function s(W,l,N,Q){var h=1e-10,t=l.x-W.x,K=l.y-W.y,s=N.x-W.x,v=N.y-W.y,k=Q.x-W.x,w=Q.y-W.y,H=t*v-K*s,G=t*w-K*k;if(f(H)>h){var A=k*v-w*s;return H>0?G>=0&&A>=0:G>=0||A>=0}return G>0}function i(o,g){function X(P,F){var f=E.length-1,j=P-1;0>j&&(j=f);var v=P+1;v>f&&(v=0);var p=s(E[P],E[j],E[v],k[F]);if(!p)return!1;var z=k.length-1,d=F-1;0>d&&(d=z);var Y=F+1;return Y>z&&(Y=0),p=s(k[F],k[d],k[Y],E[P]),p?!0:!1}function N(t,y){var L,R,v;for(L=0;L<E.length;L++)if(R=L+1,R%=E.length,v=w(t,y,E[L],E[R],!0),v.length>0)return!0;return!1}function i(o,W){var u,J,I,c,e;for(u=0;u<D.length;u++)for(J=g[D[u]],I=0;I<J.length;I++)if(c=I+1,c%=J.length,e=w(o,W,J[I],J[c],!0),e.length>0)return!0;return!1}for(var k,U,n,d,b,f,J,O,l,p,h,E=o.concat(),D=[],P=[],G=0,a=g.length;a>G;G++)D.push(G);for(var e=0,t=2*D.length;D.length>0&&(t--,!(0>t));)for(n=e;n<E.length;n++){d=E[n],U=-1;for(var G=0;G<D.length;G++)if(f=D[G],J=d.x+":"+d.y+":"+f,P[J]===_){k=g[f];for(var S=0;S<k.length;S++)if(b=k[S],X(n,S)&&!N(d,b)&&!i(d,b)){U=S,D.splice(G,1),O=E.slice(0,n+1),l=E.slice(n),p=k.slice(U),h=k.slice(0,U+1),E=O.concat(p).concat(h).concat(l),e=n;break}if(U>=0)break;P[J]=!0}if(U>=0)break}return E}for(var M,P,L,C,K,z,c={},N=t.concat(),x=0,g=R.length;g>x;x++)Array.prototype.push.apply(N,R[x]);for(M=0,P=N.length;P>M;M++)K=N[M].x+":"+N[M].y,c[K]!==_,c[K]=M;var h=i(t,R),y=Ap.Triangulate(h,!1);for(M=0,P=y.length;P>M;M++)for(C=y[M],L=0;3>L;L++)K=C[L].x+":"+C[L].y,z=c[K],z!==_&&(C[L]=z);return y.concat()},isClockWise:function(y){return Ap.Triangulate.area(y)<0},b2p0:function(v,Y){var Z=1-v;return Z*Z*Y},b2p1:function(k,v){return 2*(1-k)*k*v},b2p2:function(p,S){return p*p*S},b2:function(l,R,Q,y){return this.b2p0(l,R)+this.b2p1(l,Q)+this.b2p2(l,y)},b3p0:function(Z,k){var K=1-Z;return K*K*K*k},b3p1:function(I,k){var W=1-I;return 3*W*W*I*k},b3p2:function(E,M){var T=1-E;return 3*T*E*E*M},b3p3:function(u,f){return u*u*u*f},b3:function(I,f,N,g,k){return this.b3p0(I,f)+this.b3p1(I,N)+this.b3p2(I,g)+this.b3p3(I,k)}},Ap={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var r=j.keys(this.faces);return r.length?r[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(N){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(U){var s=U.familyName.toLowerCase(),k=this;return k.faces[s]=k.faces[s]||{},k.faces[s][U.cssFontWeight]=k.faces[s][U.cssFontWeight]||{},k.faces[s][U.cssFontWeight][U.cssFontStyle]=U,U},drawText:function(E){var D,h=this.getFace(),I=this.size/h.resolution,i=0,l=String(E).split(""),H=l.length,f=[];for(D=0;H>D;D++){var u=new fi,x=this.extractGlyphPoints(l[D],h,I,i,u);x&&(i+=x.offset*this.spacing,f.push(x.path))}var Y=i/2;return{paths:f,offset:Y}},extractGlyphPoints:function(e,k,T,F,P){var N,I,X,M,w,a,y,c,$,x,A,d,U,t,L,S,Y,G,Z,i=[],W=k.glyphs[e]||k.glyphs["?"];if(W){if(W.o)for(M=W._cachedOutline||(W._cachedOutline=W.o.split(" ")),a=M.length,y=T,c=T,N=0;a>N;)switch(w=M[N++]){case"m":$=M[N++]*y+F,x=M[N++]*c,P.moveTo($,x);break;case"l":$=M[N++]*y+F,x=M[N++]*c,P.lineTo($,x);break;case"q":if(A=M[N++]*y+F,d=M[N++]*c,L=M[N++]*y+F,S=M[N++]*c,P.quadraticCurveTo(L,S,A,d),Z=i[i.length-1])for(U=Z.x,t=Z.y,I=1,X=this.divisions;X>=I;I++){var R=I/X;Jk.b2(R,U,L,A),Jk.b2(R,t,S,d)}break;case"b":if(A=M[N++]*y+F,d=M[N++]*c,L=M[N++]*y+F,S=M[N++]*c,Y=M[N++]*y+F,G=M[N++]*c,P.bezierCurveTo(L,S,Y,G,A,d),Z=i[i.length-1])for(U=Z.x,t=Z.y,I=1,X=this.divisions;X>=I;I++){var R=I/X;Jk.b3(R,U,L,Y,A),Jk.b3(R,t,S,G,d)}}return{offset:W.ha*T,path:P}}}};Ap.generateShapes=function(C,L){L=L||{};var g=L.font;if(g===_&&(g=Ap.getDefaultFont(),!g))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var S=L.size!==_?L.size:1,O=L.curveSegments!==_?L.curveSegments:4,M=L.spacing!==_?L.spacing:1,k=L.weight!==_?L.weight:"normal",Z=L.style!==_?L.style:"normal";Ap.size=S,Ap.divisions=O,Ap.face=g,Ap.weight=k,Ap.style=Z,Ap.spacing=M;for(var j=Ap.drawText(C),r=j.paths,s=[],W=0,y=r.length;y>W;W++)Array.prototype.push.apply(s,r[W].toShapes());return s},function(b){var l=1e-10,V=function(T,D){var G=T.length;if(3>G)return null;var _,w,F,b=[],v=[],O=[];if(u(T)>0)for(w=0;G>w;w++)v[w]=w;else for(w=0;G>w;w++)v[w]=G-1-w;var J=G,A=2*J;for(w=J-1;J>2;){if(A--<=0)return D?O:b;if(_=w,_>=J&&(_=0),w=_+1,w>=J&&(w=0),F=w+1,F>=J&&(F=0),k(T,_,w,F,J,v)){var j,n,s,M,X;for(j=v[_],n=v[w],s=v[F],b.push([T[j],T[n],T[s]]),O.push([v[_],v[w],v[F]]),M=w,X=w+1;J>X;M++,X++)v[M]=v[X];J--,A=2*J}}return D?O:b},u=function(A){for(var m=A.length,Z=0,e=m-1,f=0;m>f;e=f++)Z+=A[e].x*A[f].y-A[f].x*A[e].y;return.5*Z},k=function(G,h,n,D,p,B){var F,U,W,o,S,k,K,V,e;if(U=G[B[h]].x,W=G[B[h]].y,o=G[B[n]].x,S=G[B[n]].y,k=G[B[D]].x,K=G[B[D]].y,l>(o-U)*(K-W)-(S-W)*(k-U))return!1;var A,f,O,b,N,_,j,m,T,y,x,w,r,Y,L;for(A=k-o,f=K-S,O=U-k,b=W-K,N=o-U,_=S-W,F=0;p>F;F++)if(V=G[B[F]].x,e=G[B[F]].y,!(V===U&&e===W||V===o&&e===S||V===k&&e===K)&&(j=V-U,m=e-W,T=V-o,y=e-S,x=V-k,w=e-K,L=A*y-f*T,r=N*m-_*j,Y=O*w-b*x,L>=-l&&Y>=-l&&r>=-l))return!1;return!0};return b.Triangulate=V,b.Triangulate.area=u,b}(Ap),c._typeface_js={faces:Ap.faces,loadFace:Ap.loadFace};var Kh=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},ee=Kh.prototype={constructor:Kh,computeFaceNormals:function(){for(var E=new Eb,r=new Eb,c=0,S=this.faces.length;S>c;c++){var m=this.faces[c],p=this.vertices[m.a],n=this.vertices[m.b],g=this.vertices[m.c];E.subVectors(g,n),r.subVectors(p,n),E.cross(r),E.normalize(),m.normal.copy(E)}},computeVertexNormals:function($){var J,A,x,C,j,X;for(X=new Array(this.vertices.length),J=0,A=this.vertices.length;A>J;J++)X[J]=new Eb;if($){var p,V,U,W=new Eb,c=new Eb;for(x=0,C=this.faces.length;C>x;x++)j=this.faces[x],p=this.vertices[j.a],V=this.vertices[j.b],U=this.vertices[j.c],W.subVectors(U,V),c.subVectors(p,V),W.cross(c),X[j.a].add(W),X[j.b].add(W),X[j.c].add(W)}else for(x=0,C=this.faces.length;C>x;x++)j=this.faces[x],X[j.a].add(j.normal),X[j.b].add(j.normal),X[j.c].add(j.normal);for(J=0,A=this.vertices.length;A>J;J++)X[J].normalize();for(x=0,C=this.faces.length;C>x;x++)j=this.faces[x],j.vertexNormals[0]=X[j.a].clone(),j.vertexNormals[1]=X[j.b].clone(),j.vertexNormals[2]=X[j.c].clone()},mergeVertices:function(){var Y,c,G,I,F,q,Z,N,n={},L=[],r=[],B=4,P=D(10,B);for(G=0,I=this.vertices.length;I>G;G++)Y=this.vertices[G],c=b(Y.x*P)+"_"+b(Y.y*P)+"_"+b(Y.z*P),n[c]===_?(n[c]=G,L.push(this.vertices[G]),r[G]=L.length-1):r[G]=r[n[c]];var m=[];for(G=0,I=this.faces.length;I>G;G++){F=this.faces[G],F.a=r[F.a],F.b=r[F.b],F.c=r[F.c],q=[F.a,F.b,F.c];for(var g=0;3>g;g++)if(q[g]==q[(g+1)%3]){m.push(G);break}}for(G=m.length-1;G>=0;G--){var w=m[G];for(this.faces.splice(w,1),Z=0,N=this.faceVertexUvs.length;N>Z;Z++)this.faceVertexUvs[Z].splice(w,1)}var j=this.vertices.length-L.length;return this.vertices=L,j}},bo=function(L,i,X,D,p,o,f){this.aX=L,this.aY=i,this.xRadius=X,this.yRadius=D,this.aStartAngle=p,this.aEndAngle=o,this.aClockwise=f};bo.prototype=ck(Pf),bo.prototype.getPoint=function(b){var n,S=this.aEndAngle-this.aStartAngle;0>S&&(S+=$),S>$&&(S-=$),n=this.aClockwise===!0?this.aEndAngle+(1-b)*($-S):this.aStartAngle+b*S;var V=this.aX+this.xRadius*l(n),X=this.aY+this.yRadius*d(n);return new Xp(V,X)};var rn=function(W,M){this.v1=W,this.v2=M},vl=rn.prototype=ck(Pf);vl.getPoint=function(D){var X=this.v2.clone().sub(this.v1);return X.multiplyScalar(D).add(this.v1),X},vl.getPointAt=function(P){return this.getPoint(P)},vl.getTangent=function(){var G=this.v2.clone().sub(this.v1);return G.normalize()};var As=function(T,d,$){this.v0=T,this.v1=d,this.v2=$};As.prototype=ck(Pf),As.prototype.getPoint=function(o){var Q,u;return Q=Jk.b2(o,this.v0.x,this.v1.x,this.v2.x),u=Jk.b2(o,this.v0.y,this.v1.y,this.v2.y),new Xp(Q,u)};var Fk=function(g,r,O,V){this.v0=g,this.v1=r,this.v2=O,this.v3=V};Fk.prototype=ck(Pf),Fk.prototype.getPoint=function(G){var e,P;return e=Jk.b3(G,this.v0.x,this.v1.x,this.v2.x,this.v3.x),P=Jk.b3(G,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Xp(e,P)},ii.create(function(M,l){this.v1=M,this.v2=l},function(L){var P=new Eb;return P.subVectors(this.v2,this.v1),P.multiplyScalar(L),P.add(this.v1),P});var te=ii.create(function(i,c,F){this.v0=i,this.v1=c,this.v2=F},function(T){var M,D,o;return M=Jk.b2(T,this.v0.x,this.v1.x,this.v2.x),D=Jk.b2(T,this.v0.y,this.v1.y,this.v2.y),o=Jk.b2(T,this.v0.z,this.v1.z,this.v2.z),new Eb(M,D,o)}),yc=ii.create(function(x,D,A,L){this.v0=x,this.v1=D,this.v2=A,this.v3=L},function(B){var v,l,x;return v=Jk.b3(B,this.v0.x,this.v1.x,this.v2.x,this.v3.x),l=Jk.b3(B,this.v0.y,this.v1.y,this.v2.y,this.v3.y),x=Jk.b3(B,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Eb(v,l,x)}),kb=function(x,z,Z,P,G,X,y,W){Kh.call(this),P=P!==_?P:.5,G=G!==_?G:.5,W=W!==_?W:1,x=x||8,X=X||0,y=y||$;var a,s,m=1,j=W/2,R=[],E=[],k=this.vertices,V=this.faces,t=this.faceVertexUvs;for(s=0;m>=s;s++){var J=[],i=[],c=s/m,B=c*(G-P)+P;for(a=0;x>=a;a++){var L=a/x,F=new Eb,D=-(L*y+X);F.z=B*d(D),F.y=-c*W+j,F.x=B*l(D),k.push(F),J.push(k.length-1),i.push(new Xp(L,c))}R.push(J),E.push(i)}var C,v,p=(G-P)/W;for(a=0;x>a;a++)for(0!==P?(C=k[R[0][a]].clone(),v=k[R[0][a+1]].clone()):(C=k[R[1][a]].clone(),v=k[R[1][a+1]].clone()),C.setY(w(C.x*C.x+C.z*C.z)*p).normalize(),v.setY(w(v.x*v.x+v.z*v.z)*p).normalize(),s=0;m>s;s++){var f=R[s][a],N=R[s+1][a],h=R[s+1][a+1],o=R[s][a+1],K=C.clone(),U=C.clone(),e=v.clone(),r=v.clone(),Q=E[s][a].clone(),T=E[s+1][a].clone(),H=E[s+1][a+1].clone(),S=E[s][a+1].clone();V.push(new Rl(f,N,o,[K,U,r])),t[0].push([Q,T,S]),V.push(new Rl(N,h,o,[U.clone(),e,r.clone()])),t[0].push([T.clone(),H,S.clone()])}if(z&&P>0)for(this.vertices.push(new Eb(0,j,0)),a=0;x>a;a++){var f=R[0][a],N=R[0][a+1],h=this.vertices.length-1,K=new Eb(0,1,0),U=new Eb(0,1,0),e=new Eb(0,1,0),Q=E[0][a].clone(),T=E[0][a+1].clone(),H=new Xp(T.x,0);V.push(new Rl(f,N,h,[K,U,e],null,1));var O=a/x*$,u=l(O),M=d(O),g=(a+1)/x*$,q=l(g),b=d(g);t[0].push([new Xp(.5+.5*u,.5+.5*M),new Xp(.5+.5*q,.5+.5*b),new Xp(.5,.5)])}if(Z&&G>0)for(this.vertices.push(new Eb(0,-j,0)),a=0;x>a;a++){var f=R[s][a+1],N=R[s][a],h=k.length-1,K=new Eb(0,-1,0),U=new Eb(0,-1,0),e=new Eb(0,-1,0),Q=E[s][a+1].clone(),T=E[s][a].clone();V.push(new Rl(f,N,h,[K,U,e],null,2));var O=a/x*$,u=l(O),M=d(O),g=(a+1)/x*$,q=l(g),b=d(g);t[0].push([new Xp(.5+.5*q,.5-.5*b),new Xp(.5+.5*u,.5-.5*M),new Xp(.5,.5)])}};kb.prototype=ck(ee);var po=function(c,u,P,q,W,G,r){Kh.call(this),r=r||.5,c=c||16,u=u||16,P=(P!==_?P:0)-h,q=q!==_?q:$,W=W!==_?W:0,G=G!==_?G:h;var X,K,e=[],m=[],R=this.vertices,p=this.faces,Z=this.faceVertexUvs;for(K=0;u>=K;K++){var t=[],B=[];for(X=0;c>=X;X++){var U=X/c,A=K/u,L=new Eb;L.x=-r*l(P+U*q)*d(W+A*G),L.y=r*l(W+A*G),L.z=r*d(P+U*q)*d(W+A*G),R.push(L),t.push(R.length-1),B.push(new Xp(U,A))}e.push(t),m.push(B)}for(K=0;u>K;K++)for(X=0;c>X;X++){var S=e[K][X+1],o=e[K][X],y=e[K+1][X],D=e[K+1][X+1],n=R[S].clone().normalize(),b=R[o].clone().normalize(),k=R[y].clone().normalize(),g=R[D].clone().normalize(),Y=m[K][X+1].clone(),I=m[K][X].clone(),F=m[K+1][X].clone(),Q=m[K+1][X+1].clone();f(R[S].y)===r?(Y.x=(Y.x+I.x)/2,p.push(new Rl(S,y,D,[n,k,g])),Z[0].push([Y,F,Q])):f(R[y].y)===r?(F.x=(F.x+Q.x)/2,p.push(new Rl(S,o,y,[n,b,k])),Z[0].push([Y,I,F])):(p.push(new Rl(S,o,D,[n,b,g])),Z[0].push([Y,I,Q]),p.push(new Rl(o,y,D,[b.clone(),k,g.clone()])),Z[0].push([I.clone(),F,Q.clone()]))}};po.prototype=ck(ee);var vi=function(E,y,g,m,u,Z){Kh.call(this),E=E||.33,y=y||.17,m=m||8,g=g||6,u=u||0,Z=Z||$;for(var n=new Eb,c=[],L=[],t=0;m>=t;t++)for(var e=t/m*$+h,Q=0;g>=Q;Q++){var W=Q/g*Z+u;n.x=E*l(W),n.z=-E*d(W);var q=new Eb,f=E+y*l(e);q.x=f*l(W),q.z=-f*d(W),q.y=y*d(e),this.vertices.push(q),c.push(new Xp(Q/g,1-t/m)),L.push(q.clone().sub(n).normalize())}for(var t=1;m>=t;t++)for(var Q=1;g>=Q;Q++){var F=(g+1)*t+Q-1,p=(g+1)*(t-1)+Q-1,J=(g+1)*(t-1)+Q,s=(g+1)*t+Q,K=new Rl(F,p,s,[L[F].clone(),L[p].clone(),L[s].clone()]);this.faces.push(K),this.faceVertexUvs[0].push([c[F].clone(),c[p].clone(),c[s].clone()]),K=new Rl(p,J,s,[L[p].clone(),L[J].clone(),L[s].clone()]),this.faces.push(K),this.faceVertexUvs[0].push([c[p].clone(),c[J].clone(),c[s].clone()])}this.computeFaceNormals()};vi.prototype=ck(ee);var Cl=function(p,L,z){return p?(Kh.call(this),p=p instanceof Array?p:[p],this.addShapeList(p,L),L.convertYZ!==!1&&hb(this,z),this.computeFaceNormals(),void 0):(p=[],void 0)},Go=Cl.prototype=ck(Kh.prototype);Go.addShapeList=function(k,K){for(var v=k.length,g=0;v>g;g++){var X=k[g];this.addShape(X,K)}},Go.addShape=function(Q,s){function y(){if(s.bottom)for(var B=0;O>B;B++)x=I[B],S(x[2],x[1],x[0],!0);if(s.top)for(B=0;O>B;B++)x=I[B],S(x[0]+g*r,x[1]+g*r,x[2]+g*r,!1)}function d(){var u=0;for(a(G,u),u+=G.length,z=0,D=Z.length;D>z;z++)j=Z[z],a(j,u),u+=j.length}function a(H,k){for(var O,R,o=H.length;--o>=0;){O=o,R=o-1,0>R&&(R=H.length-1);var C=0,j=r;for(C=0;j>C;C++){var f=g*C,I=g*(C+1),z=k+O+f,J=k+R+f,a=k+R+I,l=k+O+I;M(z,J,a,l,H,C,j,O,R)}}}function R(C,T,U){p.vertices.push(new Eb(C,T,U))}function S(i,M,k,L){i+=A,M+=A,k+=A,p.faces.push(new Rl(i,M,k,null,null,L?2:1));var e=L?C.generateBottomUV(p,Q,s,i,M,k):C.generateTopUV(p,Q,s,i,M,k);p.faceVertexUvs[0].push(e)}function M(u,L,N,y,j,B,F,K,R){u+=A,L+=A,N+=A,y+=A,p.faces.push(new Rl(u,L,y)),p.faces.push(new Rl(L,N,y));var V=C.generateSideWallUV(p,Q,j,s,u,L,N,y,B,F,K,R);p.faceVertexUvs[0].push([V[0],V[1],V[3]]),p.faceVertexUvs[0].push([V[1],V[2],V[3]])}var m,$,h,o,n,U=s.amount,k=s.curveSegments||Tq,r=s.steps||1,i=s.extrudePath,t=!1,C=new Wr(s.repeatUVLength,s.boundingBox);i&&(m=i.getSpacedPoints(r),t=!0,$=s.frames!==_?s.frames:new $f.FrenetFrames(i,r,!1),h=new Eb,o=new Eb,n=new Eb);var j,z,D,p=this,A=this.vertices.length,f=Q.extractPoints(k),E=f.shape,Z=f.holes,B=!Jk.isClockWise(E);if(B){for(E=E.reverse(),z=0,D=Z.length;D>z;z++)j=Z[z],Jk.isClockWise(j)&&(Z[z]=j.reverse());B=!1}var I=Jk.triangulateShape(E,Z),G=E;for(z=0,D=Z.length;D>z;z++)j=Z[z],E=E.concat(j);for(var J,x,g=E.length,O=I.length,e=0;g>e;e++)J=E[e],t?(o.copy($.normals[0]).multiplyScalar(J.x),h.copy($.binormals[0]).multiplyScalar(J.y),n.copy(m[0]).add(o).add(h),R(n.x,n.y,n.z)):R(J.x,J.y,0);var u;for(u=1;r>=u;u++)for(e=0;g>e;e++)J=E[e],t?(o.copy($.normals[u]).multiplyScalar(J.x),h.copy($.binormals[u]).multiplyScalar(J.y),n.copy(m[u]).add(o).add(h),R(n.x,n.y,n.z)):R(J.x,J.y,U/r*u);y(),d()};var $f=function(s,p,t,V,I){function X(b,Y,N){return g.vertices.push(new Eb(b,Y,N))-1}Kh.call(this),p=p||64,t=t||1,V=V||8,I=I||!1;var k,y,K,x,z,W,Z,P,v,T,A,Q,B,E,S,Y,J,e,h,_,o=[],g=this,H=p+1,U=new Eb,R=new $f.FrenetFrames(s,p,I),D=R.tangents,i=R.normals,O=R.binormals;for(this.tangents=D,this.normals=i,this.binormals=O,v=0;H>v;v++)for(o[v]=[],x=v/(H-1),P=s.getPointAt(x),k=D[v],y=i[v],K=O[v],T=0;V>T;T++)z=T/V*$,W=-t*l(z),Z=t*d(z),U.copy(P),U.x+=W*y.x+Z*K.x,U.y+=W*y.y+Z*K.y,U.z+=W*y.z+Z*K.z,o[v][T]=X(U.x,U.y,U.z);for(v=0;p>v;v++)for(T=0;V>T;T++)A=I?(v+1)%p:v+1,Q=(T+1)%V,B=o[v][T],E=o[A][T],S=o[A][Q],Y=o[v][Q],J=new Xp(v/p,T/V),e=new Xp((v+1)/p,T/V),h=new Xp((v+1)/p,(T+1)/V),_=new Xp(v/p,(T+1)/V),this.faces.push(new Rl(B,E,Y)),this.faceVertexUvs[0].push([J,e,_]),this.faces.push(new Rl(E,S,Y)),this.faceVertexUvs[0].push([e.clone(),h,_.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};$f.prototype=ck(ee),$f.FrenetFrames=function(A,w,r){function I(){T[0]=new Eb,i[0]=new Eb,R=Number.MAX_VALUE,L=f(j[0].x),O=f(j[0].y),Y=f(j[0].z),R>=L&&(R=L,P.set(1,0,0)),R>=O&&(R=O,P.set(0,1,0)),R>=Y&&P.set(0,0,1),X.crossVectors(j[0],P).normalize(),T[0].crossVectors(j[0],X),i[0].crossVectors(j[0],T[0])}var s,R,L,O,Y,h,t,P=new Eb,j=[],T=[],i=[],X=new Eb,Q=new gq,F=w+1,u=1e-4;for(this.tangents=j,this.normals=T,this.binormals=i,h=0;F>h;h++)t=h/(F-1),j[h]=A.getTangentAt(t),j[h].normalize();for(I(),h=1;F>h;h++)T[h]=T[h-1].clone(),i[h]=i[h-1].clone(),X.crossVectors(j[h-1],j[h]),X.length()>u&&(X.normalize(),s=E(ki(j[h-1].dot(j[h]),-1,1)),T[h].applyMatrix4(Q.makeRotationAxis(X,s))),i[h].crossVectors(j[h],T[h]);if(r)for(s=E(ki(T[0].dot(T[F-1]),-1,1)),s/=F-1,j[0].dot(X.crossVectors(T[0],T[F-1]))>0&&(s=-s),h=1;F>h;h++)T[h].applyMatrix4(Q.makeRotationAxis(j[h],s*h)),i[h].crossVectors(j[h],T[h])};var Cd=function(j,N,q,_){Kh.call(this),N=N||18,q=q||0,_=_==I?$:_;for(var z=1/(j.length-1),K=1/N,V=0,m=N;m>=V;V++)for(var C=q+V*K*_,J=l(C),u=d(C),b=0,g=j.length;g>b;b++){var D=j[b],S=new Eb;S.x=J*D.x-u*D.y,S.y=u*D.x+J*D.y,S.z=D.z,this.vertices.push(S)}for(var s=j.length,V=0,m=N;m>V;V++)for(var b=0,g=j.length-1;g>b;b++){var R=b+s*V,y=R,B=R+s,J=R+1+s,n=R+1,e=V*K,F=b*z,i=e+K,O=F+z;this.faces.push(new Rl(y,n,B)),this.faceVertexUvs[0].push([new Xp(e,F),new Xp(e,O),new Xp(i,F)]),this.faces.push(new Rl(B,n,J)),this.faceVertexUvs[0].push([new Xp(i,F),new Xp(e,O),new Xp(i,O)])}this.mergeVertices(),hb(this),this.computeFaceNormals(),this.computeVertexNormals()};Cd.prototype=ck(ee);var vj=function(R,K){K=K||{};var J=Ap.generateShapes(R,K);K.amount=K.amount!==_?K.amount:.5,K.convertYZ=!1,K.fill!==!1&&(K.bottom=!0,K.top=!0),Cl.call(this,J,K)};vj.prototype=ck(Go);var jr=A.Node=function(){nk(jr,this)},Er={X:re,Y:Bi,Z:Kr},oo={X:0,Y:1,Z:2},Ki={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Be=new Uk,zs="xzy",Vd=function(A,e,l){if(e){var M=e[0],K=e[1],h=e[2];"xzy"===l?(Bi(A,K),Kr(A,h),re(A,M)):"xyz"===l?(Kr(A,h),Bi(A,K),re(A,M)):"yxz"===l?(Kr(A,h),re(A,M),Bi(A,K)):"yzx"===l?(re(A,M),Kr(A,h),Bi(A,K)):"zxy"===l?(Bi(A,K),re(A,M),Kr(A,h)):"zyx"===l?(re(A,M),Bi(A,K),Kr(A,h)):(Bi(A,K),Kr(A,h),re(A,M))}};Og("Node",Nj,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:zs,_64O:0,_rotationX:0,_53O:0,_host:I,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Me},_22Q:function(){return _s},getX:function(){return this.p().x},setX:function(M){this.p(M,this.p().y)},getY:function(){return this.p().y},setY:function(z){this.p(this.p().x,z)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(t){this.setAnchor(t,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(u){this.setAnchor(this.getAnchor().x,u)},getScaleX:function(){return this.getScale().x},setScaleX:function(d){this.setScale(d,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(u){this.setScale(this.getScale().x,u)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},setQuaternion:function(T){var d=(new bd).setFromQuaternion(T,bd.ReverseOrder(this.getRotationMode()));return this._applyClosestR3(d.x,d.y,d.z)},getQuaternion:function(){var C=new bd,N=new bd,t=new Uk;return function(I){return I||(I=new Uk),this.getEuler(C),C.equals(N)?I.copy(t):I.copy(t.setFromEuler(N.copy(C)))}}(),getEuler:function(e){var G=this.r3();return e||(e=new bd),e.set(G[0],G[1],G[2],bd.ReverseOrder(this.getRotationMode()))
},setEuler:function(_){return _=_.clone().reorder(bd.ReverseOrder(this.getRotationMode())),this.r3(_.x,_.y,_.z)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(t,n){xl(t,dd(I,I,this.r3(),this.getRotationMode())),this.translate3d(t[0]*n,t[1]*n,t[2]*n)},translateFront:function(g){this.translate3dBy([0,0,1],g)},translateBack:function(t){this.translate3dBy([0,0,-1],t)},translateLeft:function(_){this.translate3dBy([-1,0,0],_)},translateRight:function(m){this.translate3dBy([1,0,0],m)},translateTop:function($){this.translate3dBy([0,1,0],$)},translateBottom:function(f){this.translate3dBy([0,-1,0],f)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(o,M,J){1===arguments.length&&(M=o[1],J=o[2],o=o[0]),this.p(o,J),this.setElevation(M)},translate3d:function(j,c,e){1===arguments.length&&(c=j[1],e=j[2],j=j[0]),this.translate(j,e),this.setElevation(this._54O+c)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(P,D,f){1===arguments.length&&(D=P[1],f=P[2],P=P[0]),this.setSize(P,f),this.setTall(D)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(X,P,I){var N=this;if(!N._updatingRotation3d){N._updatingRotation3d=1,1===arguments.length&&(P=X[1],I=X[2],X=X[0]);var S=[N._rotationX,-N._64O,N._53O];N._rotationX=X,N._64O=-P,N._53O=I,N.fp("rotation3d",S,[X,P,I]),delete N._updatingRotation3d}},_applyClosestR3:function(){function L(R){return R%=$,0>R&&(R+=$),R>h?$-R:R}function W(z,U){return L(z[0]-U[0])+L(z[1]-U[1])+L(z[2]-U[2])}return function(f,u,I){var U,L,c,Y=this.r3(),j=this.getRotationMode();"xzy"===j||"yzx"===j?(U=f>0?f-h:f+h,L=u>0?u-h:u+h,c=I>0?h-I:-h-I):"xyz"===j||"zyx"===j?(U=f>0?f-h:f+h,c=I>0?I-h:I+h,L=u>0?h-u:-h-u):("yxz"===j||"zxy"===j)&&(c=I>0?I-h:I+h,L=u>0?u-h:u+h,U=f>0?h-f:-h-f),W([U,L,c],Y)<W([f,u,I],Y)?this.r3(U,L,c):this.r3(f,u,I)}}(),setRotationY:function(H){this.setRotation(-H)},getRotationY:function(){return-this._64O},lookAtDirection:function(b,U){U=U||Pd;var I=this,c=Hd(b);U===Pd?(I.r3([-B(b[1]/c),-id(b[2],b[0])+Rg,0]),I.setRotationMode("xzy")):U===bq?(I.r3(0,-id(b[2],b[0]),B(b[1]/c)),I.setRotationMode("zyx")):U===iq?(I.r3(0,-id(b[2],b[0])+h,-B(b[1]/c)),I.setRotationMode("zyx")):U===wg?(I.r3([-B(b[1]/c)+Rg,-id(b[2],b[0])+Rg,0]),I.setRotationMode("xzy")):U===wn&&(I.r3([-B(b[1]/c)-Rg,-id(b[2],b[0])+Rg,0]),I.setRotationMode("xzy")),U===rm&&(I.r3([-B(b[1]/c)+h,-id(b[2],b[0])+Rg,h]),I.setRotationMode("zxy"))},lookAt:function(h,Y){return this.lookAtDirection(_d(h,this.p3()),Y)},lookAtX:function(){var V=new ti,u=new ti,x=new ti,Z=new gq,$=new gq,O=new bd;return function(o,k){var Y=Gq(this);if(Z.fromArray(Y),x.copy(this.p3()),V.copy(o).sub(x),!(V.lengthSq()<1e-6)){V.normalize(),k=k||Pd,"string"==typeof k?k===Pd?u.set(0,0,1):k===rm?u.set(0,0,-1):k===iq?u.set(-1,0,0):k===bq?u.set(1,0,0):k===wg?u.set(0,1,0):k===wn&&u.set(0,-1,0):u.copy(k).normalize(),u.applyMatrix4(Z).sub(x).normalize();var r=Math.acos(V.dot(u));if(r){var l=V.clone().cross(u);l.lengthSq()<1e-6&&(k===wg||k===wn||0===k[0]&&0===k[1]?l.set(0,0,1).applyMatrix4(Z).sub(x):l.set(0,1,0).applyMatrix4(Z).sub(x)),l.normalize(),O.set(this.r3(),this.getRotationMode(),!0),Z.makeRotationFromEuler(O),$.makeRotationAxis(l,-r),O.setFromRotationMatrix($.multiply(Z)),this._applyClosestR3(O.x,O.y,O.z)}}}}(),getHost:function(){return this._host},setHost:function(I){var y=this;if(y!==I&&y._host!==I){var b=y._host;b&&(b._removeAttach(y),b.updateLayoutAttaches()),y._host=I,y._host&&(y._host._addAttach(y),y._host.updateLayoutAttaches()),y.fp("host",b,I),y.onHostChanged(b,I)}},getAttaches:function(){return this._69O},_addAttach:function(R){var r=this;r._69O||(r._69O=new Gc),r._69O.add(R),r.fp("attaches",I,R)},_removeAttach:function(f){var t=this;t._69O.remove(f),t._69O.isEmpty()&&delete t._69O,t.fp("attaches",f,I)},getImage:function(){if(this._pendingCheckImageJSON){var G=z.getImage(this._image);G&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof vh&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(v){var s=this,h=s._image,O=s.getWidth(),H=s.getHeight();if(s._image=v,s.fp("image",h,v)){if(null!=v&&(qf(v)||Fp(v)&&/\.json$/i.test(v))&&(this._pendingCheckImageJSON=!0),Yr)return;s.fp(fe,O,s.getWidth()),s.fp(dj,H,s.getHeight())}},getElevation:function(){return this._54O},setElevation:function(e){var $=this;if(!$._50O){$._50O=1;var l=$._54O;$._54O=e,$.fp(Ee,l,e),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(w){var H=this;if(!H._49O){H._49O=1;var f=H._64O;H._64O=w,H.fp(Yn,f,w),delete H._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(s){var L=this;if(!L._51O){L._51O=1;var e=L._rotationX;L._rotationX=s,L.fp("rotationX",e,s),delete L._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(x){var D=this;if(!D._52O){D._52O=1;var f=D._53O;D._53O=x,D.fp("rotationZ",f,x),delete D._52O}},getPosition:function(){return this._position},setPosition:function(W,M){var E=this;if(!E._50I){E._50I=1;var v;if(v=2===arguments.length?{x:W,y:M}:W,v.x!==E._position.x||v.y!==E._position.y){var b=E._position;E._position=v,E.fp(se,b,v)}delete E._50I}},translate:function(u,c){var p=this._position;this.p(p.x+u,p.y+c)},getWidth:function(){var m=this;if(m._width>=0)return m._width;var k=m.getStyle("shape3d");if(k){var t=jo(k);if(t&&t.rawS3)return t.rawS3[0];if("billboard"===k||"plane"===k){var M=Gj(m.getStyle("shape3d.image"));return M?bi(M,m):20}}var M=Gj(m._image);return M?bi(M,m):20},setWidth:function(e){var l=this,W=l._width;l._width=e,l.fp(fe,W,e)},getHeight:function(){var C=this;if(C._height>=0)return C._height;var Z=C.getStyle("shape3d");if(Z){var A=jo(Z);if(A&&A.rawS3)return A.rawS3[2];if("plane"===Z){var H=Gj(C.getStyle("shape3d.image"));return H?Eg(H,C):20}if("billboard"===Z)return 2}var H=Gj(C._image);return H?Eg(H,C):20},setHeight:function(v){var B=this,X=B._height;B._height=v,B.fp(dj,X,v)},getTall:function(){var E=this;if(E._tall>=0)return E._tall;var n=E.getStyle("shape3d");if(n){var b=jo(n);if(b&&b.rawS3)return b.rawS3[1];if("billboard"===n){var i=Gj(E.getStyle("shape3d.image"));return i?Eg(i,E):20}if("plane"===n)return 2}return 20},setTall:function(u){var G=this,s=G._tall;G._tall=u,G.fp("tall",s,u)},setSize:function(L,a){var H=this;2===arguments.length?(H.setWidth(L),H.setHeight(a)):(H.setWidth(L.width),H.setHeight(L.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(C,K,F,q,T){var n=this,P=n.getAnchor(),J=n.getScale();arguments.length<=2&&(T=K,K=C.y,F=C.width,q=C.height,C=C.x);var D=T&&J.x<0?1-P.x:P.x,o=T&&J.y<0?1-P.y:P.y;n.p(C+F*D,K+q*o),T&&(F/=Math.abs(J.x),q/=Math.abs(J.y)),n.setWidth(F),n.setHeight(q)},getMatrix:function(){var n=this,q=n._64O,l=n._position,j=n.getScale();return new Xl(q,l.x,l.y,j.x,j.y)},getMatrix4:function(){var u=new ti,E=new Uk,c=new ti;return function(h){return this.getQuaternion(E),u.copy(this.p3()),c.copy(this.getFinalScale3d()),h||(h=new gq),h.compose(u,E,c)}}(),getAnchorRect:function(){var h=this,M=h.getWidth(),$=h.getHeight(),f=h.getAnchor();return{x:-M*f.x,y:-$*f.y,width:M,height:$}},toLocal:function(H){return this.getMatrix().tfi(H)},toGlobal:function(U){return this.getMatrix().tf(U)},getAttachPosition:function(){var X=new Xl;return function(t,v,r,w){r=r||0,w=w||0;var z=this,m=z.getAnchor(),e=z._64O,n=z._position,F=z.getScale();return X.setFromTransform(e,n.x,n.y).tf({x:r+F.x*z.getWidth()*(t-m.x),y:w+F.y*z.getHeight()*(v-m.y)})}}(),isInRect:function(u){u=this.toLocal(u);var F=this.getWidth(),E=this.getHeight();return u.x+=F*this.getAnchorX(),u.y+=E*this.getAnchorY(),!(u.x<0||u.y<0||u.x>F||u.y>E)},getRect:function(){var U=this,C=U.getWidth(),e=U.getHeight(),i=U.getAnchor(),s={x:-C*i.x,y:-e*i.y,width:C,height:e},V=U.getMatrix();return s=Mc([V.tf(s.x,s.y),V.tf(s.x+s.width,s.y),V.tf(s.x+s.width,s.y+s.height),V.tf(s.x,s.y+s.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var N=this,B=N.getAnchor(),P=N._anchorElevation;return{x:B.x,y:P,z:B.y}},setAnchorElevation:function(z){var u=this,E=u._anchorElevation;return E!==z?(u._anchorElevation=z,u.fp("anchorElevation",E,z),!0):!1},setAnchor3d:function(N,v,I,G){var Q,m=this;"number"==typeof N?Q={x:N,y:v,z:I}:(Q=N.length?{x:N[0],y:N[1],z:N[2]}:N,G=v),m.beginTransaction();var g=m.getAnchor3d(),D=m.setAnchor(Q.x,Q.z);if(m.setAnchorElevation(Q.y)&&(D=!0),D&&G&&!Yr){m.getAnchor3d();var Z=Gq(m),a=xl([Q.x-g.x,Q.y-g.y,Q.z-g.z],Z);m.p3(a)}return m.endTransaction(),D},getAnchor:function(){var v=this;if(v.hasOwnProperty("_anchor"))return v._anchor;var h=Gj(v._image);return h&&h.anchorX!==_?{x:h.anchorX,y:h.anchorY}:v._anchor},setAnchor:function(u,s,E){var v,z=this;"number"==typeof u?v={x:u,y:s}:(v=u.length?{x:u[0],y:u[1]}:u,E=s);var X=z.getAnchor();if(X.x!==v.x||X.y!==v.y){if(z.beginTransaction(),z._anchor=v,z.fp("anchor",X,v),E&&!Yr){var j=z.getPosition(),e=z.getSize(),A=z.getRotation(),n=z.getScale(),h=-e.width*(X.x-v.x)*n.x,L=-e.height*(X.y-v.y)*n.y,P=d(A),m=l(A);z.setPosition(j.x+m*h-P*L,j.y+P*h+m*L)}return z.endTransaction(),!0}return!1},getLocalQuaternion:function(U){var o=this,m=o.getHost();if(!m)return o.getQuaternion(U);var w=m.getQuaternion(),X=o.getQuaternion();return U||(U=new Uk),U.copy(w).inverse().multiply(X)},setLocalQuaternion:function(A){var X=this,M=X.getHost();if(!M)return X.setQuaternion(A);var z=M.getQuaternion();X.setQuaternion(z.clone().multiply(A))},getLocalEuler:function(){var T=new Uk;return function(u){var i=this,Y=i.getHost();return Y?(i.getLocalQuaternion(T),u||(u=new bd),u.setFromQuaternion(T,bd.ReverseOrder(this.getRotationMode()))):i.getEuler(u)}}(),setLocalEuler:function(){var A=new Uk;return function(k){var q=this,m=q.getHost();return m?(A.setFromEuler(k),q.setLocalQuaternion(A)):q.setEuler(k)}}(),getLocalPosition3d:function(i){var O=this;i||(i=new ti),i.copy(O.p3());var n=O.getHost();if(!n)return i;var B=n.getMatrix4();return i.applyMatrix4(B.getInverse(B))},setLocalPosition3d:function(L){var t=this,d=t.getHost();if(!d)return L.x!==_?t.p3(L.x,L.y,L.z):t.p3(L),void 0;var V=d.getMatrix4(),C=new ti(L);C.applyMatrix4(V),t.p3(C.x,C.y,C.z)},getScale:function(){return this._scale},setScale:function(T,m){var G,S=this;G=2===arguments.length?{x:T,y:m}:T;var v=S.getScale();(v.x!==G.x||v.y!==G.y)&&(S._scale=G,S.fp("scale",v,G))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var e=this,J=e._scaleTall,H=e.getScale();return[H.x,J,H.y]},getFinalScale3d:function(){var G=this,X=G.s3(),W=G._dynamicScale3d,t=G.getScale3d();return X&&(t[0]*=X[0],t[1]*=X[1],t[2]*=X[2]),W&&(t[0]*=W[0],t[1]*=W[1],t[2]*=W[2]),t},getFinalRotation3d:function(){var W=this;return W._dynamicRotation||W.r3()},setScaleTall:function(N){var m=this,C=m._scaleTall;C!==N&&(m._scaleTall=N,m.fp("scaleTall",C,N))},setScale3d:function(l,w,E){var d,H=this;d="number"==typeof l?{x:l,y:w,z:E}:l.length?{x:l[0],y:l[1],z:l[2]}:l,H.setScaleTall(d.y),H.setScale(d.x,d.z)},getCorners:function(H,A){H==I&&(H=0),A==I&&(A=H);var T=this,u=T.getAnchor(),Q=T.getWidth(),t=T.getHeight(),N=-Q*u.x-H,d=-t*u.y-A,X=Q+2*H,P=t+2*A,v=T.getMatrix();return[v.tf(N,d),v.tf(N,d+P),v.tf(N+X,d+P),v.tf(N+X,d)]},getEditControlPoints:function(U,X,C){X==I&&(X=0),C==I&&(C=X);var n=this,h=n.getAnchor(),p=n.getWidth(),g=n.getHeight(),B=-p*h.x-X,A=-g*h.y-C,S=p+2*X,G=g+2*C;if(U)return[{x:B,y:A},{x:B,y:0},{x:B,y:A+G},{x:0,y:A+G},{x:B+S,y:A+G},{x:B+S,y:0},{x:B+S,y:A},{x:0,y:A}];var V=n.getMatrix();return[V.tf(B,A),V.tf(B,0),V.tf(B,A+G),V.tf(0,A+G),V.tf(B+S,A+G),V.tf(B+S,0),V.tf(B+S,A),V.tf(0,A)]},rotateAt:function(L,A,Z){var c=this,x=c._position,H=c._64O,B=new Xl(H,x.x,x.y).tf(L,A),m=w(L*L+A*A),h=id(x.y-B.y,x.x-B.x)+Z;c.setRotation(H+Z),c.p(B.x+m*l(h),B.y+m*d(h))},rotateAroundAxis:function(o,k){this.setQuaternion(this.getQuaternion().multiply(Be.setFromAxisAngle(o,k)))},rotateAroundWorldAxis:function(g,E){this.setQuaternion(this.getQuaternion().premultiply(Be.setFromAxisAngle(g,E)))},rotateX:function(J){return this.rotateAroundAxis(ti.AxisX,J)},rotateY:function(F){return this.rotateAroundAxis(ti.AxisY,F)},rotateZ:function(x){return this.rotateAroundAxis(ti.AxisZ,x)},onParentChanged:function(){jr.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var S={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(p){S[p]=!0}),function(h){var p=this;jr.superClass.onPropertyChanged.call(p,h);var v=h.property;if(S[v]&&!p._layoutUpdating&&p.updateLayoutParameters(null,v),p._69O&&p._69O.each(function(u){u.handleHostPropertyChange(h)}),p._49I&&p._49I.each(function(E){E.fp("agentChange",!0,!1)}),Kn[v]&&this.updateLayoutAttaches(),"a:layout"===v.substring(0,8)){this.updateLayoutAttaches();var o=p._host;o&&o.updateLayoutAttaches()}("s:shape3d.autorotate"===v||"s:autorotate"===v||"s:shape3d.fixSizeOnScreen"===v||"s:fixSizeOnScreen"===v||"s:hide.overlapping.group"===v)&&(p._47Q=p.s("autorotate")||p.s("shape3d.autorotate")||p.s("fixSizeOnScreen")||p.s("shape3d.fixSizeOnScreen")||p.s("hide.overlapping.group"))}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(p){this.updateAttach(p)},onStyleChanged:function(N){jr.superClass.onStyleChanged.apply(this,arguments),Wp[N]&&this.updateAttach()},updateLayoutAttaches:function(){if(!Yr&&this.s("vector.layoutable")){var Q,Z,e=this;return Q=Gj(e.getImage()),Q&&Q.layoutAttach&&(Z=Q.layoutAttach,Z&&Z(e))?!0:void 0}},updateAttach:function(W){var u=this;return Yr?(u.updateLayoutParameters(),void 0):(u._51I||(u._51I=1,u._71O(W),delete u._51I),void 0)},_71O:function(N){var r,z,X,J,h,q,B=this,o=B._host,w=N?N.property:I,m=N?N.oldValue:I,S=N?N.newValue:I;if(o instanceof jr&&(!N||Kn[w])){var l;if(l=Gj(o.getImage()),l&&l.layoutAttach)return}if(o instanceof A.Grid){if(w===Ee)B.setElevation(B._54O+S-m);else if(!N||ak[w]){if(r=B.s("attach.row.index"),z=B.s("attach.column.index"),X=o.getCellRect(r,z),!X)return;J=B.s("attach.row.span"),h=B.s("attach.column.span"),(1!==J||1!==h)&&(X=xf(X,o.getCellRect(r+J-1,z+h-1))),of(X,B,"attach.padding",1),B.setRect(X)}}else if(o instanceof Mi&&(q=B.s("attach.index"))>=0&&(!N||sc[w])){var U=B.s("attach.thickness"),a=o.getScale(),v=Math.max(a.x,a.y);U>0&&B.setHeight(o.getThickness()*U*v);var Y=B.s("attach.offset"),s=o.getPoints(),P=s.size();if(P>q){var O=o.getPointsMatrix2d(),d=s.get(q),_=P===q+1?s.get(0):s.get(q+1);d=O.apply(d),_=O.apply(_);var D=[_.x-d.x,_.y-d.y],x=Hd(D);if(x){B.s("attach.offset.relative")&&(Y*=x),B.s("attach.offset.opposite")&&(Y=x-Y);var C={x:d.x+D[0]/x*Y,y:d.y+D[1]/x*Y},e=B.s("attach.gap");e&&(B.s("attach.gap.relative")&&(e*=o.getThickness()*v),C=Ko(I,C,_,e)),B.p(C),B.setRotation(id(D[1],D[0]))}}}else N&&(w===se?B.translate(S.x-m.x,S.y-m.y):w===Ee?B.setElevation(B._54O+S-m):lg[w]?"rotation3d"===w?B.syncRotation3d(o,S,m):B._11Q(o,w,S-m):("anchor"===w||"width"===w||"height"===w||"scale"===w)&&B.layout(o))},_11Q:function(){var Y=new A.Math.Euler,t=A.Math.Euler.ReverseOrder,u=new A.Math.Vector2,E=new A.Math.Vector2;return function(p,H,l){var z=this,J=p.p3(),G=p.r3(),V=z.p3(),_=z.r3();if(H===Yn&&(H="rotationY",l=-l),(H===Yn||"rotationY"===H)&&0===_[0]&&0===_[2]&&0===G[0]&&0===G[2]&&0===V[1]&&0===J[1])return z.setRotation(-_[1]-l),u.set(V[0],V[2]).rotateAround(E.set(J[0],J[2]),-l),z.p(u.x,u.y),void 0;var R=Ki[p.getRotationMode()],O=R[0],m=R[1],y=R[2],c=Er[O],S=Er[m],U=Er[y],B=dq();H===Yn+O?(U(B,G[oo[y]]),S(B,G[oo[m]]),c(B,l),S(B,-G[oo[m]]),U(B,-G[oo[y]])):H===Yn+m?(U(B,G[oo[y]]),S(B,l),U(B,-G[oo[y]])):H===Yn+y&&U(B,l);var C=_d(V,J);xl(C,B),z.p3(J[0]+C[0],J[1]+C[1],J[2]+C[2]);var A=z.getRotationMode();Vd(B,z.r3(),A),Y.setFromRotationMatrix(B,t(A)),z.r3([Y.x,Y.y,Y.z])}}(),syncRotation3d:function(){var C=new Uk,W=new bd,H=new ti;return function(J,V,e){var E=this;if(e[0]!==V[0]||e[1]!==V[1]||e[2]!==V[2]){var w=bd.ReverseOrder(J.getRotationMode());Be.setFromEuler(W.set(e[0],e[1],e[2],w)),C.setFromEuler(W.set(V[0],V[1],V[2],w)),C.multiply(Be.inverse());var h=J.p3(),I=E.p3();H.set(I[0]-h[0],I[1]-h[1],I[2]-h[2]).applyQuaternion(C),E.p3(h[0]+H.x,h[1]+H.y,h[2]+H.z),E.setQuaternion(E.getQuaternion(Be).premultiply(C))}}}(),isHostOn:function(k){var y=this;if(y._host&&k&&k._69O)for(var Q={},T=y._host;T&&T!==y&&!Q[T._id];){if(T===k)return!0;Q[T._id]=T,T=T._host}return!1},isLoopedHostOn:function(E){return this.isHostOn(E)&&E.isHostOn(this)},getScaledSize:function(){var w=this.getSize(),Q=this.getScale();return w.width*=Math.abs(Q.x),w.height*=Math.abs(Q.y),w},layout:function(m){if(m=m||this.getHost()){var F=this,W=F.s("layout.h")||"center",d=F.s("layout.v")||"center";if("center"!==W||"center"!==d){var n=new A.Math.Vector2,w=m.getPosition(),L=m.getAnchor(),v=m.getScaledSize();F.getPosition();var u,q,Y,R,M,k=1,s=1;switch(F._layoutUpdating=!0,W){case"left":n.setX(F._layoutHValue-L.x*v.width);break;case"right":n.setX((1-L.x)*v.width-F._layoutHValue);break;case"leftright":u=v.width-F._layoutHValue[2],Y=F.getRotation()-m.getRotation(),R=Math.abs(Math.sin(Y)),M=Math.abs(Math.cos(Y)),k+=M*u/F._layoutHValue[3],s+=R*u/F._layoutHValue[4],n.setX(F._layoutHValue[1]+(F._layoutHValue[5]-L.x)*v.width);break;case"center":n.setX((.5-L.x)*v.width-F._layoutHValue);break;case"scale":Y=F.getRotation()-m.getRotation(),R=Math.abs(Math.sin(Y)),M=Math.abs(Math.cos(Y)),n.setX((.5-L.x)*v.width-F._layoutHValue[1]*v.width/F._layoutHValue[0]),q=v.width/F._layoutHValue[2]-1,k+=M*q,s+=R*q}switch(d){case"top":n.setY(F._layoutVValue-L.y*v.height);break;case"bottom":n.setY((1-L.y)*v.height-F._layoutVValue);break;case"topbottom":Y||(Y=F.getRotation()-m.getRotation(),R=Math.abs(Math.sin(Y)),M=Math.abs(Math.cos(Y))),u=v.height-F._layoutVValue[2],k+=R*u/F._layoutVValue[3],s+=M*u/F._layoutVValue[4],n.setY(F._layoutVValue[1]+(F._layoutVValue[5]-L.y)*v.height);break;case"center":n.setY((.5-L.y)*v.height-F._layoutVValue);break;case"scale":Y||(Y=F.getRotation()-m.getRotation(),R=Math.abs(Math.sin(Y)),M=Math.abs(Math.cos(Y))),n.setY((.5-L.y)*v.height-F._layoutVValue[1]*v.height/F._layoutVValue[0]),q=v.height/F._layoutVValue[2]-1,k+=R*q,s+=M*q}if("leftright"===W||"scale"===W||"topbottom"===d||"scale"===d){var T=this.getScale(),H=Math.abs(T.x),D=Math.abs(T.y);"leftright"===W||"scale"===W?F.setSize(F._layoutHValue[3]*k/H,F._layoutHValue[4]*s/D):F.setSize(F._layoutVValue[3]*k/H,F._layoutVValue[4]*s/D)}n.rotateAround(null,m.getRotation()),this.setPosition(n.x+w.x,n.y+w.y),F._layoutUpdating=_}}},updateLayoutParameters:function(B,w){if(B=B||this.getHost()){var q=this,y=q.s("layout.h"),Y=q.s("layout.v");if(y||Y){var d,E,x,z,Z,j,u=new A.Math.Vector2,X=B.getPosition(),m=B.getAnchor(),P=B.getScaledSize(),H=q.getPosition(),J=q.getScaledSize();switch(u.set(H.x-X.x,H.y-X.y),u.rotateAround(null,-B.getRotation()),y){case"left":q._layoutHValue=u.x+m.x*P.width;break;case"right":q._layoutHValue=-u.x+(1-m.x)*P.width;break;case"center":q._layoutHValue=-u.x+(.5-m.x)*P.width;break;case"leftright":case"scale":"scale"===y?d=-u.x+(.5-m.x)*P.width:(E=q.getAnchor(),x=q.getRotation()-B.getRotation(),z=Math.cos(x),Z=Math.sin(x),j=-Math.min(-E.x*z+E.y*Z,-E.x*z-(1-E.y)*Z,(1-E.x)*z+E.y*Z,(1-E.x)*z-(1-E.y)*Z),d=u.x-(j-m.x)*P.width),"position"===w&&"object"==typeof q._layoutHValue?(q._layoutHValue[0]=P.width,q._layoutHValue[1]=d):q._layoutHValue=[P.width,d,P.width,J.width,J.height,j]}switch(Y){case"top":q._layoutVValue=u.y+m.y*P.height;break;case"bottom":q._layoutVValue=-u.y+(1-m.y)*P.height;break;case"center":q._layoutVValue=-u.y+(.5-m.y)*P.height;break;case"topbottom":case"scale":"scale"===Y?d=-u.y+(.5-m.y)*P.height:(x||(E=q.getAnchor(),x=q.getRotation()-B.getRotation(),z=Math.cos(x),Z=Math.sin(x)),j=-Math.min(-E.x*Z-E.y*z,-E.x*Z+(1-E.y)*z,(1-E.x)*Z-E.y*z,(1-E.x)*Z+(1-E.y)*z),d=u.y-(j-m.y)*P.height),"position"===w&&"object"==typeof q._layoutVValue?(q._layoutVValue[0]=P.height,q._layoutVValue[1]=d):q._layoutVValue=[P.height,d,P.height,J.width,J.height,j]}}}},getSerializableProperties:function(){var B=jr.superClass.getSerializableProperties.call(this);return Xi(B,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),B}});var Mf=A.Edge=function(i,w){var g=this;nk(Mf,g),g.setSource(i),g.setTarget(w)};Og("Edge",Nj,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return Do},_22Q:function(){return bt},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(z){if(z===this)return!1;if(Fg(z))return!0;for(var D,V,I,m,P,v=[this],O=-1,F=0;F>O;)if(O++,D=v[O],V=D._44I)for(V=V.getArray(),m=0,P=V.length;P>m;m++)if(I=V[m],Rn(I)&&!(v.indexOf(I)>=0)){if(I===z)return!1;v.push(I),F++}return!0},setSource:function(o){var j=this;if(j._source!==o&&j.canSetSourceTarget(o)){var C=j._source;j._source=o,C&&C._16I(j),o&&o._2I(j),j._7I(),j.fp("source",C,o)}},setTarget:function(m){var c=this;if(c._target!==m&&c.canSetSourceTarget(m)){var x=c._target;c._target=m,x&&x._18I(c),m&&m._4I(c),c._7I(),c.fp("target",x,m)}},isLooped:function(){var u=this;return u._source===u._target&&Fg(u._source)&&Fg(u._target)},onPropertyChanged:function(){var Z=this;Z._49I&&Z._49I.each(function(r){r.fp("agentChange",!0,!1)})},_7I:function(){var m,n=this,k=fp(n);n._40I!==k&&(m=this._40I,m&&m._15I(n),n._40I=k,k&&k._1I(n),n.fp("sourceAgent",m,k),xp(m,n._41I),xp(k,n._41I));var f=ec(n);n._41I!==f&&(m=n._41I,m&&m._17I(n),n._41I=f,f&&f._3I(n),n.fp("targetAgent",m,f),xp(m,n._40I),xp(f,n._40I))},_22I:function(D){this._52I=D,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var R=this;return R._52I&&R._52I.get(0)!==R&&!R.getStyle(up)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var s=this,$=s._52I;return $&&!s.getStyle(up)&&$.size()>1&&s===$.get(0)},toggle:function(){this.beginTransaction();var V=this._52I,A=!this.s(up);V&&V.size()>1&&(V.each(function(j){j.s(up,A)}),V.getSiblings().each(function(A){A!==V&&A.each(function(t){t.fp("edgeGroup",I,A)})})),this.endTransaction()},setStyle:function(y,F){(y===Wl||"edge.segments"===y)&&(F=Mp(F)),Mf.superClass.setStyle.call(this,y,F)},onStyleChanged:function(q){Mf.superClass.onStyleChanged.apply(this,arguments),_j[q]&&xp(this._41I,this._40I)},getSerializableProperties:function(){var d=Mf.superClass.getSerializableProperties.call(this);return Xi(d,{source:1,target:1}),d}});var oq=A.Group=function(){nk(oq,this)};Og("Group",jr,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Lf},onChildAdded:function(){oq.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){oq.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var T=this;if(!T._54I&&!Yr){var c=T.getChildrenRect();c&&(T._53I=1,T.p(ni(T.s("group.position"),c,T.getSize())),delete T._53I)}},getChildrenRect:function(){var E,c=this;return c.eachChild(function(m){Fg(m)&&(E=xf(E,c.getChildRect(m)))}),E},getChildRect:function(E){var w;return Fg(E)&&E.s(ze)&&(Re(E)&&E.isExpanded()&&E.eachChild(function(S){w=xf(w,E.getChildRect(S))}),!w&&E.getRect&&(w=E.getRect())),w},setPosition:function(g,w){var b=this;if(!b._54I){var Z;Z=2===arguments.length?{x:g,y:w}:g,Yr||b._53I||(b._54I=1,ed(b._children,Z.x-b._position.x,Z.y-b._position.y),delete b._54I),oq.superClass.setPosition.call(this,Z)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(p){var Y=this;if(Y._57O!==p){var Z=Y._57O;Y._57O=p,Y.fp("expanded",Z,Y._57O),Y._fireInvalidateDeep(),Y._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(s){Re(s)?s._fireInvalidateDeep():s.iv()})},_8I:function(){oq.superClass._8I.call(this),this.eachChild(function(F){Fg(F)&&F._8I()})},onStyleChanged:function(P){oq.superClass.onStyleChanged.apply(this,arguments),"group.position"===P&&this._81I()},getSerializableProperties:function(){var m=oq.superClass.getSerializableProperties.call(this);return m.expanded=1,m}});var aq=A.Camera=function(){nk(aq,this),this.s({"shadow.cast":!1,"shadow.receive":!1,shape3d:"billboard"}),this._viewMatrix=new ym.Matrix4,this._projectMatrix=new ym.Matrix4,this.setScale3d(1,1,-1),this.setCullingMask("main,top"),this._projectMatrixDirty=!0};aq.CubeDirectionParam=[1,0,0,0,-1,0,-1,0,0,0,-1,0,0,1,0,0,0,1,0,-1,0,0,0,-1,0,0,1,0,-1,0,0,0,-1,0,-1,0],Og("Camera",jr,{_22Q:function(){return Camera3dUI},attachRenderTarget:function(z){this._projectMatrixDirty=!0,this.renderTarget=z},detachRenderTarget:function(){this._projectMatrixDirty=!0,this.renderTarget=null},setCullingMask:function(O){var v=O.split(",");this._cullingMask=im(v)},isLayerVisible:function(V){var j=Xb[V];return j&&Ne(this._cullingMask,j.mask)},isOrtho:function(){return"ortho"===this.s("camera.type")&&!this.isCube()},isCube:function(){return this.renderTarget&&this.renderTarget.isCube()},isPerspective:function(){return!this.isOrtho()},setViewMatrix:function(){var Y=new A.Math.Matrix4,M=new A.Math.Euler;return function(U){var i=this;U.isMatrix4?i._viewMatrix.copy(U):i._viewMatrix.fromArray(U),Y.getInverse(i._viewMatrix),i.p3(Y.getPosition().toArray()),M.set(0,0,0,i.getRotationMode(),!0).setFromRotationMatrix(Y),i.r3([M.x,M.y,M.z])}}(),getViewMatrix:function(O){var b=this,T=dd(null,null,b.r3(),b.getRotationMode(),b.p3()),S=b._viewMatrix;return S.fromArray(T).getInverse(S),S.toArray(O)},setProjectMatrix:function(J){var D=this;J.isMatrix4?D._projectMatrix.copy(J):D._projectMatrix.fromArray(J),J=D._projectMatrix.getElements(),D.isOrtho()?D.s({"camera.near":(J[14]+1)/J[10],"camera.far":(J[14]-1)/J[10],"camera.ortho.width":2/J[0]}):D.s({"camera.near":J[14]/(J[10]-1),"camera.far":J[14]/(J[10]+1),"camera.fovy":2*Math.atan(1/J[5]),"camera.aspect":J[5]/J[0]}),D._projectMatrixDirty=!1},onPropertyChanged:function(G){var n=this;aq.superClass.onPropertyChanged.call(n,G);var X=G.property;("s:camera.near"===X||"s:camera.far"===X||"s:camera.fovy"===X||"s:camera.aspect"===X||"s:camera.ortho.width"===X)&&(n._projectMatrixDirty=!0)},getProjectMatrix:function(){var d=this;if(d._projectMatrixDirty){var T=d.gv,u=d.isCube(),Y=u?1:d.s("camera.aspect")||(T?T.getAspect():null)||z.graph3dViewAspect,c=d.s("camera.near")||(T?T.getNear():null)||z.graph3dViewNear,w=d.s("camera.far")||(T?T.getFar():null)||z.graph3dViewFar,q=dq();if(d.isOrtho()){var v=d.s("camera.ortho.width")||(T?T.getOrthoWidth():null)||z.graph3dViewOrthoWidth,k=v/2,W=k/Y;ij(q,-k,k,-W,W,c,w)}else{var Z=u?Math.PI/2:d.s("camera.fovy")||(T?T.getFovy():null)||z.graph3dViewFovy;ph(q,Z,Y,c,w)}d._projectMatrix.fromArray(q),d._projectMatrixDirty=!1}return d._projectMatrix.toArray()},lookAt:function(n,t){var P=this.p3();return n.x?this.lookAtDirection([n.x-P[0],n.y-P[1],n.z-P[2]],t):this.lookAtDirection([n[0]-P[0],n[1]-P[1],n[2]-P[2]],t)},lookAtDirection:function(){var X=new A.Math.Matrix4,T=new A.Math.Euler,j=new A.Math.Vector3,b=new A.Math.Vector3;return function(m,f){X.lookAtDirection(j.copy(m).multiplyScalar(-1),f?b.copy(f):b.set(0,1,0)),T.set(0,0,0,this.getRotationMode(),!0).setFromRotationMatrix(X),this.r3([T.x,T.y,T.z])}}(),render:function(u){var H=this,V=u.getGL();if(!V)return!1;var E,G,x=H.renderTarget;if(x)E=x.width,G=x.height;else{var M=u.getDevicePixelRatio();E=u.getWidth()*M,G=u.getHeight()*M}H.gv=u,u._camera=H;var T=u._frameState.renderState.glState,Q=T.color.clear.slice(0);Il(V,H.s("camera.background"));var F=u.getEye;if(u.getEye=function(){return H.p3()},H.isCube())for(var l=aq.CubeDirectionParam,g=0;6>g;g++)x&&x.bind(V,g),H.lookAtDirection([l[6*g+0],l[6*g+1],l[6*g+2]],[l[6*g+3],l[6*g+4],l[6*g+5]]),V.clear(V.COLOR_BUFFER_BIT),u.setViewport(V,0,0,E,G),H.s("camera.onlySky")?u.renderSky():u.renderScene({renderAxis:H.s("camera.renderAxis"),renderGrid:H.s("camera.renderGrid"),renderEdit:H.s("camera.renderEdit"),renderReflector:!1}),x&&x.unbind(V);else x&&x.bind(V),V.clear(V.COLOR_BUFFER_BIT),u.overlappingBox.clear(),u.setViewport(V,0,0,E,G),H.s("camera.onlySky")?u.renderSky():u.renderScene({renderAxis:H.s("camera.renderAxis"),renderGrid:H.s("camera.renderGrid"),renderEdit:H.s("camera.renderEdit")}),x&&x.unbind(V);return u.getEye=F,Il(V,Q),u._camera=null,H.gv=null,!0}});var dp=A.Block=function(){nk(dp,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};Og("Block",jr,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Yp},_22Q:function(){return at},onChildAdded:function(){dp.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){dp.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function K(d,S,g){z.fromArray(Gq(S));var i=S.getAnchor3d();d.push((new ti).set(0-i.x,0-i.y,0-i.z).applyMatrix4(z).applyMatrix4(g)),d.push((new ti).set(0-i.x,0-i.y,1-i.z).applyMatrix4(z).applyMatrix4(g)),d.push((new ti).set(0-i.x,1-i.y,0-i.z).applyMatrix4(z).applyMatrix4(g)),d.push((new ti).set(0-i.x,1-i.y,1-i.z).applyMatrix4(z).applyMatrix4(g)),d.push((new ti).set(1-i.x,0-i.y,0-i.z).applyMatrix4(z).applyMatrix4(g)),d.push((new ti).set(1-i.x,0-i.y,1-i.z).applyMatrix4(z).applyMatrix4(g)),d.push((new ti).set(1-i.x,1-i.y,0-i.z).applyMatrix4(z).applyMatrix4(g)),d.push((new ti).set(1-i.x,1-i.y,1-i.z).applyMatrix4(z).applyMatrix4(g))}function G(i,p){var h=(new gq).makeRotationFromEuler(this.getEuler()).setPosition((new ti).fromArray(this.p3()));h.getInverse(h),i.forEach(function(Q){Fg(Q)&&K(p,Q,h)})}var z=new gq;return function(_,P){if(_ instanceof jr&&(_=[_]),!_||0===_.length)return I;var P=[];G.call(this,_,P);var c=[1/0,1/0,1/0],w=[-1/0,-1/0,-1/0];return P.forEach(function(Z){c[0]=Math.min(Z.x,c[0]),c[1]=Math.min(Z.y,c[1]),c[2]=Math.min(Z.z,c[2]),w[0]=Math.max(Z.x,w[0]),w[1]=Math.max(Z.y,w[1]),w[2]=Math.max(Z.z,w[2])}),{min:c,max:w}}}(),updateFromChildren:function(){var Z=this;if(!Yr&&!Z._updatingToChildren&&Z._syncSize&&0!==Z.size()&&!Z._freezeSyncFromChildren){var G=this._getBoundingBox(Z.toChildren(Fg));if(G){Z._updatingFromChildren=1;var h=(new ti).fromArray(this.getScale3d()),x=(new ti).fromArray(G.min),r=(new ti).fromArray(G.max),K=z.blockMinSize,Y=new ti,y=r.clone().sub(x);0===y.x&&Y.setX(.5),0===y.y&&Y.setY(.5),0===y.z&&Y.setZ(.5);var O=this._width==I||-1===this._width,X=new ti(this.getAnchor3d()),p=h.clone().multiply((new ti).fromArray(this.s3())),D=y.clone();0===D.x&&D.setX(K),0===D.y&&D.setY(K),0===D.z&&D.setZ(K);var N=X.clone().multiply(p),f=N.clone().multiplyScalar(-1).sub(x).divide(D).add(N.divide(D)).add(Y),H=this.s("keepPosition");if(O||this._anchorChanged||this._scaleChanged||!H){!O&&H&&(X=f);var v=X.clone().multiply(y).add(x).applyEuler(this.getEuler()).add((new ti).fromArray(this.p3()));this.p3([v.x,v.y,v.z])}else this.setAnchor3d(f.x,f.y,f.z);var n=new ti(1,1,1).divide(h).multiply(y);this.s3(Math.abs(n.x),Math.abs(n.y),Math.abs(n.z)),delete Z._updatingFromChildren}}},setPosition:function(v,t){var r=this;if(!r._updatingToChildren){var O;O=2===arguments.length?{x:v,y:t}:v,Yr||r._updatingFromChildren||(r._updatingToChildren=1,ed(r._children,O.x-r._position.x,O.y-r._position.y),delete r._updatingToChildren),dp.superClass.setPosition.call(this,O)}},setSize3d:function(){this.beginTransaction(),dp.superClass.setSize3d.apply(this,arguments),this.endTransaction()},setTall:function(e){var j=this;if(!j._updatingToChildren){this.beginTransaction(),e=i(e,z.blockMinSize);var o=j.getTall();if(e!==o&&dp.superClass.setTall.call(j,e),!Yr&&!j._updatingFromChildren){j._updatingToChildren=1;var s=e/o;j._adjustChildTallOrScale(s,"size"),delete j._updatingToChildren,j.updateFromChildren()}this.endTransaction()}},setWidth:function(M){return this.setSize(M,this.getHeight())},setHeight:function(I){return this.setSize(this.getWidth(),I)},setSize:function(B,h){var S=z.blockMinSize;B=i(B,S),h=i(h,S);
var H=this;if(!H._updatingToChildren){2!==arguments.length&&(h=B.height,B=B.width),this.beginTransaction();var O=H.getWidth(),c=H.getHeight();if(B!==O&&dp.superClass.setWidth.call(H,B),h!==c&&dp.superClass.setHeight.call(H,h),!Yr&&!H._updatingFromChildren){H._updatingToChildren=1;var U=B/O,f=h/c;H._adjustChildScaleOrSize(U,f,"size"),delete H._updatingToChildren,H.updateFromChildren()}this.endTransaction()}},_adjustChildScaleOrSize:function(k,J,t){var s=this;if(s._syncSize){var n=s.getPosition(),D=s.getRotation();s.eachChild(function(p){if(Fg(p)){var y=p.getPosition(),Z=p.getRotation(),w=p.getWidth(),x=p.getHeight(),b=p.getScale(),L=b.x*w,m=b.y*x;if(0!==L&&0!==m){0>k*J&&p.setRotation(-1*Z);var G=new Xl(Z,y.x,y.y,L,m);G.translate(-n.x,-n.y),G.rotate(-D),Z=id(G.b*Math.sign(L),G.a*Math.sign(L)),G.scale(k,J);var s,g,V,F=l(Z);if(Math.abs(F)<.001?(s=d(Z),g=G.b/s,V=-G.c/s):(g=G.a/F,V=G.d/F),"scale"===t)p.setScale(g/w,V/x);else if("size"===t){var I=g/b.x,Y=V/b.y;p.setScale(Oh(g)*Math.abs(b.x),Oh(V)*Math.abs(b.y)),p instanceof A.Shape?(p.setWidthForce(Math.max(Math.abs(I),1e-5)),p.setHeightForce(Math.max(Math.abs(Y),1e-5))):p.setSize(Math.max(.01,Math.abs(I)),Math.max(.01,Math.abs(Y)))}G.rotate(D),G.translate(n.x,n.y),p.setPosition(G.tx,G.ty)}}})}},_calcChangeFactor:function(z,r,D,H){var K,I,X,o;return K=f(z),I=f(D),X=K>I?K/I:I/K,K=f(r),I=f(H),o=K>I?K/I:I/K,i(X,o)},setElevation:function(u){var y=this;if(!y._updatingToChildren){var m=y.getElevation(),C=u-m;0!==C&&(Yr||y._updatingFromChildren||(y._updatingToChildren=1,ed(y._children,0,C,0),delete y._updatingToChildren),dp.superClass.setElevation.apply(y,arguments))}},setScaleTall:function(s){var P=this;if(!P._updatingToChildren){var V=P.getScaleTall();if(f(s)<.01&&(s=.01*(Oh(s)||Oh(V))),dp.superClass.setScaleTall.call(P,s),!Yr&&!P._updatingFromChildren){P._updatingToChildren=1;var b=s/V;P._adjustChildTallOrScale(b,"scale"),delete P._updatingToChildren,P._scaleChanged=1,this.updateFromChildren(),delete P._scaleChanged}}},_adjustChildTallOrScale:function(A,F){var k=this;if(k._syncSize){var s=k.getElevation();k.eachChild(function(M){if(Fg(M)){if("size"===F){var Z=M.getTall();0>A&&M.setScaleTall(-1*M.getScaleTall()),M.setTall(Math.max(.01,Math.abs(Z*A)))}else{var B=M.getScaleTall();M.setScaleTall(B*A)}M.setElevation(s+(M.getElevation()-s)*A)}})}},setAnchor3d:function(){if(!this._updatingToChildren){this.beginTransaction();var y=dp.superClass.setAnchor3d.apply(this,arguments);return y&&!Yr&&!this._updatingFromChildren&&this._syncSize&&(this._anchorChanged=1,this.updateFromChildren(),delete this._anchorChanged),this.endTransaction(),y}},setAnchor:function(){var k=this;if(!k._updatingToChildren){var y=k.getAnchor(),f=dp.superClass.setAnchor.apply(k,arguments);if(Yr||k._updatingFromChildren||!k._syncSize)return f;k._updatingToChildren=1;var r=k.getAnchor();k.getPosition();var E=k.getSize(),H=k.getScale(),u=k.getRotation(),i=-E.width*H.x*(y.x-r.x),t=-E.height*H.y*(y.y-r.y),g=d(u),Y=l(u),$=Y*i-g*t,A=g*i+Y*t;return k.eachChild(function(L){if(Fg(L)){var k=L.getPosition();L.setPosition(k.x-$,k.y-A)}}),delete k._updatingToChildren,f}},setAnchorElevation:function(){var n=this;if(!n._updatingToChildren){var m=n.getAnchorElevation(),q=dp.superClass.setAnchorElevation.apply(n,arguments);if(Yr||n._updatingFromChildren||!n._syncSize)return q;n._updatingToChildren=1;var y=n.getAnchorElevation(),c=n.getTall(),Q=n.getScaleTall(),E=-c*Q*(m-y);return n.eachChild(function(q){if(Fg(q)){var B=q.getElevation();q.setElevation(B-E)}}),delete n._updatingToChildren,q}},setRotation:function(n){this._updateChildrenRotation3d("rotation",n)},setRotationX:function(Y){this._updateChildrenRotation3d("rotationX",Y)},setRotationZ:function(Y){this._updateChildrenRotation3d("rotationZ",Y)},setRotation3d:function(){var V=this;if(!V._updatingToChildren){var I=V.r3();dp.superClass.setRotation3d.apply(V,arguments);var a=V.r3();Yr||V._updatingFromChildren||(V._updatingToChildren=1,V.eachChild(function(k){Fg(k)&&k.syncRotation3d(V,a,I)}),delete V._updatingToChildren)}},_updateChildrenRotation3d:function(R,o){var T=this;if(!T._updatingToChildren){var X=T[yf(R)]();dp.superClass[om(R)].call(T,o),Yr||T._updatingFromChildren||this._updateRotationToChildren(R,o-X)}},_updateRotationToChildren:function(u,V){var X=this;X._updatingToChildren=1,X.eachChild(function(f){Fg(f)&&f._11Q(X,u,V)}),delete X._updatingToChildren},setScale:function(b,g){var Y=this;if(!Y._updatingToChildren){null==g&&(g=b.y,b=b.x);var k=Y.getScale();if(f(b)<.01&&(b=.01*(Oh(b)||Oh(k.x))),f(g)<.01&&(g=.01*(Oh(g)||Oh(k.y))),dp.superClass.setScale.call(Y,b,g),!Yr&&!Y._updatingFromChildren){Y._updatingToChildren=1;var x=b/k.x,y=g/k.y;Y._adjustChildScaleOrSize(x,y,"scale"),delete Y._updatingToChildren,Y._scaleChanged=1,Y.updateFromChildren(),delete Y._scaleChanged}}},onPropertyChanged:function(e){dp.superClass.onPropertyChanged.call(this,e),"s:3d.visible"===e.property&&this._invalidateChildrenBatch()},_invalidateChildrenBatch:function(){this.eachChild(function(W){(W.s("batch")||W.s("wf.geometry")||W.s("wf.visible"))&&W.iv(),W instanceof dp&&W._invalidateChildrenBatch()})},getSerializableProperties:function(){var c=dp.superClass.getSerializableProperties.call(this);return c.clickThroughEnabled=1,c.syncSize=1,c}});var bl=A.Grid=function(){nk(A.Grid,this)};Og("Grid",jr,{IRotatable:!1,_icon:"grid_icon",_image:I,getUIClass:function(){return mm},setRotation:function(){},getCellRect:function(l,N){var m=this,c=m.s("grid.row.count"),i=m.s("grid.column.count");if(0>=c||0>=i||0>l||l>=c||0>N||N>=i)return I;var q,p,P,w=m.getRect(),e=m.s("grid.row.percents"),C=m.s("grid.column.percents");if(of(w,m,"grid.border",-1),e&&e._as&&(e=e._as),C&&C._as&&(C=C._as),e&&e.length===c){for(P=0,q=0;l>q;q++)P+=w.height*e[q];w.y+=P,w.height=w.height*e[l]}else w.height=w.height/c,w.y+=w.height*l;if(C&&C.length===i){for(p=0,q=0;N>q;q++)p+=w.width*C[q];w.x+=p,w.width=w.width*C[N]}else w.width=w.width/i,w.x+=w.width*N;return oh(w,-m.s("grid.gap")),w}});var ji=A.Text=function(){nk(ji,this),this.setSize(100,50),this.s("text","TEXT")};Og("Text",jr,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return tm},setWidth:function(h){h||(h=.001),ji.superClass.setWidth.call(this,h)},setHeight:function(d){d||(d=.001),ji.superClass.setHeight.call(this,d)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),Se("__text__",{width:{value:100,isSafeFunc:!0,func:function(J){return J?J._width:100}},height:{value:50,isSafeFunc:!0,func:function(F){return F?F._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"},gradient:{func:"style@text.gradient"},gradientColor:{func:"style@text.gradient.color"},gradientPack:{func:"style@text.gradient.pack"},decoration:{func:"style@text.decoration"},vertical:{func:"style@text.vertical"},verticalGap:{func:"style@text.vertical.gap"},wrap:{func:"style@text.wrap"},letterGap:{func:"style@text.letter.gap"},borderWidth:{func:"style@text.border.width"},borderColor:{func:"style@text.border.color"}}]});var Mi=A.Shape=function(){nk(Mi,this),this._59O=new Gc};Mi.__de__=Ai,Og("Shape",jr,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Zm},_22Q:function(){return ct},getLength:function(C){return Pg(rb(this._59O,this._58O,C,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var w=this._58O;return w?new Gc(w._as.slice(0)):w},setSegments:function(V){var v=this._58O;V=V?gc(V)?new Gc(V.slice(0)):new Gc(V._as.slice(0)):null,(v&&V&&v._as.join(",")!==V._as.join(",")||v!==V)&&(this._58O=V,this.fp("segments",v,V))},getPoints:function(){return this._59O},toPoints:function(){var G=this._59O;return new Gc(G._as.slice(0))},getPointsMatrix2d:function(){var g=this,N=new ym.Matrix2d,H=g.getPosition(),t=g.getScale(),O=g.getRotation();return N.translate(-H.x,-H.y).scale(t.x,t.y).rotate(O).translate(H.x,H.y),N},getPointsMatrix3d:function(){return function(){var Q=this,r=new ym.Matrix4,H=r.getElements(),w=Q.p3();oi(H,w),Vd(H,Q.getFinalRotation3d(),Q.getRotationMode());var G=Q.getScale3d(),R=Q._dynamicScale3d;return R&&(G[0]*=R[0],G[1]*=R[1],G[2]*=R[2]),yi(H,G),oi(H,ad(w)),r}}(),setPoints:function(T,$){var Y=this,w=Y._59O;T=T?gc(T)?new Gc(T.slice(0)):new Gc(T._as.slice(0)):new Gc;var m,S,p,O,U,g;$&&(m=Y.getPosition(),g=new Xl(Y.getRotation(),0,0,Y.getScale().x,Y.getScale().y)),(w&&T&&w._as.join(",")!==T._as.join(",")||w!==T)&&(Y._59O=T,Y.fs(),Y.fp("points",w,T)),$&&(S=Y.getPosition(),p=S.x-m.x,O=S.y-m.y,U=g.tf(p,O),Y.setPosition(S.x-p+U.x,S.y-O+U.y))},setPoints3d:function(L,p){var U=new ti(this.p3()),Y=this.getPointsMatrix3d();if(Y.setPosition(new ti),nl.superClass.setPoints.call(this,L),p){var e=new ti(this.p3()),h=e.clone().sub(U).applyMatrix4(Y);U.add(h),this.p3(U.x,U.y,U.z)}},addPoint:function(R,u,K){var H=this.toPoints();H.add(R,u),this.setPoints(H,K)},setPoint:function(r,v,z){var w=this.toPoints();w.set(r,v),this.setPoints(w,z)},removePointAt:function(Y){var f=this.toPoints();f.removeAt(Y),this.setPoints(f)},setWidthForce:function(s){var K=this;if(!K._55I&&!Yr&&K.getWidth()){K._55I=1;var d=K._position.x,B=s/K.getWidth(),k=K.toPoints(),V=new Gc;1!==B&&(k.each(function(C){V.add({x:(C.x-d)*B+d,y:C.y,e:C.e})}),K.setPoints(V),qc(K,[B,0,0,1,d*(1-B),0]),K.fs()),delete K._55I}Mi.superClass.setWidth.call(K,s)},setWidth:function(j){return this.setWidthForce(Nm>j?Nm:j)},setHeightForce:function(F){var P=this;if(!P._55I&&!Yr&&P.getHeight()){P._55I=1;var L=P._position.y,i=F/P.getHeight(),r=P.toPoints(),d=new Gc;1!==i&&(r.each(function(W){d.add({x:W.x,y:(W.y-L)*i+L,e:W.e})}),P.setPoints(d),qc(P,[1,0,0,i,0,L*(1-i)]),P.fs()),delete P._55I}Mi.superClass.setHeight.call(P,F)},setHeight:function(J){return this.setHeightForce(Nm>J?Nm:J)},setAnchorElevation:function(v){var e=this;e._55I=!0;var h=e._updatingAnchor3d,C=!Yr&&!h;if(C){var l,j=v,y=e.getAnchorElevation(),L=e.getTall();l=L*(y-j),0!==l&&e.shiftPointsElevation(l)}var V=Mi.superClass.setAnchorElevation.apply(e,arguments);return h||delete e._55I,V},getShapeElevation:function(){var v=this,m=v._54O;return m-(v.getTall()||0)*(v._anchorElevation-.5)},setAnchor3d:function(L,M,R,Q){var W,w=this;if("number"==typeof L?W={x:L,y:M,z:R}:(W=L.length?{x:L[0],y:L[1],z:L[2]}:L,Q=M),w._55I=!0,w._updatingAnchor3d=!0,w.beginTransaction(),!Yr){var y=w.getAnchor3d(),Z=w.getSize(),i=w.getTall(),U=Z.width*(y.x-W.x),h=Z.height*(y.z-W.z),e=i*(y.y-W.y);Q||w.shiftPoints(U,h,e);var m=w.p3()}var T=Mi.superClass.setAnchor3d.apply(w,arguments);if(!Yr&&Q){var f=w.p3();w.shiftPoints(f[0]-m[0]+U,f[2]-m[2]+h,f[1]-m[1]+e)}return w.endTransaction(),delete w._updatingAnchor3d,delete w._55I,T},setAnchor:function(T,r,Y){var e=this;e._55I=!0;var _=e._updatingAnchor3d,F=!Yr&&!_;if(F){var K,s,v;"number"==typeof T?v={x:T,y:r}:(v=T.length?{x:T[0],y:T[1]}:T,Y=r);var E=e.getAnchor(),U=e.getSize();K=U.width*(E.x-v.x),s=U.height*(E.y-v.y),Y||e.shiftPoints(K,s);var i=e.getPosition()}var w=Mi.superClass.setAnchor.apply(e,arguments);if(F){var N=e.getPosition();Y&&e.shiftPoints(N.x-i.x+K,N.y-i.y+s)}return _||delete e._55I,w},shiftPoints:function(R,i,f){if(R||i||f){var s=this,J=s.getElevation()||0,L=s.toPoints(),p=new Gc;L.each(function(u){var Y=u.e;f&&(Y=(Y==I?J:Y)+f),p.add({x:u.x+R,y:u.y+i,e:Y})}),s.setPoints(p),s.fs()}},shiftPointsElevation:function(I){return this.shiftPoints(0,0,I)},setPosition:function(Z,b){var t,g=this;if(!g._28Q){if(g._28Q=1,!g._55I&&!Yr){t=2===arguments.length?{x:Z,y:b}:Z;var j=t.x-g._position.x,f=t.y-g._position.y;if(0===j&&0===f)return delete g._28Q,void 0;g._55I=1,g.shiftPoints(j,f),qc(g,[1,0,0,1,j,f]),delete g._55I}Mi.superClass.setPosition.apply(g,arguments),delete g._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var O=this;if(2!==O._59O.size())return!1;var s=O._58O;return s?2===s.size()&&1===s.get(0)&&2===s.get(1)?!0:!1:!0},fireShapeChange:function(){var A=this;if(!A._55I&&!Yr){var w=Mc(A._59O);w&&(A._55I=1,A.setRect(w),delete A._55I)}A.fp(eo,!1,!0)},getSerializableProperties:function(){var W=Mi.superClass.getSerializableProperties.call(this);return W.segments=1,W.points=1,W.thickness=1,W.closePath=1,W}});var Gm=A.Points=function(){nk(Gm,this)};Og("Points",jr,{_59O:[],_colors:[],_sizes:[],_uvoffsets:[],_22Q:function(){return dt},getPoints:function(){return this._59O},setPoints:function(n){var Q=this._59O;n=n?n.slice(0):[];var K=n[0];if(Cp(K)){var l=n;n=[];for(var e=0,A=l.length;A>e;e+=3)n.push({x:l[e],e:l[e+1],y:l[e+2]})}this._59O=n,this._pointsDirty=!0,this.fp("points",Q,this._59O)},setPoint:function(C,q){var P=this._59O.slice(0);P[C]=q,this.setPoints(P)},addPoint:function(I){this.setPoint(this._59O.length,I)},getColors:function(){return this._colors},setColors:function(s){var m=this._colors;s=s?s.slice(0):[],this._colors=s,this._colorsDirty=!0,this.fp("colors",m,s)},setPointColor:function(E,Q){var n=this._colors.slice(0);n[E]=Q,this.setColors(n)},getSizes:function(){return this._sizes},setSizes:function(B){var N=this._sizes;B=B?B.slice(0):[],this._sizes=B,this._sizesDirty=!0,this.fp("sizes",N,this._sizes)},setPointSize:function(I,P){var B=this._sizes.slice(0);B[I]=P,this.setSizes(B)},getUvoffsets:function(){return this._uvoffsets},setUvoffsets:function(X){var x=this._uvoffsets;X=X?X.slice(0):[],this._uvoffsets=X,this._offsetsDirty=!0,this.fp("uvoffsets",x,this._uvoffsets)},setPointUvoffset:function(O,D,L){var I;"object"==typeof D?(I=D[0],L=D[1]):I=D;var X=this._uvoffsets.slice(0);X[2*O+0]=I,X[2*O+1]=L,this.setUvoffsets(X)},getPointInfo:function(W){var U=this.getPoints();if(!U||U[W]==I)return I;var w=U[W],l=[w.x,w.e,w.y],Y=this.mat||Gq(this),P=[l[0],l[1],l[2]];xl(P,Y);var _=this.getColors(),Z=_[W]||this.s("points.color"),c=this.getSizes(),D=c[W];return{size:D==I?this.s("points.size"):D,color:Z,local:l,world:P}},getSerializableProperties:function(){var p=Gm.superClass.getSerializableProperties.call(this);return p.points=1,p.colors=1,p.sizes=1,p.uvoffsets=1,p},onPropertyChanged:function(D){Gm.superClass.onPropertyChanged.call(this,D);var L=D.property;"s:points.color"===L?this._colorsDirty=!0:"s:points.size"===L?this._sizesDirty=!0:"s:points.model"===L&&(this._modelDirty=!0)},getWidth:function(){var x=this;if(x._width>=0)return x._width;var r=x.getStyle("points.model");if(r){var Q=jo(r);if(Q&&Q.rawS3)return Q.rawS3[0]}return 1},getHeight:function(){var G=this;if(G._height>=0)return G._height;var J=G.getStyle("points.model");if(J){var Z=jo(J);if(Z&&Z.rawS3)return Z.rawS3[2]}return 1},getTall:function(){var b=this;if(b._tall>=0)return b._tall;var r=b.getStyle("points.model");if(r){var g=jo(r);if(g&&g.rawS3)return g.rawS3[1]}return 1}});var nl=A.Polyline=function(){nk(nl,this),this.s({"shape.background":null,"shape.border.width":2})};Og("Polyline",Mi,{_icon:"polyline_icon",_22Q:function(){return gt},getUIClass:function(){return dn},setClosePath:function(){},setTall:function(n){var W=this;if(W.beginTransaction(),!W._55I&&!W._24Q&&!Yr&&W.getTall()){W._24Q=1;var p=W._54O,o=n/W.getTall();if(1!==o){var l=W.toPoints(),e=new Gc;l.each(function(Y){e.add({x:Y.x,y:Y.y,e:Y.e==I?Y.e:(Y.e-p)*o+p})}),W.setPoints(e),W.fs()}delete W._24Q}nl.superClass.setTall.call(W,n),W.endTransaction()},setElevation:function(L){var m=this;if(m.beginTransaction(),!m._55I&&!m._24Q&&!Yr){m._24Q=1;var M=L-m._54O;0!==M&&m.shiftPointsElevation(M),delete m._24Q}nl.superClass.setElevation.apply(m,arguments),m.endTransaction()},fireShapeChange:function(){var g=this,w=g._59O;if(!g._55I&&!g._24Q&&!Yr){var y=w.size();if(y){var D=1,U=w.get(0),A=g._54O;U.e==I&&(U.e=A);for(var c=U.e,r=0;y>D;D++){U=w.get(D),U.e==I&&(U.e=A);var f=a(c,U.e),Z=i(c+r,U.e);c=f,r=Z-f}g._24Q=1,g.setTall(r),g.setElevation(c+r*g._anchorElevation),delete g._24Q}}nl.superClass.fireShapeChange.apply(g,arguments)}});var Lp=A.SubGraph=function(){nk(Lp,this)};Og("SubGraph",jr,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Lp.superClass._8I.call(this),this.eachChild(function(b){Fg(b)&&b._8I()})}}),z.loadingRefGraph=0;var vh=A.RefGraph=function(){nk(vh,this)};Og("RefGraph",dp,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(j){var H=this._ref;this._ref=j,this.fp("ref",H,j),this.updateRef()},_21I:function(){vh.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var E=this;if(z.loadingRefGraph++,E.clearChildrenFromDataModel(),z.loadingRefGraph--,E._ref&&E._dataModel){E._xhrLoadHandler&&(E._xhrLoadHandler.cancel=!0);var A=Yr,C=E._xhrLoadHandler=function(k){if(k&&E._dataModel){z.loadingRefGraph++;var n=E._pendingUpdateInfo={needToRestore:A};A&&(n.p3=E.p3(),n.s3=E.s3(),n.r3=E.r3(),n.anchor3d=E.getAnchor3d(),n.scale3d=E.getScale3d()),E.r3(0,0,0),E.setScale3d(1,1,1),E.setAnchor3d(.5,.5,.5),E.p3(0,0,0);var b=z.parse(k),P=E._dataModel.deserialize(b,E,{justDatas:!0});P.each(function(d){d._refGraph=E}),E.checkPendingUpdateInfo(),z.loadingRefGraph--,z.handleRefGraphLoaded(E,P,b)}};C.xhrLoadCalled=!1,z.load(E._ref,function(c){C.cancel||(C.xhrLoadCalled?C(c):Km(function(){C(c)}))}),C.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var Q=this,v=Q._pendingUpdateInfo;if(!v)return Q.onPendingUpdated&&(z.loadingRefGraph++,Q.onPendingUpdated(),z.loadingRefGraph--),void 0;var m=!0;this.eachChild(function(p){(p._pendingCheckImageJSON||p._pendingUpdateInfo)&&(m=!1)}),m&&(z.loadingRefGraph++,Q._pendingUpdateInfo=null,Q.updateFromChildren(),v.needToRestore&&(Q.setAnchor3d(v.anchor3d),Q.setScale3d(v.scale3d),Q.r3(v.r3),Q.p3(v.p3)),this.getParent()instanceof vh&&this.getParent().checkPendingUpdateInfo(),Q.onPendingUpdated&&Q.onPendingUpdated(),z.loadingRefGraph--)},getSerializableProperties:function(){var E=vh.superClass.getSerializableProperties.call(this);return E.ref=1,E}}),A.EdgeGroup=function(F,w){this._70O=F,this._siblings=w;for(var l,g,T=0,j=F.size(),V=s[up];j>T;T++)if(l=F.get(T).getStyle(up,!1),l!=I){V=l;break}V==I&&(V=!0);var o=z.edgeGroupAgentFunc;for(o&&(g=o(F),g&&g!==F.get(0)&&(F.remove(g),F.add(g,0))),T=0;j>T;T++)F.get(T).s(up,V)},Og("EdgeGroup",j,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(P){return this._70O.get(P)},indexOf:function(b){return this._70O.indexOf(b)},each:function(H,X){this._70O.each(H,X)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(D,P){this._siblings.each(function(H){H._70O.each(D,P)})}});var op=function(u,J,C){var s=Yb[u]={type:u,action:J};if(C)for(var x in C)s[x]=C[x]};Xi(z,{setConnectAction:op,getConnectAction:function(P,G){if(!G){if(!P)return null;G=P.getCurrentConnectActionType()}return Yb[G]},doConnectAction:function(q,I,e,s){s=s||q.getCurrentConnectActionType();var y=Yb[s];if(!y)return!1;var K=y.action;return K?(I instanceof wf.Group?q.sm().getSelection().each(function(b){K.call(null,q,b,e)}):K.call(null,q,I,e),!0):!1},doDeleteConnectionAction:function(p,a,Y){Y=Y||p.getCurrentConnectActionType();var t=Yb[Y];if(!t||!t.delete)return!1;var F=t.delete.action;return F?(a instanceof wf.Group?p.sm().getSelection().each(function(d){F.call(null,p,d)}):F.call(null,p,a),!0):!1}});var ih=A.JSONSerializer=function(d,p){this.dm=this._dataModel=d,this._hierarchical=z.forceHierarchicalSerialization?!0:p==I?d.isHierarchicalRendering():p};Og("JSONSerializer",j,{ms_ac:["hierarchical"],serialize:function(C){return z.stringify(this.toJSON(),C)},toJSON:function(){var F,D=this,v=D.dm,e=v.getRoots(),Q=D.json={v:z.getVersion(),p:{},a:{},d:[]},G=v.getSerializableAttrs();(F=v.getInit())&&(Q.init=F),(F=v.getName())&&(Q.p.name=F),(F=v.getBackground())&&(Q.p.background=F),(F=v.getLayers())&&(Q.p.layers=F),(F=v.getEnvmap())&&(Q.p.envmap=F),(F=v.getEnvmapType())&&(Q.p.envmapType=F),Q.p.autoAdjustIndex=v.isAutoAdjustIndex(),Q.p.hierarchicalRendering=v.isHierarchicalRendering();for(var N in G){var T=v.a(N);T!==_&&D[Uj](N,T,Q.a)}return Ze(Q.a)&&delete Q.a,D._hierarchical?e.each(D.serializeData,this):v.each(function(K){D.serializeData(K)}),v.fireSerializeEvent({type:"serialize",json:Q}),v.getPostProcessingData()&&(Q.p.postProcessingData=v.getPostProcessingData()),Q},isSerializable:function(){return!0},getProperties:function(D){return D.getSerializableProperties()},getStyles:function(f){return f.getSerializableStyles()},getAttrs:function(w){return w.getSerializableAttrs()},serializeData:function(k){var L=this;if(L.isSerializable(k)&&!k._refGraph){var $,y,T,D,h=_b(k.getClassName())||k.getClass(),m=new h,w={c:k.getClassName(),i:k.getId(),p:{},s:{},a:{}};L.json.d.push(w),$=L.getProperties(k);for(y in $)if(/^_/.test(y)){if(T=k[y],!("_width"!==y&&"_height"!==y||T!=I&&-1!==T)){var s;((k.s("layout.h")||k.s("layout.v"))&&k.getHost()||k instanceof A.Node&&(s=k.getParent())&&s instanceof A.Block||k.s("fullscreen"))&&(T=k[y]="_width"===y?k.getWidth():k.getHeight())}T!==m[y]&&L[Uj](y.substr(1),T,w.p)}else D=yf(y),k[D]&&(T=k[D](),T!==m[D]()&&L[Uj](y,T,w.p));$=L.getStyles(k);for(y in $)T=k.s(y),T!==m.s(y)&&L[Uj](y,T,w.s);$=L.getAttrs(k);for(y in $)T=k.a(y),T!==m.a(y)&&L[Uj](y,T,w.a);Ze(w.p)&&delete w.p,Ze(w.s)&&delete w.s,Ze(w.a)&&delete w.a}L._hierarchical&&k.getChildren().each(L.serializeData,L)},serializeValue:function(y,M,Z){vq(M)?M={__a:M._as}:M instanceof Nj?M={__i:M.getId()}:M instanceof Tf&&(M={__dm:M.serialize(0)}),Z[y]=M},deserialize:function(U,b,m){var H=this;return Fp(U)&&/.json$/.test(U)?(z.xhrLoad(U,function(K){H.deserializeImpl(K,b,m)}),void 0):H.deserializeImpl(U,b,m)},deserializeImpl:function(q,C,R){var a=this,K=a.dm;K.setDeserializing(!0),R=Je(R)?{setId:R}:gg(R)?{finishFunc:R}:R||{},q=a.json=Fp(q)?z.parse(q):q,!R.justDatas&&q.a&&q.a.onPreDeserialize&&!R.disableOnPreDeserialize&&q.a.onPreDeserialize(q,K,R.view),K.beginTransaction(),Yr++,a._82I={};var W=new Gc,e=new Gc,G=0,B=q.d.length;if(R.justDatas||(!R.disableInit&&gg(q.init)&&q.init(K),K.setInit(q.init)),!R.justDatas){for(var E in q.a)K.a(E,a[Ug](q.a[E]));for(var v in q.p)K[om(v)](q.p[v])}for(;B>G;G++){var f=q.d[G],n=_b(f.c),s=new n,D=f.i;R.setId&&D!=I&&(s._id=D),a._82I[D]=s,W.add(s),e.add(f)}for(G=0;B>G;G++)a.deserializeData(W.get(G),e.get(G));return W.each(function(x){C&&!x.getParent()&&x.setParent(C),K.add(x)}),R.__innerHandler__&&R.__innerHandler__(q,K,R.view,W),K.fireSerializeEvent({type:"deserialize",json:q}),Yr--,K.endTransaction(),!R.justDatas&&q.a&&q.a.onPostDeserialize&&!R.disableOnPostDeserialize&&q.a.onPostDeserialize(q,K,R.view,W),R.finishFunc&&R.finishFunc(q,K,R.view,W),K.setDeserializing(!1),W},deserializeData:function(S,e){for(var u in e.p)S[om(u)](this[Ug](e.p[u]));for(u in e.s)S.s(u,this[Ug](e.s[u]));for(u in e.a)S.a(u,this[Ug](e.a[u]))},deserializeValue:function(v){if(qf(v)){var y=v.__i;if(y!=I)return this._82I[y];if(y=v.__dm,y!=I){var g=new A.DataModel;return g.deserialize(y),g}if(y=v.__a,gc(y))return new Gc(y)}return v}}),Xi(Tf,{serialize:function($,v){return new ih(this,v).serialize($)},toJSON:function(G){return new ih(this,G).toJSON()},deserialize:function(R,a,C){return new ih(this).deserialize(R,a,C)}});var Fc=A.OverlappingBox=function(I){this.gv=I,this.boxes={}};Og("OverlappingBox",j,{clear:function(){var V,$,f=this.boxes;for(V in f)$=f[V],$.length=0},isOverlapping:function($,l){var k,s,B=this,G=B.boxes,q=G[$];q?(k=q.rects,s=q.length):q=G[$]={rects:k=[],length:s=0};var v,I,l;for(v=0;s>v;v++)if(I=k[v],I.x<l.x+l.w&&I.x+I.w>l.x&&I.y<l.y+l.h&&I.h+I.y>l.y)return!0;return k.length<=s?(k.push(l),q.length++):k[q.length++]=l,!1}}),Xi(z,{fetch:function(G,P){var T="GET",e=!1,u=null,f="";P&&(T=P.method||"GET",e=P.sync,f=P.url,u=P.data||null),G.open(T,f,!e),P.responseType?G.responseType=P.responseType:P.overrideMimeType&&G.overrideMimeType&&G.overrideMimeType(P.overrideMimeType),G.send(u)},convertImageSrc:function(Q,c){c&&"function"==typeof c||(c=function(){}),c(Q)}});var ld=A.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};Og("Request",j,{_responseType:null,_overrideMimeType:"text/plain",send:function(u){var h=this._xhr,N=this.onload,r=this.onerror;this.getResponseType()?u.responseType=this.getResponseType():this.getOverrideMimeType()&&(u.overrideMimeType=this.getOverrideMimeType()),h.onload=N,h.onerror=r,z.fetch(h,u)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(y){this._responseType=y},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(h){this._overrideMimeType=h},getResponseText:function(){var W=this._xhr;return W.response||W.responseText}}),Ic.GraphView=function(g){var Q=this;Q._24I={},Q._34I=new Gc,Q.enableDirtyRect(),Q._25I={},Q._56I={},Q._view=nh(1,Q),Q._canvas=th(Q._view),Q.dm(g?g:new Tf),this._coreInteractor=new wq(this),Q.setEditable(!1),Q.setScrollBarVisible(z.graphViewScrollBarVisible),Q._initView()},ll("GraphView",j,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[$k,Hb,Vn,$q,"resettable","editInteractor",On,"zoomable","pannable","rectSelectable","autoScrollZone",Jo,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:z.graphViewZoomable,_resettable:z.graphViewResettable,_pannable:z.graphViewPannable,_rectSelectable:z.graphViewRectSelectable,_autoScrollZone:z.graphViewAutoScrollZone,_rectSelectBackground:z.graphViewRectSelectBackground,_rectSelectBorderColor:z.graphViewRectSelectBorderColor,_editPointSize:z.graphViewEditPointSize,_editPointBorderColor:z.graphViewEditPointBorderColor,_editPointBackground:z.graphViewEditPointBackground,_scrollBarColor:Xq,_scrollBarSize:Eh,_autoHideScrollBar:vc,_autoMakeVisible:Un,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function($){this._dataModel.setLayers($)},setEditable:function(A){var q=this,b=q.__interactorMap__;if(!b){var Y=Ic.XEditInteractor;b=q.__interactorMap__={scrollBar:new Pe(q),select:new jk(q),edit:Y?new Y(q):new wj(q),text:new Wo(q),move:new Cs(q),"default":new $d(q),touch:new pk(q,{editable:!1})}}A?(q._uieditable=!0,q.setInteractors([b.scrollBar,b.select,b.edit,b.text,b.move,b.default,b.touch])):(q._uieditable=!1,q.setInteractors([b.scrollBar,b.select,b.move,b.default,b.touch]))},getCanvas:function(){return this._canvas},_33I:function(p){var j=p.getUIClass();return j?new j(this,p):I},getDataUI:function(x){var F=this,f=F._25I[x._id];return f===_&&(f=F._33I(x),F._25I[x._id]=f),f},getNodeRect:function(O){return z.getNodeRect(this,O)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(F){var d=this.getDataUI(F);return d?(d._79o(),d._78o):null},getEdgeSourcePosition:function(V){var D=this,n=D.getDataUI(V),y=n.s,k=n._data._40I;return rk(D,k,y("edge.source.position"),y("edge.source.offset.x"),y("edge.source.offset.y"),y("edge.source.anchor.x"),y("edge.source.anchor.y"))},getEdgeTargetPosition:function(F){var r=this,N=r.getDataUI(F),V=N.s,e=N._data._41I;return rk(r,e,V("edge.target.position"),V("edge.target.offset.x"),V("edge.target.offset.y"),V("edge.target.anchor.x"),V("edge.target.anchor.y"))},invalidateAll:function(H){var T=this;if(H){for(var U in T._25I){var g=T._25I[U];g&&g.dispose()}T._25I={},T._56I={},T._24I={},T._34I.clear(),T.redraw()}else T.dm().each(function(h){T.invalidateData(h)})},invalidateSelection:function(){var C=this;C.sm().each(function(b){C.invalidateData(b)})},invalidateData:function(n){var J=this;J._24I[n._id]=n,J._21Q(n),J.iv()},_21Q:function(k){var o=this,h=o._24I;if(Rn(k)&&nm[k.s(hs)]){var i=k.getSourceAgent();i&&i.getAgentEdges().each(function(p){h[p._id]=p}),i=k.getTargetAgent(),i&&i.getAgentEdges().each(function(w){h[w._id]=w}),o.iv()}},redraw:function(m){var C=this;C._32I||(m?C._34I.add(m):(C._32I=1,C._34I.clear()),C.iv())},each:function(G,s){var h,k,A,R=0,q=this.getLayers(),X=this._dataModel,E=X._datas._as,B=E.length;if(q){for(var z=q.length;z>R;R++)if(A=q[R],qf(A)&&(A=A.name),X.isHierarchicalRendering()){var i=function(E){return E._layer===A?s?G.call(s,E):G(E):void 0};if(this._dataModel.eachByHierarchical(i)===!1)return}else for(var g=0;B>g;g++)if(h=E[g],h._layer===A&&(k=s?G.call(s,h):G(h),k===!1))return}else if(X.isHierarchicalRendering())this._dataModel.eachByHierarchical(G,null,s);else for(;B>R;R++)if(h=E[R],k=s?G.call(s,h):G(h),k===!1)return},reverseEach:function(q,u){var X,F,s,B,Z=this._dataModel,E=Z._layers,l=Z._datas._as,Q=l.length;if(E){for(X=E.length-1;X>=0;X--)if(B=E[X],qf(B)&&(B=B.name),Z.isHierarchicalRendering()){var g=function(E){return E._layer===B?u?q.call(u,E):q(E):void 0};if(Z.reverseEachByHierarchical(g)===!1)return}else for(var Y=Q-1;Y>=0;Y--)if(F=l[Y],F._layer===B&&(s=u?q.call(u,F):q(F),s===!1))return}else if(Z.isHierarchicalRendering())Z.reverseEachByHierarchical(q,null,u);else for(X=Q-1;X>=0;X--)if(F=l[X],s=u?q.call(u,F):q(F),s===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var c=this,F=c._84I;if(!F){var a=this.dm().a("width"),C=this.dm().a("height");a>0&&C>0?c._84I={x:0,y:0,width:a,height:C}:(c.each(function(g){c.isVisible(g)&&(F=xf(F,c.getDataUIBounds(g)))}),c._84I=F?F:Uf)}return c._84I},getScrollRect:function(){return xf(this.getContentRect(),this._29I)},makeCenter:function(g,W,Q){var z=this;if(!z.getWidth()||!z.getHeight())return Q||Km(z.makeCenter,z,[g,W,!0],500),void 0;z.makeVisible(g),z.validate();var p=z.getDataUIBounds(g);if(p){var u=z.getWidth(),o=z.getHeight(),C=p.x+p.width/2,f=p.y+p.height/2,G=-C*z._zoom+u/2,d=-f*z._zoom+o/2;z.setTranslate(G,d,W)}},fitData:function(i,C,F,e,H){var B=this;if(!B.getWidth()||!B.getHeight())return H||Km(B.fitData,B,[i,C,F,e,!0],500),void 0;var q=function(){B.makeVisible(i),B.validate();var Y=B.getDataUIBounds(i);Y&&(Y=Tl(Y),oh(Y,F==I?20:F),B.fitRect(Y,C,e))};C?z.callWhenLoaded(q):q()},fitContent:function(W,r,u,$){var d=this;if(!d.getWidth()||!d.getHeight())return $||Km(d.fitContent,d,[W,r,u,!0],500),void 0;var V=function(){d.validate();var s=Tl(d.getContentRect());oh(s,r==I?20:r),d.fitRect(s,W,u)};W?z.callWhenLoaded(V):V()},fitRect:function(p,T,R){var e=this,h=e.getWidth(),Y=e.getHeight(),v=p.x+p.width/2,I=p.y+p.height/2,b=a(h/p.width,Y/p.height),U=e._zoom,f=-v*U+h/2,P=-I*U+Y/2;0===b||isNaN(b)||(R&&(b=a(1,b)),T?(e._65I&&(delete e._65I.finishFunc,e._65I.stop(!0)),e._14o&&e._14o.stop(!0),e.setTranslate(f,P,{finishFunc:function(){e.setZoom(b,T)}})):(e.setTranslate(f,P),e.setZoom(b)))},fitSelection:function(t,Y,K){var a=this,P=a.sm(),G=null;P.size()&&(P.each(function(b){G=xf(a.getDataUIBounds(b),G)}),t&&oh(G,t),a.fitRect(G,Y,K))},toCanvas:function(E,s,i){s=s||this._zoom,this.validateImpl();var T=this,n=T.getContentRect();i&&oh(n,i),n.width||(n.width=10),n.height||(n.height=10);var D=th(),M=n.x*s,g=n.y*s,y=Math.ceil(n.width*s),F=Math.ceil(n.height*s);Pq(D,y,F,1);var Q=wr(D);E=E||this._dataModel.getBackground(),E&&Eq(Q,0,0,y,F,E),Fi(Q,-M,-g),Q.scale(s,s);var B=this._zoom;return this._zoom=s,T._42(Q),this._zoom=B,Q.restore(),D},toDataURL:function(k,L,G,q){return this.toCanvas(k,G,q).toDataURL(L||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(k,j){var n=this,I=n.dm().getBackground();if(I){var E=n.dm().a("width"),g=n.dm().a("height");E>0&&g>0&&Eq(k,0,0,E,g,I)}var B=n.__htmlOrderList,a=[],J=n._forcedLayoutHTML;if(n._93db(k,j),n.each(function(s){var Q=n.getDataUI(s);if(Q){var w=n._56I[s._id],E=Q._htmlView;if(w){var c=Q._79o();if(E=Q._htmlView,A.HtmlNode&&s instanceof A.HtmlNode)Q._42(k);else{var t=n.getViewRect(),T=E&&E.layoutHTML;!j||Fn(j,c)?(T&&(E.layoutHTML(),Q.__outerLayout&&delete Q.__outerLayout),Q._42(k)):Fn(t,c)||!T||Q.__outerLayout&&!J||(E.layoutHTML(),Q.__outerLayout=!0)
}}E&&(a.push(E),E.getView&&(E=E.getView()),E.style.display=w?"block":ne)}}),B&&a.length>0){var s=!1;if(B.length!==a.length)s=!0;else for(var T=0;T<a.length;T++)if(a[T]!==B[T]){s=!0;break}s&&(a.forEach(function(k){k.autoAdjustIndex!==!1&&n.appendHTML(k,!0)}),this.__htmlOrderList=a)}else this.__htmlOrderList=a;n._92db(k,j)},disableDirtyRect:function(){this._shouldRedrawAll=u},enableDirtyRect:function(){var X=this;X._shouldRedrawAll=function(){return X._32I}},validateImpl:function(){this.tryUpdateRootData();var M,F,H,S,f,K=this,X=K.tx(),p=K.ty(),C=K._zoom,t=K._canvas,s=this.getWidth(),e=this.getHeight(),m=K._29I,O={x:-X/C,y:-p/C,width:s/C,height:e/C},A={},g=K._34I,T=K._24I,h=K._shouldRedrawAll(),d=K._23I;K._24I={},(s!==t.clientWidth||e!==t.clientHeight)&&(Pq(t,s,e),h=1,K._forcedLayoutHTML=1),h||Ck(O,m)||(h=1,K._forcedLayoutHTML=1),K._29I=O,K.each(function(I){F=I._id;var S=A[F]=K.isVisible(I);S!==K._56I[F]&&(T[F]=I,H=K.getDataUI(T[F]),H&&H._84o(S),K._84o(I,S))},K);for(F in T)H=K.getDataUI(T[F]),H&&(!h&&K._56I[F]&&(f=H._79o(),f&&g.add(f)),H.invalidate()),K._83I=1;if(K._56I=A,!h)for(F in T)A[F]&&(H=K.getDataUI(T[F]),H&&(f=H._79o(),f&&g.add(f)));if(h?S=O:(g.each(function(B){Fn(O,B)&&(S=xf(S,B))}),S&&(oh(S,i(1,1/C)),S.x=k(S.x*C)/C,S.y=k(S.y*C)/C,S.width=L(S.width*C)/C,S.height=L(S.height*C)/C,S=al(O,S))),K._74O=S,S&&0!==S.width&&0!==S.height){M=wr(t);var V=S.x,I=S.y,y=S.width,W=S.height;V=Math.floor((V*C+X)*Ch),I=Math.floor((I*C+p)*Ch),y=Math.ceil(y*C*Ch)+1,W=Math.ceil(W*C*Ch)+1,h||(S.x=(V/Ch-X)/C,S.y=(I/Ch-p)/C,S.width=y/Ch/C,S.height=W/Ch/C),M.beginPath(),M.rect(V,I,y,W),M.clip(),M.clearRect(V,I,y,W),Ql(M,X,p,C),K._42(M,S),M.restore(),delete K._74O}if(g.clear(),delete K._32I,delete K._forcedLayoutHTML,d&&s>0&&e>0){var H=K.getDataUI(d);if(H){var f=H._79o(),c=K._29I,B=c.x,D=c.y,z=c.width,n=c.height,C=K._zoom;f&&!Fn(f,c)&&(f.x+f.width<B&&K.tx(-f.x*C),f.x>B+z&&K.tx(-(f.x+f.width-z)*C),f.y+f.height<D&&K.ty(-f.y*C),f.y>D+n&&K.ty(-(f.y+f.height-n)*C))}delete K._23I}K._83I&&(delete K._83I,delete K._84I),K._98O(),K.countFrame(),Ze(K._24I)||Km(K.iv,K)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var d,F=this.getFullscreenDatas();for(var J in F)d=F[J],this.scaleRootData(d);this.onRootDataUpdated&&this.onRootDataUpdated(),this._rootDataUpdating=!1}},scaleRootData:function(V){var n=V.s("fullscreen");if("uniform"===n||"fill"===n){V.getRotation()&&V.setRotation(0);var F=V.s("fullscreen.gap")||0,r=this.getWidth(),O=this.getHeight();if(r&&O){var K,g,w,i=r-2*F,X=O-2*F,I=V.getAnchor(),v=V.getScaledSize(),S=v.width,k=v.height,T=V.s("fullscreen.lock");if(T)return"uniform"===n?i/X>S/k?(K=X/k,S=k*i/X):(K=i/S,k=S*X/i):"v"===T?(K=X/k,S=i/K,V.getWidth()!==S&&V.setWidth(S)):(K=i/S,k=X/K,V.getHeight()!==k&&V.setHeight(k)),this.setZoom(K),g=F-(V.getX()-I.x*S)*K,w=F-(V.getY()-I.y*k)*K,g!==this.tx()&&this.tx(g),w!==this.ty()&&this.ty(w),void 0;g=this.tx(),w=this.ty(),K=this._zoom;var H={x:(-g+F)/K,y:(-w+F)/K,width:i/K,height:X/K};if("uniform"===n){var A=S/k,h=Math.min(H.width,H.height*A),$=h/A;H.x+=.5*(H.width-h),H.y+=.5*(H.height-$),H.width=h,H.height=$}i=H.width/V.getScaleX(),X=H.height/V.getScaleY(),(V.getWidth()!=i||V.getHeight()!==X)&&V.setSize(i,X);var C=H.x+I.x*H.width,Q=H.y+I.y*H.height,G=V.getPosition();(C!==G.x||Q!==G.y)&&V.setPosition(C,Q)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(c){var T=this;c!==T.isScrollBarVisible()&&(c?(Ik(T._view,T._79O=_k()),Ik(T._79O,T._27I=_k()),Ik(T._79O,T._28I=_k())):(Hj(T._79O),delete T._79O,delete T._27I,delete T._28I),T.fp("scrollBarVisible",!c,c))},getDebugTip:function(){return""},showScrollBar:function(){var J=this;J._79O&&(J._85I||(Nq(function(){J._86I()},zk),J.iv()),J._85I=new Date)},_86I:function(){var $=this;if($._85I){var A=new Date,F=A.getTime();F-$._85I.getTime()>=zk?(delete $._85I,$.iv()):Nq(function(){$._86I()},zk)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var O=this,b=this._27I,h=this._28I;if(O._79O){if(O._autoHideScrollBar&&!O._85I)return b.style.visibility=mr,h.style.visibility=mr,void 0;var F=O.getScrollBarColor(),C=O._zoom,W=O.getScrollBarSize(),f=O.getViewRect(),$=O.getScrollRect(),d=f.height*C,H=$.height*C,T=f.width*C-W-2,A=d*((f.y-$.y)*C/H),_=d*(d/H),v=b.style;H-.5>d?(gl>_&&(A=A+_/2-gl/2,0>A&&(A=0),A+gl>d&&(A=d-gl),_=gl),zb(b,T,A,W,_),v.visibility=Xn,v.background=F,v.borderRadius=W/2+pn):v.visibility=mr;var m=f.width*C,I=$.width*C,A=f.height*C-W-2,T=m*((f.x-$.x)*C/I),Y=m*(m/I),v=h.style;I-.5>m?(gl>Y&&(T=T+Y/2-gl/2,0>T&&(T=0),T+gl>m&&(T=m-gl),Y=gl),zb(h,T,A,Y,W),v.visibility=Xn,v.background=F,v.borderRadius=W/2+pn):v.visibility=mr}},setDataModel:function(M){var D=this,S=D._dataModel,J=D._selectionModel;S!==M&&(S&&(S.ump(D.handleDataModelPropertyChange,D),S.umm(D.handleDataModelChange,D),S.umd(D.handleDataPropertyChange,D),S.removeIndexChangeListener(D._75O,D),S.removeHierarchyChangeListener(D.handleHierarchyChange,D),J||S.sm().ums(D.handleSelectionChange,D)),D._dataModel=M,M.mp(D.handleDataModelPropertyChange,D),M.mm(D.handleDataModelChange,D),M.md(D.handleDataPropertyChange,D),M.addIndexChangeListener(D._75O,D),M.addHierarchyChangeListener(D.handleHierarchyChange,D),J?J._21I(M):M.sm().ms(D.handleSelectionChange,D),D.invalidateAll(!0),D.fp(Vi,S,M),D.updateBackground())},getLayersInfo:function(){if(this._layersInfo===_){var p=this.getLayers();p?(this._layersInfo={},p.forEach(function(s){var G=qf(s)?s.name:s;this._layersInfo[G]=s},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(x,n,d){var M,h,f,I,O=this;x instanceof A.Data?(I=O.getDataUI(x),f=le(I)):(f=le(null,arguments[0],arguments[1]),n=arguments[2],d=arguments[3]),2===n.length&&(n=new gr(n[0],n[1]));var T=Ub(n,function(z){return Kp(f,100*z)},100,.001),j=Kp(f,100*T);if(!d){var D=I?sb(I):sb(arguments[0],arguments[1]),m=new gr(j.x,j.y),u=49/(O._zoom*O._zoom);for(M=0,h=D.length;h>M;M++)if(m.distanceToSquared(D[M])<u)return{index:M,point:D[M],distance:Math.sqrt((D[M].x-n.x)*(D[M].x-n.x)+(D[M].y-n.y)*(D[M].y-n.y))}}return{percent:T,point:j,distance:Math.sqrt((j.x-n.x)*(j.x-n.x)+(j.y-n.y)*(j.y-n.y))}},getPercentPositionOfPath:function(V,h){var p;if(V instanceof A.Data){var H=this.getDataUI(V);p=le(H)}else p=le(null,arguments[0],arguments[1]),h=arguments[2];return Kp(p,h)},getNeareastPositionOfPath:function(){return this.calculateEdgePosition.apply(this,arguments)},getPointsOfPath:function(){function U(h,m,S,E,C,n){var A=new gr(m.get(S)),K=n.apply(A);h.push({local:A,world:K,type:C,index:S,realIndex:E})}return function(T){var p,K;if(T instanceof A.Data){var a=this.getDataUI(T),g=tr(a);p=g.points,K=g.segments}else p=arguments[0],K=arguments[1];var V,s,P,M=T instanceof A.Shape?T.getPointsMatrix2d():new ym.Matrix2d,y=[],I=-1,Q=-1;for(s=0,P=K?K.length:p.length;P>s;s++)V=K?K.get(s):1,5!==V&&(Q++,3===V?(U(y,p,I+1,Q,"C",M),U(y,p,I+2,Q,"M",M),I+=2):4===V?(U(y,p,I+1,Q-1,"R",M),U(y,p,I+2,Q,"L",M),U(y,p,I+3,Q,"M",M),I+=3):(U(y,p,I+1,Q,"M",M),I+=1));return y}}(),calculateAttachPoint:function(){var c=new gr,o=new gr,N=new gr;return function(z,x){var D=this.getAttachPoints(z);if(!D||!D.length)return null;N.set(x.x,x.y);for(var X,v,q,M,i,T=1/0,d=0,A=D.length;A>d;d++)q=D[d],o.x=q.x,o.y=q.y,c.x=q.offsetX||0,c.y=q.offsetY||0,M=rk(this,z,0,c.x,c.y,o.x,o.y),v=N.distanceToSquared(M),T>v&&(X=d,T=v,i=M);T=Math.sqrt(T);var j=this.getAttachStyle(z);if("close"===j){var e=z.s("attach.close.threshold")/this._zoom;if(T>e)return null}return{index:X,distance:T,info:D[X],point:i}}}(),getAttachPoints:function(g){var t=g.s("attach.points");if(t)return t;var H=Gj(g._image);return H?ui(H.attachPoints,g,this)||null:void 0},getAttachStyle:function(d){var o=d.s("attach.style");if(o)return o;var N=Gj(d._image);return N?ui(N.attachStyle,d,this)||"close":void 0},updateLayers:function(){this._layersInfo=_,this.invalidateSelection(),this.redraw()},updateBackground:function(){var c=this.dm().a("width"),_=this.dm().a("height");this._canvas.style.background=c>0&&_>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(N){if("background"===N.property){var F=this._canvas.style.background,O=N.newValue||"";this.updateBackground(),this.fp("canvasBackground",F,O),this.redraw()}else"a:width"===N.property||"a:height"===N.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===N.property?this.updateLayers():"hierarchicalRendering"===N.property&&this.redraw()},handleDataPropertyChange:function(c){this.dm().isHierarchicalRendering()&&"parent"===c.property&&c.data.hasChildren()&&this.redraw(),this.invalidateData(c.data)},onPropertyChanged:function(S){var T=this,q=S.property;if(T.redraw(),"zoom"===q){var J=T.sm().getSelection();J.size()&&J.each(function(p){p.invalidate()})}else"dataModel"===q&&(T._83I=1);Po[q]?T.showScrollBar():q===On&&T.onCurrentSubGraphChanged(S)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(_){var j=this,s=_.kind,n=_.data;if(j._83I=1,"add"===s)j.invalidateData(n),Rn(n)&&n.getEdgeGroup()&&n.getEdgeGroup().eachSiblingEdge(j.invalidateData,j),n.getHost&&n.getHost()&&n.getHost().updateLayoutAttaches();else if(s===Oe){j._21Q(n);var P=n._id,i=j._25I[P];if(i){if(j._56I[P]){var m=i._79o();m&&j.redraw(m)}i.dispose(),delete j._25I[P],delete j._24I[P],delete j._56I[P]}n===j._currentSubGraph&&j.setCurrentSubGraph(I)}else s===gs&&(j.invalidateAll(!0),j.setCurrentSubGraph(I))},_75O:function(h){this.invalidateData(h.data)},handleHierarchyChange:function(R){this.dm().isHierarchicalRendering()&&R.data.hasChildren()&&this.redraw(),this.invalidateData(R.data)},adjustIndex:function(e){var Z=this;if(Z.isVisible(e)){Z.dm().beginTransaction();for(var o=e;o._parent&&Z.isVisible(o._parent);)o=o._parent;o&&o!==e&&Z._dataModel.adjustIndex(o),Z._dataModel.adjustIndex(e),Z.dm().endTransaction()}},getImage:function(f){return f.getImage?f.getImage():_},getSelectWidth:function(h){var O=Gj(this.getImage(h));return O&&ui(O.disableSelectedBorder,h,this)?0:h.s("select.width")},getSelectColor:function(Y){return Y.s("select.color")},isSelectable:function(e,X){if(this.isSelected(e))return!0;if(!X&&e.getParent()instanceof dp&&this.isSelectable(e.getParent(),!0)&&e.getParent().isSyncSize())return!1;var g=this.getLayersInfo();if(g){var C=g[e._layer];if(C&&C.selectable===!1)return!1}return e.s("2d.selectable")&&this.sm().isSelectable(e)},isMovable:function(J){var U=this;if(Rn(J)&&J.getStyle(hs)!==Wq)return!1;var W=this.getLayersInfo();if(W){var E=W[J._layer];if(E&&E.movable===!1)return!1}return J.s("2d.movable")?U._movableFunc?U._movableFunc(J):!0:!1},isEditable:function(m){var C=this;if(A._uiSerializing)return C._uieditable;if(!C._editInteractor||!C.isSelected(m))return!1;if(Re(m)){var I=C.getDataUI(m);if(!I||I._88I)return!1}if(Rn(m)&&m.getStyle(hs)!==Wq)return!1;var M=this.getLayersInfo();if(M){var r=M[m._layer];if(r&&r.editable===!1)return!1}return m.s("2d.editable")?C._editableFunc?C._editableFunc(m):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(P){return Fg(P)&&0!==P.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(P):!0},isRectEditable:function(M){return this._rectEditableFunc?this._rectEditableFunc(M):!0},isAnchorEditable:function(Q){return this._anchorEditableFunc?this._anchorEditableFunc(Q):!0},isRotationEditable:function(W){return W.setRotation&&W.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(W):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(X){var W=X.getAnchor(),Z=X.getScale(),E=this._zoom,J=ff(X.getRotation(),0,-X.getHeight()*Z.y*W.y-(Z.y<0?-1:1)*(to?32:16)/E),e=X.p();return J.x+=e.x,J.y+=e.y,J},getLogicalPoint:function(s){var O=this;return Qe(s,O._canvas,O.tx(),O.ty(),O._zoom,O._zoom)},getScreenPoint:function(T,H){var P,v=this;return"object"==typeof T?T.x!==_?(P=T.x,H=T.y):(P=T[0],H=T[1]):P=T,pp(P,H,v._canvas,v.tx(),v.ty(),v._zoom,v._zoom)},getSelectedDataAt:function(t){var w=this;return this.getDataAt(t,function(Y){return w.isSelected(Y)})},getDataInfoAt:function(f,W,S){var Z,$=this.lp(f),l=this.getDataAt($,W,S);if(l){var E=this.getDataUI(l);Z={data:l,ui:E,point:$};var k=E._38o;if(k){var P=k.icons;for(var R in P){var z=P[R],p=k.rects[R];if(p)for(var J=ui(z.names,l,this),q=J?J.length:0,Y=p.rotation,w=q-1;w>=0;w--){var B=J[w],e=p[w];if(An(e,$,Y))return Z.part="icons",Z.name=R,Z.icon=B,Z.rect=e,Z.index=w,Z.rotation=Y,Z}}}if(this.isNoteVisible(l)){if(E.note2Info&&An(E.note2Info.clickRect,$,I,E.note2Info.scale))return Z.part="note2",Z;if(E.noteInfo&&An(E.noteInfo.clickRect,$,I,E.noteInfo.scale))return Z.part="note",Z}if(this.isLabelVisible(l)){if(E.label2Info&&An(E.label2Info.rect,$,E.label2Info.rotation,E.label2Info.scale))return Z.part="label2",Z;if(E.labelInfo&&An(E.labelInfo.rect,$,E.labelInfo.rotation,E.labelInfo.scale))return Z.part="label",Z}if(l.isInRect&&l.isInRect($))return Z.part="body",Z}return Z},getDataAt:function(I,o,N){I.target&&(I=this.lp(I));var r,J=this._zoom;return this.reverseEach(function(U){return(o?o(U):this.isSelectable(U))&&this.rectIntersects(U,rd(I.x,I.y,N,J))?(r=U,!1):void 0},this),r},getIconInfoAt:function(Z,a){var f=this;if(Z.target&&(Z=f.lp(Z)),a||(a=f.getDataAt(Z)),a){var J=f.getDataUI(a);if(J&&J._38o){var R,o=J._38o,C=new Gc;for(R in o.icons)C.add(R);for(var N=C.size()-1;N>=0;N--){R=C.get(N);for(var _=o.rects[R],T=_.rotation,n=_.length-1;n>=0;n--){var h=_[n],c=h.width,Q=h.height,K={x:Z.x-h.x-c/2,y:Z.y-h.y-Q/2};T!=I&&(K=ff(-T,K.x,K.y));var h={x:-c/2,y:-Q/2,width:c,height:Q};if(An(h,K))return{key:R,index:n,name:o.icons[R].names[n],rect:_[n],point:Z,rotation:T,relativeRect:h,relativePoint:K,data:a}}}}}return I},getDatasInRect:function(L,z,$){$===_&&($=1);var D=this,f=new Gc;return D.reverseEach(function(J){$&&!D.isSelectable(J)||(z?D.rectIntersects(J,L):D.rectContains(J,L))&&f.add(J)}),f},moveSelection:function(H,V){var a=this;a.dm().beginTransaction(),ed(a.sm().toSelection(a.isMovable,a),H,V),a.dm().endTransaction()},moveDatas:function(F,q,o){var U=this;U.dm().beginTransaction(),F instanceof Gc||(F=new Gc(F)),ed(F,q,o),U.dm().endTransaction()},getDataUIBounds:function(B){var x=this.getDataUI(B);return x?x._79o():I},drawData:function(z,E,e){var M=this.getDataUI(E);if(M){var I=M._79o();(!e||Fn(e,I))&&(M._42(z),E instanceof A.Block&&E.eachChild(function(o){this.isVisible(o)&&this.drawData(z,o,e)},this))}},getBoundsForGroup:function(n){return n.s(ze)?this.getDataUIBounds(n):I},isPixelPerfect:function(M){return M.s("pixelPerfect")},rectIntersects:function(m,J){this.validate();var e=I;if(this._56I[m._id]){var D=this._25I[m._id];if(D){var M=D._79o();if(td(J,M))e=!0;else if((J=al(J,M))&&(D.rectIntersects&&(e=D.rectIntersects(J)),e==I)){if(!this.isPixelPerfect(m))return!0;var Z=J.x,O=J.y,k=J.width,N=J.height,p=this._zoom,b=z.hitMaxArea,d=k*N*p*p;if(d>b){var T=Math.sqrt(b/d);p*=T}k*=p,N*=p,2>k&&(k=2),2>N&&(N=2),Z*=p,O*=p;var X=ys(k,N);Fi(X,-Z,-O),X.scale(p,p),this._drawForChecking=!0,this.drawData(X,m,J),this._drawForChecking=!1;try{for(var o=0,v=X.getImageData(0,0,k,N).data;o<v.length;o+=4)if(0!==v[o+3]){e=!0;break}X.restore()}catch(P){Xj=I,e=!1}}}}return e?!0:!1},rectContains:function(O,i){if(this._56I[O._id]){var c=this._25I[O._id];if(c)return td(i,c._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(L){if(!z.isInput(L.target)){var g=this,G=g._focusData,W=G&&g._25I[G._id],m=0,X=g._dataModel._datas;if(!(G&&G._enabled&&G._editable&&W&&W.onKeyDown&&W.onKeyDown(L)===!0))if(9===L.keyCode&&(G&&(m=X.indexOf(G),Io(L)?-1===--m&&(m=0):++m===X.size()&&(m=0)),g._focusData=G=X.get(m),g.sm().setSelection(G)),Kf(L)?g.selectAll():Ui(L)&&g.isResettable()&&g.reset(),g.sm().isEmpty()){if(g._editing)return;var E=g.tx(),N=g.ty(),P=!1,u=Io()?100:10;li(L)&&(E-=u,P=!0),mq(L)&&(N-=u,P=!0),ar(L)&&(E+=u,P=!0),si(L)&&(N+=u,P=!0),P&&g.setTranslate(E,N)}else{yq(L)&&g.handleDelete(L);var q=Io()?10:1;li(L)&&(g.moveSelection(-q,0),g.fi({kind:"moveLeft"})),mq(L)&&(g.moveSelection(0,-q),g.fi({kind:"moveUp"})),ar(L)&&(g.moveSelection(q,0),g.fi({kind:"moveRight"})),si(L)&&(g.moveSelection(0,q),g.fi({kind:"moveDown"}))}}},handleScroll:function(X,e){if(um(X),this.isZoomable()){if(!this.getEditInteractor()){var M=this.getDataAt(X);if(M){var s=Gj(this.getImage(M));if(s&&ui(s.scrollable,M,this))return}}var i=this.lp(X);e>0?this.scrollZoomIn(i):0>e&&this.scrollZoomOut(i)}},handlePinch:function(p,l,O){this.isZoomable()&&(Math.abs(l-O)<z.pinchZoomThreshold||(l>O?this.pinchZoomIn(p):this.pinchZoomOut(p)))},checkDoubleClickOnNote:function(C,o){var M=this,e=M.lp(C),m=M.getDataUI(o),p=m.note2Info;return p&&o.s("note2.toggleable")&&An(p.clickRect,e)?(o.s(Ph,!o.s(Ph)),M.fi({kind:"toggleNote2",event:C,data:o}),!0):(p=m.noteInfo,p&&o.s("note.toggleable")&&An(p.clickRect,e)?(o.s(Vk,!o.s(Vk)),M.fi({kind:"toggleNote",event:C,data:o}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(x,Q){var f=this,G=f.getAutoScrollZone(),q=G/f.getZoom(),_=G/4,u=f._29I,B=f.lp(x),E={x:f.tx(),y:f.ty()};return B&&G>0&&u&&(B.x-u.x<q?f.translate(_,0):u.x+u.width-B.x<q&&f.translate(-_,0),B.y-u.y<q?f.translate(0,_):u.y+u.height-B.y<q&&f.translate(0,-_)),E.x=f.tx()-E.x,E.y=f.ty()-E.y,Q&&(Q.x+=E.x,Q.y+=E.y),E},getMoveMode:function(c,U){var H=U.s("2d.move.mode");return H?H:Yk["88"]?"x":Yk["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(J,G,E){var Z=this;return"currentSubGraph"===G?{__i:J.getId()}:E.serializeProperty(J,G,Z)},deserializeProperty:function(q,Q,g){var Z=this;if("currentSubGraph"===Q){var N=Z.dm(),e=N.__idMap;return e[q.__i]}return g.deserializeProperty(q,Q,Z)},setDefaultCursor:function(D,V){this._defaultCursor=D,V!==!1&&this.setCursor(D)},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(R){return R===I||z.getConnectAction(null,R)?(this._currentActionType=R,this.redraw(),!0):!1},getEditStyle:function(Y){var M=this.getEditInteractor();return M?M.getStyle(Y):_},setEditStyle:function(P,M,x){var j=this.getEditInteractor();return j?(j.setStyle(P,M,x),!0):!1},isConnectActionVisible:function(W){var H=z.getConnectAction(this);if(!H)return!1;var Y=H.visible;return gg(Y)&&(Y=Y(this,W)),Y},isInteractive:function(N){if(this._drawForChecking)return!1;var X=Gj(this.getImage(N));return X&&ui(X.interactive,N,this)?!0:N.s("interactive")},getRenderingStyleIconName:function(){return Ec},appendHTML:function(h,W){var S=this.getView();if(!(W||h&&h.parentNode!==S))return!1;var $=h.getView&&h.getView(),Q=h.beforeCanvas;if(!W&&$&&$.parentNode===S)return!1;(h.getView||h.isSelfViewEvent)&&(h=h.getView());var s=this.getEditInteractor();return Q?S.insertBefore(h,this.getCanvas()):s&&s._canvas?S.insertBefore(h,s._canvas):this.isScrollBarVisible()?S.insertBefore(h,this.getView().lastChild):Ik(S,h),!0},_layoutHTMLImpl:function(C,H,T){if(arguments.length>1){var u,L=this,A=L._zoom;if(H.getView&&(u=H,H=H.getView()),H.style.position="absolute",T){var S=C.getRect();zb(u||H,L.tx()+S.x*A,L.ty()+S.y*A,S.width*A,S.height*A)}else{var d=new ab,S=C.getAnchorRect(),f=C.getPosition(),X=C.getScale(),$=H.style;zb(u||H,S),d.appendTranslate(L.tx(),L.ty()),d.appendScale(A,A),d.append(new ab(C.getRotation(),f.x,f.y,X.x,X.y)),vr($,"transform","matrix("+d.a.toFixed(5)+", "+d.b.toFixed(5)+", "+d.c.toFixed(5)+",\n    "+d.d.toFixed(5)+", "+d.tx.toFixed(5)+", "+d.ty.toFixed(5)+")"),vr($,"transformOrigin",(-S.x).toFixed(5)+"px "+(-S.y).toFixed(5)+"px"),H.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(F){return F instanceof ji?{name:"text",accessType:"s",isMultiline:!0}:void 0},getState:function(U){var z="state",E=U.s(z);if(E)return E;var u=Gj(U._image);return u?ui(u[z],U,this)||null:void 0},getShape:function(H){return H.getStyle(eo)}}),j.defineProperties(Ic.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(x){this._layoutHTML=x}}});var Em=function(v,i){var k=this;k.gv=v,k.s=function(T){return i.getStyle(T)},k._data=i,k._87I=new Gc},Ec=I;Ag(Em,j,{_6I:I,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var a=this,I=a.gv.isSelected(a._data);return!I||a.isShadowed()?0:a.gv.getSelectWidth(a._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(g){var m=this._data,q=this.gv.getBodyColor(m);return q?q:g?m.getStyle(g):I},_2Q:function(i){return this.s(i)},_1Q:function(v,o,b,e){var y=this.s,N=y("2d.gray"),k=y(o+".dash.color");if(N&&(k=z.toGrayColor(k)),v.strokeStyle=k,v.lineWidth=b,v.stroke(),y(o+".dash.3d")){var O=y(o+".dash.3d.color");gb(v,k,N?z.toGrayColor(O):O,b,this.gv._zoom,y(o+".dash.3d.accuracy"))}Hc(v,e)},invalidate:function(){this._6I=I},_79o:function(){var E=this;if(!E._6I){var H=E._data,P=E.gv;E.labelInfo=E.label2Info=E.noteInfo=E.note2Info=E._38o=I,E._87I.clear(),E.interactiveInfo=P.isInteractive(H)?{}:I,E._3O(),E._55O=P.isEditable(H)?{_42O:P.isRectEditable(H),_43O:P.isPointEditable(H),_56O:P.isRotationEditable(H)}:I,E._6I=E._81o()}return E._6I},_3O:function(){},getPosition:function(){return Uf},_68o:function(k,y){k&&this._87I.add(Ln(k,y))},_81o:function(){var m=this,p=m.s;m._24O(rc,"getLabel"),m._24O(vb,"getLabel2"),m._26O(Zf,"getNote"),m._26O(gi,"getNote2"),m._15O(),m._55O&&m._48O();var o;if(m._87I.each(function(m){o=xf(o,m)}),o&&p("shadow.interactable")){var s=m.isShadowed(),Y=p("shadow2"),Q=Tl(o);Y?(Q.x+=p("shadow2.offset.x"),Q.y+=p("shadow2.offset.y"),oh(Q,p("shadow2.blur"))):s&&(Q.x+=p("shadow.offset.x"),Q.y+=p("shadow.offset.y"),oh(Q,p("shadow.blur"))),o=xf(o,Q)}return m._87I.clear(),o},_42:function(h){var E=this,K=E._data,X=E.gv,d=E.s,P=d("opacity"),B=this.isShadowed(),g=d("shadow2");if(B||g){var M=h.shadowOffsetX,e=h.shadowOffsetY,a=h.shadowBlur,q=h.shadowColor,t=X.getZoom()*z.devicePixelRatio,W=B?"shadow":"shadow2";h.shadowOffsetX=d(W+".offset.x")*t,h.shadowOffsetY=d(W+".offset.y")*t,h.shadowBlur=d(W+".blur")*t,h.shadowColor=B?E.getSelectColor():d(W+".color")}if(P!=I){var R=h.globalAlpha;h.globalAlpha=P}E._80o(h),X.isLabelVisible(K)&&((!X._drawForChecking||d("label.selectable"))&&Yj(h,E.labelInfo),(!X._drawForChecking||d("label2.selectable"))&&Yj(h,E.label2Info)),X.isNoteVisible(K)&&(ng(h,E.noteInfo),ng(h,E.note2Info)),E._99O(h),P!=I&&(h.globalAlpha=R),(B||g)&&(h.shadowOffsetX=M,h.shadowOffsetY=e,h.shadowBlur=a,h.shadowColor=q)},_80o:function(){},_47O:function(){},_24O:function(Q,O){var $=this,f=$._data,Z=$.gv,J=$.s,P=Z[O](f);if(P!=I){var g=J(Q+".scale"),e=J(Q+".max"),C=J(Q+".position"),Y=$[Q+"Info"]={label:P,scale:g,color:Z[O+"Color"](f),font:J(Q+".font"),opacity:J(Q+".opacity"),align:J(Q+".align"),decoration:J(Q+".decoration"),rotation:$.getRotation(J(Q+".rotation"),!1,C),background:Z[O+"Background"](f)},o=sl(Y,P);e>0&&e<o.width&&(Y.labelWidth=o.width,o.width=e),1!==g&&(o.width*=g,o.height*=g);var k=$.getPosition(C,J(Q+".offset.x"),J(Q+".offset.y"),o,J(Q+".position.fixed"));if(o.x=k.x-o.width/2,o.y=k.y-o.height/2,$._68o(Y.rect=o,Y.rotation),1!==g){var s=o.width/g,j=o.height/g;Y.rect={x:k.x-s/2,y:k.y-j/2,width:s,height:j}}}},_26O:function(G,e){var v=this,t=v.gv,m=v._data,R=v.s,B=t[e](m);if(B!=I){var w,M,b=R(G+".scale"),Z=v[G+"Info"]={note:B,scale:b,data:m,view:t,expanded:R(G+".expanded"),font:R(G+".font"),color:R(G+".color"),opacity:R(G+".opacity"),align:R(G+".align"),icon:R(G+".icon"),backgroundImage:R(G+".backgroundImage"),borderWidth:R(G+".border.width"),borderColor:R(G+".border.color"),background:t[e+"Background"](m)},F=v.getPosition(R(G+".position"),R(G+".offset.x"),R(G+".offset.y")),Y=F.x,X=F.y;if(Z.expanded){var $,k=R(G+".max"),p=R(G+".backgroundImage");p?(p=Gj(p),$={width:bi(p,m),height:Eg(p,m)}):$=sl(Z,B),$.width+=6,$.height+=2,k>0&&k<$.width&&(Z.labelWidth=$.width,$.width=k),w=$.width,M=$.height+8,Z.clickRect={x:Y-w*b/2,y:X-M*b,width:w*b,height:M*b*$.height/M}}else{var J=R(G+".icon");J?(J=Gj(J),w=bi(J,m),M=Eg(J,m)):(w=12,M=18),Z.clickRect={x:Y-w*b/2,y:X-M*b,width:w*b,height:M*b}}Z.rect={x:Y-w/2,y:X-M*b/2-M/2,width:w,height:M};var T=L(Z.borderWidth/2)*b;v._68o({x:Y-w*b/2-T,y:X-M*b-T,width:w*b+2*T,height:M*b+2*T})}},_48O:function(){},_99O:function(y){var d=this,V=d._38o;if(V){var M=d.gv,N=d._data,h=V.icons,C=d.interactiveInfo;C&&(C._38o={});for(var l in h){var u=h[l],B=V.rects[l];if(B){C&&(C._38o[l]=[]);var p=ui(u.opacity,N,M),J=ui(u.names,N,M),X=J?J.length:0,v=B.rotation;if(p!=I){var Q=y.globalAlpha;y.globalAlpha*=p}for(var R=0;X>R;R++){var j=J[R],E=Gj(j),c=B[R];if(v){var z=c.x+c.width/2,W=c.y+c.height/2;y.save(),Fi(y,z,W),Gd(y,v),Fi(y,-z,-W)}C&&C._38o[l].push(y.interactiveInfo={compInfos:[],matrix:v?new ab(v,z,W).appendTranslate(-z,-W):new ab});var e=Ec;Ec=l,cq(y,E,ui(u.stretch,N,M),c.x,c.y,c.width,c.height,d._data,d.gv),Ec=e,y.interactiveInfo=I,v&&y.restore()}p!=I&&(y.globalAlpha=Q)}}}}});var Me=function(w,M){nk(Me,this,[w,M])};Ag(Me,Em,{_checkEmptyRect:!0,_40O:function(z,l){var _=this,U=_.s,x=z.rect;(z.borderColor=_.gv.getBorderColor(_._data))&&(z.borderType=U("border.type"),z.borderWidth=U("border.width"),z.borderPadding=U("border.padding"),l=i(l,z.borderPadding+z.borderWidth/2));var J=_._data.getScale(),H=i(1,i(f(J.x),f(J.y)));if(z.selectWidth=_.getSelectWidth()){var w=_.gv._zoom;z.selectType=U("select.type"),z._97o=_.getSelectColor(),z.selectPadding=U("select.padding"),l=i(l,(z.selectPadding+z.selectWidth/2/w)/H)}l>0&&(l*=H,x=Tl(x),oh(x,l)),_._68o(x)},_39O:function(l,h){var R,r=this,X=h.rect;if(h.borderWidth>0&&(R=h.borderPadding,l.strokeStyle=h.borderColor,l.lineWidth=h.borderWidth,Op(l,h.borderType,{x:X.x-R,y:X.y-R,width:X.width+2*R,height:X.height+2*R}),l.stroke()),h.selectWidth>0){var V=r.gv._zoom;if(R=h.selectPadding,l.strokeStyle=h._97o,l.lineWidth=h.selectWidth/V,h.rotation!=I){l.save(),l.translate(h.position.x,h.position.y),l.rotate(h.rotation);var J=r._data,M=J.getWidth(),k=J.getHeight(),j=h.scale,g=h.anchor;X={x:j.x*-M*g.x,y:j.y*-k*g.y,width:j.x*M,height:j.y*k}}Op(l,h.selectType,{x:X.x-R,y:X.y-R,width:X.width+2*R,height:X.height+2*R}),h.rotation!=I&&l.restore(),l.stroke()}},dispose:function(){var B=this,n=B._htmlView;Me.superClass.dispose.call(B),n&&(n.onHTMLRemoved&&n.onHTMLRemoved(),Hj(n))},_3O:function(){var Q,E=this,r=E.s,d=E._data,s=E.gv,G=s.getShape(d),Z=E.getBodyColor(),X=r("shape.border.color"),z=E._83o=G?{shape:G,_53o:E.getBodyColor("shape.background"),_27Q:Gj(r("shape.repeat.image"),Z),shapeGradientPack:r("shape.gradient.pack"),shapeBorderGradientPack:r("shape.border.gradient.pack"),_54o:r("shape.border.width"),_55o:X,shapeBorderRepeatImage:Gj(r("shape.border.repeat.image"),X),_56o:r("shape.border.3d"),_57o:r("shape.border.3d.color"),_58o:r("shape.border.3d.accuracy"),shapeGradient:r("shape.gradient"),_59o:r("shape.gradient.color"),_60o:r("shape.border.pattern"),_61o:r("shape.border.cap"),_62o:r("shape.border.join"),shapeForeground:r("shape.foreground"),bodyColor:Z,gray:r("2d.gray")}:{img:Gj(s.getImage(d),Z),bodyColor:Z,gray:r("2d.gray"),stretch:r("image.stretch")},O=z.img;O&&O.renderHTML?(E._htmlInfo&&E._htmlInfo.img!==O&&(E._htmlInfo=I),E._htmlInfo||(E._htmlInfo={img:O,cache:{}}),Q=O.renderHTML(d,s,E._htmlInfo.cache)):E._htmlInfo=I,E._htmlView&&E._htmlView!==Q&&(E._htmlView.onHTMLRemoved&&E._htmlView.onHTMLRemoved(),Hj(E._htmlView.getView?E._htmlView.getView():E._htmlView)),(E._htmlView=Q)&&s.appendHTML(Q)&&(Q.onHTMLAddedSync&&Q.onHTMLAddedSync(),Q.onHTMLAdded&&Km(Q.onHTMLAdded)),z.rect=d.getRect(),z.position=d.p(),z.scale=d.getScale(),z.anchor=d.getAnchor(),z.rotation=d.getRotation(),G===qk&&(z._63o=r("shape.depth"));var h=0;if(G)h=Sn(I,z._54o/2,z._62o),E.s("shape.dash")&&(h=i(h,(E.s("shape.dash.width")||z._54o)/2));else if(O&&O.boundExtend)if(h=ui(O.boundExtend,d,s),O.boundExtendAbsolute){var t=d.getScale();h/=s._zoom*i(1,i(f(t.x),f(t.y)))}else if(!ui(O.fitSize,d,s)){var c=ui(O.width,d,s),m=ui(O.height,d,s);h*=i(d.getWidth()/c,d.getHeight()/m)}E._40O(z,h);var b=r("clip.percentage");if(b!=_&&(z.clipRect=ke(d.getAnchorRect(),r("clip.direction"),b)),G){var k=r("shape.fill.clip.percentage");k!=_&&(z.shapeClipRect=ke(d.getAnchorRect(),r("shape.fill.clip.direction"),k));var R=r("shape.foreground.clip.percentage");R!=_&&(z.shapeForegroundClipRect=ke(d.getAnchorRect(),r("shape.foreground.clip.direction"),R))}},getPosition:function(I,B,f,O){var _=ni(I,this._83o.rect,O);return _.x+=B,_.y+=f,_},_80o:function(v){var t=this,x=t.s,V=t.gv,n=t._data,A=t._83o,g=A.rect,i=A.position,R=A.rotation,r=A.anchor,N=A.scale,F=A.shape,D=A.clipRect;if(!t._checkEmptyRect||g.width>0&&g.height>0){var o=n.getSize();if(o.x=-o.width*r.x,o.y=-o.height*r.y,ig&&!Xh&&Fi(v,o.width,o.height),v.save(),Fi(v,i.x,i.y),Gd(v,R),Dm(v,N.x,N.y),D&&(v.beginPath(),v.rect(D.x,D.y,D.width,D.height),v.clip()),V._drawForChecking&&A.img&&ui(A.img.pixelPerfect,n,V)===!1)Eq(v,o.x,o.y,o.width,o.height,"#888888");else if(t.freeDraw)t.freeDraw(v,o,A);else if(F){var U,Q,s,j,Z=A._60o,q=zn(v,Z),X=A._27Q,C=A._54o,J=A.shapeGradientPack,K=A.gray,P=v.lineJoin,H=v.lineCap,b=function(L){return K?z.toGrayColor(L):L};"roundRect"===F?U=x("shape.corner.radius"):"polygon"===F?(U=x("shape.polygon.side"),Q=x("shape.corner.radius")):"arc"===F&&(U=x("shape.arc.from"),Q=x("shape.arc.to"),s=x("shape.arc.close"),j=x("shape.arc.oval")),v.lineJoin=A._62o,v.lineCap=A._61o;var f=b(A._53o);if(f||X||J){var e=A.shapeClipRect;e&&(v.save(),v.beginPath(),v.rect(e.x,e.y,e.width,e.height),v.clip()),Op(v,F,o,U,Q,s,j),J?kk(v,J,function(a){return cb(a,A.bodyColor)},!1,o):X?Fh(v,X,b(A.bodyColor),null,n,V):Vm(v,f,A.shapeGradient,b(A._59o),o),v.fill(),J&&v.restore(),e&&v.restore(),v!==q&&Op(q,F,o,U,Q,s,j)}else Op(q,F,o,U,Q,s,j);var h=A.shapeForeground;if(h){v.save();var u=A.shapeForegroundClipRect;u&&(v.beginPath(),v.rect(u.x,u.y,u.width,u.height),v.clip()),Op(v,F,o,U,Q,s,j),Vm(v,h,x("shape.foreground.gradient"),b(x("shape.foreground.gradient.color")),o),v.fill(),v.restore()}if(C>0){var a=x("shape.border.width.absolute");a&&(v.save(),v.setTransform(1,0,0,1,0,0)),v.lineWidth=C;var $=b(A._55o),O=A.shapeBorderGradientPack;O?kk(v,O,b,!0,o):A.shapeBorderRepeatImage?Ie(v,A.shapeBorderRepeatImage,$,null,n,V):v.strokeStyle=$,v.stroke(),O&&v.restore(),a&&v.restore(),A._56o&&gb(v,$,b(A._57o),C,V._zoom,A._58o)}if(Hc(v,Z),x("shape.dash")){var W=x("shape.dash.width")||C;if(W>0){Z=x("shape.dash.pattern");var q=zn(v,Z,t._2Q("shape.dash.offset"));q!==v&&Op(q,F,o,U,Q,s,j),t._1Q(v,"shape",W,Z)}}Gk(v,f,A._63o,o),v.lineJoin=P,v.lineCap=H}else{var Y=t.interactiveInfo;Y&&(v.interactiveInfo=Y.bodyInfo={compInfos:[],matrix:new ab(R,i.x,i.y,N.x,N.y)}),A.gray&&(v.compGray=!0);var p=A.img;p&&p.cacheRule!=I&&(p=cl(v,p,A.stretch,o.width,o.height,n,V,A.bodyColor)),cq(v,p,A.stretch,o.x,o.y,o.width,o.height,n,V,A.bodyColor),v.compGray=!1,v.interactiveInfo=I}v.restore()}t._39O(v,A)},_48O:function(){},_47O:function(){}});var Do=function(Q,q){nk(Do,this,[Q,q])},Xr=function(o,G,P,w){var l=Hd(o,G);return P=w?a(P,l):qn(P,l),l?P/=l:P=0,{x:o.x+(G.x-o.x)*P,y:o.y+(G.y-o.y)*P}};Ag(Do,Em,{_3O:function(){var o,r=this,Z=r._data,Q=r.gv,x=r.s,t=x(hs),K=Z.isLooped(),P=x("edge.width"),k=r.getBodyColor("edge.color"),y=x("edge.center"),E=x("edge.offset"),v=Q.getBorderColor(Z),D=v?x("border.width"):0,W=r.getSelectWidth(),C=Z._40I,R=Z._41I,b=r._78o=C&&R?{looped:K,type:t,width:P,center:y,color:k,repeatImage:Gj(x("edge.repeat.image"),k),borderColor:v,borderWidth:D,_97o:W?r.getSelectColor():I,selectWidth:W,pattern:x("edge.pattern"),cap:x("edge.cap"),join:x("edge.join"),is3d:x("edge.3d"),_67o:x("edge.3d.color"),_66o:x("edge.3d.accuracy"),gray:x("2d.gray")}:I;
if(b){var g=z.getEdgeType(t);if(g){var S=g(Z,Bn(r,Q,Z,K,t),Q,r._19Q);S.points&&S.points.size()>1?(b.edgeTypeInfo=S,o=Mc(b.edgeTypeInfo.points)):S[Jf]&&S.rect&&(b.edgeTypeInfo=S,o=S.rect)}else{var A=x("edge.source.anchor.x"),N=x("edge.source.anchor.y"),c=x("edge.target.anchor.x"),$=x("edge.target.anchor.y"),l=Or(Q,Z,"source"),m=Or(Q,Z,"target");if(t===Wq){var n=b.points=x(Wl)||pg,f=n.size();b.segments=x("edge.segments");var G=A!==_||N!==_||Rn(C),J=c!==_||$!==_||Rn(R);if(!y)if(E)G||(l=Xr(l,f?n.get(0):m,E,f)),J||(m=Xr(m,f?n.get(f-1):l,E,f));else{var B;G||(B=tj(l,f?n.get(0):m,Sc(Q,C)),B&&(l={x:B[0],y:B[1]})),J||(B=tj(f?n.get(f-1):l,m,Sc(Q,R)),B&&(m={x:B[0],y:B[1]}))}o=xf(Mc(b.points),Mc(l,m))}else{var u=Bn(r,Q,Z,K,t);if(r._19Q||(u=-u),K)l=Tl(l),l.x=Q.getNodeRect(C).x,b.radius=u,o={x:l.x-u,y:l.y-u,width:2*u,height:2*u};else{var M=Hd(l,m),j=qn(E,M),T={x:j,y:u},q={x:M-j,y:u},w=id(m.y-l.y,m.x-l.x),U=b.mat=new Xl(w);if(b.orienAngle=w,b.angle=m.x<l.x?w+h:w,b.rect={x:T.x,y:T.y,width:q.x-T.x,height:0},b.origin=l,T=U.tf(T),T.x+=l.x,T.y+=l.y,q=U.tf(q),q.x+=l.x,q.y+=l.y,y){var V={x:M,y:0};V=U.tf(V),V.x+=l.x,V.y+=l.y,o=Mc([l,T,q,V]),b.c1=l,b.c2=V}else o=Mc(T,q);l=T,m=q}}b.sourcePoint=l,b.targetPoint=m,Z._lastSourcePoint=l,Z._lastTargetPoint=m}var H=0;x("edge.dash")&&(H=x("edge.dash.width")||P);var s="square"===b.cap?.71:.5;Sn(o,i(H*s,P*s+D+W),b.join),r._68o(o)}},getRotation:function(T,i,O){T=T||0;var o=this._78o;if(o){var L,w=o.angle,X=o.points,W=o.edgeTypeInfo;if(w!=I)return i?o.orienAngle+T:w+T;if(W&&W[Jf])return W.getRotation?W.getRotation(this,T,i,O):0;if(W&&W.points){var u=W.points;return L=u.size(),lh[O]?L&&0===L%2?_l(u.get(L/2-1),u.get(L/2),i,T):T:fn[O]?_l(u.get(0),u.get(1),i,T):_l(u.get(L-2),u.get(L-1),i,T)}if(X){var y=X.toArray();return y.unshift(o.sourcePoint),y.push(o.targetPoint),X=new Gc(y),L=X.size(),lh[O]?L&&0===L%2?_l(X.get(L/2-1),X.get(L/2),i,T):T:fn[O]?_l(o.sourcePoint,L?X.get(0):o.targetPoint,i,T):_l(L?X.get(L-1):o.sourcePoint,o.targetPoint,i,T)}}return T},getPosition:function(a,C,d,e,X){var b=this._78o;if(b){var j,z=b.type,k=b.points,v=b.edgeTypeInfo,K=b.sourcePoint,O=b.targetPoint;if(!z)return b.looped?{x:K.x-b.radius+C,y:K.y+d}:(X&&K&&O&&(K.x>O.x||K.x===O.x&&K.y>O.y)&&(a=Wj[a],d=-d),j=ni(a,b.rect,e),j.x+=C,j.y+=d,j=b.mat.tf(j),j.x+=b.origin.x,j.y+=b.origin.y,j);if(v&&v[Jf])return v.getPosition?v.getPosition(this,a,C,d,e,X):{x:(K.x+O.x)/2,y:(K.y+O.y)/2};if(k){var j,m=k.size();if(lh[a]){if(m){var o=m%2;if(0===o)return Qi(k.get(m/2-1),k.get(m/2),a,C,d,e,X);j=k.get((m-o)/2)}else j={x:(K.x+O.x)/2,y:(K.y+O.y)/2};return j=ni(a,{x:j.x,y:j.y,width:0,height:0},e),j.x+=C,j.y+=d,j}return fn[a]?Qi(K,m?k.get(0):O,a,C,d,e,X):Qi(m?k.get(m-1):K,O,a,C,d,e,X)}if(v){var B=v.points,m=B.size();if(lh[a]){var o=m%2;return 0===o?Qi(B.get(m/2-1),B.get(m/2),a,C,d,e,X):(j=B.get((m-o)/2),j=ni(a,{x:j.x,y:j.y,width:0,height:0},e),j.x+=C,j.y+=d,j)}return fn[a]?Qi(B.get(0),B.get(1),a,C,d,e,X):Qi(B.get(m-2),B.get(m-1),a,C,d,e,X)}}return Uf},_42:function(W){this._78o&&Do.superClass._42.call(this,W)},drawPath:function(U,n){U.beginPath();var r=n.type,k=n.points,q=n.segments,I=n.edgeTypeInfo;if(!r||k){var w=n.sourcePoint,X=w.x,_=w.y,N=n.targetPoint,H=N.x,W=N.y;if(r)if(q){var L=new Gc({x:X,y:_});L.addAll(k),L.add({x:H,y:W}),Wb(U,L,q)}else U.moveTo(X,_),k.each(function(o){U.lineTo(o.x,o.y)}),U.lineTo(H,W);else n.looped?U.arc(X,_,n.radius,0,$,!0):n.center?(U.moveTo(n.c1.x,n.c1.y),U.lineTo(X,_),U.lineTo(H,W),U.lineTo(n.c2.x,n.c2.y)):(U.moveTo(X,_),U.lineTo(H,W))}else I&&(I.points?Wb(U,I.points,I.segments):I[Jf]&&I[Jf](U,I))},_80o:function(X){var C=this,N=C.s,r=C._78o,y=r.width,F=r.selectWidth,u=r.borderWidth,A=r.repeatImage,i=X.lineJoin,d=X.lineCap,b=r.gray,t=r.pattern;X.lineJoin=r.join,X.lineCap=r.cap,C.drawPath(zn(X,t),r);var S=N("edge.width.absolute");S&&(X.save(),X.setTransform(1,0,0,1,0,0)),F&&(X.strokeStyle=r._97o,X.lineWidth=y+2*(u+F),X.stroke()),u&&(X.strokeStyle=b?z.toGrayColor(r.borderColor):r.borderColor,X.lineWidth=y+2*u,X.stroke());var q=b?z.toGrayColor(r.color):r.color;if(A?Ie(X,A,q,null,C._data,C.gv):X.strokeStyle=q,X.lineWidth=y,X.stroke(),r.is3d){var j=b?z.toGrayColor(r._67o):r._67o;gb(X,q,j,y,C.gv._zoom,r._66o)}if(Hc(X,t),N("edge.dash")){t=N("edge.dash.pattern");var P=zn(X,t,C._2Q("edge.dash.offset"));P!==X&&C.drawPath(P,r),C._1Q(X,"edge",N("edge.dash.width")||y,t)}S&&X.restore(),X.lineJoin=i,X.lineCap=d},_48O:function(){},_47O:function(){}});var Lf=function(u,r){nk(Lf,this,[u,r])};Ag(Lf,Me,{_3O:function(){var v,p,t=this,N=t.s,F=t._data,n=t.gv;if(t._88I=I,F.isExpanded()&&F.eachChild(function(N){if(Fg(N)){var x=n.getBoundsForGroup(N);x&&(p||(p=[]),p.push(x),v=xf(v,x))}}),v){var W=n.getLabel(F),u=N("group.type"),z=N("group.border.width")||0,q=N("group.border.width.absolute"),K=z/2;q&&(z/=n._zoom),v=Vg(u,p,v),of(v,F,"group.padding",1),oh(v,z);var f=t._88I={type:u,rect:v,_64o:v};if(!u&&W!=I){var R,a=t.labelInfo={label:W,color:N("group.title.color"),font:N("group.title.font"),align:N("group.title.align")},x=sl(a,W),U=x.width+z,k=x.height+z,r=N("group.title.align"),V=N("group.title.orientation");if(V===wg||V===wn?(v.height+=z,U>v.width&&(v.width=U)):(V===iq||V===bq)&&(v.width+=z,U>v.height&&(v.height=U)),R=r===iq?v.x:r===bq?v.x+v.width-U:v.x+v.width/2-U/2,V===wn)f.titleRect={x:v.x,y:v.y+v.height,width:v.width,height:k},f.rect={x:v.x,y:v.y,width:v.width,height:v.height+k},a.rect={x:R,y:v.y+v.height,width:U,height:k};else if(V===iq){var m=f.titleRect={x:v.x-k,y:v.y,width:k,height:v.height};f.rect={x:v.x-k,y:v.y,width:v.width+k,height:v.height},a.rect={x:m.x+k/2-v.height/2,y:m.y+v.height/2-k/2,width:v.height,height:k},a.rotation=-Math.PI/2}else if(V===bq){var m=f.titleRect={x:v.x+v.width,y:v.y,width:k,height:v.height};f.rect={x:v.x,y:v.y,width:v.width+k,height:v.height},a.rect={x:m.x+k/2-v.height/2,y:m.y+v.height/2-k/2,width:v.height,height:k},a.rotation=Math.PI/2}else f.titleRect={x:v.x,y:v.y-k,width:v.width,height:k},f.rect={x:v.x,y:v.y-k,width:v.width,height:v.height+k},a.rect={x:R,y:v.y-k-K,width:U,height:k+z}}t._40O(f,N("group.border.width")/2)}else Lf.superClass._3O.call(t)},getPosition:function(e,z,H,K){var Y=this._88I;if(Y){var t=ni(e,Y.rect,K);return t.x+=z,t.y+=H,t}return Lf.superClass.getPosition.apply(this,arguments)},_24O:function(M,I){var t=this._88I;(!t||t.type||"label2"===M)&&Lf.superClass._24O.call(this,M,I)},_80o:function(S){var w=this,Y=w._88I;if(Y){var v=w._data,K=w.s,d=w.gv,r=Y.type,J=Y.rect,c=Y._64o,N=Y.titleRect,D=w.getBodyColor(),W=Gj(K("group.image"),D),f=K("group.image.stretch"),U=w.getBodyColor("group.background"),q=Gj(K("group.repeat.image"),D),H=K("group.gradient.pack"),k=K("group.gradient"),G=K("group.gradient.color"),y=K("group.border.width"),Q=K("group.border.color"),E=K("group.border.pattern"),m=K("group.title.orientation"),b=K("group.depth"),g=K("group.border.radius"),R=K("group.border.join"),F=K("group.border.cap"),x=K("group.border.width.absolute");x&&(y/=d._zoom);var u=Q,a=K("group.border.repeat.image");if(a&&(a=Gj(a,Q))&&(u=To(S,a,Q,null,v,d)),r){var V=S.lineJoin,j=S.lineCap;if(S.lineJoin=R,S.lineCap=F,W){if(S.save(),Op(S,r,J,g),S.clip(),cq(S,W,f,J.x,J.y,J.width,J.height,v,d,D),S.restore(),y>0){var e=zn(S,E);Op(e,r,J,g),S.lineWidth=y,S.strokeStyle=u,S.stroke(),Hc(S,E)}}else{var e=zn(S,E);U||q||H?(Op(S,r,J,g),H?kk(S,H,function(R){return cb(R,D)},!1,J):q?Fh(S,q,D,null,v,d):Vm(S,U,k,G,J),S.fill(),H&&S.restore(),S!==e&&Op(e,r,J,g)):Op(e,r,J,g),y>0&&(S.lineWidth=y,S.strokeStyle=u,S.stroke()),Hc(S,E),r===qk&&Gk(S,U,b,J)}S.lineJoin=V,S.lineCap=j}else{var I=K("group.title.background");if((!g||0>g)&&(g=0),W)cq(S,W,f,c.x,c.y,c.width,c.height,v,d,w.getBodyColor());else if(U||q)if(q?Fh(S,q,D,null,v,d):Vm(S,U,k,G,c),0===y)Op(S,qk,c),S.fill(),Gk(S,U,b,c);else{switch(S.beginPath(),m){case wn:_c(S,c.x,c.y,c.width,c.height,g,g,0,0);break;case iq:_c(S,c.x,c.y,c.width,c.height,0,g,0,g);break;case bq:_c(S,c.x,c.y,c.width,c.height,g,0,g,0);break;case wg:_c(S,c.x,c.y,c.width,c.height,0,0,g,g)}S.fill()}if(N&&I)if(0===y)Eq(S,N.x,N.y,N.width,N.height,I),Gk(S,I,b,N);else{switch(S.beginPath(),S.fillStyle=I,m){case wn:_c(S,N.x,N.y,N.width,N.height,0,0,g,g);break;case iq:_c(S,N.x,N.y,N.width,N.height,g,0,g,0);break;case bq:_c(S,N.x,N.y,N.width,N.height,0,g,0,g);break;case wg:_c(S,N.x,N.y,N.width,N.height,g,g,0,0)}S.fill()}if(y>0){var e=zn(S,E);if(Op(e,"roundRect",J,g),S.save(),S.lineWidth=y,S.strokeStyle=u,S.lineJoin=R,S.lineCap=F,S.closePath(),S.stroke(),N&&K("group.splitLine")){var $=N.x,l=N.y,L=N.width,C=N.height;S.beginPath(),m===wn?(S.moveTo($,l),S.lineTo($+L,l)):m===iq?(S.moveTo($+L,l),S.lineTo($+L,l+C)):m===bq?(S.moveTo($,l),S.lineTo($,l+C)):(S.moveTo($,l+C),S.lineTo($+L,l+C))}S.stroke(),S.restore(),Hc(e,E)}}w._39O(S,Y)}else Lf.superClass._80o.call(w,S)}});var Yp=function(q,H){nk(Yp,this,[q,H])};Ag(Yp,Me,{_80o:function(Y){this._39O(Y,this._83o)}});var Zm=function(z,N){nk(Zm,this,[z,N])};Ag(Zm,Me,{_3O:function(){var y=this,P=y._data,D=y.s,h=y.gv,k=P.getPoints(),g=h.getBorderColor(P),E=g?D("border.width"):0,A=y.getSelectWidth(),q=D("shape.border.width"),u=P.getRect(),W=P.getAnchorRect(),s=h.getBodyColor(P),$=D("shape.border.color"),x=y._99o=k.isEmpty()?I:{rect:u,rotation:P.getRotation(),fillRule:D("shape.fill.rule"),scale:P.getScale(),position:P.p(),points:k,segments:P.getSegments(),bodyColor:s,borderColor:g,borderWidth:E,_94o:D("shape.border.3d"),_95o:D("shape.border.3d.color"),_96o:D("shape.border.3d.accuracy"),_97o:A?y.getSelectColor():I,selectWidth:A,_53o:D("shape.background"),_27Q:Gj(D("shape.repeat.image"),s),shapeGradientPack:D("shape.gradient.pack"),shapeBorderGradientPack:D("shape.border.gradient.pack"),_54o:q,_55o:$,shapeBorderRepeatImage:Gj(D("shape.border.repeat.image"),$),shapeGradient:D("shape.gradient"),_59o:D("shape.gradient.color"),_60o:D("shape.border.pattern"),_61o:D("shape.border.cap"),_62o:D("shape.border.join"),shapeForeground:D("shape.foreground"),gray:D("2d.gray")};if(x){W.x+=x.position.x,W.y+=x.position.y,x.gradientRect=W;var G=P.getScale(),m=i(1,i(f(G.x),f(G.y)));D("shape.dash")&&D("shape.dash.width")>q&&(q=D("shape.dash.width"));var l,t=D("shape.border.width.absolute");l=t?(q+E+A)/y.gv._zoom/m:q*("square"===x._61o?.71:.5)+E+A/y.gv._zoom/m,l&&(l*=m,u=Tl(u),Sn(u,l,x._62o)),y._68o(u);var a=D("clip.percentage");a!=_&&(x.clipRect=ke(P.getAnchorRect(),D("clip.direction"),a));var S=D("shape.fill.clip.percentage");S!=_&&(x.shapeClipRect=ke(P.getAnchorRect(),D("shape.fill.clip.direction"),S));var N=D("shape.foreground.clip.percentage");N!=_&&(x.shapeForegroundClipRect=ke(P.getAnchorRect(),D("shape.foreground.clip.direction"),N))}},getPosition:function(I,i,$,h){var d=this._99o;if(d){var F=ni(I,d.rect,h);return F.x+=i,F.y+=$,F}return Uf},_42:function(y){this._99o&&Zm.superClass._42.call(this,y)},_80o:function(t){var N,O=this,R=O.s,s=O._99o,Q=s.position,r=s.scale,Y=s.rotation,u=s.borderWidth,T=s.selectWidth/O.gv._zoom,b=s._27Q,L=s.shapeGradientPack,H=s._54o,j=s.clipRect,i=s.shapeClipRect,E=s.points,M=s.segments,I=O._data.isClosePath(),x=s.fillRule,P=s.gray,w=function(W){return P?z.toGrayColor(W):W},U=w(s._53o),y=U||b||L;t.save(),Fi(t,Q.x,Q.y),Gd(t,Y),Dm(t,r.x,r.y),j&&(t.beginPath(),t.rect(j.x,j.y,j.width,j.height),t.clip()),y&&i&&(t.save(),t.beginPath(),t.rect(i.x,i.y,i.width,i.height),t.clip()),A.Default.extractShapeTranslation?(E=Tl(E),E.forEach(function(Y){Y.x-=Q.x,Y.y-=Q.y})):Fi(t,-Q.x,-Q.y);var C=s._60o,q=zn(t,C),D=t.lineJoin,K=t.lineCap;t.lineJoin=s._62o,t.lineCap=s._61o;var W=w(s.bodyColor);y?(Wb(t,E,M,I),L?kk(t,L,function(c){return cb(c,s.bodyColor)},!1,s.rect):b?Fh(t,b,W,null,O._data,O.gv):(N=W?W:U,Vm(t,N,s.shapeGradient,w(s._59o),s.gradientRect)),t.fill(x),L&&t.restore(),i&&(t.restore(),Fi(t,-Q.x,-Q.y)),q!==t&&Wb(q,E,M,I)):Wb(q,E,M,I);var J=s.shapeForeground;if(J){t.save();var X=s.shapeForegroundClipRect;X&&(Fi(t,Q.x,Q.y),t.beginPath(),t.rect(X.x,X.y,X.width,X.height),t.clip(),Fi(t,-Q.x,-Q.y)),Wb(t,E,M,I),Vm(t,J,R("shape.foreground.gradient"),w(R("shape.foreground.gradient.color")),s.gradientRect),t.fill(x),t.restore()}var $=R("shape.border.width.absolute");if($&&(t.save(),t.setTransform(1,0,0,1,0,0)),T&&(t.strokeStyle=s._97o,t.lineWidth=H+2*(u+T),t.stroke()),u&&(t.strokeStyle=w(s.borderColor),t.lineWidth=H+2*u,t.stroke()),H){N=w(s._55o);var h=s.shapeBorderGradientPack;h?kk(t,h,w,!0,s.rect):s.shapeBorderRepeatImage?Ie(t,s.shapeBorderRepeatImage,N,null,O._data,O.gv):(!U&&W&&(N=W),t.strokeStyle=N),t.lineWidth=H,t.stroke(),h&&t.restore(),s._94o&&gb(t,N,w(s._95o),H,O.gv._zoom,s._96o)}if(Hc(t,C),R("shape.dash")){var S=R("shape.dash.width")||H;if(S>0){C=R("shape.dash.pattern");var q=zn(t,C,O._2Q("shape.dash.offset"));q!==t&&Wb(q,E,M,I),O._1Q(t,"shape",S,C)}}$&&t.restore(),t.lineJoin=D,t.lineCap=K,t.restore()},_48O:function(){},_47O:function(){}});var dn=function(E,B){nk(dn,this,[E,B])};Ag(dn,Zm,{getRotation:function(g,e,G){g=g||0;var c=this._data.getPoints(),_=c.size();return _>1?lh[G]?_&&0===_%2?_l(c.get(_/2-1),c.get(_/2),e,g):g:fn[G]?_l(c.get(0),c.get(1),e,g):_l(c.get(_-2),c.get(_-1),e,g):g},getPosition:function(d,e,A,i,v){var P=this._data.getPoints(),E=P.size();if(E>1){if(lh[d]){var s=E%2;if(0===s)return Qi(P.get(E/2-1),P.get(E/2),d,e,A,i,v);var J=P.get((E-s)/2),t={x:J.x,y:J.y,width:0,height:0};return J=ni(d,t,i),J.x+=e,J.y+=A,J}return fn[d]?Qi(P.get(0),P.get(1),d,e,A,i,v):Qi(P.get(E-2),P.get(E-1),d,e,A,i,v)}return Uf}});var mm=function(b,O){nk(mm,this,[b,O])};Ag(mm,Me,{_3O:function(){var E=this;mm.superClass._3O.call(E);var q=E.s,J=E._83o;E._82o=J.img||J.shape?I:{background:E.getBodyColor("grid.background"),depth:q("grid.depth"),rect:J.rect,_88o:q("grid.cell.depth"),cellBorderColor:q("grid.cell.border.color"),_89o:q("grid.row.count"),_90o:q("grid.column.count"),block:q("grid.block"),_91o:q("grid.block.color"),_92o:q("grid.block.padding"),_93o:q("grid.block.width")}},_80o:function(b){var q=this,e=q._82o;if(!e)return mm.superClass._80o.call(q,b),void 0;var F,j,f=q._data,w=e.background,c=e.rect,t=e.block,W=e._91o,m=e._92o,V=e._93o,N=e._88o,M=e.cellBorderColor,g=e._89o,x=e._90o;if(w)if(Eq(b,c.x,c.y,c.width,c.height,w),Gk(b,w,e.depth,c),N)for(F=0;g>F;F++)for(j=0;x>j;j++)c=f.getCellRect(F,j),c&&Gk(b,w,N,c);else if(M){for(b.beginPath(),F=0;g>F;F++)for(j=0;x>j;j++)c=f.getCellRect(F,j),c&&b.rect(c.x,c.y,c.width,c.height);b.strokeStyle=M,b.lineWidth=1,b.stroke()}if("h"===t)for(F=0;g>F;F++)c=xf(f.getCellRect(F,0),f.getCellRect(F,x-1)),oh(c,m),ko(b,W,c.x,c.y,c.width,c.height,V);else if("v"===t)for(j=0;x>j;j++)c=xf(f.getCellRect(0,j),f.getCellRect(g-1,j)),oh(c,m),ko(b,W,c.x,c.y,c.width,c.height,V);q._39O(b,q._83o)}});var tm=function(s,F){nk(tm,this,[s,F])},Tb=K?th().getContext("2d"):I;Ag(tm,Me,{_checkEmptyRect:!1,_81o:function(){var O=this._data,F=tm.superClass._81o.call(this),y=O.s("text");if(y!=I){y+="";var f,j=O.s("text.font"),r=O.s("text.align"),B=O.s("text.vAlign"),H=O.s("text.wrap"),S=O.s("text.vertical"),L=O.s("text.vertical.gap"),P=O.s("text.letter.gap")||0,W=O.getWidth(),D=O.getHeight();if(null==L&&(L=1),S){var X;X=H?Fo(y,D,j,P,S,L):[y];var Y=(X.length-1)*P,J=0;Tb.textBaseline=wg,Tb.font=j,X.forEach(function(E){for(var y=E.length,n=0,C=(y-1)*L,t=0;y>t;t++){var j=Tb.measureText(E[t]);C+=j.fontBoundingBoxDescent,n=i(n,j.width)}Y+=n,J=i(C,J)});var u=(X.length-1)*P;X.forEach(function(S){u+=S}),f={width:Y,height:J}}else{var X=H?Fo(y,W,j,P,S,L):y.split("\n"),s=X.length;if(s>1){var v=me(j,y).height,Y=0,J=v*s+L*(s-1);X.forEach(function(y){Y=i(Y,me(j,y).width)}),f={width:Y,height:J}}else f=me(j,y),P&&(f.width+=(y.length-1)*P)}var R,N,m=f.width,M=f.height,l=O.getAnchor();"left"===r?R=-W*l.x:"center"===r?R=-W*l.x+(W-m)/2:"right"===r&&(R=W*(1-l.x)-f.width),"top"===B?N=-D*l.y:"middle"===B?N=-D*l.y+(D-M)/2:"bottom"===B&&(N=D*(1-l.y)-f.height);var U,d=O.getMatrix();if(U=Mc([d.tf(R,N),d.tf(R+m,N),d.tf(R+m,N+M),d.tf(R,N+M)]),F=xf(F,U),F&&O.s("text.shadow")){var o=Tl(F);o.x+=O.s("text.shadow.offset.x"),o.y+=O.s("text.shadow.offset.y"),oh(o,O.s("text.shadow.blur")),F=xf(F,o)}}return F}});var Bm=Ic.Interactor=function(e){this.gv=this._graphView=e};ll("Interactor",j,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(M){this.gv.fi(M)},setCursor:function(e){to||this.gv.setCursor(e)},startDragging:function(r){var Y=this;Y._lastClientPoint=Xe(r),Y._lastLogicalPoint=Y.gv.lp(r),Fd(Y,r)},clearDragging:function(){var D=this;D._lastClientPoint=D._lastLogicalPoint=D._logicalPoint=I},autoScroll:function(L){return this.gv.autoScroll(L,this._lastClientPoint)}});var je=I,In=function(C){je.handleWindowTouchMove(C)},Wn=function(N){je.handleWindowTouchEnd(N),g(c,Wi,In),g(c,ws,Wn),je=I},Zg=function(w){je.handleWindowMouseMove(w)},Qd=function(V){je.handleWindowMouseUp(V),g(c,vf,Zg),g(c,Qf,Qd),je=I},fb=function(l,E){if(l!==je){var P=Pm(E);je?P?je.handleWindowTouchEnd(E):je.handleWindowMouseUp(E):P?(p(c,Wi,In),p(c,ws,Wn)):(p(c,vf,Zg),p(c,Qf,Qd)),je=l}},wq=function(V){var r=this;r.gv=V,r._is2d=V instanceof Ic.GraphView,r._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",Vc,"wheel"].forEach(function(Z){r.addListener(Z)}),r.initImageResource()};Ag(wq,Bm,{enableVR:function(E){var w=this;!!w._vrEnable!==E&&(w._vrEnable=E,E?w.gv.vr.mp(w.onVRControllerChange,w):w.gv.vr.ump(w.onVRControllerChange,w))},onVRControllerChange:function(k){var g=this,W=k.property,O=k.newValue,H=O.id,E=g.gv.vr.getController(H),l=E.getRay();if(l){l.controllerId=H;var I=g.gv.vr.getRayEventType(l,W,O._62O);switch(I){case"down":g.handle_mousedown(l);break;case"up":je&&Qd(l);break;case"move":g.handle_mousemove(l),je&&g.handleWindowMouseMove(l)}}},setPreventEventDefault:function(q,j){var l=this,s=l._eventListeners[q];s?s._prevent=j:l._eventListeners[q]=s={_removal:_,_prevent:j}},removeListener:function(J){var f=this,n=f._eventListeners[J];n&&n._removal&&(n._removal(),n._removal=_)},addListener:function(J){var f=this,Z=f._eventListeners[J];if(Z||(f._eventListeners[J]=Z={_removal:_,_prevent:!0}),!Z||!Z._removal){var n=function(o){Z._prevent&&z.preventDefault(o),f.disabled||f.gv._48Q||("wheel"===J?Sr(f,o):f["handle_"+J](o))};p(f.gv.getView(),J,n),Z._removal=function(){g(f.gv.getView(),J,n)}}},handleWindowTouchMove:function(G){this.handleWindowMouseMove(G)},handleWindowMouseMove:function(U){return!this.downInfo||Pm(U)&&1!==hq(U)?(this.isDragging&&(this.handleDownInfo("onEndDrag",U),this.isDragging=!1),void 0):(this.isDragging?this.handleDownInfo("onDrag",U):(this.handleDownInfo("onBeginDrag",U),this.isDragging=!0),void 0)},handleWindowTouchEnd:function(H){this.handleWindowMouseUp(H)},handleWindowMouseUp:function(S){if(this.isDragging&&(this.handleDownInfo("onEndDrag",S),this.isDragging=!1),this.downInfo){var h=this.handle("onUp",S);if(h&&h.data===this.downInfo.data){this.handleMissingUp(S);var J=this,F=2===S.button?"onContextMenu":"onClick";if(!J._dbclickTimer)return J._dbclickTimer=Nq(function(){delete J._dbclickTimer,J.handleClick(S,F,h),this.downInfo=I},z.clickDelay),void 0;np(J._dbclickTimer),delete J._dbclickTimer,F="onDoubleClick",J.handleClick(S,F,h)}else this.handleDownInfo("onUp",S);this.downInfo=I,this.downComps=I}},handle_mouseleave:function(S){var f=this,Y=f.gv;f._hoverTimer&&(np(f._hoverTimer),delete f._hoverTimer);var c=f.currentInfo?f.currentInfo.data:I;if(c){c.s("onLeave")&&c.s("onLeave")(S,c,Y),f.fire("data","onLeave",S,c);var F=f.currentInfo?f.currentInfo.hits:I;if(F)for(var d in F)f.handleLeave(S,d);f.currentInfo=I}},handle_mousewheel:function(h){h.scrollDelta=h.wheelDelta/40,this.handle("onScroll",h)},handle_DOMMouseScroll:function(C){C.scrollDelta=2===C.axis?-C.detail:0,this.handle("onScroll",C)},handle_touchstart:function(o){this.handle_mousedown(o)},handle_touchmove:function(E){this.handle("onMove",E)},handle_mousedown:function(R){this.isDragging&&(this.handleDownInfo("onEndDrag",R),this.isDragging=!1),this.downComps=[],this.downInfo=this.handle("onDown",R),this.downInfo&&fb(this,R)},handle_mousemove:function(u){var e=this,y=e.gv;if(e._hoverTimer&&(np(e._hoverTimer),delete e._hoverTimer),!y._panning&&!y._moving){var o,F,T,D=e.handle("onMove",u),V=this.currentInfo?this.currentInfo.data:I,f=this.currentInfo?this.currentInfo.hits:I;if(D&&(F=D.data,T=D.hits,e._hoverTimer=Nq(function(){np(e._hoverTimer),delete e._hoverTimer,e.handle("onHover",u,D)},y.getHoverDelay()||z.hoverDelay)),F!==V){if(V&&(V.s("onLeave")&&V.s("onLeave")(u,V,y),this.fire("data","onLeave",u,V)),F&&(F.s("onEnter")&&F.s("onEnter")(u,F,y),this.fire("data","onEnter",u,F)),f)for(o in f)this.handleLeave(u,o);if(T)for(o in T){var X=T[o],m=F._interactPrefix=X.prefix,Z=m&&F.a(m+"onEnter")||X.target.onEnter;Z&&Z.call(X.target,u,F,y,X.point,X.width,X.height),this.fire(X.type,"onEnter",X.event,X.data,X.image,X.comp,X.point,X),F._interactPrefix=null}}else{if(f)for(o in f)T&&T[o]||this.handleLeave(u,o);if(T)for(o in T)if(!f||!f[o]){var X=T[o],m=F._interactPrefix=X.prefix,Z=m&&F.a(m+"onEnter")||X.target.onEnter;Z&&Z.call(X.target,u,F,y,X.point,X.width,X.height),this.fire(X.type,"onEnter",X.event,X.data,X.image,X.comp,X.point,X),F._interactPrefix=null}}this.currentInfo=D}},handle:function(B,L,W){var Y,N=this,d=N.gv;if(N._is2d){if(W=W||d.getDataInfoAt(L),!W||!d.isInteractive(W.data))return;if(Y=W.ui.interactiveInfo){var v,t=W.data;if(t.s(B)&&t.s(B)(L,t,d),this.fire("data",B,L,t),"body"===W.part&&Y.bodyInfo)v="body",W.hits=this.handleImage(v,d.getImage(t),B,L,t,W.point,Y.bodyInfo);else if("icons"===W.part&&Y._38o){var I=Y._38o[W.name];I&&I[W.index]&&(v="icons|"+W.name+"|"+W.index,W.hits=this.handleImage(v,W.icon,B,L,t,W.point,I[W.index]))}}return W}var t,i;if(!W)if(L&&L instanceof A.Math.Ray&&d.isVREnabled()){var S=d.vr.intersectWorld(L);if(t=S.data,i=S.intersect,d.vr.renderRayDuringInteraction(L,t,i),!t)return;var G=d.getData3dUI(t);if(Y=G.interactiveInfo,!Y)return;W={data:t,part:i.part,ui:G}}else{if(W=d.getDataInfoAt(L),!W)return;W&&(W={data:W.data,part:W.part})}if(d.isInteractive(W.data)){if(!i){t=W.data;var G=d.getData3dUI(t);if(W.ui=G,Y=G.interactiveInfo,!Y)return W;if(i=d.intersectObject(L,t),!i)return W}t.s(B)&&t.s(B)(L,t,d),this.fire("data",B,L,t);var l,j=i.part;return"body"!==j&&(l=t.s(j+".image")||t.s("shape3d."+j+".image")),l||(l=t.s("all.image")||t.s("shape3d.image")),l?(Y="object"==typeof l?Y[l.uuid]:Y[l],Y&&Y.bodyInfo?(W.part="body",W.interactiveInfo=Y,W.point=this._convertUVToPoint(i.uv,Y),W.image=l,W.hits=this.handleImage("body",l,B,L,t,W.point,Y.bodyInfo),W):W):W}},_handleLeaveOrMissing:function(k,T,h){var R="leave"===k?this.currentInfo:this.downInfo;if(R){var Y=R.interactiveInfo||R.ui.interactiveInfo;if(Y){var m,g,f=R.data;if(this._is2d){if(g=this.gv.lp(T),"body"===R.part&&Y.bodyInfo)m="body","leave"===k?this.handleLeaveImage(h,m,this.gv.getImage(f),T,f,g,Y.bodyInfo):this.handleMissingUpImage(m,this.gv.getImage(f),T,f,g,Y.bodyInfo);else if("icons"===R.part&&Y._38o){var C=Y._38o[R.name];C&&C[R.index]&&(m="icons|"+R.name+"|"+R.index,"leave"===k?this.handleLeaveImage(h,m,R.icon,T,f,g,C[R.index]):this.handleMissingUpImage(m,R.icon,T,f,g,C[R.index]))}}else{if(!Y.bodyInfo)return;var t=this.gv.intersectObject(T,f);g=t&&t.uv?this._convertUVToPoint(t.uv,Y):{x:1/0,y:1/0},"leave"===k?this.handleLeaveImage(h,"body",R.image,T,f,g,Y.bodyInfo):this.handleMissingUpImage("body",R.image,T,f,g,Y.bodyInfo)}}}},handleClick:function(s,Y,k){var z=this,_=this.downInfo;if(_&&k){var D,S=k.interactiveInfo||k.ui.interactiveInfo,T=k.data,L=this.gv;if(T.s(Y)&&T.s(Y)(s,T,L),z.fire("data",Y,s,T),S)if(this._is2d){if(_.part===k.part){var M=L.lp(s);"body"===k.part&&S.bodyInfo&&(D="body",this.handleClickImage(D,L.getImage(T),Y,s,T,M,S.bodyInfo,k))}}else{if(!S.bodyInfo)return;var F=L.intersectObject(s,T);if(!F)return;M=this._convertUVToPoint(F.uv,S),this.handleClickImage("body",_.image,Y,s,T,M,S.bodyInfo,k)}}},handleDownInfo:function(E,V){if(this.downInfo){var S=this.downInfo,D=this.gv,A=S.interactiveInfo||S.ui.interactiveInfo;if(A){var j,b=S.data;if(b.s(E)&&b.s(E)(V,b,D),this.fire("data",E,V,b),this._is2d){var U=D.lp(V);if("body"===S.part&&A.bodyInfo)j="body",this.handleDownInfoImage(j,D.getImage(b),E,V,b,U,A.bodyInfo);else if("icons"===S.part&&A._38o){var v=A._38o[S.name];v&&v[S.index]&&(j="icons|"+S.name+"|"+S.index,this.handleDownInfoImage(j,S.icon,E,V,b,U,v[S.index]))}}else{if(!A.bodyInfo)return;var Z;if("onBeginDrag"===E?(Z=D._raycaster.intersectObjectAndRecordTriangle(V,b),Z&&(A.beginDragIntersectInfo=Z.triangleInfo)):Z=D.intersectObject(V,b),!Z&&("onDrag"!==E&&"onEndDrag"!==E||!A.beginDragIntersectInfo||(Z=D._raycaster.intersectLastTriangle(V,A.beginDragIntersectInfo)),!Z))return;U=this._convertUVToPoint(Z.uv,A),this.handleDownInfoImage("body",S.image,E,V,b,U,A.bodyInfo)}}}},fire:function(w,F,h,A,J,D,x,R){this.gv.fi({kind:F,type:w,event:h,data:A,image:J,comp:D,view:this.gv,point:x,width:R?R.width:_,height:R?R.height:_})},handleImage:function(W,I,h,q,e,G,R){var c={};if(I&&(I=Gj(I))){var y=this.gv,t=R.rect,S=this.convertPoint(G,R);S.inRect&&(I[h]&&I[h](q,e,y,S,t.width,t.height),this.fire("image",h,q,e,I,_,S,t),c[W+"|image"]={target:I,type:"image",image:I,data:e,event:q,point:S,width:t.width,height:t.height});for(var Q,v=R.compInfos,Z=I,k=v.length-1;k>=0;k--){var b=v[k],B=b.comp;if(S=this.convertPoint(G,b,Z,B,y,e),S.inRect){t=b.rect;var F=e._interactPrefix=b.prefix,x=F&&e.a(F+h)||B[h];if(x&&(Q=x.call(B,q,e,y,S,t.width,t.height)),this.fire("comp",h,q,e,I,B,S,t),Q!==!0&&(I=t.image)&&(I[h]&&(Q=I[h](q,e,y,S,t.width,t.height)),this.fire("image",h,q,e,I,_,S,t)),e._interactPrefix=null,c[W+"|"+k]={target:B,type:"comp",comp:B,image:I,data:e,event:q,point:S,width:t.width,height:t.height,prefix:F},this.downComps&&this.downComps.push(B),I&&(c[W+"|"+k+"|image"]={target:I,type:"image",image:I,data:e,event:q,point:S,width:t.width,height:t.height,prefix:F}),Q===!0)break}}}return c},handleLeave:function(f,V){return this._handleLeaveOrMissing("leave",f,V)},handleMissingUp:function(O){return this._handleLeaveOrMissing("missing",O)},handleLeaveImage:function(K,H,L,A,M,D,t){if(L&&(L=Gj(L))){var Q=this.gv,e=t.rect,o=this.convertPoint(D,t);K===H+"|image"&&(L.onLeave&&L.onLeave(A,M,Q,o,e.width,e.height),this.fire("image","onLeave",A,M,L,_,o,e));for(var c,O=t.compInfos,X=L,x=O.length-1;x>=0;x--){var b=O[x],P=b.comp;o=this.convertPoint(D,b,X,P,Q,M),e=b.rect;var R=M._interactPrefix=b.prefix;if(K===H+"|"+x){var I=R&&M.a(R+"onLeave")||P.onLeave;I&&(c=I.call(P,A,M,Q,o,e.width,e.height)),this.fire("comp","onLeave",A,M,L,P,o,e)}if(c!==!0&&(L=e.image)&&K===H+"|"+x+"|image"&&(L.onLeave&&(c=L.onLeave(A,M,Q,o,e.width,e.height)),this.fire("image","onLeave",A,M,L,_,o,e)),M._interactPrefix=null,c===!0)break}}},handleMissingUpImage:function(c,Q,B,L,U,i){var T="onUp",j=this.downInfo.hits;if(j&&Q&&(Q=Gj(Q))){var z=this.gv,H=i.rect,t=this.convertPoint(U,i);!t.inRect&&j[c+"|image"]&&(Q[T]&&Q[T](B,L,z,t,H.width,H.height),this.fire("image",T,B,L,Q,_,t,H));for(var W,h=i.compInfos,q=Q,S=h.length-1;S>=0;S--){var D=h[S],f=D.comp;if(t=this.convertPoint(U,D,q,f,z,L),!t.inRect){H=D.rect;var p=L._interactPrefix=D.prefix;if(j[c+"|"+S]){var M=p&&L.a(p+T)||f[T];M&&(W=M.call(f,B,L,z,t,H.width,H.height)),this.fire("comp",T,B,L,Q,f,t,H)}if(W!==!0&&(Q=H.image)&&j[c+"|"+S+"|image"]&&(Q[T]&&(W=Q[T](B,L,z,t,H.width,H.height)),this.fire("image",T,B,L,Q,_,t,H)),L._interactPrefix=null,W===!0)break}}}},handleDownInfoImage:function(e,M,b,p,Q,x,W){var I=this.downInfo.hits;if(I&&M&&(M=Gj(M))){var d=this.gv,m=W.rect,S=this.convertPoint(x,W);I[e+"|image"]&&(M[b]&&M[b](p,Q,d,S,m.width,m.height),this.fire("image",b,p,Q,M,_,S,m));for(var P,Z=W.compInfos,t=M,F=Z.length-1;F>=0;F--){var l=Z[F],g=l.comp;S=this.convertPoint(x,l,t,g,d,Q),m=l.rect;var k=Q._interactPrefix=l.prefix,q=["onDrag","onEndDrag"].indexOf(b)>=0;if(!q&&I[e+"|"+F]||q&&this.downComps&&this.downComps.indexOf(g)>=0){var D=k&&Q.a(k+b)||g[b];D&&(P=D.call(g,p,Q,d,S,m.width,m.height)),this.fire("comp",b,p,Q,M,g,S,m)}if(P!==!0&&(M=m.image)&&I[e+"|"+F+"|image"]&&(M[b]&&(P=M[b](p,Q,d,S,m.width,m.height)),this.fire("image",b,p,Q,M,_,S,m)),Q._interactPrefix=null,P===!0)break}}},handleClickImage:function(q,h,r,z,L,b,A,s){var C=this.downInfo.hits,H=s.hits;if(C&&h&&(h=Gj(h))){var U=this.gv,N=A.rect,w=this.convertPoint(b,A);C[q+"|image"]&&(h[r]&&h[r](z,L,U,w,N.width,N.height),this.fire("image",r,z,L,h,_,w,N));for(var I,e=A.compInfos,x=h,u=e.length-1;u>=0;u--){var l=e[u],G=l.comp;w=this.convertPoint(b,l,x,G,U,L),N=l.rect;var V=L._interactPrefix=l.prefix;if(C[q+"|"+u]&&H[q+"|"+u]){var n=V&&L.a(V+r)||G[r];n&&(I=n.call(G,z,L,U,w,N.width,N.height)),this.fire("comp",r,z,L,h,G,w,N)}if(I!==!0&&(h=N.image)&&C[q+"|"+u+"|image"]&&(h[r]&&(I=h[r](z,L,U,w,N.width,N.height)),this.fire("image",r,z,L,h,_,w,N)),L._interactPrefix=null,I===!0)break}}},initImageResource:function(){z.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(j,$){if(!j)return{x:1/0,y:1/0};var Y=$.bodyInfo.rect,k=j.clone(),f=j.multiply({x:Y.width,y:Y.height});return f.local=k,f},convertPoint:function(L,C,w,M,b,W){var k=C.rect,U=C.matrix.applyInverse(L).sub(k),D=U.x>=0&&U.y>=0&&U.x<=k.width&&U.y<=k.height;if(!D)return U;if(M&&ui(M.pixelPerfect,W,b)){var k,h=1;this._is2d?(h=b.getZoom(),k=rd(L.x,L.y,_,h)):k=rd(L.x,L.y);var Y=!1,i=k.x,$=k.y,l=k.width,J=k.height,B=z.hitMaxArea,V=l*J*h*h;if(V>B){var K=Math.sqrt(B/V);h*=K}l*=h,J*=h,2>l&&(l=2),2>J&&(J=2),i*=h,$*=h;var G=ys(l,J),x=new ab(0,-i,-$,h,h);x.append(C.matrix),b._drawForChecking=!0,M.transform=x;var F=w.fitSize;C.refRect&&C.refRect.fitSize?(M.refRect=C.refRect,w.fitSize=!0):w.fitSize=!1;var f=w.comps;w.comps=[M],jp(G,w,0,0,l,J,W,self),w.comps=f,w.fitSize=F,delete M.refRect,delete M.unionRect,delete M.transform,b._drawForChecking=!1;try{for(var u=0,j=G.getImageData(0,0,l,J).data;u<j.length;u+=4)if(0!==j[u+3]){Y=!0;break}G.restore()}catch(y){Xj=I,Y=!1}U.inRect=Y}else U.inRect=!0;return U}});var $d=Ic.DefaultInteractor=function(x){nk($d,this,[x])};ll("DefaultInteractor",Bm,{handle_mousedown:function(f){um(f);var O=this,b=O.gv,B=b.getDataAt(f);if(b.setFocus(f)&&!b._editing&&!b._scrolling){we(f)?b.handleDoubleClick(f,B):b.handleClick(f,B);var g=fh(f);!Ui()&&!g&&B&&(b.isMovable(B)||b._39Q(B))||!b.isPannable()||!Uo(f)&&!g||Ro(f)||(O._tx=b.tx(),O._ty=b.ty(),O.startDragging(f))}},handleWindowMouseUp:function(K){var q=this,S=q.gv;S._panning&&(delete S._panning,S.onPanEnded(),q.fi({kind:"endPan",event:K})),delete q._tx,delete q._ty,q.clearDragging()},handle_mousemove:function(D){var b=this,d=b.gv;b._hoverTimer&&(np(b._hoverTimer),delete b._hoverTimer),b._hoverTimer=Nq(function(){b.fi({kind:"hover",event:D}),np(b._hoverTimer),delete b._hoverTimer},d.getHoverDelay()||z.hoverDelay)},handle_mouseleave:function(){var S=this;S._hoverTimer&&(np(S._hoverTimer),delete S._hoverTimer)},handleWindowMouseMove:function(Z){var c=this,s=c.gv;c.fi({kind:s._panning?"betweenPan":"beginPan",event:Z}),s._panning=1;var K=Ii(s,Z,c._lastClientPoint);s.setTranslate(c._tx+K.x,c._ty+K.y)},handle_mousewheel:function(t){this.gv.handleScroll(t,t.wheelDelta)},handle_DOMMouseScroll:function(N){2===N.axis&&this.gv.handleScroll(N,-N.detail)},handle_keydown:function(Q){this.gv.handleKeyDown(Q)}});var jk=Ic.SelectInteractor=function(k){nk(jk,this,[k])};ll("SelectInteractor",Bm,{_42:function(){var A=this,G=A.gv,$=G.getZoom(),t=A.mark,Z=A.div;Z||(Z=A.div=_k(),Ik(A.getView(),Z));var H={};H.x=t.x*$+G.tx(),H.y=t.y*$+G.ty(),H.width=t.width*$,H.height=t.height*$,zb(Z,H),this.intersects()?(Z.style.border="",Z.style.background=G.getRectSelectBackground()):(Z.style.background="",Z.style.border="1px solid "+G.getRectSelectBorderColor())},handle_mousedown:function(t){var o=this,c=o.gv;if(o._57I=I,o.pendingClickThrough=I,!(c._editing||c._scrolling||Ui()||fh(t))){var i=c.getDataAt(t),P=c.sm();i?Ro(t)?P.co(i)?P.rs(i):P.as(i):P.co(i)?i instanceof dp&&i.isClickThroughEnabled()&&Uo(t)&&(o.pendingClickThrough=Xe(t)):P.ss(i):Ro(t)||!c.isPannable()?Uo(t)&&(Ro(t)||P.cs(),c.isRectSelectable()&&(o.startDragging(t),c._77O=1)):Uo(t)&&(o._57I=Xe(t))
}},handle_mouseup:function(h){var Y=this,p=Y.gv,O=Y._57I;if(O&&(Hd(O,Xe(h))<=1&&p.sm().cs(),Y._57I=I),Y.pendingClickThrough){if(Hd(Y.pendingClickThrough,Xe(h))<=1){var E=p.getDataAt(h);if(E instanceof dp&&E.isClickThroughEnabled()){var V=p.getDataAt(h,function($){var S=$.getParent()===E&&p.isSelectable($,!0);return S});V&&(h.clickThrough=!0,p.sm().ss(V))}}Y.pendingClickThrough=I}},handleWindowMouseUp:function(p){this.clear(p)},handleWindowMouseMove:function(Q){var A=this,k=A.gv;A._logicalPoint=k.lp(Q),A.mark?(A.fi({kind:"betweenRectSelect",event:Q}),k.isPannable()&&A.autoScroll(Q),A.redraw()):A.fi({kind:"beginRectSelect",event:Q}),A.mark=Mc(A._lastLogicalPoint,A._logicalPoint),A.redraw()},intersects:function(){var y=this,q=y._lastLogicalPoint,M=y._logicalPoint;return q.x>M.x||q.y>M.y},clear:function(a){var l=this,u=l.gv,Y=l.mark;if(l._57I=I,l.pendingClickThrough=I,l._lastLogicalPoint){if(Y){if(0!==Y.width&&0!==Y.height){var j=u.getDatasInRect(Y,l.intersects());if(!j.isEmpty()){var c=u.sm(),m=c.toSelection(),X=Io(a),r=a.altKey;j.each(function(U){c.co(U)?(!X||X&&r)&&m.remove(U):(!r||X&&r)&&m.add(U)}),c.ss(m)}}Hj(l.div),delete l.div,delete l.mark,l.redraw(),l.fi({kind:"endRectSelect",event:a}),u.onRectSelectEnded()}l.clearDragging(),delete u._77O}},redraw:function(){var G=this;G._draw||(G._draw=1,Nq(function(){G.mark&&G._42(),delete G._draw},16))}});var Cs=Ic.MoveInteractor=function(j){nk(Cs,this,[j])};ll("MoveInteractor",Bm,{handle_mousedown:function(Z){var R=this,F=R.gv;if(Uo(Z)&&!F._editing&&!F._scrolling&&!Ui()){var l=F.getSelectedDataAt(Z);!l||F._39Q(l)&&!F.isMovable(l)?F._focusData=I:(R._data=l,F.handleMouseDown&&F.handleMouseDown(Z,l),R.startDragging(Z),F.isMovable(l)&&(F._moving=1))}},handleWindowMouseUp:function(J){var O=this,K=O.gv;K.handleMouseUp&&K.handleMouseUp(J,O._data),O.clear(J)},handleWindowMouseMove:function(I){var w=this,m=w._data,B=w.gv;if((!B._93O||!B._93O(I,m))&&B._moving){w._logicalPoint||w.fi({kind:"prepareMove",event:I});var z=w._logicalPoint?"betweenMove":"beginMove",E={kind:z,event:I},Q=w._logicalPoint=B.lp(I);"beginMove"!==z||w._alreadyBeginTransaction||(w._alreadyBeginTransaction=!0,B.getDataModel().beginTransaction());var X=w._calcShift(z,I),n=X.x,V=X.y,T=w.gv.getMoveMode(I,m);T&&("x"===T?V=0:"y"===T?n=0:"xy"!==T&&(n=V=0)),B.moveSelection(n,V),w._lastLogicalPoint=Q,w.autoScroll(I),w.fi(E)}},_calcShift:function(){var r=this,H=r._logicalPoint,i=r._lastLogicalPoint,m=H.x-i.x,L=H.y-i.y;return{x:m,y:L}},clear:function(T){var o=this,g=o.gv;o._lastLogicalPoint&&(o._lastLogicalPoint=o._data=g._moving=I,o._logicalPoint&&(o.fi({kind:"endMove",event:T}),g.onMoveEnded()),o.clearDragging()),o._alreadyBeginTransaction&&(o._alreadyBeginTransaction=!1,g.getDataModel().endTransaction())}});var Wo=Ic.TextEditInteractor=function(u){nk(Wo,this,[u]),this.init()};ll("TextEditInteractor",Bm,{init:function(){var J=this,A=this.input=K.createElement("input"),T=A.style;A.text="text",T.border="1px solid #d8d8d8",T.position="absolute",T.padding="2px 3px",T.outline="none",T.marginLeft="-90px",T.marginTop="-16px",T.backgroundColor="rgba(255,255,255, 0.9)",T.fontSize="14px",T.width="180px",T.height="32px",T.boxShadow="0 0 13px rgba(16,142,233, 0.5)",T.textAlign="center",T.boxSizing="border-box",p(A,"keyup",function(B){dc(B)&&J.endTextEdit()}),p(A,"focus",function(){A.select()});var E=this.textarea=K.createElement("textarea"),x=this.wrap=K.createElement("div");x.appendChild(E),T=E.style,T.margin=0,T.padding="4px",T.overflow="hidden",T.boxSizing="border-box",T.position="absolute",T.outline="none",T.backgroundColor="transparent",T.resize="none",T.textAlign="center",T.fontSize="14px",T.border="none",T.borderWidth=0,T.width="100%",T.top="50%",T=x.style,T.boxSizing="border-box",T.margin=0,T.padding=0,T.position="absolute",T.boxShadow="0 0 13px rgba(16,142,233, 0.5)",T.border="1px solid #d8d8d8",T.backgroundColor="rgba(255,255,255, 0.9)",T.width="180px",T.marginLeft="-90px",p(E,"keydown",function(X){return(Io()||Ro())&&dc(X)?(J.endTextEdit(),void 0):(J.calculateTextareaHeight(String.fromCharCode(X.keyCode)),void 0)}),p(E,"focus",function(){E.select()});var L=function(E){E.stopPropagation()};p(A,"mousedown",L),p(A,"touchstart",L),p(E,"mousedown",L),p(E,"touchstart",L),J.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],J.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",J.handleWindowClick=function(t){var s=J._editingDOM;if(s){var B=s.getBoundingClientRect(),G=Xe(t);An(B,G)||J.endTextEdit()}}},handle_mousedown:function(p){var K=this,$=K.gv;if(we(p)&&!$._editing){var t=$.getDataAt(p);if(t){var Z=$.getTextEditInfo(t);Z&&(this._editInfo=Z,this._editTarget=t,$._editing=!0,Z.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var A=this,S=A.gv,J=A._editTarget,v=A.getTargetValue(),e=A.textarea,L=A.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===v||v===_)&&(v=""),e.value=v,A._editingDOM=e,S.getView().appendChild(L),this.layoutHTML(L,J),this.calculateTextareaHeight(),Nq(function(){e.focus(),p(c,"mousedown",A.handleWindowClick),p(c,"touchstart",A.handleWindowClick)},10)},handleTextEdit:function(){var T=this,r=T.gv,W=T._editTarget,y=T.getTargetValue(),I=T.input;(null===y||y===_)&&(y=""),I.value=y,T._editingDOM=I,r.getView().appendChild(I),this.layoutHTML(I,W),Nq(function(){I.focus(),p(c,"mousedown",T.handleWindowClick),p(c,"touchstart",T.handleWindowClick)},10)},layoutHTML:function(U,d){var z=this.gv,E=z.getZoom();if(d instanceof A.Node){var p=d.getRect(),t=Math.min(Math.max(100,p.width*E),800);U.style.left=(p.x+p.width/2)*E+z.tx()+"px",U.style.top=(p.y+p.height/2)*E+z.ty()+"px",U.style.width=t+"px",U.style.marginLeft=-t/2+"px"}else if(d instanceof A.Edge){var K=z.getDataUI(d),p=K._6I;U.style.left=(p.x+p.width/2)*E+z.tx()+"px",U.style.top=(p.y+p.height/2)*E+z.ty()+"px"}},endTextEdit:function(){var x=this,n=x._editInfo.isMultiline?x.wrap:x.input,A=x._editInfo.isMultiline?x.textarea:x.input;x.setTargetValue(A.value),x.gv.getView().removeChild(n),x.gv._editing=!1,delete x._editingDOM,g(c,"mousedown",x.handlelick),g(c,"touchstart",x.handleWindowClick)},setTargetValue:function(E){var C=this,$=C._editTarget,S=C._editInfo,T=S.accessType,Q=S.name;if(Q&&T||(T="p",Q="name"),"p"===T){var a=A.Default.setter(Q);$[a](E)}else"a"===T?$.a(Q,E):$.s(Q,E)},getTargetValue:function(){var i=this,U=i._editTarget,Q=i._editInfo,s=Q.accessType,z=Q.name;if(z&&s||(s="p",z="name"),"p"===s){var O=A.Default.getter(z);return U[O]()}return"a"===s?U.a(z):U.s(z)},createHiddenTextarea:function(){this.hiddenTextarea=K.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(P,F){if(F&&this.computedStyleCache)return this.computedStyleCache;var A=this,Q=c.getComputedStyle(P),j=Q.getPropertyValue("box-sizing")||Q.getPropertyValue("-moz-box-sizing")||Q.getPropertyValue("-webkit-box-sizing"),o=parseFloat(Q.getPropertyValue("padding-bottom"))+parseFloat(Q.getPropertyValue("padding-top")),N=parseFloat(Q.getPropertyValue("border-bottom-width"))+parseFloat(Q.getPropertyValue("border-top-width")),x=A.SIZING_STYLE.map(function(B){return B+":"+Q.getPropertyValue(B)}).join(";"),$={sizingStyle:x,paddingSize:o,borderSize:N,boxSizing:j};return F&&(this.computedStyleCache=$),$},calculateTextareaHeight:function(A){A=A||"";var b=this,l=b.textarea,U=b.hiddenTextarea,D=b.wrap,B=32,i=b.calculateHTMLStyle(l,!1),L=i.paddingSize,j=i.borderSize,M=i.boxSizing,v=i.sizingStyle;U.setAttribute("style",v+";"+b.HIDDEN_TEXTAREA_STYLE),U.value=l.value+A;var X=U.scrollHeight;"border-box"===M?X+=j:"content-box"===M&&(X-=L),l.style.height=X+"px",l.style.marginTop=0-.5*X+"px",D.style.height=Math.max(X,B)+"px",D.style.marginTop=X*-.5+"px"}});var Pe=Ic.ScrollBarInteractor=function(y){nk(Pe,this,[y])};ll("ScrollBarInteractor",Bm,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(S){var T=this.gv.getViewRect();return this._41o()&&(T.x+T.width-this.gv.lp(S).x)*this.gv.getZoom()<_e},isH:function(h){var a=this.gv.getViewRect();return this._40o()&&(a.y+a.height-this.gv.lp(h).y)*this.gv.getZoom()<_e},handle_mousemove:function(x){this.handle_touchmove(x)},handle_touchmove:function(N){if(!Lq&&Uo(N)&&this.gv.isScrollBarVisible()){var G=this,i=G.isV(N),z=G.isH(N);(i||z)&&G.gv.showScrollBar(),G.gv._scrolling=i||z}},handleWindowMouseUp:function(b){this.handleWindowTouchEnd(b)},handleWindowTouchEnd:function(y){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=I,this.fi({kind:"endScroll",event:y})},handle_mousedown:function(k){this.handle_touchstart(k)},handle_touchstart:function(B){var M=this;if(M.gv.setFocus(B),um(B),M.handle_touchmove(B),!(hq(B)>1)&&M.gv._scrolling&&M.gv.isScrollBarVisible()){M._cp=Xe(B),M._tx=M.gv.tx(),M._ty=M.gv.ty();var C=M.isV(B);M._state=C?"vScroll":"hScroll",Fd(M,B),M.fi({kind:"beginScroll",event:B})}},handleWindowMouseMove:function(x){this.handleWindowTouchMove(x)},handleWindowTouchMove:function(o){var e=Xe(o),G=this.gv.getViewRect(),v=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-e.y)*v.height/G.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-e.x)*v.width/G.width),this.fi({kind:"betweenScroll",event:o})}});var pk=Ic.TouchInteractor=function(P,s){s=s||{},s.selectable===_&&(s.selectable=!0),s.movable===_&&(s.movable=!0),s.pannable===_&&(s.pannable=!0),s.pinchable===_&&(s.pinchable=!0),s.editable===_&&(s.editable=!0),this.params=s,nk(pk,this,[P])};ll("TouchInteractor",Bm,{ms_edit:1,setUp:function(){var t=this;pk.superClass.setUp.call(t),to&&t.params.editable&&t.gv.setEditInteractor(t)},tearDown:function(){var N=this;pk.superClass.tearDown.call(N),to&&N.params.editable&&N.gv.setEditInteractor(I)},clear:function(S){var w=this,T=w.gv;T._moving&&(w.fi({kind:"endMove",event:S}),delete T._moving,T.onMoveEnded(),T.dm().endTransaction()),T._panning&&(w.fi({kind:"endPan",event:S}),delete T._panning,T.onPanEnded()),T._pinching&&(w.fi({kind:"endPinch",event:S}),delete T._pinching,T.onPinchEnded()),T._editing&&(w._46O(S),w._77I=w._node=w._edge=w._shape=w._rect=w._89I=w._index=T._editing=I),w.pendingClickThrough=w._moving=w._panning=w._pinching=w._editing=w._57I=w._data=w._beginHistory=I,w.clearDragging()},handle_touchstart:function(i){var W=this;if(!W.gv._editing){um(i),W._57I=I,W.pendingClickThrough=I;var u=W.params,y=W.gv,A=y.sm(),S=y.getDataAt(i),p=hq(i);if(1===p){if(we(i))return y.handleDoubleClick(i,S),void 0;y.handleClick(i,S),S&&(y.handleMouseDown&&y.handleMouseDown(i,S),W._data=S),u.selectable||(S=I),S&&(A.co(S)?S instanceof dp&&S.isClickThroughEnabled()&&(W.pendingClickThrough=Xe(i)):A.ss(S),u.editable&&y.isEditable(S)&&W._79I(i,S,!0)?(W._editing=1,W.startDragging(i)):u.movable&&y.isMovable(S)&&(W._moving=1,W.startDragging(i))),S&&(y.isMovable(S)||y._39Q(S))||(W._57I=Xe(i),u.pannable&&y.isPannable()&&(W._panning=1,W.startDragging(i),W._translate={x:y.tx(),y:y.ty()}))}else if(u.pinchable&&2===p){if(!y.getEditInteractor()&&S){var M=Gj(y.getImage(S));if(M&&ui(M.scrollable,S,this))return}W._pinching=1,W.startDragging(i);var j=y.getView(),n=y.getZoom(),C=j.getBoundingClientRect(),K=i.touches[0],G=i.touches[1],x={x:(K.clientX+G.clientX)/2-C.left,y:(K.clientY+G.clientY)/2-C.top};x.x-=y.tx(),x.y-=y.ty(),x.x/=n,x.y/=n,W._p=x,W._d=xn(i)}}},handle_touchend:function(H){var m=this,U=m.gv,v=m._57I,L=m._data;if(v&&(Hd(v,Xe(H))<=1&&!U.getDataAt(H)&&U.sm().cs(),m._57I=I),L&&U.handleMouseUp&&U.handleMouseUp(H,L),m.pendingClickThrough){if(Hd(m.pendingClickThrough,Xe(H))<=1){var L=U.getDataAt(H);if(L instanceof dp&&L.isClickThroughEnabled()){var t=U.getDataAt(H,function(X){var I=X.getParent()===L&&U.isSelectable(X,!0);return I});t&&(H.clickThrough=!0,U.sm().ss(t))}}m.pendingClickThrough=I}},handleWindowTouchEnd:function(L){this.clear(L)},handleWindowTouchMove:function(q){var o=this,Q=o.gv,$=hq(q);if(1===$){var x=Xe(q),f=Ii(Q,x,o._lastClientPoint),B=Hd({x:0,y:0},f);if(o._editing&&(o._beginHistory||(o._beginHistory=1,Q.dm().beginTransaction()),Q._editing=1,o._78I(q)),o._moving){if(!Q._moving&&B<z.touchMoveThreshold)return;o._beginHistory||(o._beginHistory=1,Q.dm().beginTransaction()),o.handleMove(q)}else if(o._panning){if(!Q._panning&&B<z.touchMoveThreshold)return;Q.setTranslate(o._translate.x+f.x,o._translate.y+f.y),o.fi({kind:Q._panning?"betweenPan":"beginPan",event:q}),Q._panning=1}}else if(2===$&&o._pinching){var d=xn(q);Q.handlePinch(o._p,d,o._d),o._d=d,o.fi({kind:Q._pinching?"betweenPinch":"beginPinch",event:q}),Q._pinching=1}},handleMove:function(H){var W=this,t=W.gv,X=t.lp(H);t._93O&&t._93O(H,W._data)||(t.moveSelection(X.x-W._lastLogicalPoint.x,X.y-W._lastLogicalPoint.y),W._lastLogicalPoint=X,W.autoScroll(H),W.fi({kind:t._moving?"betweenMove":"beginMove",event:H}),t._moving=1)}});var A=c.ht,wf=A.graph._editor={Math:A.Math,Guide:{}};wf.getStyle=function(u){var b,d=wf.StyleMap;return d&&(b=d[u],b!==_)?b:wf.DefaultStyleMap[u]},wf.setStyle=function(i,W){var J=wf.StyleMap;J||(J=wf.StyleMap={}),J[i]=W},wf.inEdit=function(U){return U._inXEdit===!0},wf.startEdit=function(q){q._inXEdit=!0,wf.Inject.doInject(q)},wf._46O=function(X){X._inXEdit=!1,wf.Inject.undoInject(X)},wf.toScreenPosition=function(F,w){var O=F.tx(),k=F.ty(),m=F._zoom;return new wf.Math.Vector2(w.x*m+O,w.y*m+k)},wf.checkHit=function(U,B,$){return U.distanceTo(B)<$?!0:!1},wf.toWorldPosition=function(M,r){var H=M.tx(),J=M.ty(),S=M._zoom;return{x:(r.x-H)/S,y:(r.y-J)/S}},wf.setAntialias=function(Z,h){for(var c,D=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],w=0,P=D.length;P>w&&(c=D[w],!(c in Z));w++);Z[c],Z[c]=h},wf.getTargetCornersOnScreen=function(B,$){if(!$)return null;var F,K=[];if(os($,B)){var S=Sc(B,$);F=[{x:S.x,y:S.y},{x:S.x+S.width,y:S.y},{x:S.x+S.width,y:S.y+S.height},{x:S.x,y:S.y+S.height}]}else{if(!$.getCorners)return null;F=$.getCorners()}return F.forEach(function(e){var N=wf.toScreenPosition(B,e);K.push(N.x,N.y)}),K},wf.log=function(){};var eb;wf.updateTipInfo=function(U,H,Y){if(Y){var M=A.Default.getLogicalPoint(U,H._canvas);M.x+=wf.Icons.TipShiftX,M.y+=wf.Icons.TipShiftY,eb={helperPos:M,text:Y,size:Y.length}}else eb=I},wf.drawTip=function(y,Q){eb&&wf.Icons.DrawIcon(Q,y,wf.Icons.TipHelper,eb)};var Hi=wf.Inject={_modules:[]};Hi.registAsModule=function(M,r){var t={},B={};for(var Y in M){var I=r.prototype[Y];t[Y]=I}M.getBackup=function(f){return t[f]},M.getBackups=function(){return t},B.doInject=function(){for(var g in M)"getBackup"!==g&&(r.prototype[g]=M[g])},B.undoInject=function(){for(var y in M)"getBackup"!==y&&(r.prototype[y]=t[y])},Hi._modules.push(B)},Hi.doInject=function(C){for(var x,I=Hi._modules,n=0,c=I.length;c>n;n++)x=I[n],x.doInject(C)},Hi.undoInject=function(v){for(var Z,k=Hi._modules,c=0,f=k.length;f>c;c++)Z=k[c],Z.undoInject(v)};var Bm=A.graph.EditInteractor=function(O){var a=this,s=K.createElement("canvas");s.className="editCanvas",s.style.position="absolute",a._uuid=A.Math.generateUUID(),a._styleMap={},a._canvas=s,a._context=s.getContext("2d"),Bm.superClass.constructor.call(a,O),this._editDetail=!1,wf.setAntialias(a._context,!1),a._subModules=a.initSubModule(),a._gridGuide=new wf.Guide.Grid(a),a._rectGuide=new wf.Guide.Rect(a),a._hoverGuide=new wf.Guide.Hover(a)},wj=Bm;A.Default.def(Bm,A.graph.Interactor,{ms_edit:1,ms_fire:1}),j.defineProperties(Bm.prototype,{editDetail:{get:function(){var g=!!this._editDetail;return g},set:function(S){var V=this,k=V._editDetail;k!==S&&(V._editDetail=S,V.gv._editing=S,V.fp("editDetail",k,S),V.fp("pointsEditingMode",k,S),V.fi({kind:S?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(g){(!this._editDetail||g)&&(this.gv._editing=g,g||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(U){this._editing=U,this.gvEditing=U}},editingModule:{get:function(){return this._editMod}},pointsEditingMode:{get:function(){return this.editDetail},set:function(w){var z=this;z.editDetail!==w&&(w?z._tryEnterEditDetailMode():z._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var v=this._gridEnabled;if(!v)return!1;var Q=this.gv;return Q?!0:!0},set:function(T){T!==this._gridEnabled&&(this._gridEnabled=T,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(Y){Y!==this._agEnabled&&(this._agEnabled=Y,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),Bm.prototype.initSubModule=function(){var j=this;return[new wf.Anchor(j),new wf.RotateX(j),new wf.MoveDummy(j),new wf.Rect(j),new wf.Curve(j),new wf.MoveHelper(j)]},Bm.prototype.getSubModule=function(j){var a,h,V,N=this._subModules;for(h=0,V=N.length;V>h;h++)if(a=N[h],a.catalog===j)return a},Bm.prototype.invokeSubModule=function(z,A){for(var b,D,h,t=this,o=t._subModules,H=Array.prototype.slice.call(arguments,2),y=0,d=o.length;d>y;y++)if(b=o[y],D=b[z],D&&(h=D.apply(b,H),h!=_&&A))return b},Bm.prototype.invokeSubModuleInverse=function(v,N){var J=this,V=J._subModules;if(V)for(var y,r,f,i=Array.prototype.slice.call(arguments,2),S=V.length-1;S>=0;S--)if(y=V[S],r=y[v],r&&(f=r.apply(y,i),f!=_&&N))return y},Bm.prototype.setUp=function(){wf.log("setUp");var f=this,J=f.gv,d=J.getView(),x=f._canvas;Bm.superClass.setUp.call(f),J.setEditInteractor(f),J._79O?d.insertBefore(x,J._79O):d.appendChild(x),wf.startEdit(J),f.invokeSubModule("setUp"),J.dm().mm(f._onDataModelChanged,f),J.dm().md(f._onDataPropertyChanged,f)},Bm.prototype.tearDown=function(){wf.log("tearDown");var J=this,c=J.gv,q=c.getView();J._resetCustomCursorStyle(),Bm.superClass.tearDown.call(J),c.dm().umm(J._onDataModelChanged,J),c.dm().umd(J._onDataPropertyChanged,J),c.setEditInteractor(null),q.removeChild(J._canvas),J._drawTimer&&(np(J._drawTimer),J._drawTimer=null),wf._46O(c),J.invokeSubModule("tearDown")},Bm.prototype._onDataModelChanged=function(c){var C=this;("clear"===c.kind||"remove"===c.kind&&C.editDetail&&c.data===C.getSubModule("Curve").target)&&(C.editDetail=!1,C._42())},Bm.prototype._onDataPropertyChanged=function(l){var d=this;if(d.editDetail){var N=d.getSubModule("Curve"),_=l.data;_===N.target&&(_._writing||N._handleDataChanged(l))}},Bm.prototype.clear=function(){wf.log("clear")},Bm.prototype.redraw=function(){this._42()},Bm.prototype._42=function(){var S=this;S._drawTimer||(S._drawTimer=Nq(function(){S._drawTimer=null,S.drawImpl()},0))},Bm.prototype.drawImpl=function(){var t;for(t in{_42:!0})break;return function(){var N=this,d=N._canvas,J=N.gv,G=J.getWidth(),M=J.getHeight(),U=N._context,j=A.Default.getInternal(),Q=z.devicePixelRatio;(d.width!==G||d.height!==M)&&j.setCanvas(d,G,M,Q),U.clearRect(0,0,d.width,d.height);var r=N._getValidSelection();U.save(),U.scale(Q,Q),N._gridGuide._42(),N.invokeSubModuleInverse(t,!1,U,J,r),N._rectGuide._42(),N._hoverGuide._42(),U.restore()}}(),Bm.prototype._getValidSelection=function(){var s=this,L=s.gv,S=L.sm().getSelection(),V=[];return S.each(function($){L.isVisible($)&&L.isEditable($)&&V.push($)}),V},Bm.prototype.handle_touchmove=function(L){return this.handle_mousemove(L)},Bm.prototype.handle_mousemove=function(z){if(!A.Default.isDragging()){var o=this;if((o.editDetail||!Ui()&&!fh(z))&&!o.gv._externalEditing){if(o.gvEditing=!1,o._checkEdit(z))o.gvEditing=!0;else{if(!o.getStyle("hoverGuideVisible"))return;o.hoverData=o.gv.getDataAt(z)}o._42()}}},Bm.prototype.handle_touchstart=function(S){return this.handle_mousedown(S)},Bm.prototype.handle_mousedown=function(t){um(t);var q=this;if((q.editDetail||!Ui()&&!fh(t))&&!q.gv._externalEditing){if(we(t)&&!t.clickThrough){if(q.editDetail){if(q._tryQuitEditDetailMode(t))return}else if(q._tryEnterEditDetailMode())return;q.gv.dm().beginTransaction();var m=q.invokeSubModule("handleDoubleClick",!0,t);if(q.gv.dm().endTransaction(),m)return}var a=q._checkEdit(t);a&&(q._downPosition=q._getLogicalPoint(t),q.gv.dm().beginTransaction(),a.startEdit(q,t),q.editing=!0)}},Bm.prototype._checkEdit=function(E){var h=this,w=h.gv,y=h._getLogicalPoint(E),z=h.invokeSubModule("check",!0,w,E,y)||null;return h._editMod=z,z},Bm.prototype.handleWindowTouchMove=function(I){return this.handleWindowMouseMove(I)},Bm.prototype.handleWindowMouseMove=function(P){var p=this,N=p._downPosition;if(N){var C=p._getLogicalPoint(P);if(C.distanceTo(N)<p.getStyle("moveSensitivity"))return;delete p._downPosition}var V=p._editMod;V&&V.handleEdit(p.gv,P),p.redraw()},Bm.prototype._getLogicalPoint=function(r){var Y=this,F=A.Default.getLogicalPoint(r,Y._canvas);return new wf.Math.Vector2(F)},Bm.prototype.handleWindowTouchEnd=function(E){return this.handleWindowMouseUp(E)},Bm.prototype.handleWindowMouseUp=function(){var N;for(N in{_46O:!0})break;return function(z){var r=this;r.editing=!1,r.setCursor("default"),r.invokeSubModule(N,!1,z),r._42(),r.gv.dm().endTransaction()}}(),Bm.prototype.handle_mousewheel=function(I){var T=this;um(I),T.invokeSubModule("preHandleScroll",!0)||T.gv.handleScroll(I,I.wheelDelta)},Bm.prototype.handleDelete=function(){var R=this;if(!R.editDetail){R.gv.dm().beginTransaction();var i=R.invokeSubModule("handleNormalStateDelete",!0);return R.gv.dm().endTransaction(),i||R.gv.removeSelection(),void 0}R.gv.dm().beginTransaction(),R.invokeSubModule("handleDelete",!0),R.gv.dm().endTransaction(),R._42()},Bm.prototype.handle_keydown=function(J){var Q=this;if((J.metaKey||J.ctrlKey)&&Q._42(),Ui(J)&&!Q.editing)return Q.gvEditing=!1,Q.setCursor("default"),Q._42(),void 0;var X=dc(J);return Q.editDetail?((X||Li(J))&&(Q.editDetail=!1,Q._42()),Q.gv.dm().beginTransaction(),Q.invokeSubModule("handle_keydown",!0,J),Q.gv.dm().endTransaction(),void 0):(Q.gv.dm().beginTransaction(),Q.invokeSubModule("handleNormalStateKeyDown",!0,J),Q.gv.dm().endTransaction(),X&&Q._tryEnterEditDetailMode(),void 0)},Bm.prototype.handle_keyup=function(F){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,F),this.gv.dm().endTransaction()},Bm.prototype._tryEnterEditDetailMode=function(){var S=this;return!S.editDetail&&S.invokeSubModule("canEnterEditDetailMode",!0)&&1===S._getValidSelection().length?(S.editDetail=!0,S._42(),!0):void 0},Bm.prototype._tryQuitEditDetailMode=function(j){var o=this;return o.editDetail?!j||o.invokeSubModule("canQuitEditDetailMode",!0,j)?(o.editDetail=!1,o._42(),!0):!1:!1},Bm.prototype.setStyle=function(f,j,l){var t=this;l?wf.setStyle(f,j):t._styleMap[f]=j,"baseColor"===f&&(jj=j),t.fp("styleChanged",null,{key:f,value:j,base:l}),t._42()},Bm.prototype.getStyle=function(W){var c=this,p=c._styleMap[W];return p!==_?p:wf.getStyle(W)},Bm.prototype.setCursor=function(p){this._resetCustomCursorStyle(),A.graph.EditInteractor.superClass.setCursor.call(this,p)},Bm.prototype._drawHostGuide=function(U){var z=this,N=z._context,l=z.gv;wf.Icons.DrawIcon(z,N,wf.Icons.NodeHoverGuide,U.corners);var K=U.host;if(K){var F=l.getAttachPoints(K);if(F&&F.length)for(var I=0,C=F.length;C>I;I++){var e=F[I],Q=rk(l,K,0,e.offsetX||0,e.offsetY||0,e.x,e.y);Q=wf.toScreenPosition(l,Q),Q.isAttach=U.attach===I,wf.Icons.DrawIcon(z,N,wf.Icons.AttachPoint,Q)}}},Bm.prototype._resetCustomCursorStyle=function(){var D=this;if(D._customStyle){var B=this.gv.getView();B.classList&&B.classList.remove&&B.classList.remove(D._customStyle),D._customStyle=null}},Bm.prototype._setRotateCursor=function(c){var T=this,d=T._cursorFactory;d||(d=T._cursorFactory=new wf.CursorFactory(T));var U=d.getRotateCursor(c),G=T.gv.getView();T._resetCustomCursorStyle(),T._customStyle=U,G.classList&&G.classList.add&&G.classList.add(U)};var hk=wf.Group=function(h){var m=this;m._entities=h,m._64O=0,m._position={x:0,y:0},m._scale={x:1,y:1},m._anchor={x:.5,y:.5},m._anchor2={x:.5,y:.5}};hk.prototype={},hk.prototype.constructor=hk;var Pl=null,Hf=null;hk.findOrCreateGroup=function(Q,A){if(Hf===A&&Pl&&Pl.checkIsMe(Q))return Pl;Hf=A;var q=new wf.Group(Q);return q.getKeyOb()?(Pl=q,q):void 0},hk.prototype.checkIsMe=function(b){var r=this._entities;if(r.length!==b.length)return!1;var _,$={},m=b.length;for(_=0;m>_;_++)$[b[_]._id]=!0;for(_=0;m>_;_++)if(!$[r[_]._id])return!1;return!0},hk.prototype.getRotation=function(){return this._64O},hk.prototype.getPosition=function(){return this._position},hk.prototype.getAnchor=function(){return this._anchor},hk.prototype.getWidth=function(){return this._width},hk.prototype.getScale=function(){return this._scale},hk.prototype.getSize=function(){return{width:this._width,height:this._height}},hk.prototype.getHeight=function(){return this._height},hk.prototype.getKeyOb=function(){for(var Z=this._entities,s=Z.length-1;s>=0;s--){var d=Z[s];if(this.isNode(d))return d}},hk.prototype.getAnchor2=function(){var T=this,F=T.rotateCenter;if(F)return F;var N=T.getKeyOb();if(!N)return T._anchor;var x=T._anchor2,c=N.getMatrix();return c.tf({x:N.getWidth()*(x.x-N.getAnchor().x),y:N.getHeight()*(x.y-N.getAnchor().y)})},hk.prototype.setAnchor2=function(z,W){var K=this,o=K.getKeyOb();if(o){var $,A=o.getMatrix();$="number"==typeof z?{x:z,y:W}:z;var e=A.tfi($);K._anchor2={x:o.getAnchor().x+e.x/o.getWidth(),y:o.getAnchor().y+e.y/o.getHeight()}}},hk.prototype.setRotation=function(){},hk.prototype.beginRotate=function(Q){this.rotateCenter=Q.pos,this.rotateMode=Q.groupRotateMode},hk.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},hk.prototype.addRotation=function(Z,X,Q){return"batch"===X?this._addRotationInBatchMode(Z,Q):"block"===X?this._addRotationInBlockMode(Z,Q):void 0},hk.prototype._addRotationInBlockMode=function(V,M){var T=this,m=T.rotateCenter||T.getPosition();T._entities.forEach(function(h){if(T.isNode(h)&&(!M||M(h))){var j=h.getMatrix();j.translate(-m.x,-m.y),j.rotate(V),j.translate(m.x,m.y);var p=Math.sign(h.getScale().x);h.setRotation(id(j.b*p,j.a*p)),h.setPosition(j.tx,j.ty)}})},hk.prototype._addRotationInBatchMode=function(d,A){var C=this,L=C._anchor2;C._entities.forEach(function(M){if(C.isNode(M)&&(!A||A(M))){var G=M.getAnchor(),j=M.getMatrix(),N=j.tf({x:M.getWidth()*(L.x-G.x),y:M.getHeight()*(L.y-G.y)}),V=new wf.Math.Matrix2d;V.set(j.a,j.b,j.c,j.d,j.tx,j.ty),V.translate(-N.x,-N.y),V.rotate(d),V.translate(N.x,N.y);var x=Math.sign(M.getScale().x);M.setRotation(id(V.b*x,V.a*x)),M.setPosition(V.tx,V.ty)}})},hk.prototype.setPosition=function(x){var p,Z,_,l,m=this,n=m._position,f=x.x-n.x,G=x.y-n.y,e=m._entities;for(Z=0,_=e.length;_>Z;Z++)p=e[Z],Fg(p)&&(l=p.getPosition(),p.setPosition(l.x+f,l.y+G));m._position=x},hk.prototype.setScale=function(y,V){var r=this,P=y/r._scale.x,c=V/r._scale.y;r._adjustChildScaleOrSize(P,c,"size"),r._scale={x:y,y:V}},hk.prototype.getRect=function(){var L=this,G=L._position,j=L._width,M=L._height;return{x:G.x-j/2,y:G.y-M/2,width:j,height:M}},hk.prototype.setSize=function(H,S){var m=this,H=Math.max(1,H),S=Math.max(1,S),F=H/m._width,i=S/m._height;m._adjustChildScaleOrSize(F,i,"size"),m._width=H,m._height=S},hk.prototype._adjustChildScaleOrSize=function(Q,j,x){var t,N,m,Y,_,g,i,T,H,$,h,B,C,M,o=this,D=o._position,X=o._entities,W=new wf.Math.Matrix2d;for(N=0,m=X.length;m>N;N++)if(t=X[N],o.isNode(t)){if(Y=t.getPosition(),_=t.getRotation(),g=t.getWidth(),i=t.getHeight(),T=t.getScale(),h=T.x*g,B=T.y*i,W.identity().scale(h,B).rotate(_).translate(Y.x,Y.y).translate(-D.x,-D.y).rotate(-o._64O),_=id(W.b*Math.sign(h),W.a*Math.sign(h)),W.scale(Q,j),H=Math.cos(_),$=Math.sin(_),Math.abs(H)<.001?(C=W.b/$,M=-W.c/$):(C=W.a/H,M=W.d/H),"scale"===x)t.setScale(C/g,M/i);else if("size"===x){var K=C/T.x,c=M/T.y;t.setScale(Oh(C)*Math.abs(T.x),Oh(M)*Math.abs(T.y)),t.setSize(Math.max(.1,Math.abs(K)),Math.max(.1,Math.abs(c)))}W.rotate(o._64O).translate(D.x,D.y),t.setPosition(W.tx,W.ty)}},hk.prototype.getMatrix=function(){var f=this,d=f._position,w=A.Default.getInternal(),Y=f._scale;return new w.Mat(f._64O,d.x,d.y,Y.x,Y.y)},hk.prototype.toGlobal=function(K){return this.getMatrix().tf(K)},hk.prototype.getCorners=function(){var z=this,I=z._width,n=z._height,K=z._anchor,e=-I*K.x,g=-n*K.y,a=z.getMatrix();return[a.tf(e,g),a.tf(e,g+n),a.tf(e+I,g+n),a.tf(e+I,g)]},hk.prototype.calcInfo=function(){var i,G,Y,p,j,Q,Z=this,w=[],E=Z._entities,e=Z._64O;for(p=0,j=E.length;j>p;p++)Q=E[p],Z.isNode(Q)&&Q.getCorners&&w.push.apply(w,Q.getCorners());if(w.length){var R=Math.cos(-e),K=Math.sin(-e),S=1/0,f=-1/0,M=1/0,c=-1/0;for(p=0,j=w.length;j>p;p++)Y=w[p],i=Y.x,G=Y.y,Y.x=R*i-K*G,Y.y=K*i+R*G,S=Math.min(S,Y.x),f=Math.max(f,Y.x),M=Math.min(M,Y.y),c=Math.max(c,Y.y);Z._width=(f-S)/Z._scale.x,Z._height=(c-M)/Z._scale.y,R=Math.cos(e),K=Math.sin(e);var d=Z._anchor;i=S+(f-S)*d.x,G=M+(c-M)*d.y,Z._position={x:R*i-K*G,y:K*i+R*G}}},hk.prototype.isNode=function(x){return Fg(x)?os(x)?x.size()?!1:!0:!0:!1},hk.prototype._42=function(l,z,h){var p,c,O,H,G,f,J,b,m=this,e=m._entities,E=m.rotateMode;for("batch"===E&&(b=m.getKeyOb()),p=0,c=e.length;c>p;p++)O=e[p],m.isNode(O)&&(f=O.getRect(),H=wf.toScreenPosition(h,{x:f.x,y:f.y}),G=wf.toScreenPosition(h,{x:f.x+f.width,y:f.y+f.height}),J={min:H,max:G},O===b&&(J.isKeyOb=!0),wf.Icons.DrawIcon(l,z,wf.Icons.GroupSubEntityRect,J))};var Mk=wf.CurveActiving=function(X,_){this._curve=X,this._interactor=X._interactor,this.silent=!0;for(var x in _)this[x]=_[x];delete this.silent};Mk.prototype={},Mk.prototype.constructor=Mk,j.defineProperties(Mk.prototype,{point:{get:function(){return this._point},set:function(T){var d=this;d._point=T,d.editingCtrl||d.silent||d._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(u){var Q=this;Q._pairs=u,Q.editingCtrl&&!Q.silent&&Q._firePointChange()}}}),Mk.prototype._firePointChange=function(){var N=this,B=N.getCurrentEditingPoint(),Y=N._interactor;if(!B)return Y.fi({kind:"selectPoint"}),void 0;var P=this._curve.target;if(P){var X=wf.getDataMatrix(P).invert(),b=B.e;B=X.apply(wf.toWorldPosition(Y.gv,B)),B.e=b;var u=N._lastFirePoint;u&&Math.abs(B.x-u.x)<1e-5&&Math.abs(B.y-u.y)<1e-5&&(B.e==_&&u.e==_||Math.abs(B.e-u.e)<1e-5)||(N._lastFirePoint=B,Y.fi({kind:"selectPoint",x:B.x,y:B.y,e:B.e}))}},Mk.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Mk.prototype.getCurrentEditingPoint=function(){var J=this,E=J.editingCtrl;if(E){var L=J.pairs;if(L){var N=L[E.pairId];if(N){var M=N[E.type];if(M)return M}}}return J._point};var bh=wf.CursorFactory=function(Q){var X=this;X._interactor=Q,X._rotateCursorStyles={}};bh.prototype={},bh.prototype.constructor=bh,bh.prototype.getRotateCursor=function(B){var e=this;0>B&&(B+=2*Math.PI);var m=e._interactor,Q=m.getStyle("rotateCursorSize"),I=m.getStyle("rotateCursorRound"),_=Math.round(180*(B/Math.PI)/I);_*I>=360&&(_=0);var r=e._rotateCursorStyles,L="htCustomRotateStyle_"+Q+"_"+I+"_"+_;return r[L]||(e._produceRotateCursor(L,Q,I,_),r[L]=!0),L},bh.prototype._produceRotateCursor=function(A,w,_,N){var X=this;X._interactor;var u=X._canvas;u||(u=X._canvas=K.createElement("canvas"));var j=z.devicePixelRatio;u.width=u.height=w*j,u.style.width=u.style.height=w+" px";var Y=u.getContext("2d");wf.setAntialias(Y,!1),Y.scale(j,j);var C,V,Q,s,k,l=Math.round(w/2),t=""+l+" "+l+",auto !important;",m=4;C=Math.PI/180*N*_,Y.clearRect(0,0,w,w),Y.save(),Y.scale(w/32,w/32),Y.translate(16,15),Y.rotate(C+Math.PI/2),Y.beginPath(),Y.moveTo(-8,0),Y.lineTo(-8,m),Y.lineTo(-8+m,m),Y.moveTo(8,0),Y.lineTo(8,m),Y.lineTo(8-m,m),Y.moveTo(-8,m),Y.quadraticCurveTo(0,-6,8,m),Y.restore(),Y.lineCap="round",Y.lineJoin="miter",Y.strokeStyle="white",Y.lineWidth=4,Y.stroke(),Y.strokeStyle="black",Y.lineWidth=2,Y.stroke(),V=JSON.stringify(u.toDataURL()),s="cursor:url("+V+")"+t,1!==j&&(Q='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+w+'px" height="'+w+'px"><image xlink:href='+V+' width="'+w+'" height="'+w+'"/></svg>',s+="cursor:url(data:image/svg+xml;base64,"+btoa(Q)+")"+t,s+="cursor:-webkit-image-set(url("+V+")"+j+"x,url("+V+")1x)"+t),k=K.createElement("style"),k.textContent="body."+A+" *, ."+A+"{"+s+"}",K.head.appendChild(k)
};var bl=wf.Guide.Grid=function(t){var Q=this;Q._interactor=t,Q._alignmentGuideId=0,Q._xAlignmentGuide=[],Q._yAlignmentGuide=[]};bl.prototype={},bl.prototype.constructor=bl,j.defineProperties(bl.prototype,{gridBlockSize:{get:function(){var j=this;return j._gridBlockSize||j._interactor.getStyle("gridBlockSize")},set:function(g){this._gridBlockSize=g,this._interactor._42()}},gridThickLinesEvery:{get:function(){var F=this;return F._gridThickLinesEvery||F._interactor.getStyle("gridThickLinesEvery")},set:function(p){this._gridThickLinesEvery=p,this._interactor._42()}},gridEnabled:{get:function(){var i=this,Z=i._interactor;return Z.gridEnabled&&i.isValidGrid()}}}),bl.prototype._42=function(){var y=this,A=y._interactor;y.gridEnabled&&y.drawGrid(),A.alignmentGuideEnabled&&y.drawAlignmentGuide()},bl.prototype.makeMatrix=function(){var Q=this,b=Q._interactor.getStyle("gridAngle"),x=Q._interactor.getStyle("gridRotation"),S=new wf.Math.Matrix2d,B=Math.sin(b),o=Math.cos(b);return S.set(1,0,o,B,0,0),S.rotate(x),S},bl.prototype.isValidGrid=function(){var S=this,L=Math.PI,V=S._interactor,I=V.gv;if(I._zoom<V.getStyle("gridZoomThreshold"))return!1;var Y=V.getStyle("gridAngle"),g=Math.abs(180*(Y%L/L)),x=1-1e-8;return x>g||g>180-x?!1:!0},bl.prototype.drawAlignmentGuide=function(){var I=this,T=I._interactor,U=T.gv,c=T._canvas,u=T._context,P=c.width,C=c.height,L=U.tx(),w=U.ty(),R=U._zoom;u.beginPath(),u.strokeStyle=T.getStyle("gridAlignmentGuideColor"),u.lineWidth=1,I._xAlignmentGuide.forEach(function(r){var b=r.p*R+L;u.moveTo(b,0),u.lineTo(b,C)}),I._yAlignmentGuide.forEach(function(k){var y=k.p*R+w;u.moveTo(0,y),u.lineTo(P,y)}),u.stroke()},bl.prototype.drawGrid=function(){function L(o,l,I,s){var A=wf.toScreenPosition(P,H.apply({x:o,y:l})),R=wf.toScreenPosition(P,H.apply({x:I,y:s}));e.moveTo(A.x,A.y),e.lineTo(R.x,R.y)}var B=this,p=B._interactor,j=B.gridBlockSize,S=B.gridThickLinesEvery,C=p.getStyle("gridThickColor"),i=p.getStyle("gridLightColor"),P=p.gv,N=p._canvas,e=p._context,d=N.width,A=N.height,H=B.makeMatrix(),b=H.applyInverse(wf.toWorldPosition(P,{x:0,y:0})),Y=H.applyInverse(wf.toWorldPosition(P,{x:d,y:0})),l=H.applyInverse(wf.toWorldPosition(P,{x:0,y:A})),G=H.applyInverse(wf.toWorldPosition(P,{x:d,y:A})),J=Math.min(b.x,Y.x,l.x,G.x),Z=Math.max(b.x,Y.x,l.x,G.x),f=Math.min(b.y,Y.y,l.y,G.y),W=Math.max(b.y,Y.y,l.y,G.y);d=Z-J,A=W-f;var X=Math.ceil(J/j),$=Math.floor(Z/j),c=Math.ceil(f/j),E=Math.floor(W/j);P.tx(),P.ty(),P._zoom;var V,z,O;for(e.save(),e.lineWidth=1,e.beginPath(),e.strokeStyle=C,O=Math.ceil(X/S)*S;$>=O;O+=S)V=O*j,L(V,f,V,W);for(O=Math.ceil(c/S)*S;E>=O;O+=S)z=O*j,L(J,z,Z,z);for(e.stroke(),e.beginPath(),e.strokeStyle=i,O=X;$>=O;O++)0!==O%S&&(V=O*j,L(V,f,V,W));for(O=c;E>=O;O++)0!==O%S&&(z=O*j,L(J,z,Z,z));e.stroke(),e.restore()},bl.prototype.getAlignmentGuides=function(){var V=this;return{x:V._xAlignmentGuide,y:V._yAlignmentGuide}},bl.prototype.addAlignmentGuide=function(P,F,T){var d=this,l="x"===P?d._xAlignmentGuide:d._yAlignmentGuide,T=T?T:++d._alignmentGuideId,Q={p:F,id:T};if(l.length){var N=d._findClosestAlignmentGuide(Q.p,l);N.dis<0?l.splice(N.index+1,0,Q):l.splice(N.index,0,Q)}else l.push(Q);return d._interactor._42(),T},bl.prototype.findClosest=function(O,Z,E){var p=this,u=p._interactor,q=u.gv;E&&(O=wf.toWorldPosition(q,O));var F,w,h,b=1/0,W=1/0,e=O.x,g=O.y;if(p.gridEnabled){var A=p.gridBlockSize,M=p.makeMatrix(),s=M.applyInverse(O);s=M.apply({x:Math.round(s.x/A)*A,y:Math.round(s.y/A)*A}),b=s.x-e,W=s.y-g,h=!0}if(u.alignmentGuideEnabled&&(F=p._findClosestAlignmentGuide(e,p._xAlignmentGuide).dis,w=p._findClosestAlignmentGuide(g,p._yAlignmentGuide).dis,Math.abs(F)<Math.abs(b)&&(b=F,h=!0),Math.abs(w)<Math.abs(W)&&(W=w,h=!0)),h){h=!1;var j=q._zoom,l=u.getStyle("smartGuideThreshold")/j,I={};if(Math.abs(b)<l&&"y"!==Z&&(I.x=E?b*j:b,h=!0),Math.abs(W)<l&&"x"!==Z&&(I.y=E?W*j:W,h=!0),h)return I}},bl.prototype._findClosestAlignmentGuide=function(Q,U){if(!U.length)return{dis:1/0};for(var W,z=0,T=U.length-1;T-z>1;)W=Math.floor((z+T)/2),U[W].p<Q?z=W:T=W;var A=U[z].p-Q,$=U[T].p-Q;return Math.abs(A)<=Math.abs($)?{line:U[z],dis:A,index:z}:{line:U[T],dis:$,index:T}},bl.prototype.removeAllAlignmentGuide=function(p){var B=this;"y"!==p&&(B._xAlignmentGuide=[]),"x"!==p&&(B._yAlignmentGuide=[]),B._interactor._42()},bl.prototype.removeAlignmentGuide=function(k){for(var W,g,M,Y=this,x=Y._xAlignmentGuide,U=0;2>U;U++)for(x=0===U?Y._xAlignmentGuide:Y._yAlignmentGuide,W=0,g=x.length;g>W;W++)if(M=x[W],M.id===k)return x.splice(W,1),Y._interactor._42(),{axis:0===U?"x":"y",position:M.p};return!1},bl.prototype.adjustAlignmentGuide=function(y,U){var X=this,v=X.removeAlignmentGuide(y);return v?(X.addAlignmentGuide(v.axis,U,y),!0):!1};var ge=wf.Guide.Rect=function(D){var $=this;$._interactor=D};ge.prototype={},ge.prototype.constructor=ge,ge.prototype.gatherRects=function(){var z,l,u,B,v=this,V=v._interactor.gv,O=[],d=[],a={x:O,y:d},$={},J=V.getDataModel(),X=J.a("width"),S=J.a("height");X&&S&&(z=0,l=0,u=X,B=S,O.push({node:J,type:0,p:z},{node:J,type:1,p:z+u/2},{node:J,type:2,p:z+u}),d.push({node:J,type:0,p:l},{node:J,type:1,p:l+B/2},{node:J,type:2,p:l+B}),$[J._id||0]={x:z,y:l,width:u,height:B}),J.each(function(G){if(Fg(G)&&!V.isSelected(G)&&V.isVisible(G)&&V.isValidGuideLineSource(G)){var t=!1;if(V.sm().getSelection().each(function(y){t||(G.isHostOn(y)?t=!0:G.isDescendantOf(y)&&(t=!0))}),!t){var Y=G.getRect();z=Y.x,l=Y.y,u=Y.width,B=Y.height,O.push({node:G,type:0,p:z},{node:G,type:1,p:z+u/2},{node:G,type:2,p:z+u}),d.push({node:G,type:0,p:l},{node:G,type:1,p:l+B/2},{node:G,type:2,p:l+B}),$[G._id]=Y}}}),O.sort(function(S,y){return S.p-y.p}),d.sort(function(I,K){return I.p-K.p}),v._grid=a,v._87I=$},ge.prototype.gatherLines=function(e,D,b){var K,y,W,U,c,$,u,q,E,h,k,N,Y=this,x=[Y.findClosest({x:e.x,y:e.y},D),Y.findClosest({x:e.x+e.w/2,y:e.y+e.h/2},D),Y.findClosest({x:e.x+e.w,y:e.y+e.h},D)],Q={},B=Y._87I;b=b||255;var j,T;for(Y._guideLine=[],K=0;2>K;K++)for(Q={},0===K?(U="y",q=e.x,E=q+e.w):(U="x",q=e.y,E=q+e.h),y=0;3>y;y++)c=x[y],c&&isFinite(c[U])&&(j=1<<3*K+y,b&j&&($=c[U+"Line"],u=$.node,T=u._id||0,Q[T]||(Q[T]=!0,N=B[T],"y"===U?(h=N.x,k=N.x+N.width):(h=N.y,k=N.y+N.height),W=$.p,Y._guideLine.push({type:U,a:q,b:E,c:h,d:k,p:W,center:1===$.type}))))},ge.prototype._binarySearchClosest=function(p,I){if(!I.length)return{dis:1/0};for(var h,j=0,O=I.length-1;O-j>1;)h=Math.floor((j+O)/2),I[h].p<p?j=h:O=h;var l=I[j].p-p,f=I[O].p-p;return Math.abs(l)<=Math.abs(f)?{line:I[j],dis:l}:{line:I[O],dis:f}},ge.prototype.findClosest=function(z,c,r){var R=this,u=R._interactor,Z=u.gv,o=R._grid;r&&(z=wf.toWorldPosition(Z,z));var E,q=R._binarySearchClosest(z.x,o.x),W=R._binarySearchClosest(z.y,o.y),D=q.dis,K=W.dis,e=Z._zoom,x=u.getStyle("smartGuideThreshold")/e,V={};return Math.abs(D)<x&&"y"!==c&&(V.x=r?D*e:D,V.xLine=q.line,E=!0),Math.abs(K)<x&&"x"!==c&&(V.y=r?K*e:K,V.yLine=W.line,E=!0),E?V:void 0},ge.prototype._42=function(){var n=this,G=n._guideLine;if(G&&!A.Default.isCtrlDown()){var $=n._interactor;if($.getStyle("guideLineVisible")){var v,i,s,O,m,Z,X,C,c,d,j,D,L,f,e,u,W,g=$.gv,M=$._context,b=g.tx(),y=g.ty(),x=g._zoom,P=$.getStyle("guideLineTextSpacing");for(v=0,i=G.length;i>v;v++)s=G[v],C=s.type,c=s.p,d=s.a,j=s.b,D=s.c,L=s.d,f=Math.min(d,D),e=Math.max(j,L),"x"===C?(O=c*x+b,m=f*x+y,Z=O,X=e*x+y):(O=f*x+b,m=c*x+y,Z=e*x+b,X=m),wf.Icons.DrawIcon($,M,wf.Icons.MoveLineGuide,{rect:[O,m,Z,X],center:s.center}),L>=d&&j>=D||(f=d>L?L:j,e=d>L?d:D,W=e-f,"x"===C?(s.center2center||(O-=P,Z=O),m=f*x+y,X=e*x+y,u=wf.Icons.MoveLineGuideDistanceV):"y"===C&&(s.center2center||(m-=P,X=m),O=f*x+b,Z=e*x+b,u=wf.Icons.MoveLineGuideDistanceH),wf.Icons.DrawIcon($,M,u,{x0:O,y0:m,x1:Z,y1:X,dis:W}))}}},ge.prototype.clear=function(){this._guideLine=null};var pi=wf.Guide.Hover=function(r){var u=this;u._interactor=r};pi.prototype={},pi.prototype.constructor=pi,j.defineProperties(pi.prototype,{}),pi.prototype._42=function(){var n=this._interactor;if(n.getStyle("hoverGuideVisible")&&!n.gvEditing){var L=n.hoverData,d=n.gv;if(!Fg(L)||d.isSelected(L))return n.hoverData=null,void 0;var i=Sc(d,L),D=wf.toScreenPosition(d,{x:i.x,y:i.y}),z=wf.toScreenPosition(d,{x:i.x+i.width,y:i.y+i.height});wf.Icons.DrawIcon(n,n._context,wf.Icons.HoverDataRect,{min:D,max:z,color:n.getStyle("hoverGuideColor")||n.getStyle("baseColor"),borderWidth:n.getStyle("hoverGuideBorderWidth")||1,borderPattern:n.getStyle("hoverGuideBorderPattern")||[1,4]})}},wf.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,rotateTipVisible:!0,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Gb=wf.Icons={},Ke=1e4,io=null,jj=wf.DefaultStyleMap.baseColor,oj="rgb(183,232,135)",kp="rgb(255,204,153)",tc=6;A.Default.setImage("Icons.RectPoint",{width:tc,height:tc,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return jj}},rect:[0,0,tc,tc]}]}),Gb.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var A=Gb.GroupSubEntityRect.data;if(!A)return[];var c=A.min,N=A.max;return[c.x,c.y,c.x,N.y,N.x,N.y,N.x,c.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Gb.GroupSubEntityRect.data.isKeyOb?jj:jj}}}]};var Lc=4;Gb.HoverDataRect={comps:[{type:"shape",points:{func:function(){var i=Gb.HoverDataRect.data;if(!i)return[];var r=i.min,c=i.max,M=Lc;return r.x-=M,r.y-=M,c.x+=M,c.y+=M,[r.x,r.y,r.x,c.y,c.x,c.y,c.x,r.y]}},segments:[1,2,2,2,5],background:null,borderWidth:{func:function(){return Gb.HoverDataRect.data.borderWidth}},borderColor:{func:function(){return Gb.HoverDataRect.data.color}},borderCap:"butt",borderPattern:{func:function(){return Gb.HoverDataRect.data.borderPattern}}}]},Gb.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Gb.Line.data.P1.x,Gb.Line.data.P1.y],tc,tc]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Gb.Line.data.P2.x,Gb.Line.data.P2.y],tc,tc]}}}]},Gb.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Gb.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Gb.Rect={comps:[{type:"shape",points:{func:function(){var G=Gb.Rect.data;if(!G)return[];var S=G.LT,o=G.LB,k=G.RB,t=G.RT;return[S.x,S.y,o.x,o.y,k.x,k.y,t.x,t.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return jj}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Gb.Rect.data.rotation}},rect:{func:function(){return[[Gb.Rect.data.LT.x,Gb.Rect.data.LT.y],tc,tc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Gb.Rect.data.rotation}},rect:{func:function(){return[[Gb.Rect.data.LB.x,Gb.Rect.data.LB.y],tc,tc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Gb.Rect.data.rotation}},rect:{func:function(){return[[Gb.Rect.data.RB.x,Gb.Rect.data.RB.y],tc,tc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Gb.Rect.data.rotation}},rect:{func:function(){return[[Gb.Rect.data.RT.x,Gb.Rect.data.RT.y],tc,tc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Gb.Rect.data.rotation}},visible:{func:function(){return Gb.Rect.data.L?!0:!1}},rect:{func:function(){return[[Gb.Rect.data.L.x,Gb.Rect.data.L.y],tc,tc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Gb.Rect.data.rotation}},visible:{func:function(){return Gb.Rect.data.R?!0:!1}},rect:{func:function(){return[[Gb.Rect.data.R.x,Gb.Rect.data.R.y],tc,tc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Gb.Rect.data.rotation}},visible:{func:function(){return Gb.Rect.data.T?!0:!1}},rect:{func:function(){return[[Gb.Rect.data.T.x,Gb.Rect.data.T.y],tc,tc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Gb.Rect.data.rotation}},visible:{func:function(){return Gb.Rect.data.B?!0:!1}},rect:{func:function(){return[[Gb.Rect.data.B.x,Gb.Rect.data.B.y],tc,tc]}}}]};var xc=16;A.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return jj}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return jj}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Gb.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Gb.Anchor.data.POS.x,Gb.Anchor.data.POS.y],xc,xc]}}}]},Gb.TipShiftX=12,Gb.TipShiftY=12;var $o=[8,28];Gb.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Gb.TipHelper.data.helperPos.x,Gb.TipHelper.data.helperPos.y,$o[0]*Gb.TipHelper.data.size,$o[1]]}},background:{func:function(){return io.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Gb.TipHelper.data.text}},rect:{func:function(){return[Gb.TipHelper.data.helperPos.x,Gb.TipHelper.data.helperPos.y,$o[0]*Gb.TipHelper.data.size,$o[1]]}},color:{func:function(){return io.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var Yi=7;Gb.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!Gb.ShapePoint.data.dynamicVisible}},rect:{func:function(){var Y=Gb.ShapePoint.data.point,z=Gb.ShapePoint.data.size||Yi;return[Y,z+10,z+10]}},background:{func:function(){var u=Date.now(),s=Gb.ShapePoint.data.dynamicPeriod||1500,x=Math.sin(u%s/s*Math.PI);return"rgba(27,124,22,"+.5*x+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var u=Gb.ShapePoint.data.point,W=Gb.ShapePoint.data.size||Yi;return[u,W,W]}},background:{func:function(){var r=Gb.ShapePoint.data.isEnd;return r?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return Gb.ShapePoint.data.color||jj}}},{type:"rect",visible:{func:function(){return!!Gb.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return jj}},rect:{func:function(){var i=5;return[Gb.ShapePoint.data.point,i,i]}}}]},Gb.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!Gb.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return Gb.ShapeBgCurve.data.P}},segments:{func:function(){return Gb.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var K=Date.now(),d=Gb.ShapeBgCurve.data.dynamicPeriod||1500,X=Math.sin(K%d/d*Math.PI);return"rgba(27,124,22,"+.3*X+")"}}},{type:"shape",points:{func:function(){return Gb.ShapeBgCurve.data.P}},segments:{func:function(){return Gb.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return Gb.ShapeBgCurve.data.color||jj}}}]};var $j=8;Gb.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var g=Gb.ShapeHighlighPoint.data;return[[g.x,g.y],$j,$j]}},background:{func:function(){return io.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Uq=10;Gb.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var r=Gb.ShapeHighlighRealPoint.data;return[[r.x,r.y],Uq,Uq]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return jj}}}]};var kr=8;Gb.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var w=Gb.ShapeHighlighCtrlPoint.data,o=w.x,$=w.y,i=kr/2;return[o-i,$-i,o-i,$+i,o+i,$+i,o+i,$-i]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return io.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return io.getStyle("shapeCtrlPointBorderColor")||jj}}}]};var Tg=3;Gb.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Gb.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Tg,borderColor:{func:function(){return io.getStyle("curveHighlightColor")}}}]},Gb.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Gb.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Gb.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Gb.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Gb.MoveLineGuide.data.center?oj:kp}}}]};var go=5;Gb.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var I=Gb.MoveLineGuideDistanceH.data,t=I.x0,e=I.y0;return[t,e-go,t,e+go]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:kp},{type:"shape",points:{func:function(){var Y=Gb.MoveLineGuideDistanceH.data,p=Y.x1,s=Y.y1;return[p,s-go,p,s+go]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:kp},{type:"text",text:{func:function(){return Math.round(Gb.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var G=Gb.MoveLineGuideDistanceH.data;return[[(G.x0+G.x1)/2,G.y0-10],20,20]}},color:kp,font:"12px Arial",align:"center"}]},Gb.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var G=Gb.MoveLineGuideDistanceV.data,j=G.x0,h=G.y0;return[j-go,h,j+go,h]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:kp},{type:"shape",points:{func:function(){var j=Gb.MoveLineGuideDistanceV.data,L=j.x1,O=j.y1;return[L-go,O,L+go,O]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:kp},{type:"text",text:{func:function(){return Math.round(Gb.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var x=Gb.MoveLineGuideDistanceV.data;return[[x.x0-10,(x.y0+x.y1)/2],20,20]}},color:kp,font:"12px Arial",align:"center"}]},A.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Gb.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var h=Gb.EdgeElevationGuide.data,A=h.x,o=h.y,j=io.getStyle("curveElevationIntersectSize"),S=io.getStyle("curveElevationGuideShift");return A+=S[0],o+=S[1],[A-j,o-j,2*j,2*j]}}}]},A.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),A.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Gb.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Gb.ConnectGuide.data.rotation}},rect:{func:function(){var C=Gb.ConnectGuide.data.connect;C.x,C.y;var E=io.getStyle("connectGuideIntersectSize");return[[C.x,C.y],2*E,2*E]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var l=Gb.ConnectGuide.data.cursorPos||Gb.ConnectGuide.data.connect,n=io.getStyle("connectGuideIntersectSize");return[[l.x,l.y],2*n-2,2*n-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var E=Gb.ConnectGuide.data.connect,r=Gb.ConnectGuide.data.cursorPos||E;return[E.x,E.y,E.x+.5*(r.x-E.x),E.y,r.x+.5*(E.x-r.x),r.y,r.x,r.y]}}}]},A.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),A.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Gb.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var w=Gb.ConnectGuideGarbage.data.hover;return w?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var j=Gb.ConnectGuideGarbage.data,W=io.getStyle("connectGuideGarbageIntersectsize");return j.hover&&(W+=5),[[j.x,j.y],2*W,2*W]}}}]};var fj=6;Gb.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Gb.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var N=Gb.ShapeActivingCtrl.data;return[N.point.x,N.point.y,N.c1.x,N.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return jj}}},{type:"shape",visible:{func:function(){return Gb.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var Z=Gb.ShapeActivingCtrl.data;return[Z.point.x,Z.point.y,Z.c2.x,Z.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return jj}}},{type:"shape",visible:{func:function(){return Gb.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var t=Gb.ShapeActivingCtrl.data.c1,P=t.x,G=t.y,O=fj/2;return"c1"===Gb.ShapeActivingCtrl.data.hl&&(O+=.5),[P-O,G-O,P-O,G+O,P+O,G+O,P+O,G-O]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return io.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Gb.ShapeActivingCtrl.data.hl?io.getStyle("shapeCtrlPointHighlightBorder")||jj:io.getStyle("shapeCtrlPointBorderColor")||jj}}},{type:"shape",visible:{func:function(){return Gb.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var $=Gb.ShapeActivingCtrl.data.c2,y=$.x,w=$.y,H=fj/2;return"c2"===Gb.ShapeActivingCtrl.data.hl&&(H+=.5),[y-H,w-H,y-H,w+H,y+H,w+H,y+H,w-H]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return io.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Gb.ShapeActivingCtrl.data.hl?io.getStyle("shapeCtrlPointHighlightBorder")||jj:io.getStyle("shapeCtrlPointBorderColor")||jj}}}]},Gb.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return jj}},rect:{func:function(){return[[Gb.RoundPoint.data.x,Gb.RoundPoint.data.y],tc,tc]}}}]},Gb.AttachPoint={comps:[{type:"rect",background:{func:function(){return Gb.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return jj}},rect:{func:function(){var $=Gb.AttachPoint.data.isAttach?tc+4:tc;return[[Gb.AttachPoint.data.x,Gb.AttachPoint.data.y],$,$]}}}]},Gb.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return Gb.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return Gb.SimpleRect.data.color||jj}},rect:{func:function(){var C=Gb.SimpleRect.data;return[C.x,C.y,C.width,C.height]}}}]},A.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),Gb.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var W=Gb.MoveDummy.data;return[[W.pos.x,W.pos.y],2*W.size,2*W.size]}}}]},wf.Icons.DrawIcon=function(F,U,p,i){p.width=p.height=Ke,p.data=i,io=F,A.Default.drawImage(U,p,0,0,Ke,Ke),io=_},wf.Icons.MapPoints=function(u,t){for(var C=0,w=u.length;w>C;C++)u[C]/=t},wf.roundTo=function(R,j,U){var C=Math.abs(R%j);return U>C||U>j-C?j*Math.round(R/j):R},wf.toFixed=function(y){return Math.round(100*y)/100},wf.getDataMatrix=function(Q){if(Q instanceof A.Shape){var m=new A.Math.Matrix2d,J=Q.getPosition();return m.translate(-J.x,-J.y).scale(Q.getScale().x,Q.getScale().y).rotate(Q.getRotation()).translate(J.x,J.y),m}return Q.getMatrix?Q.getMatrix():new A.Math.Matrix2d};var Mn=wf.Math.Curve=function(){this._curves=[]};Mn.prototype={},Mn.prototype.constructor=Mn,Mn.prototype.createFromHtShape=function(Y,x,n){x instanceof A.List&&(x=x.toArray());var k,K,R,l,I,N,T,u=this,b=null,f=null,Q=0,y=wf.Math.Vector2,D=wf.Math.CubicBezier,U=function(q){return new y(Y[q],Y[q+1],n?n[q/2]:_)};for(K=0,R=x.length;R>K;K++){switch(l=x[K],I=null,l){case 1:f=U(Q),b=f,Q+=2;break;case 2:k=U(Q),Q+=2,I=new D(f,f.clone(),k.clone(),k),f=k;break;case 3:N=U(Q),k=U(Q+2),Q+=4,I=new D(f,N.clone().sub(f).multiplyScalar(2/3).add(f),N.clone().sub(k).multiplyScalar(2/3).add(k),k),f=k;break;case 4:N=U(Q),T=U(Q+2),k=U(Q+4),Q+=6,I=new D(f,N,T,k),f=k;break;case 5:if(!b)break;I=new D(f,f.clone(),b.clone(),b),f=null,b=null}I&&(I._index=u._curves.length,u._curves.push(I))}},Mn.prototype.checkPoint=function(c,w){var Z,e,s,K,j,V=this,T=V._curves;for(Z=0,e=T.length;e>Z;Z++)if(K=T[Z],j=K.intersectRect(c,w,w),j.length)return s=0,j.forEach(function(p){s+=p.t}),s/=j.length,c=K.getPointAt(s),c.t=s,{bezier:K,intersection:c}},Mn.prototype.insertKnot=function(p,j){var a=p.insertKnot(j),O=this,X=O._curves;X.splice(p._index,1,a[0],a[1])},Mn.prototype._isCloseEnough=function(o,y){return Math.abs(o.x-y.x)<1e-6&&Math.abs(o.y-y.y)<1e-6},Mn.prototype._isSamePoint=function(J,I){return J===I},Mn.prototype.moveRealPoint=function(M,I){var j=this,t=j._curves,b=I.clone().sub(M);t.forEach(function(s){var f=s._p1;s._p2,s._p3;var P=s._p4;j._isSamePoint(f,M)&&(s._p2.add(b),s._p1=I),j._isSamePoint(P,M)&&(s._p3.add(b),s._p4=I)})},Mn.prototype.moveCtrlDueToRealPointMovement=function(C,S){var w=this,o=w._curves,V=function(_){_.add(S),_.e&&S.e&&(_.e+=S.e)};o.forEach(function(K){var t=K._p1;K._p2,K._p3;var l=K._p4;w._isSamePoint(t,C)&&V(K._p2),w._isSamePoint(l,C)&&V(K._p3)})},Mn.prototype.moveCtrlPoint=function(q,A,M){var w=q[M];if(w){w.e!==_&&(A.e=w.e);var L=this,y=L._curves;A.clone().sub(w),y.forEach(function(V){var l;"c2"===M?l="_p2":"c1"===M&&(l="_p3"),L._isSamePoint(V[l],w)&&(V[l]=A)}),q[M]=A}},Mn.prototype.deleteRealPoint=function(M,b){var X,E,c,z,G,J,$,h=this,V=h._curves,v={},t=[],U=wf.Math.CubicBezier;for(E=0,c=V.length;c>E;E++)X=V[E],z=X._p1,G=X._p2,J=X._p3,$=X._p4,(v[E]||!h._isSamePoint(z,M))&&(h._isSamePoint($,M)?c>E+1&&h._isSamePoint(V[E+1]._p1,M)&&(b||t.push(new U(z,G,V[E+1]._p3,V[E+1]._p4))):t.push(X));h._curves=t},Mn.prototype.findPairs=function(X,j){var m,L,$,H,D,T,v,s,B=this,a=B._curves,S={},l=[];for(L=0,$=a.length;$>L;L++)m=a[L],H=m._p1,D=m._p2,T=m._p3,v=m._p4,!S[L]&&B._isSamePoint(H,X)&&(j?l.push({point:H,r2:v}):l.push({point:H,c2:D})),B._isSamePoint(v,X)&&(s=j?{point:v,r1:H}:{point:v,c1:T},$>L+1&&B._isSamePoint(a[L+1]._p1,X)&&(j?s.r2=a[L+1]._p4:s.c2=a[L+1]._p2,S[L+1]=!0),l.push(s));return l},Mn.prototype.toHtShape=function(){var u=this,t=u._curves,I=[],L=[],g={x:1/0,y:1/0};return t.forEach(function(v){var T=v._p1,n=v._p2,P=v._p3,h=v._p4;return u._isCloseEnough(T,g)||(I.push(1),L.push(T.clone())),g=h,u._isCloseEnough(T,n)&&u._isCloseEnough(P,h)?(I.push(2),L.push(h.clone()),void 0):(I.push(4),L.push(n.clone(),P.clone(),h.clone()),void 0)
}),{segments:I,points:L}};var Ao=wf.Math.CubicBezier=function(i,G,K,p){var u=this;u._id=wf.Math.CubicBezier._globalId++,u._p1=i,u._p2=G,u._p3=K,u._p4=p};Ao._globalId=1,Ao.prototype={},Ao.prototype.constructor=Ao,Ao.prototype.toString=function(){return this._id},Ao.prototype.intersectRect=function(v,Y,V){var n=Y/2,t=V/2,l=v.x,y=v.y,u=wf.Math.Vector2,T=new u(-n+l,-t+y),$=new u(n+l,t+y),w=new u($.x,T.y),p=new u(T.x,$.y),F=this,m=F.intersectLine(T,w),z=F.intersectLine(w,$),s=F.intersectLine($,p),D=F.intersectLine(p,T),o=m.concat(z).concat(s).concat(D);return o},Ao.prototype.intersectLine=function(o,_){var f,E,Q,s,p,l,v,M,z,k,G,Z,q,e=this,Y=o.clone().min(_),P=o.clone().max(_);s=e._p1,p=e._p2,l=e._p3,v=e._p4,f=s.clone().multiplyScalar(-1),E=p.clone().multiplyScalar(3),Q=l.clone().multiplyScalar(-3),G=f.add(E).add(Q).add(v),f=s.clone().multiplyScalar(3),E=p.clone().multiplyScalar(-6),Q=l.clone().multiplyScalar(3),k=f.add(E).add(Q),f=s.clone().multiplyScalar(-3),E=p.clone().multiplyScalar(3),z=f.add(E),M=s.clone(),q=new wf.Math.Vector2(o.y-_.y,_.x-o.x),Z=o.x*_.y-_.x*o.y;for(var t=e.getRoots(q.dot(G),q.dot(k),q.dot(z),q.dot(M)+Z),y=new Array,j=0,m=t.length;m>j;j++){var D=t[j];if(!(0>D||D>1)){var R=e.getPointAt(D);R.t=D,o.x==_.x?Y.y<=R.y&&R.y<=P.y&&y.push(R):o.y==_.y?Y.x<=R.x&&R.x<=P.x&&y.push(R):R.x>=Y.x&&R.y>=Y.y&&R.x<=P.x&&R.y<=P.y&&y.push(R)}}return y},Ao.prototype.solveTForPoint=function(O){var v,$,N,V,I=this;v=I._p1.x-O.x,$=I._p2.x-O.x,N=I._p3.x-O.x,V=I._p4.x-O.x;for(var X=I.getRoots(V-3*N+3*$-v,3*N-6*$+3*v,3*$-3*v,v),g=_,Z=1/0,p=0,n=X.length;n>p;p++){var K=X[p];if(!(0>K||K>1)){var R=I.getPointAt(K);R.t=K;var T=Math.abs(R.y-O.y);Z>T&&(Z=T,g=R)}}return g},Ao.prototype.getPointAt=function(V){var W=this,f=W._p1,_=W._p2,l=W._p3,i=W._p4,u=f.clone().lerp(_,V),L=_.clone().lerp(l,V),b=l.clone().lerp(i,V),P=u.lerp(L,V),Z=L.lerp(b,V);return P.lerp(Z,V)},Ao.prototype.getPointByPercentage=function(N){var P=this.length*N,W=this._cacheLength,L=W.length;if(0===P)return W[0].point;if(N>=1)return W[L-1].point;for(var n=0;L>n;n++){var O=W[n];if(!(O.len<P)){var F=W[n-1];return O.point.clone().sub(F.point).setLength(P-F.len).add(F.point)}}},Ao.prototype.getTByPercentage=function(d){var $=this.length*d,T=this._cacheLength,r=T.length;if(0===$||0>=d)return T[0].t;if(d>=1)return T[r-1].t;for(var P=0;r>P;P++){var Z=T[P];if(!(Z.len<$)){var N=T[P-1];return($-N.len)/(Z.len-N.len)*(Z.t-N.t)+N.t}}},Ao.prototype.getRoots=function(l,$,K,w){var j,q,b,v,B,c=new Array;if(Math.abs(l)<1e-6){var j=$,q=K/j,b=w/j,v=q*q-4*b;if(v>0){var B=Math.sqrt(v);c.push(.5*(-q+B)),c.push(.5*(-q-B))}else 0==v&&c.push(.5*-q)}$/=l,K/=l,w/=l,j=(3*K-$*$)/3,q=(2*$*$*$-9*K*$+27*w)/27;var D=$/3,M=q*q/4+j*j*j/27,Z=q/2;if(Math.abs(M)<=1e-6&&(M=0),M>0){var d,k,B=Math.sqrt(M);d=-Z+B,k=d>=0?Math.pow(d,1/3):-Math.pow(-d,1/3),d=-Z-B,d>=0?k+=Math.pow(d,1/3):k-=Math.pow(-d,1/3),c.push(k-D)}else if(0>M){var f=Math.sqrt(-j/3),E=Math.atan2(Math.sqrt(-M),-Z)/3,A=Math.cos(E),m=Math.sin(E),R=Math.sqrt(3);c.push(2*f*A-D),c.push(-f*(A+R*m)-D),c.push(-f*(A-R*m)-D)}else{var d;d=Z>=0?-Math.pow(Z,1/3):Math.pow(-Z,1/3),c.push(2*d-D),c.push(-d-D)}return c},Ao.prototype._70I=function(){var Z=this;return Z._p1.distanceToSquared(Z._p2)<1e-10&&Z._p3.distanceToSquared(Z._p4)<1e-10},Ao.prototype.insertKnot=function(W){var I=this,D=I._p1,E=I._p2,Y=I._p3,i=I._p4,G=D.clone().lerp(E,W),A=E.clone().lerp(Y,W),L=Y.clone().lerp(i,W),v=G.clone().lerp(A,W),X=A.clone().lerp(L,W),k=v.clone().lerp(X,W);return I._70I()?(D.clone().lerp(i,W),[new wf.Math.CubicBezier(D,D.clone(),k.clone(),k),new wf.Math.CubicBezier(k,k.clone(),i.clone(),i)]):[new wf.Math.CubicBezier(D,G,v,k),new wf.Math.CubicBezier(k,X,L,i)]},j.defineProperties(Ao.prototype,{length:{get:function(){var o=this._cacheLength;if(!o){o=this._cacheLength=[];for(var y=this._p1,k=0,a=0;1>=k;){var T=this.getPointAt(k+=.001);a+=T.clone().sub(y).length(),y=T,o.push({len:a,t:k,point:T.clone()})}}return o[o.length-1].len}},p1:{get:function(){return this._p1},set:function(z){this._p1=z,this._cacheLength=_}},p2:{get:function(){return this._p2},set:function(m){this._p2=m,this._cacheLength=_}},p3:{get:function(){return this._p3},set:function(E){this._p3=E,this._cacheLength=_}},p4:{get:function(){return this._p4},set:function(R){this._p4=R,this._cacheLength=_}}});var Do=A.Default.getInternal().ui().EdgeUI,km={_47O:function(z){var k=this,F=km.getBackups()._47O;wf.inEdit(k.gv)||F.call(k,z)}};wf.Inject.registAsModule(km,Do);var Me=A.Default.getInternal().ui().NodeUI,Xf={_47O:function(n){var u=this,I=Xf.getBackups()._47O;wf.inEdit(u.gv)||I.call(u,n)},getSelectWidth:function(){var w=this,l=w.gv,Y=w._data;if(l.isEditable(Y)&&wf.inEdit(l))return 0;var c=Xf.getBackup("getSelectWidth");return c.call(w)}};wf.Inject.registAsModule(Xf,Me);var _g=A.graph.GraphView,Of={_editPointSize:function(){var S=A.Default.isTouchable,w=wf.getStyle("pointSize");return w[S?0:1]}(),isPointEditable:function($){var G=this;if(wf.inEdit(G))return G._pointEditableFunc?G._pointEditableFunc($):!0;var o=Of.getBackup("isPointEditable");o.call(G,$)},isEditable:function(H){var Z,L=this,i=Of.getBackup("isEditable");if(Z=H instanceof wf.Group?!0:i.call(L,H),!wf.inEdit(L))return Z;if(!(H instanceof A.Edge))return Z;if(!H.s("2d.editable"))return!1;var V=L.getEditableFunc();return V?V(H):!0},_42:function(m,U){var y=this,a=Of.getBackups()._42;if(a.call(y,m,U),wf.inEdit(y)){var j=y.getEditInteractor();j.drawImpl()}}};wf.Inject.registAsModule(Of,_g);var Zm=A.Default.getInternal().ui().ShapeUI,rq={_47O:function(J){var e=this,o=rq.getBackups()._47O;wf.inEdit(e.gv)||o.call(e,J)}};wf.Inject.registAsModule(rq,Zm);var $d=A.graph.DefaultInteractor,dh={handle_mousewheel:function(x){var J=this,Y=dh.getBackup("handle_mousewheel");wf.inEdit(J.gv)||Y.call(J,x)}};wf.Inject.registAsModule(dh,$d);var Cs=A.graph.MoveInteractor,Vr={_calcShift:function(O,g){var T=this,w=Vr.getBackup("_calcShift"),C=T.gv;if(!wf.inEdit(C))return w.call(T,O,g);var y=C.getEditInteractor(),x=y.getSubModule("Move").calcShift(O,g,T);return x||w.call(T,O,g)},clear:function(d){var i=this,n=Vr.getBackup("clear");n.call(i,d);var g=i.gv;if(wf.inEdit(g)){var W=g.getEditInteractor();W.getSubModule("Move").clear(d)}}};wf.Inject.registAsModule(Vr,Cs);var ge=wf.Rect=function(Y){this.catalog="Rect",this._interactor=Y};ge.prototype={},ge.prototype.constructor=ge,ge.prototype.gatherInfo=function(i,s){var k=this;if(1===s.length){var N=s[0];return N instanceof A.Shape&&N._70I()?k.gatherLine(i,N):os(N,i)?!1:k.gatherSingleTarget(i,N)}return s.length>1?k.gatherMultiTargets(i,s):!1},ge.prototype.gatherSingleTarget=function(z,U){if(U.getCorners){var e,S=this,N=S.info;S.target=U,e=S.screenInfo={};var u=U.getCorners();N.LT=new wf.Math.Vector2(u[0]),N.LB=new wf.Math.Vector2(u[1]),N.RB=new wf.Math.Vector2(u[2]),N.RT=new wf.Math.Vector2(u[3]),N.T=N.LT.clone().add(N.RT).divideScalar(2),N.B=N.LB.clone().add(N.RB).divideScalar(2),N.L=N.LT.clone().add(N.LB).divideScalar(2),N.R=N.RT.clone().add(N.RB).divideScalar(2);for(var O in N)e[O]=wf.toScreenPosition(z,N[O]);var t=S._interactor,h=t.getStyle("checkSize"),W=function(C,H,S){var E=H.clone().sub(C).setLength(-h),G=S.clone().sub(C).setLength(-h),p=E.add(G).add(C);return p};return e.rotLT=W(e.LT,e.RT,e.LB),e.rotLB=W(e.LB,e.LT,e.RB),e.rotRB=W(e.RB,e.LB,e.RT),e.rotRT=W(e.RT,e.LT,e.RB),e.rotT=e.rotLT.clone().add(e.rotRT).divideScalar(2),e.rotB=e.rotLB.clone().add(e.rotRB).divideScalar(2),e.rotL=e.rotLT.clone().add(e.rotLB).divideScalar(2),e.rotR=e.rotRT.clone().add(e.rotRB).divideScalar(2),e.rotation=U.getRotation(),S.gatherConnectInfo(),!0}},ge.prototype.gatherConnectInfo=function(){var M=this,e=M.target,s=M._interactor,o=M.screenInfo,r=s.gv;if(r.isConnectActionVisible(e)&&s.getStyle("connectGuideVisible")){var X;e.s&&(X=e.s("connectGuideShift")),X||(X=s.getStyle("connectGuideShift"));var Z=e.getAnchor(),D=e.getSize(),U=e.toGlobal({x:D.width*(X[0]-Z.x),y:D.height*(X[1]-Z.y)});U=wf.toScreenPosition(r,U),o.P1?U.add(o.P2.clone().sub(o.P1).setLength(X[2])):(U.add(o.RT.clone().sub(o.LT).setLength(X[2])),U.add(o.LB.clone().sub(o.LT).setLength(X[3]))),o.connect=U}},ge.prototype.gatherMultiTargets=function(n,J){var E=wf.Group.findOrCreateGroup(J,this._interactor._uuid);if(!E)return!1;var v=this;return v.editing&&"rotate"!==v.editing.mode||E.calcInfo(),v.gatherSingleTarget(n,E)},ge.prototype.gatherLine=function(t,i){this.target=i;var N=this.screenInfo={},c=i.getPoints(),S=wf.getDataMatrix(i);return N.P1=wf.toScreenPosition(t,S.apply(c.get(0))),N.P2=wf.toScreenPosition(t,S.apply(c.get(1))),this.gatherConnectInfo(),!0},ge.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],ge.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],ge.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],ge.prototype.check=function(H,R,q){if(A.Default.isLeftButton(R)){var o=this;if(o.editing=null,o.tipInfo=null,o.screenInfo){var p=o.target,M=H.isEditable(p),v=o.screenInfo;if(M&&v.connect){var K=o._checkConnect(q);if(K)return K}if(v.P1)return o._checkLine(q);var X,Q,I,E=null,O=o._interactor,B=O.getStyle("checkSize");if(M&&H.isRectEditable(p))for(Q=0;Q<wf.Rect.ResizeKeys.length;Q++)if(I=wf.Rect.ResizeKeys[Q],wf.checkHit(q,v[I],B)){E=I,X="resize";break}if(!E&&M&&H.isRotationEditable(p)&&!O.getStyle("rotateAsClock")){var C=O.getStyle("rotateCheckSize");for(Q=0;Q<wf.Rect.RotateKeys.length;Q++)if(I=wf.Rect.RotateKeys[Q],wf.checkHit(q,v[I],C)){E=I,X="rotate";break}}if(!E)return O.setCursor("default"),void 0;if("rotate"===X){var F,z=H.lp(R);if(p instanceof wf.Group){var w=O.getStyle("groupRotateModeKey");"string"==typeof w&&(w=[w]);for(var Z=!1,f=0,Y=w.length;Y>f;f++)if(R[w[f]]){Z=!0;break}var S=O.getStyle("groupRotateModeDefault");F=Z?"batch"===S?"block":"batch":S}var N="batch"===F?p.getAnchor2():p.getPosition(),i=Math.atan2(z.y-N.y,z.x-N.x);O._setRotateCursor(i),o.editing={mode:X,key:E,pos:N,flipY:p.getScale().y<0,rotation:p.getRotation(),hitRot:i},F&&(o.editing.groupRotateMode=F)}else{var V=wf.Rect.ResizeKeys.indexOf(E),m=wf.Rect.ResizeDirection[V],u=Math.cos(p.getRotation()),_=Math.sin(p.getRotation()),J=m.x*Math.sign(p.getScale().x),y=m.y*Math.sign(p.getScale().y),s=Math.atan2(-_*J-u*y,u*J-_*y),l=(Math.round(s/(Math.PI/4))+8)%8,T=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][l];this._interactor.setCursor(T);var d=p.getWidth(),b=p.getHeight(),g=p.getAnchor();o.editing={mode:X,key:E,rect:{x:-d*g.x,y:-b*g.y,width:d,height:b},anchor:g,matrix:p.getMatrix()}}return E}}},ge.prototype._checkLine=function(J){var M=this;M.screenInfo;var O,I=M._interactor.getStyle("checkSize");if(wf.checkHit(J,M.screenInfo.P1,I))O="P1";else{if(!wf.checkHit(J,M.screenInfo.P2,I))return this._interactor.setCursor("default"),void 0;O="P2"}return M.editing={mode:"line",key:O},O},ge.prototype._checkConnect=function(s){var H=this,A=H.screenInfo,O=H._interactor,C=O.getStyle("connectGuideIntersectSize"),y=A.connect,c=s.x,K=y.x;if(K>c&&C>K-c&&Math.abs(y.y-s.y)<C||c>=K&&wf.checkHit(s,y,C)){var Z="connect",I=z.getConnectAction(O.gv);if(H.editing={mode:Z},I&&I.delete)if(H.target instanceof wf.Group){var G=!0;O.gv.sm().getSelection().each(function(W){I.delete.visible.call(null,O.gv,W)||(G=!1)}),H.editing.hasDeleteAction=G}else I.delete.visible.call(null,O.gv,H.target)&&(H.editing.hasDeleteAction=!0);return O.setCursor("default"),Z}},ge.prototype._fireEditEvent=function(H,d){var D=this._interactor,v=this.editing;if(v){var V=v.mode;V="rotate"===V?"Rotation":"connect"===V?"Connection":"resize"===V?"Rect":V[0].toUpperCase()+V.slice(1),D.fi({kind:H+"Edit"+V,event:d})}},ge.prototype.startEdit=function(U,G){U.startDragging(G);var u=this;u._interactor.fi({kind:"prepareEdit",event:G});var h=u.editing,F=u.target;if(h){if(u._fireEditEvent("begin",G),h.started=!0,"rotate"===h.mode)return h.groupRotateMode&&F.beginRotate(h),U._42(),void 0;if("connect"!==h.mode)("line"===h.mode||F&&0===F.getRotation())&&(u._inSmartGuide=!0,u._interactor.rectGuide.gatherRects());else if(h.hasDeleteAction){var z=U.gv,Y=u._interactor.getStyle("connectGuideGarbageShift");h.garbageInfo={x:z.getWidth()*Y[0]+Y[2],y:z.getHeight()*Y[1]+Y[3],size:u._interactor.getStyle("connectGuideGarbageIntersectsize")},U._42()}}},ge.prototype._46O=function(q){var w,R,N=this,v=N.editing,i=N.target;if(v){if("connect"===v.mode&&!v.canceled&&!v.deleted)try{v.garbageInfo&&v.garbageInfo.hover?z.doDeleteConnectionAction(N._interactor.gv,i):z.doConnectAction(N._interactor.gv,i,v.target)}catch(d){console.error(d)}R=v.freezeFlag,w=N.editing.groupRotateMode,N._fireEditEvent("end",q),N.editing=null}N.tipInfo=null,N._inSmartGuide&&(N._interactor.rectGuide.clear(),N._inSmartGuide=!1),w&&i&&i.endRotate(),i instanceof A.Block&&(R===_?delete i._freezeSyncFromChildren:i._freezeSyncFromChildren=R,i.updateFromChildren())},ge.prototype.handleNormalStateDelete=function(){var L=this,F=L.editing;if(F&&"connect"===F.mode&&!F.canceled&&!F.deleted){if(F.garbageInfo){try{z.doDeleteConnectionAction(L._interactor.gv,L.target)}catch(n){console.error(n)}F.garbageInfo=null}return F.cursorPos=null,F.targetCorners=null,F.deleted=!0,L._interactor._42(),!0}},ge.prototype.handleNormalStateKeyDown=function(X){var g=this,b=g.editing;return!b||"connect"!==b.mode||b.canceled||b.deleted?void 0:A.Default.isEsc(X)?(b.cursorPos=null,b.targetCorners=null,b.canceled=!0,g._interactor._42(),!0):void 0},ge.prototype.handleEdit=function(k,u){var X=this,e=X.editing;if(e){var f,n,x,t,K,h=X.target,J=e.key,$=e.mode,D=k.lp(u),B=X._interactor;if("connect"===$){if(e.canceled)return;if(e.deleted)return;e.cursorPos=B._getLogicalPoint(u);var Z=e.garbageInfo;return Z&&wf.checkHit(e.cursorPos,Z,Z.size)?(Z.hover=!0,e.target=null,e.targetCorners=null):(Z&&(Z.hover=!1),e.target=k.getDataAt(D,function(H){return k.isSelectable(H)?Fg(H)?!0:!1:!1})||null,e.targetCorners=wf.getTargetCornersOnScreen(k,e.target)),B._42(),void 0}if("rotate"===$){var j,v,m=e.pos,H=Math.atan2(D.y-m.y,D.x-m.x);if(e.groupRotateMode?v=H-e.hitRot:(j=H-e.hitRot,v=e.rotation+j),v%=2*Math.PI,0>v&&(v+=2*Math.PI),!A.Default.isCtrlDown(u)){var W,U;Io(u)?(W=B.getStyle("shiftRotateRound"),U=W/2):(W=B.getStyle("rotateRound"),U=B.getStyle("rotateSensitivity")),v=wf.roundTo(v,W,U)}e.groupRotateMode?(j=v-(e.lastRotation||0),0!==j&&(h.addRotation(j,e.groupRotateMode,function(N){return k.isRotationEditable(N)}),e.lastRotation=v)):h.setRotation(v),B._setRotateCursor(H),v>Math.PI&&(v-=2*Math.PI);var o=180*(v/Math.PI);o=o.toFixed(2),f=""+o+"°"}else if("resize"===$){var c=e.rect;x=c.x,t=c.y;var V,i=c.width,S=c.height,p=e.anchor,C=e.matrix,Q=h.s&&h.s("keepAspectRatio")||B.getStyle("keepAspectRatio");Io(u)&&(Q=!Q);var R=X._unionPointMode1,G=X._unionPointMode2;if(X._inSmartGuide&&!A.Default.isCtrlDown(u)&&!Q){var r;"L"===J||"R"===J?r="x":("T"===J||"B"===J)&&(r="y"),X._adsorbedToClosest(D,r),K=!0}V=C.tfi(D);var F;"LT"===J?(c=R(V,{x:x+i,y:t+S},i,S,Q),F=9):"T"===J?(c=G({x:x,y:V.y},{x:x+i,y:t+S},i,S,Q,"v"),F=1):"RT"===J?(c=R(V,{x:x,y:t+S},i,S,Q),F=33):"L"===J?(c=G({x:V.x,y:t},{x:x+i,y:t+S},i,S,Q,"h"),F=8):"R"===J?(c=G({x:x,y:t},{x:V.x,y:t+S},i,S,Q,"h"),F=32):"LB"===J?(c=R(V,{x:x+i,y:t},i,S,Q),F=12):"B"===J?(c=G({x:x,y:t},{x:x+i,y:V.y},i,S,Q,"v"),F=4):"RB"===J&&(c=R(V,{x:x,y:t},i,S,Q),F=36);var w=C.tf(c.x+c.width*p.x,c.y+c.height*p.y);h instanceof A.Block&&(e.hasOwnProperty("freezeFlag")||(e.freezeFlag=h._freezeSyncFromChildren,h._freezeSyncFromChildren=!0)),h.setPosition(w),h.setSize(c.width,c.height),K&&(n=h.getRect(),B.rectGuide.gatherLines({node:h,x:n.x,y:n.y,w:n.width,h:n.height},r,F)),f=""+Math.round(c.width)+" * "+Math.round(c.height)}else if("line"===$){if(Io(u)){var O=h.getPoints(),Y="P1"===J?O.get(1):O.get(0),N={x:D.x-Y.x,y:D.y-Y.y},T=B.getStyle("shiftLineRotateRound"),I=X._shiftDirList;if(!I||X._shiftRotateRound!==T){X._shiftRotateRound=T,X._shiftDirList=I=[];for(var g=0;g<Math.PI;g+=T)I.push({x:d(g),y:l(g)})}for(var s,P=0,a=0,_=I.length;_>a;a++){var y=I[a],E=y.x*N.x+y.y*N.y;Math.abs(E)>Math.abs(P)&&(P=E,s=y)}D={x:Y.x+s.x*P,y:Y.y+s.y*P},B.rectGuide.clear()}else X._inSmartGuide&&!A.Default.isCtrlDown(u)&&(X._adsorbedToClosest(D),K=!0);var L=wf.getDataMatrix(h).applyInverse(D);h.setPoint("P1"===J?0:1,L,!0);var z=h.getPoints(),q=z.get(0),b=z.get(1);x=q.x-b.x,t=q.y-b.y,f=" "+Math.round(Math.sqrt(x*x+t*t))+" ",K&&(n=h.getRect(),B.rectGuide.gatherLines({node:h,x:n.x,y:n.y,w:n.width,h:n.height}))}if(f){var M=A.Default.getLogicalPoint(u,B._canvas);M.x+=wf.Icons.TipShiftX,M.y+=wf.Icons.TipShiftY,X.tipInfo={helperPos:M,text:f,size:f.length}}X._fireEditEvent("between",u)}},ge.prototype._unionPointMode1=function(b,z,X,K,Z){if(Z&&X&&K){var m=b.x-z.x,q=b.y-z.y;Math.abs(m*K)<Math.abs(q*X)?(q=Math.sign(q)*Math.abs(m*K/X),b.y=z.y+q):(m=Math.sign(m)*Math.abs(q*X/K),b.x=z.x+m)}return A.Default.unionPoint(b,z)},ge.prototype._unionPointMode2=function(x,N,W,X,L,k){var R=A.Default.unionPoint(x,N);if(L&&W&&X){var o;"v"===k?(o=R.x+R.width/2,R.width=W*R.height/X,R.x=o-R.width/2):(o=R.y+R.height/2,R.height=X*R.width/W,R.y=o-R.height/2)}return R},ge.prototype._adsorbedToClosest=function(D,n){var Y=this,R=Y._interactor,t=R.rectGuide.findClosest(D,n),L=R.gridGuide.findClosest(D,n),w=1/0,e=1/0;t&&(isFinite(t.x)&&(w=t.x),isFinite(t.y)&&(e=t.y)),L&&(isFinite(L.x)&&Math.abs(L.x)<Math.abs(w)&&(w=L.x),isFinite(L.y)&&Math.abs(L.y)<Math.abs(e)&&(e=L.y)),isFinite(w)&&(D.x+=w),isFinite(e)&&(D.y+=e)},ge.prototype._42=function(B,Z,n){var f=this;f.info={},f.screenInfo=null;var w=f._interactor;if(!w.editDetail&&f.gatherInfo(Z,n)){var R=f.editing,M=R?R.groupRotateMode:null,v=f.screenInfo;if("block"!==M||!R||!R.started){if(v.P1?wf.Icons.DrawIcon(w,B,wf.Icons.Line,v):wf.Icons.DrawIcon(w,B,wf.Icons.Rect,v),v.connect&&(wf.Icons.DrawIcon(w,B,wf.Icons.ConnectGuide,{rotation:v.rotation,connect:v.connect,cursorPos:R?R.cursorPos:null}),R)){if(R.targetCorners){for(var j={x:1/0,y:1/0},g={x:-1/0,y:-1/0},z=0,o=R.targetCorners.length;o>z;z+=2)j.x=Math.min(j.x,R.targetCorners[z]),g.x=Math.max(g.x,R.targetCorners[z]),j.y=Math.min(j.y,R.targetCorners[z+1]),g.y=Math.max(g.y,R.targetCorners[z+1]);wf.Icons.DrawIcon(w,B,wf.Icons.HoverDataRect,{min:j,max:g,color:w.getStyle("hoverGuideColor")||w.getStyle("baseColor")})}R.garbageInfo&&wf.Icons.DrawIcon(w,B,wf.Icons.ConnectGuideGarbage,R.garbageInfo)}w.getStyle("rotateTipVisible")&&f.tipInfo&&wf.Icons.DrawIcon(w,B,wf.Icons.TipHelper,f.tipInfo)}f.target instanceof wf.Group&&f.target._42(w,B,Z)}};var Kb=wf.Anchor=function(I){this.catalog="Anchor",this._interactor=I};Kb.prototype={},Kb.prototype.constructor=Kb,Kb.prototype.gatherInfo=function(F,Y){var M=this;if(1===Y.length){var n=Y[0];if(!n.getAnchor)return;if(n instanceof A.Shape&&n._70I())return;if(os(n,F))return;return M.gatherSingleTarget(F,Y[0])}return Y.length>1?M.gatherMultiTargets(F,Y):!1},Kb.prototype.gatherSingleTarget=function(j,r){var O=this;return O.info.POS=r.getPosition(),O.screenInfo.POS=wf.toScreenPosition(j,O.info.POS),O.target=r,!0},Kb.prototype.gatherMultiTargets=function(d,R){var V=this,x=wf.Group.findOrCreateGroup(R,this._interactor._uuid);return x?(V.screenInfo.POS=wf.toScreenPosition(d,x.getAnchor2()),V.target=x,!0):!1},Kb.prototype.isVisible=function(){var z=this,C=z._interactor;if(C.getStyle("anchorVisible")===!1)return!1;var Z=z.target;if(Z){if(this.editing)return!0;var F=Z.getAnchor(),$=C.getStyle("anchorOutsideVisibleThreshold");if(F.x<-$||F.x>1+$||F.y<-$||F.y>1+$)return!0;var M=Z.getSize(),f=Z.getScale(),c=Math.min(Math.abs(M.width*f.x),Math.abs(M.height*f.y));if(c*C.gv._zoom<C.getStyle("anchorHideThreshold"))return!1}return!0},Kb.prototype.check=function(k,e,x){if(A.Default.isLeftButton(e)){var Y=this,q=Y._interactor;if(Y.isVisible()&&q.getStyle("anchorMovable")!==!1){Y.editing=null,Y.tipInfo=null;var F=Y.target;if(F&&k.isAnchorEditable(F)&&k.isEditable(F)){var N;if(Y.screenInfo&&(N=Y.screenInfo.POS)&&wf.checkHit(x,new wf.Math.Vector2(N),q.getStyle("checkSize"))){if(F instanceof wf.Group)return Y.editing={},!0;var v=F.getWidth(),D=F.getHeight(),Q=F.getAnchor();return Y.editing={rect:{x:-v*Q.x,y:-D*Q.y,width:v,height:D},anchor:Q,matrix:F.getMatrix()},!0}}}}},Kb.prototype.startEdit=function(O,C){O.startDragging(C),O.fi({kind:"beginEditAnchor",event:C})},Kb.prototype._46O=function(y){var N=this;N.editing&&(N.editing=null,N._interactor.fi({kind:"endEditAnchor",event:y})),N.tipInfo=null},Kb.prototype.handleEdit=function(q,d){var h=this,I=h.target;if(I){var e=h.editing;if(e){var r=q.lp(d),k=h._interactor;if(I instanceof wf.Group)return I.setAnchor2(r),k._42(),void 0;var l=e.matrix,p=l.tfi(r),z=e.rect,o=(p.x-z.x)/z.width,B=(p.y-z.y)/z.height;if(!A.Default.isCtrlDown(d)){var n=k.getStyle("anchorRound"),x=k.getStyle("anchorSensitivity");o=wf.roundTo(o,n,x),B=wf.roundTo(B,n,x)}I.setAnchor(o,B,!0);var y=A.Default.getLogicalPoint(d,k._canvas);y.x+=wf.Icons.TipShiftX,y.y+=wf.Icons.TipShiftY;var C=""+o.toFixed(2)+", "+B.toFixed(2);h.tipInfo={helperPos:y,text:C,size:C.length},k.fi({kind:"betweenEditAnchor",event:d})}}},Kb.prototype._42=function(y,W,i){var t=this;t.info={},t.screenInfo={};var J=t._interactor;J.editDetail||t.gatherInfo(W,i)&&t.isVisible()&&(wf.Icons.DrawIcon(J,y,wf.Icons.Anchor,t.screenInfo),t.tipInfo&&wf.Icons.DrawIcon(J,y,wf.Icons.TipHelper,t.tipInfo))};var Qq=wf.MoveDummy=function(c){this.catalog="MoveDummy",this._interactor=c};Qq.prototype={},Qq.prototype.constructor=Qq,Qq.prototype.gatherInfo=function(){var V=this,y=this._interactor.getSubModule("Rect");if(y){var c=y.screenInfo;if(c){var C=V._interactor,T=V.getMovableTarget(y.target);if(T){var O=C.getStyle("moveDummyThreshold");if(O!==!1){var g=c.LT||c.P1,F=c.RT||c.P2,P=c.LB||g;if(g){var W=c.P1,k=Math.min(g.distanceTo(P),g.distanceTo(F));if(!(O!==!0&&k>O)){var R=C.getStyle("moveDummyPosition"),L=F.clone().sub(g),n=P.clone().sub(g),_=R[2],d=R[3];if(W){var v=C.getStyle("moveDummyLineExtraShift");v&&(_+=v[0],d+=v[1])}var e=g.clone().add(L.clone().multiplyScalar(R[0])).add(L.setLength(_)).add(n.clone().multiplyScalar(R[1])).add(n.setLength(d));return V.screenInfo.pos=e,V.screenInfo.size=C.getStyle("moveDummySensitivity"),!0}}}}}}},Qq.prototype.getMovableTarget=function($){var D=this._interactor.gv;if(Fg($)){if(D.isMovable($))return $}else if($ instanceof wf.Group)for(var K=$._entities,v=K.length-1;v>=0;v--){var P=K[v];if(Fg(P)&&D.isMovable(P))return P}return null},Qq.prototype.getMoveInteractor=function(){for(var P,_,r,d=this._interactor.gv,X=d.getInteractors(),P=0,_=X.length;_>P;P++)if(r=X.get(P),r instanceof Cs)return r},Qq.prototype.startEdit=function(l,b){l.startDragging(b);var F=this.getMoveInteractor();if(F){var j=this.selectedTarget,R=l.gv;R._moving=1,F._data=j,R.handleMouseDown&&R.handleMouseDown(b,j)}},Qq.prototype._46O=function(g){var C=this,B=C.getMoveInteractor();B&&(B.handleWindowMouseUp(g),C.selectedTarget=null)},Qq.prototype.handleEdit=function(r,b){var x=this.getMoveInteractor();x&&x.handleWindowMouseMove(b)},Qq.prototype.check=function(q,I,m){if(this.selectedTarget=null,A.Default.isLeftButton(I)&&!q._scrolling&&!Ui()){var l=this;if(l.screenInfo){var s=l.screenInfo.pos;if(s&&!(m.distanceTo(s)>l.screenInfo.size)){var X=l._interactor;return l.selectedTarget=l.getMovableTarget(X.getSubModule("Rect").target),X.setCursor("default"),!0}}}},Qq.prototype._42=function(W,u,$){var Y=this;Y.screenInfo={};var P=Y._interactor;P.editDetail||Y.gatherInfo(u,$)&&(!P.editing||Y.selectedTarget)&&wf.Icons.DrawIcon(P,W,wf.Icons.MoveDummy,Y.screenInfo)};var tp=wf.RotateX=function(v){this.catalog="RotateX",this._interactor=v};tp.prototype={},tp.prototype.constructor=tp,tp.prototype.gatherInfo=function(w,b){var J=this;if(1===b.length){var v=b[0];return v instanceof A.Shape&&v._70I()||os(v,w)?!1:J.gatherSingleTarget(w,v)}return b.length>1?J.gatherMultiTargets(w,b):!1},tp.prototype.gatherSingleTarget=function(){var r=new A.Math.Vector2,c=new A.Math.Vector2,z=new A.Math.Vector2,Y=new A.Math.Vector2,o=function(u,g){var s=u.x-g.x,_=u.y-g.y;return s*s+_*_};return function(X,S){if(S.getCorners){var T=this,f=S.getCorners(),h=15,C=S.getPosition();r.copy(f[0]),z.copy(f[1]),Y.copy(f[3]),c.copy(r).add(Y).divideScalar(2).add(r.sub(z).setLength(h/X.getZoom()));var V=Math.max(o(C,f[0]),o(C,f[1]),o(C,f[2]),o(C,f[3]));return T.info.POS=c.clone(),T.screenInfo.POS=wf.toScreenPosition(X,T.info.POS),T.screenInfo.LEN=Math.sqrt(V)*X.getZoom()+h,T.screenInfo.CENTER=wf.toScreenPosition(X,C),T.target=S,!0}}}(),tp.prototype.gatherMultiTargets=function(x,o){var M=this,i=wf.Group.findOrCreateGroup(o,this._interactor._uuid);if(!i)return!1;var M=this;return M.gatherSingleTarget(x,i)},tp.prototype.isVisible=function(){var X=this._interactor;if(!X.getStyle("rotateAsClock"))return!1;var y=this.target;if(!y)return!0;var r=X.gv;return r.isEditable(y)&&r.isRotationEditable(y)?!0:!1},tp.prototype.check=function(t,z,c){var y=this,Y=y._checkImpl(t,z,c);return(Y||y._clockPainted)&&y._interactor._42(),Y},tp.prototype._checkImpl=function(m,W,P){if(A.Default.isLeftButton(W)){var b=this;b.editing=null,b.tipInfo=null;var T;if(b.screenInfo&&(T=b.screenInfo.POS)&&b.isVisible()){var g=b._interactor;if(wf.checkHit(P,T,g.getStyle("checkSize"))){var q=b.target,N=m.lp(W),H=q.getPosition(),r=Math.atan2(N.y-H.y,N.x-H.x);return g._setRotateCursor(r),b.editing={pos:H,rotation:q.getRotation(),hitRot:r,groupRotateMode:"block",screenInfo:{CENTER:b.screenInfo.CENTER,LEN:b.screenInfo.LEN}},!0}}}},tp.prototype.startEdit=function(y,A){y.startDragging(A),y.fi({kind:"beginEditRotation",event:A}),this.target instanceof wf.Group&&this.target.beginRotate(this.editing)},tp.prototype._46O=function(v){var e=this;e.editing&&(e.editing=null,e._interactor.fi({kind:"endEditRotation",event:v})),e.target instanceof wf.Group&&e.target.endRotate(),e.tipInfo=null},tp.prototype.handleEdit=function(q,B){var m=this,l=m.editing;if(l){var Z,O,t=m.target,x=q.lp(B),e=m._interactor,J=l.pos,j=Math.atan2(x.y-J.y,x.x-J.x),N=t instanceof wf.Group;if(N?O=j-l.hitRot:(Z=j-l.hitRot,O=l.rotation+Z),O%=2*Math.PI,0>O&&(O+=2*Math.PI),!A.Default.isCtrlDown(B)){var X,G;Io(B)?(X=e.getStyle("shiftRotateRound"),G=X/2):(X=e.getStyle("rotateRound"),G=e.getStyle("rotateSensitivity")),O=wf.roundTo(O,X,G)}N?(Z=O-(l.lastRotation||0),0!==Z&&(t.addRotation(Z,l.groupRotateMode,function(n){return q.isRotationEditable(n)}),l.lastRotation=O)):t.setRotation(O),e._setRotateCursor(j),O>Math.PI&&(O-=2*Math.PI);var M=180*(O/Math.PI),r=""+M.toFixed(2)+"°",y=A.Default.getLogicalPoint(B,e._canvas);y.x+=wf.Icons.TipShiftX,y.y+=wf.Icons.TipShiftY,m.tipInfo={helperPos:y,text:r,size:r.length},e.fi({kind:"betweenEditRotation",event:B})}},tp.prototype._42=function(o,V,C){var h=this;h._clockPainted=!1,h.info={},h.screenInfo={};var l=h._interactor;l.editDetail||h.gatherInfo(V,C)&&h.isVisible()&&(wf.Icons.DrawIcon(l,o,wf.Icons.RoundPoint,h.screenInfo.POS),l.getStyle("rotateTipVisible")&&h.tipInfo&&wf.Icons.DrawIcon(l,o,wf.Icons.TipHelper,h.tipInfo),h.editing&&h.drawClock(o))},tp.prototype.drawClock=function(i){i.save();var I=this;I._clockPainted=!0;var r=I.editing||{},u=r.screenInfo||I.screenInfo,Y=u.LEN,Z=Y+8,v=Y+18;i.save(),i.translate(u.CENTER.x,u.CENTER.y),i.beginPath(),i.strokeStyle="rgb(150, 150, 150)";for(var t,K,g,c,p,b=0;360>b;b++)t=b*Math.PI/180,0===b%5&&(K=l(t)*Y,g=d(t)*Y,c=l(t)*Z,p=d(t)*Z,i.moveTo(K,g),i.lineTo(c,p)),0===b%45&&(K=l(t)*Y,g=d(t)*Y,c=l(t)*v,p=d(t)*v,i.moveTo(K,g),i.lineTo(c,p));i.stroke(),i.rotate(-Rg);var P=r.lastRotation||I.target.getRotation();i.beginPath(),i.fillStyle="rgba(255, 0, 0, 0.1)",i.strokeStyle="rgb(157, 157, 157)",i.moveTo(0,0),i.arc(0,0,v,0,P,!1),i.fill(),i.beginPath(),i.moveTo(0+v,0),i.arc(0,0,v,0,P,!1),i.stroke(),i.restore()};var Mn=wf.Curve=function(K){this.catalog="Curve",this._interactor=K};Mn.prototype={},Mn.prototype.constructor=Mn,j.defineProperties(Mn.prototype,{activing:{get:function(){return this._activing},set:function($){var J=this;if($)J._activing=new wf.CurveActiving(this,$),J._activing._firePointChange();else{var c=J._activing;c&&c.dispose(),J._activing=null}}}}),Mn.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Mn.prototype.setUp=function(){var f=this,j=f._interactor;j&&j.gv.mp(f._onGraphviewPropertyChanged,f)},Mn.prototype._onGraphviewPropertyChanged=function(z){("zoom"===z.property||"translateX"===z.property||"translateY"===z.property)&&this._handleDataChanged()},Mn.prototype.tearDown=function(){var T=this,f=T._interactor;f&&f.gv.ump(T._onGraphviewPropertyChanged,T)},Mn.prototype.canEnterEditDetailMode=function(){var F=Ge(this._interactor);return F?this.target=F:void 0},Mn.prototype.canQuitEditDetailMode=function(E){var y=this,K=y._interactor._getLogicalPoint(E);return y._checkEditRealPoint(K)?void 0:y._interactor.gv.getDataAt(E)!==y.target?!0:void 0},Mn.prototype.preHandleScroll=function(){var T=this.editing;return T&&T.inEdit?!0:void 0},Mn.prototype.getCurrentSelectintStatus=function(){var G=this;if(G.activing&&!G.activing.selections){if(G.activing.status!=_)return G.activing.status;var P=function(d){var I=G.activing.status;G.activing.status=d,G._interactor.fp("shapePointStatus",I,d)},S=wf.Curve.PointType,L=G.activing.point,R=G.activing.pairs;if(!R||1!==R.length)return P(S.Mirrored);var w=R[0],i=w.c1&&w.c1.isNearEnough(L),$=w.c2&&w.c2.isNearEnough(L);if(!w.c1||!w.c2)return i||$?P(S.Straight):P(S.Disconnected);if(i&&$)return P(S.Straight);if(i||$)return P(S.Asymmetric);var Z=w.c1.clone().sub(L),z=w.c2.clone().sub(L);return Math.abs(Z.x*z.y-Z.y*z.x)>1e-5||Z.x*z.x>0?P(S.Disconnected):Math.abs(Z.length()-z.length())>1e-5?P(S.Asymmetric):P(S.Mirrored)}},Mn.prototype.handle_keydown=function(p){var m=this;if(m._interactor.editDetail){var S=wf.Curve.PointType;"1"===p.key?m._setCurrentSelectionStatus(S.Straight):"2"===p.key?m._setCurrentSelectionStatus(S.Mirrored):"3"===p.key?m._setCurrentSelectionStatus(S.Disconnected):"4"===p.key&&m._setCurrentSelectionStatus(S.Asymmetric)}},Mn.prototype.setCurrentSelectionStatus=function(b){var G=this,D=G._interactor;if(D){var M=D.gv;M.dm().beginTransaction(),this._setCurrentSelectionStatus(b),M.dm().endTransaction()}},Mn.prototype._setCurrentSelectionStatus=function(z){var r=this,W=r.activing;if(W){var Z=r.getCurrentSelectintStatus();if(null!==Z&&Z!==z){W.status=z;var s=r.activing.point,t=r.activing.pairs;if(t&&1===t.length){var C=t[0],f=r.screenInfo.curve,D=wf.Curve.PointType,m=r._interactor,e=function(){r._writeToHt(),m.fp("shapePointStatus",Z,z),r.check(m.gv,null,new wf.Math.Vector2(m._lastLogicalPoint))};if(z===D.Straight)return f.moveCtrlPoint(C,s,"c1"),f.moveCtrlPoint(C,s,"c2"),e(),void 0;if(Z===D.Straight){var K=f.findPairs(s,!0),w=K[0],h=w.r1||s,G=w.r2||s,b=G.clone().sub(h).multiplyScalar(.25);return f.moveCtrlPoint(C,s.clone().sub(b),"c1"),f.moveCtrlPoint(C,s.clone().add(b),"c2"),e(),void 0}var l=C.c1,n=C.c2;if(l&&n){if(z===D.Mirrored)return f.moveCtrlPoint(C,s.clone().multiplyScalar(2).sub(n),"c1"),e(),void 0;if(z===D.Asymmetric&&Z===D.Disconnected){var P=l.clone().sub(s).length(),b=s.clone().sub(n).setLength(P).add(s);return f.moveCtrlPoint(C,b,"c1"),e(),void 0}}W._firePointChange(),m.fp("shapePointStatus",Z,z),r.check(m.gv,null,new wf.Math.Vector2(m._lastLogicalPoint))}}}},Mn.prototype._handleDataChanged=function(){var U="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(u){var I=this;if(I.screenInfo&&I.target){if(u&&U.indexOf(u.property)<0)return;var t=I._interactor;I.gatherSingleTarget(t.gv,I.target,!0),I.check(t.gv,null,new wf.Math.Vector2(t._lastLogicalPoint)),t._42()}}}(),Mn.prototype.gatherSingleTarget=function(y,c,g){var U,k,q=this;q.screenInfo&&q.screenInfo.curve&&(k=q.screenInfo.curve._curves);var M=q.editing;U=M?q.screenInfo:q.screenInfo={};var G,$,D=c instanceof A.Edge;D?(G=c.s("edge.segments"),$=c.s("edge.points")||new A.List):(G=c._58O,$=c._59O),U.S=G;var W,m=U.P=[],L=wf.getDataMatrix(c);if(c instanceof A.Polyline||c instanceof A.Edge&&q._interactor.getStyle("edgeElevationEditable"))W=c.getElevation&&c.getElevation()||0,U.E=[];else{var O=!1;$.each(function(Y){Y.e!==_&&(O=!0)}),O&&(U.E=[])}if($.each(function(h){U.E&&U.E.push(h.e!=_?h.e:W),h=L.apply(h);var x=wf.toScreenPosition(y,h);
m.push(x.x,x.y)}),D){var R=m.length,Z=wf.toScreenPosition(y,c._lastSourcePoint||(R?{x:m[0],y:m[1]}:{x:0,y:0})),d=wf.toScreenPosition(y,c._lastTargetPoint||(R?{x:m[R-2],y:m[R-1]}:{x:0,y:0}));if(m.splice(0,0,Z.x,Z.y),m.push(d.x,d.y),U.E){var b=c.getSourceAgent();b instanceof A.Edge?U.E.splice(0,0,c.s("edge.source.offset.elevation")):U.E.splice(0,0,((c.s("edge.source.anchor.elevation")||.5)-.5)*b.getTall()*b.getScaleTall()+b.getElevation()+c.s("edge.source.offset.elevation"));var T=c.getTargetAgent();T instanceof A.Edge?U.E.push(c.s("edge.target.offset.elevation")):U.E.push(((c.s("edge.target.anchor.elevation")||.5)-.5)*T.getTall()*T.getScaleTall()+T.getElevation()+c.s("edge.target.offset.elevation"))}}if(!U.S||!U.S.size()){U.S=new A.List,U.S.add(1);for(var Q=0;Q<m.length/2-1;Q++)U.S.add(2)}if((!M||g)&&q.convertToCubicBezier(k),q.activing&&(g||!q.editing||"realPoint"===q.editing.type)){var w=U.curve.findPairs(q.activing.point);q.activing.pairs=w}},Mn.prototype._convertToNewPoint=function(L,J,S,E){var O,v,u;for(O=0,v=J.length;v>O;O++){if(u=J[O],u._p1.isNearEnough(L)&&(!E||E.indexOf(u._p1)<0))return u._p1;if(u._p4.isNearEnough(L)&&(!E||E.indexOf(u._p4)<0))return u._p4}if(S)for(O=0,v=Math.min(S.length,v);v>O;O++){if(u=S[O],u._p1===L&&(!E||E.indexOf(J[O]._p1)<0))return J[O]._p1;if(u._p4===L&&(!E||E.indexOf(J[O]._p4)<0))return J[O]._p4}},Mn.prototype.convertToCubicBezier=function(L){var M,A,W=this,Z=new wf.Math.Curve,v=W.screenInfo;if(Z.createFromHtShape(v.P,v.S,v.E),v.curve=Z,W.activing){var y=Z._curves;M=W.activing.point,A=W._convertToNewPoint(M,y,L);var d=[];if(A&&(W.activing.point=A,d.push(A)),W.activing.selections){var Y=-1,B=W.activing.selections;B.forEach(function(X){Y++,A=W._convertToNewPoint(X,y,L,d),A&&(B[Y]=A,d.push(A))})}}},Mn.prototype.check=function(q,Z,r){if(!Z||Uo(Z)||fh(Z)){var T=this;if(T._interactor.setCursor("default"),T.editing=null,T.highlight=null,T.tipInfo=null,T.edgeEditResult=null,T.screenInfo){if(Ui()||Z&&fh(Z))return T._interactor._42(),!0;if(T._checkEditCtrlPoint(r))return T._interactor._42(),!0;if(T._checkEditRealPoint(r))return T._interactor._42(),!0;if(T._checkEditElevation(r))return T._interactor._42(),!0;var c=T.screenInfo.curve,K=c.checkPoint(r,T._interactor.getStyle("curveIntersectSize"));if(K){var S=T.highlight={};S.type="insertKnot",S.bezier=K.bezier,S.point=K.intersection}return T._interactor._42(),!0}}},Mn.prototype.getAdjacentBeziers=function(h){var O=this.screenInfo;if(O){var y,d,c,W=O.curve._curves,Y=[],m=_;for(y=0,d=W.length;d>y;y++)if(c=W[y],m===_){if(c._p4.isNearEnough(h)){Y.push(c),m=y;continue}}else{if(c._p1.isNearEnough(h))return Y.push(c),Y;if(c._p4.isNearEnough(h)){Y[0]=c,m=y;continue}}}},Mn.prototype.roundCorner=function(t){if(this.activing&&this.screenInfo){var h=this.screenInfo.curve,v=h._curves,Z=this.getAdjacentBeziers(this.activing.point),a=Z[1],f=a._index;a=a.insertKnot(a.getTByPercentage(t/a.length))[1],v[f]=a;var H=a.p1,W=Z[0],k=W._index;W=W.insertKnot(W.getTByPercentage(1-t/W.length))[0],v[k]=W;var s=W.p4,D=this.activing.point,J=new wf.Math.CubicBezier(s,D.clone().sub(s).multiplyScalar(2/3).add(s),D.clone().sub(H).multiplyScalar(2/3).add(H),H);v.splice(f,0,J),this._writeToHt(),this.activing=null,this._interactor._42()}},Mn.prototype._checkEditRealPoint=function(s){var b,G,X,K,L,f,N=this,Z=N.screenInfo.curve._curves,d=N._interactor.getStyle("curvePointIntersectSize"),o=1/0;for(d*=d,X=0,K=Z.length;K>X;X++)b=Z[X],L=b._p1,f=s.distanceToSquared(L),o>f&&(o=f,G=L),L=b._p4,f=s.distanceToSquared(L),o>f&&(o=f,G=L);if(o>d)return!1;var Q=N.highlight={};return Q.type="changeRealPoint",Q.point=G,N.editing={type:"realPoint",point:G,shiftGuide:{point:G.clone(),dir:"x",limit:0}},N._interactor.setCursor("crosshair"),!0},Mn.prototype._checkEditElevation=function(B){var d=this;if(!d._interactor.getStyle("curveElevationVisible"))return!1;var v=d.target;if(v instanceof A.Edge&&!d._interactor.getStyle("edgeElevationEditable"))return!1;var p=d.activing;if(!p)return!1;var k=p.getCurrentEditingPoint();if(!k)return!1;var U=d._interactor,C=U.getStyle("curveElevationGuideShift"),V=U.getStyle("curveElevationIntersectSize"),u=B.distanceToSquared({x:k.x+C[0],y:k.y+C[1]});if(!(u>V*V)){var w=d.highlight={};w.type="elevation";var F=new wf.Math.Vector2(B.x,B.y,k.e);return d.editing={type:"elevation",startPoint:F},d._interactor.setCursor("crosshair"),!0}},Mn.prototype._checkEditCtrlPoint=function(R){var i=this;if(i.activing&&!i.activing.selections){var z=i.getCurrentSelectintStatus();if(z!==wf.Curve.PointType.Straight){var Y=i.activing.pairs;if(Y){var l=i._interactor.getStyle("curvePointIntersectSize");l*=l;var Z,k,P,O,$,J,h,q,a,_=1/0;for(h=0,a=Y.length;a>h;h++)for(O=Y[h],q=0;2>q;q++)$=0===q?"c1":"c2",O[$]&&(J=R.distanceToSquared(O[$]),_>J&&(_=J,Z=O,k=h,P=$));if(_>l)return!1;i.activing.hlpair=Z,i.activing.hltype=P;var r=i.highlight={};return r.type="changeCtrlPoint",r.point=Z[P],i.editing={type:"ctrlPoint",pair:Z,pairId:k,ctrlType:P,direction:Z[P].clone().sub(i.activing.point).normalize()},i._interactor.setCursor("crosshair"),!0}}}},Mn.prototype.startEdit=function(V,c){V.startDragging(c);var s=this;s.highlight&&"insertKnot"===s.highlight.type&&(s.insertKnot(),s.gatherSingleTarget(s._interactor.gv,s.target),s.activing=null,s._checkEditRealPoint(s._interactor._getLogicalPoint(c)));var S=s._activing;if(S){var v=s.editing?s.editing.type:null;"ctrlPoint"===v?S.editingCtrl={pairId:s.editing.pairId,type:S.hltype}:"realPoint"===v&&(S.editingCtrl=!1)}var y=s.highlight,B=A.Default.isCtrlDown(c);if(!y||Ui()||fh(c)){var n=s._interactor.gv;if(!n.setFocus(c)||n._scrolling)return;return B?s._multiSelect={startPoint:n.lp(c)}:n.isPannable()&&(Uo(c)||fh(c))&&(s._pan={tx:n.tx(),ty:n.ty()},V.fi({kind:"beginPan",event:c})),void 0}if("changeRealPoint"===y.type){var D,O=s.activing?s.activing.point:null,b=s.activing?s.activing.selections:null;if(B&&s.activing)O===y.point?(b?(s.activing={point:b[0]},b.length>1&&(b.splice(0,1),s.activing.selections=b)):s.activing=null,s.editing=null):b&&(D=b.indexOf(y.point))>=0?(b.length>1?b.splice(D,1):delete s.activing.selections,s.editing=null):b?(b.push(O),s.activing={point:y.point,selections:b}):s.activing={point:y.point,selections:[O]};else if(b)O===y.point||((D=b.indexOf(y.point))>=0?(b.splice(D,1,O),s.activing={point:y.point,selections:b}):s.activing={point:y.point});else{var x;O===y.point&&(x=s.activing.status),s.activing={point:y.point},x&&(s.activing.status=x)}V.fi({kind:"beginEditPoint",event:c})}},Mn.prototype.insertKnot=function(){var N=this,Y=N.highlight,w=N.screenInfo.curve;w.insertKnot(Y.bezier,Y.point.t),N._writeToHt()},Mn.prototype._writeToHt=function(){var B,c,Z=this,_=Z.screenInfo.curve,S=_.toHtShape(),T=S.points,V=[],E=S.segments,F=Z._interactor.gv;F.dm().beginTransaction();var i,y,C=Z.target,q=C instanceof A.Edge,X=wf.getDataMatrix(C).invert();y=C instanceof A.Polyline||q&&Z._interactor.getStyle("edgeElevationEditable"),y&&(i=C.getElevation&&C.getElevation()||0);for(var W=0,P=T.length;P>W;W++)B=T[W],c=wf.toWorldPosition(F,B),c=X.apply(c),isFinite(B.e)&&B.e!==i&&(c.e=B.e),V.push(c);if(C._writing=!0,q){C.s("edge.type","points"),C.setStyle("edge.segments",E),C.setStyle("edge.points",V.slice(1,V.length-1)),C.setStyle("edge.source.offset.x",0),C.setStyle("edge.source.offset.y",0),C.setStyle("edge.target.offset.x",0),C.setStyle("edge.target.offset.y",0);var Q=Z._nextChangeEdgeHost;delete Z._nextChangeEdgeHost,Q&&("source"===Q.type?C.setSource(Q.host):C.setTarget(Q.host)),Z._writeEdgeHostAnchor("source",V[0]),Z._writeEdgeHostAnchor("target",V[V.length-1])}else V.length?(C.setSegments(E),C.setPoints(V,!0)):C.removeFromDataModel();F.dm().endTransaction(),delete C._writing},Mn.prototype._writeEdgeHostAnchor=function(H,P){var M=this,f=M.target,i=M._calcHostAnchor(f,H,P);i.index!==_?(f.setStyle("edge."+H+".index",i.index),f.setStyle("edge."+H+".percent",_),f.setStyle("edge."+H+".anchor.x",_),f.setStyle("edge."+H+".anchor.y",_),f.setStyle("edge."+H+".anchor.elevation",_),f.setStyle("edge."+H+".offset.elevation",P.e)):i.percent!==_?(f.setStyle("edge."+H+".percent",i.percent),f.setStyle("edge."+H+".index",_),f.setStyle("edge."+H+".anchor.x",_),f.setStyle("edge."+H+".anchor.y",_),f.setStyle("edge."+H+".anchor.elevation",_),f.setStyle("edge."+H+".offset.elevation",P.e)):(f.s("edge."+H+".anchor.x",i.x),f.s("edge."+H+".anchor.y",i.y),f.s("edge."+H+".anchor.elevation",i.e),i.offsetX||i.offsetY||i.offsetElevation?(f.s("edge."+H+".offset.x",i.offsetX),f.s("edge."+H+".offset.y",i.offsetY),f.s("edge."+H+".offset.elevation",i.offsetElevation)):(f.s("edge."+H+".offset.x",0),f.s("edge."+H+".offset.y",0),f.s("edge."+H+".offset.elevation",0)))},Mn.prototype._calcHostAnchor=function(Q,D,N,v){v||(v="source"===D?Q.getSource():Q.getTarget());var g=this._interactor.gv,b=g.calculateAttachPoint(v,N);if(b)return b.info;if(Rn(v)){var U=g.calculateEdgePosition(v,N);return U}var z=v.getRotation(),T=v.getAnchor();os(v,g)&&(z=0);var p=v.getElevation(),q=v.getTall()*v.getScaleTall();p=((N.e||0)-Q.s("edge."+D+".offset.elevation")-p)/q+.5;var B=v.getScale();if(z||B.x<0||B.y<0){var c=v.getMatrix(),H=c.tfi(N),s=v.getSize();return{x:H.x/s.width+T.x,y:H.y/s.height+T.y,e:p}}var Z=Sc(g,v),X={x:(N.x-Z.x)/Z.width,y:(N.y-Z.y)/Z.height,e:p};return X},Mn.prototype._handlePanning=function(W){var D=this,j=D._pan;if(j){j.started=!0;var I=D._interactor,o=I.gv,T=I._lastClientPoint,q=Xe(W),d=Ii(o,q,T);o.setTranslate(j.tx+d.x,j.ty+d.y),D.gatherSingleTarget(I.gv,D.target),I._42(),I.fi({kind:"betweenPan",event:W})}},Mn.prototype.handleEdit=function(v,z){var O=this,l=O.editing;if(O._pan)return O._handlePanning(z),void 0;if(O._multiSelect)return O._multiSelect.endPoint=v.lp(z),O._interactor.redraw(),void 0;if(l){l.inEdit=!0;var U,$,W,q=O._interactor._getLogicalPoint(z),K=A.Default.isCtrlDown(z),C=A.Default.isShiftDown(z),y=l.type,T=O.activing;if(O._guideInfo=null,"ctrlPoint"===y&&C){var n=O.editing.direction.clone();U=T.point;var c=n.dot(q.clone().sub(U));q=n.setLength(c).add(U)}else if("ctrlPoint"===y||"realPoint"===y){var n;if("realPoint"===y&&C){var g=O.editing.shiftGuide;$=g.point;var E=Math.abs(q.x-$.x),j=Math.abs(q.y-$.y);E>j&&E>g.limit&&"y"===g.dir&&(g.dir="x"),j>E&&j>g.limit&&"x"===g.dir&&(g.dir="y"),n=g.dir,"x"===n?(q.y=$.y,g.limit=Math.max(g.limit,E)):"y"===n&&(q.x=$.x,g.limit=Math.max(g.limit,j))}if(!K){var G,x=O._isEditEdgeSourceTarget();x&&(G=q.clone());var e=O._guidingToEdit(q,n),J="realPoint"===y?O._interactor.gridGuide.findClosest(q,n,!0):null,Y=1/0,V=1/0;J&&(J.x&&(Y=J.x),J.y&&(V=J.y));var h=!1;if(e&&(e.xList&&(Math.abs(e.x)<=Math.abs(Y)?(h=!0,Y=e.x):delete e.xList),e.yList&&(Math.abs(e.y)<=Math.abs(V)?(h=!0,V=e.y):delete e.yList),h&&(O._guideInfo=e)),isFinite(Y)&&(q.x+=Y),isFinite(V)&&(q.y+=V),h&&(e.v=q),x){var m=h?q.clone():null;q.copy(G);var P=O._editEdgeSourceTarget(x,q,K,m);P&&(O.edgeEditResult=P,W=P.tipText,P.isFixed&&(O._guideInfo=null))}}}var M=O.screenInfo.curve;if("realPoint"===l.type){U=l.point,U.e!==_&&(q.e=U.e),M.moveRealPoint(U,q),l.point=q,O.highlight.point=q;var N=T.status,d=T.selections;if(O.activing={point:q,status:N},d){var B=q.clone().sub(U),u=0;d.forEach(function(q){var N=q.clone().add(B);M.moveRealPoint(q,N),d[u++]=N}),O.activing.selections=d}}else if("ctrlPoint"===l.type){var f=T.pairs,L=f[l.pairId];M.moveCtrlPoint(L,q,l.ctrlType);var r=T.status,D=wf.Curve.PointType;if((r===D.Mirrored||r===D.Asymmetric)&&L.c1&&L.c2){var U=new wf.Math.Vector2(T.point),i="c1"===l.ctrlType?"c2":"c1";if(r===wf.Curve.PointType.Mirrored)M.moveCtrlPoint(L,U.clone().multiplyScalar(2).sub(q),i);else if(r===D.Asymmetric){var c=L[i].clone().sub(U).length(),w=U.clone().sub(L[l.ctrlType]).setLength(c).add(U);isNaN(w.x)||M.moveCtrlPoint(L,w,i)}}T._firePointChange()}else if("elevation"===l.type){$=l.startPoint;var s=$.e+($.y-q.y)/v._zoom;O._setCurrentPointImpl("e",s),T._firePointChange(),W="E: "+wf.toFixed(s)}var F=A.Default.getLogicalPoint(z,O._interactor._canvas);if(F.x+=wf.Icons.TipShiftX,F.y+=wf.Icons.TipShiftY,!W){var o=wf.toWorldPosition(v,q);W=""+wf.toFixed(o.x)+", "+wf.toFixed(o.y)}O.tipInfo={helperPos:F,text:W,size:W.length},O._writeToHt(),O._interactor.fi({kind:"betweenEditPoint",event:z})}},Mn.prototype._setCurrentPointImpl=function(Y,N){var I=this,v=I._activing;if(!v)return!1;var R=I.target;if(!R)return!1;var o=v.getCurrentEditingPoint();if(!o)return!1;var C=v.editingCtrl;if(!C)var M=o.clone();if("e"===Y)o.e=N;else{var q;if("x"===Y||"y"===Y){var T=v._lastFirePoint;q="x"===Y?{x:N,y:T?T.y:0}:{x:T?T.x:0,y:N}}else"object"==typeof Y?(q=Y,Y.e!==_&&(o.e=Y.e)):(q={x:arguments[0],y:arguments[1]},arguments[2]!==_&&(o.e=arguments[2]));var z=wf.getDataMatrix(R);q=wf.toScreenPosition(I._interactor.gv,z.apply(q)),o.x=q.x,o.y=q.y}if(!C){var H=M.multiplyScalar(-1).add(o);Cp(o.e)&&Cp(M.e)&&(H.e=o.e-M.e);var m=I.screenInfo.curve;m.moveCtrlDueToRealPointMovement(o,H);var E=v.selections;if(E){var b=0;E.forEach(function(O){var k=O.clone().add(H);isFinite(H.e)&&(k.e=(isFinite(O.e)?O.e:R.getElevation()||0)+H.e),m.moveRealPoint(O,k),E[b++]=k}),v.selections=E}}return!0},Mn.prototype.setCurrentPoint=function(X,U){return this._setCurrentPointImpl(X,U)?(this._writeToHt(),!0):!1},Mn.prototype._isEditEdgeSourceTarget=function(){var R=this,U=R.target;if(!(U instanceof A.Edge))return!1;var u=R.editing.point,J=R.screenInfo.curve._curves;return u===J[0]._p1?"source":u===J[J.length-1]._p4?"target":!1},Mn.prototype._editEdgeSourceTarget=function(x,W,U,k){var $,c=this,A=c.target;if($="source"===x?A.getSource():A.getTarget()){var q,J=c._interactor.gv,j=wf.toWorldPosition(J,W),R=c._calcHostAnchor(A,x,j,$);if(q=R.index!==_||R.percent!==_?R.distance*J.getZoom()>c._interactor.getStyle("edgeHostEdgeMaxDistance"):c._interactor.getStyle("edgeHostDetectPerFrame")?!0:R.x<0||R.x>1||R.y<0||R.y>1?!0:!1){var K=J.getDataAt(j,function(k){return J.isSelectable(k)?J.isSourceTargetEditable(A,k,x)?A.canSetSourceTarget(k,x)?!0:!1:!1:!1});if(K){var h=c._calcHostAnchor(A,x,j,K);$=K,c._nextChangeEdgeHost={type:x,host:K},R=h}}var l,T,F,B=!1;if(U||R.x===_)(R.percent!==_||R.index!==_)&&(B=!0,T=R.point);else{var v=c._interactor.getStyle("anchorRound"),G=c._interactor.getStyle("anchorSensitivity");l=J.calculateAttachPoint($,j),l?(R=l.info,B=!0):(k&&(R=c._calcHostAnchor(A,x,wf.toWorldPosition(J,k),$)),R.x=wf.roundTo(R.x,v,G),R.y=wf.roundTo(R.y,v,G)),T=rk(J,$,0,R.offsetX||0,R.offsetY||0,R.x,R.y)}T&&(F=wf.toScreenPosition(J,T),W.x=F.x,W.y=F.y),c._edgeHostGuideInfo={corners:wf.getTargetCornersOnScreen(J,$),attach:l?l.index:-1,host:$};var y;return R.percent!==_?y="percent: "+R.percent.toFixed(2):R.index!==_?y="index: "+R.index:(y=""+R.x.toFixed(2)+", "+R.y.toFixed(2),(R.offsetX||R.offsetY)&&(y+=" offset: "+R.offsetX.toFixed(2)+", "+R.offsetY.toFixed(2))),{host:$,anchor:R,tipText:y,isFixed:B}}},Mn.prototype._guidingToEdit=function(c,l){var P,A,D=this;if(P=D.screenInfo.curve){A=P._curves;var $,J,C,L,n,f,V,T,F=1/0,R=1/0,z=[];for(D.editing&&"realPoint"===D.editing.type&&(T=D.editing.point),n=0,f=2*A.length;f>n;n++)V=A[Math.floor(n/2)][n%2?"_p4":"_p1"],z.indexOf(V)>=0||(z.push(V),T&&T===V||(C=V.x-c.x,L=V.y-c.y,Math.abs(C)<Math.abs(F)?(F=C,$=[V]):C===F&&$.push(V),Math.abs(L)<Math.abs(R)?(R=L,J=[V]):L===R&&J.push(V)));var b=D._interactor.getStyle("smartGuideThreshold");if((Math.abs(F)>b||"y"===l)&&($=null),(Math.abs(R)>b||"x"===l)&&(J=null),$||J){var U=!1,x={};if($&&(U=!0,x.xList=$,x.x=F),J&&(U=!0,x.yList=J,x.y=R),U)return x}}},Mn.prototype._46O=function(t){var l=this;l.editing&&(l.editing=null,l._interactor.fi({kind:"endEditPoint",event:t})),l._guideInfo=null,l._edgeHostGuideInfo=null,l._pan&&(l._pan=null,l._interactor.fi({kind:"endPan",event:t})),l._multiSelect&&(l._handleMultiSelect(l._multiSelect,t),l._multiSelect=null),l.tipInfo=null,l.edgeEditResult=null},Mn.prototype._handleMultiSelect=function(O,W){if(O.startPoint&&O.endPoint){var h,H,j,k,N,x,z=this,T=z._interactor,c=T.gv,M=wf.toScreenPosition(c,O.startPoint),u=wf.toScreenPosition(c,O.endPoint),Y=A.Default.unionPoint(M,u),S=z.screenInfo.curve._curves,B=[],n=function(y){y.x>=Y.x&&y.y>=Y.y&&y.x<=Y.x+Y.width&&y.y<=Y.y+Y.height&&B.indexOf(y)<0&&B.push(y)};for(h=0,H=S.length;H>h;h++)N=S[h],n(N._p1),n(N._p4);if(B.length){var I=z.activing||{},g=I.selections||[];I.point&&g.push(I.point);var r=A.Default.isShiftDown(W),Z=W.altKey;if(Z&&!r)for(x=B,B=[],h=0,H=x.length;H>h;h++)j=x[h],k=g.indexOf(j),k>=0&&B.push(j);for(h=0,H=g.length;H>h;h++)j=g[h],k=B.indexOf(j),k>=0?(!r||r&&Z)&&(B[k]=_):B.push(j);for(x=B,B=[],h=0,H=x.length;H>h;h++)x[h]&&B.push(x[h]);H=B.length,0===H?z.activing=null:1===H?z.activing={point:B[0]}:(j=B[H-1],z.activing={point:j,selections:B.splice(0,H-1)}),T.redraw()}}},Mn.prototype._canDeletePoint=function(_,$){var F=this.target;if(!(F instanceof A.Edge))return!0;var H=_._curves[0],n=_._curves[_._curves.length-1];return H._p1===$||n._p4===$?!1:!0},Mn.prototype.handleDelete=function(){var q=this;if(q.activing&&q.screenInfo){var v=A.Default.isShiftDown(),g=q.screenInfo.curve;q._canDeletePoint(g,q.activing.point)&&g.deleteRealPoint(q.activing.point,v),q.activing.selections&&q.activing.selections.forEach(function(s){q._canDeletePoint(g,s)&&g.deleteRealPoint(s,v)}),q.activing=null,delete q.editing,delete q.tipInfo,delete q.edgeEditResult,delete q._pan,delete q._multiSelect,q._writeToHt(),q._interactor.fp("deleteShapePoint",!1,!0)}},Mn.prototype.handleDoubleClick=function(G){var y=this,u=y._interactor._getLogicalPoint(G);if(y.screenInfo&&y._checkEditRealPoint(u)){var i=y.getCurrentSelectintStatus(),R=wf.Curve.PointType;return i=i===R.Mirrored?R.Straight:R.Mirrored,y._setCurrentSelectionStatus(i),y._interactor._42(),!0}},Mn.prototype._drawHighlight=function(N){var O=this,f=O.highlight;if(f){var V=f.bezier,n=O._interactor;V&&wf.Icons.DrawIcon(n,N,wf.Icons.ShapeHighlightCurve,[V._p1.x,V._p1.y,V._p2.x,V._p2.y,V._p3.x,V._p3.y,V._p4.x,V._p4.y]);var J=f.point;J&&"insertKnot"===f.type&&wf.Icons.DrawIcon(n,N,wf.Icons.ShapeHighlighPoint,J)}},Mn.prototype._drawGuide=function(E){var o=this,Z=o._guideInfo;if(Z){var M,g,I,N,K=Z.v;for(M=0;2>M;M++)if(N=0===M?Z.xList:Z.yList)for(g=0,I=N.length;I>g;g++)wf.Icons.DrawIcon(o._interactor,E,wf.Icons.ShapeGuideLine,[K.x,K.y,N[g].x,N[g].y])}},Mn.prototype._drawCurrentPoint=function(y){var t=this;if(t.activing){var b=t.activing,_=t.getCurrentSelectintStatus(),W=t._interactor;if(_!==wf.Curve.PointType.Straight){var N=b.pairs;b.hlpair,b.hltype;var B=b.selections,x=b.editingCtrl;if(N&&!B){var j,Z,S;for(Z=0,S=N.length;S>Z;Z++)j=N[Z],x&&Z===x.pairId&&j[x.type]?wf.Icons.DrawIcon(W,y,wf.Icons.ShapeActivingCtrl,{point:j.point,c1:j.c1,c2:j.c2,hl:x.type}):wf.Icons.DrawIcon(W,y,wf.Icons.ShapeActivingCtrl,j)}}wf.Icons.DrawIcon(W,y,wf.Icons.ShapeHighlighRealPoint,t.activing.point),B&&B.forEach(function(e){wf.Icons.DrawIcon(W,y,wf.Icons.ShapeHighlighRealPoint,e)})}},Mn.prototype.clear=function(){var V=this;V.editing=null,V._guideInfo=null,V.activing=null,V.highlight=null},Mn.prototype._42=function(V){var v=this;v.info={},v.editing||(v.screenInfo=null);var w=v._interactor;if(!w.editDetail)return v.clear(),void 0;var E=w.gv;if(!v.target||!E.isSelected(v.target)||!E.isVisible(v.target))return w.editDetail=!1,v.clear(),void 0;if(v.gatherSingleTarget(E,v.target),wf.Icons.DrawIcon(w,V,wf.Icons.ShapeBgCurve,v.screenInfo),v._interactor.getStyle("curveElevationVisible")&&(v.target instanceof A.Polyline||v.target instanceof A.Edge&&v._interactor.getStyle("edgeElevationEditable"))&&v.activing){var a=v.activing.getCurrentEditingPoint();a&&"string"!=typeof a.e&&wf.Icons.DrawIcon(w,V,wf.Icons.EdgeElevationGuide,a)}if(v._drawHighlight(V),v._drawCurrentPoint(V),v._getRealPoint().forEach(function(n){wf.Icons.DrawIcon(w,V,wf.Icons.ShapePoint,n)}),v._drawGuide(V),v.tipInfo&&v._interactor.getStyle("curveTipVisible")&&wf.Icons.DrawIcon(w,V,wf.Icons.TipHelper,v.tipInfo),v._edgeHostGuideInfo&&w._drawHostGuide(v._edgeHostGuideInfo),v.edgeEditResult&&v._drawEdgeHostHighlight(V,v.edgeEditResult.host,v.edgeEditResult.anchor),v._multiSelect&&v._multiSelect.endPoint){var I=A.Default.unionPoint(wf.toScreenPosition(E,v._multiSelect.startPoint),wf.toScreenPosition(E,v._multiSelect.endPoint));I.color=E.getRectSelectBorderColor(),V.save(),V.setTransform(1,0,0,1,0,0);var i=z.devicePixelRatio,t=I.borderWidth=Math.round(i);t/=2,I.x=Math.round(I.x*i)+t,I.y=Math.round(I.y*i)+t,I.width=Math.round(I.width*i),I.height=Math.round(I.height*i),wf.Icons.DrawIcon(w,V,wf.Icons.SimpleRect,I),V.restore()}},Mn.prototype._drawEdgeHostHighlight=function(f,V,n){this.drawEdgeHostHighlight(f,V,n),this._interactor.redraw()},Mn.prototype.drawEdgeHostHighlight=function(I,X,H){if(Rn(X)){var j,b,f,x,P=this,w=P._interactor,W=w.gv,V=W.getDataUI(X),k=tr(V),E=[];for(f=0,x=k.points.length;x>f;f++)b=wf.toScreenPosition(W,k.points.get(f)),E.push(b.x,b.y);k.segments&&(j=k.segments.toArray());var r=w.getStyle("edgeHostHighlighPeriod"),g=w.getStyle("edgeHostEdgeHighlighColor");wf.Icons.DrawIcon(w,I,wf.Icons.ShapeBgCurve,{P:E,S:j,color:g,dynamicVisible:H.index===_,dynamicPeriod:r}),g=w.getStyle("edgeHostPointHighlighColor");var S=sb(V);for(f=0,x=S.length;x>f;f++){var Q=S[f],A=wf.toScreenPosition(W,Q);wf.Icons.DrawIcon(w,I,wf.Icons.ShapePoint,{point:{x:A.x,y:A.y},color:g,size:12,dynamicVisible:f===H.index,dynamicPeriod:r})}}},Mn.prototype._getRealPoint=function(){var z,R=this.screenInfo,s=R.P,J=R.S,M=-1,V=[],Z=-1,N=J.length;return J.each(function(X){Z++;var P=1;if(3===X)P=2;else if(4===X)P=3;else if(5===X)return;M+=P,z=Z+1>=N?!0:1===J.get(Z+1)?!0:!1,V.push({point:{x:s[2*M],y:s[2*M+1]},segmentIndex:Z,pointIndex:M,isEnd:z})}),V},Mn.prototype.getEditingPointsInfo=function(c){var _=this,x=_.activing;if(!x)return!1;var I=x.point;if(!I)return!1;var n=this._getRealPoint(),Q=[{screen:I}];x.selections&&x.selections.forEach(function(W){Q.push({screen:W})});var s,j,R=n.length;return Q.forEach(function(u){for(s=0;R>s;s++)if(j=n[s],u.screen.isNearEnough(j.point)){u.segmentIndex=j.segmentIndex,u.pointIndex=j.pointIndex,u.point=_.target.getPoints().get(j.pointIndex);break}}),c&&Q.sort(function(B,c){return B.segmentIndex-c.segmentIndex}),Q};var af=wf.MoveHelper=function(q){var w=this;w.catalog="Move",w._interactor=q};af.prototype={},af.prototype.constructor=af,af.prototype.calcShift=function(H,V,X){var w,E,f=this,c=f._interactor.gv,G=c.lp(V);if("beginMove"===H&&f._gatherGridInfo(X._lastLogicalPoint||G),w=f._target){var u=w.downPosition;if(u){var I=f._interactor.getStyle("moveSensitivity")/c._zoom;if(u.distanceTo(G)<I)return{x:0,y:0};delete w.downPosition}var M;E=A.Default.isShiftDown(V),E&&(G=f._dealShiftDown(G),M=w.shiftGuide.dir);var J,T=w.rawPos={x:w.pos.x+G.x-w.lp.x,y:w.pos.y+G.y-w.lp.y};if(A.Default.isCtrlDown(V)){if(J=f._calcShiftByAddon(),f._target.node instanceof wf.Group){var $=f._target.node;$._position.x+=J.x,$._position.y+=J.y}return J}var z=f._interactor.rectGuide;if(w.node instanceof A.Data&&w.node.s("2d.attachable")){var b=f._calcAttachNodeShift(w.node,T);if(z.clear(),b)return b}for(var q,r=w.x+T.x,B=w.y+T.y,C={x:r,y:B},p={x:r+w.w/2,y:B+w.h/2},o={x:r+w.w,y:B+w.h},S=f._interactor.gridGuide,K=[z.findClosest(C,M),z.findClosest(p,M),z.findClosest(o,M),S.findClosest(C,M),S.findClosest(p,M),S.findClosest(o,M)],l=1/0,t=1/0,R=0,d=K.length;d>R;R++)q=K[R],q&&(r=q.x,B=q.y,isFinite(r)&&Math.abs(r)<Math.abs(l)&&(l=r),isFinite(B)&&Math.abs(B)<Math.abs(t)&&(t=B));if(isFinite(l)||(l=0),isFinite(t)||(t=0),J=f._calcShiftByAddon(l,t),f._target.node instanceof wf.Group){var $=f._target.node;$._position.x+=J.x,$._position.y+=J.y}var m=w.node;if(!os(m,c)){var Y=T.x+l,W=T.y+t;f._interactor.rectGuide.gatherLines({node:m,x:w.x+Y,y:w.y+W,w:w.w,h:w.h},M)}return J}},af.prototype._calcShiftByAddon=function(E,W){var s=this._target,l=s.rawPos,B=s.node.getPosition();return E=E||0,W=W||0,{x:l.x-B.x+E,y:l.y-B.y+W}},af.prototype._dealShiftDown=function($){var Q=this,O=Q._target.shiftGuide,c=Q._target.lp,U=Math.abs($.x-c.x),Z=Math.abs($.y-c.y);U>Z&&U>O.limit&&"y"===O.dir&&(O.dir="x"),Z>U&&Z>O.limit&&"x"===O.dir&&(O.dir="y");var M=O.dir;return"x"===M?($.y=c.y,O.limit=Math.max(O.limit,U)):"y"===M&&($.x=c.x,O.limit=Math.max(O.limit,Z)),$},af.prototype._isAttachableLineShape=function(G){if(!G.getSegments)return!1;var t=G.getSegments();if(!t)return!0;t instanceof A.List&&(t=t.getArray());for(var c=1,i=t.length;i>c;c++)if(2!==t[c])return!1;return!0},af.prototype._calcAttachNodeShift=function(){var R=new gr,i=new gr,c=new gr,l=new gr;return function(x,P){var S=this._interactor.gv,f=x.getHost(),t=S.getDataAt(P,function(y){return y.s("2d.hostable")?!0:!1});if(t&&f!==t&&x.setHost(t),!t)return this._edgeHostGuideInfo=null,x.setHost(null);var D=this._edgeHostGuideInfo={corners:wf.getTargetCornersOnScreen(S,t),host:t,attach:-1};if(this._isAttachableLineShape(t)){for(var r,B,z,u,k,b,$=t.getPoints(),n=$.size(),C=t.getPointsMatrix2d(),Y=1/0,E=0;n>E&&(E!==n-1||t.isClosePath());E++)0!==E?i.copy(c):C.apply($.get(E),i),C.apply(E===n-1?$.get(0):$.get(E+1),c),R.copy(P).sub(i),l.copy(c).sub(i),r=l.length(),l.divideScalar(r),B=R.dot(l),0>B?B=0:B>r&&(B=r),l.multiplyScalar(B).add(i),z=R.copy(P).sub(l).lengthSq(),Y>z&&(Y=z,b=E,u=B,k=r);return Math.sqrt(Y)*S.getZoom()>this._interactor.getStyle("attachThreshold")?(x.s({"attach.index":-1}),x.setHost(null),void 0):(x.s("attach.offset.opposite")&&(u=k-u),x.s({"attach.index":b,"attach.offset":x.s("attach.offset.relative")?u/k:u}),{x:0,y:0})}var q=S.calculateAttachPoint(t,P);if(q){var e=q.point;return D.attach=q.index,this._calcShiftByAddon(e.x-P.x,e.y-P.y)}}}(),af.prototype._gatherGridInfo=function(f){var V,q=this,n=q._interactor,g=n._getValidSelection();if(g.length){if(1===g.length){if(V=g[0],!V.getRect)return q._target=null,void 0}else if(V=wf.Group.findOrCreateGroup(g,n._uuid),!V)return q._target=null,void 0}else{var g=n.gv.sm().getSelection();if(g.length&&(V=g.get(0),!V.getRect))return q._target=null,void 0}if(V){var F=V.getPosition(),p=V.getRect();q._target={node:V,x:p.x-F.x,y:p.y-F.y,w:p.width,h:p.height,lp:{x:f.x,y:f.y},pos:{x:F.x,y:F.y},shiftGuide:{dir:"x",limit:0},downPosition:new wf.Math.Vector2(f)},n.rectGuide.gatherRects()}},af.prototype.clear=function(){var y=this;y._edgeHostGuideInfo=null,y._interactor.rectGuide.clear(),y._interactor._42()},af.prototype._42=function(){var u=this._edgeHostGuideInfo;u&&this._interactor._drawHostGuide(u)};var Bd=j.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),Jg=function(){function J(z,N){var l=_;
return function(){return l||(l=z.getExtension(N)),l}}function G(Y,m){m==_&&(m={}),m.version=p&&(Y instanceof WebGL2RenderingContext||j.prototype.toString.call(Y)===Q)?2:1,m.extensions=function(){for(var q={},n=Y.getSupportedExtensions(),x=n.length;x--;)q[name]=J(Y,n[x]);return q}();for(var A=j.keys(Z),i=0,G=A.length;G>i;++i){var K=A[i];m[K]=Y.getParameter(Z[K])}if(m.version>1){A=j.keys(l);for(var i=0,G=A.length;G>i;++i){var K=A[i];m[K]=Y.getParameter(l[K])}}return m}var p="undefined"!=typeof WebGL2RenderingContext,Q="[object WebGL2RenderingContext]",Z={aliasedLineWidthRange:Bd.ALIASED_LINE_WIDTH_RANGE,aliasedPointSizeRange:Bd.ALIASED_POINT_SIZE_RANGE,maxCombinedTextureImageUnits:Bd.MAX_COMBINED_TEXTURE_IMAGE_UNITS,maxCubeMapTextureSize:Bd.MAX_CUBE_MAP_TEXTURE_SIZE,maxFragmentUniformVectors:Bd.MAX_FRAGMENT_UNIFORM_VECTORS,maxRenderBufferSize:Bd.MAX_RENDERBUFFER_SIZE,maxTextureImageUnits:Bd.MAX_TEXTURE_IMAGE_UNITS,maxTextureSize:Bd.MAX_TEXTURE_SIZE,maxVaryingVectors:Bd.MAX_VARYING_VECTORS,maxVertexAttribs:Bd.MAX_VERTEX_ATTRIBS,maxVertexTextureImageUnits:Bd.MAX_VERTEX_TEXTURE_IMAGE_UNITS,maxVertexUniformVectors:Bd.MAX_VERTEX_UNIFORM_VECTORS,maxViewportDIMs:Bd.MAX_VIEWPORT_DIMS},l={max3DTextureSize:Bd.MAX_3D_TEXTURE_SIZE,maxArrayTextureLayers:Bd.MAX_ARRAY_TEXTURE_LAYERS,maxColorAttachments:Bd.MAX_COLOR_ATTACHMENTS,maxCombinedFragmentUniformComponents:Bd.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,maxCombinedUniformBlocks:Bd.MAX_COMBINED_UNIFORM_BLOCKS,maxCombinedVertexUniformComponents:Bd.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,maxDrawBuffers:Bd.MAX_DRAW_BUFFERS,maxElementIndex:Bd.MAX_ELEMENT_INDEX,maxElementsIndices:Bd.MAX_ELEMENTS_INDICES,maxElementsVertices:Bd.MAX_ELEMENTS_VERTICES,maxFragmentInpuComponents:Bd.MAX_FRAGMENT_INPUT_COMPONENTS,maxFragmentUniformBlocks:Bd.MAX_FRAGMENT_UNIFORM_BLOCKS,maxFragmentUniformComponents:Bd.MAX_FRAGMENT_UNIFORM_COMPONENTS,maxProgramTexelOffset:Bd.MAX_PROGRAM_TEXEL_OFFSET,maxSamples:Bd.MAX_SAMPLES,maxTextureLODBias:Bd.MAX_TEXTURE_LOD_BIAS,maxTransformFeedbackInterleavedComponents:Bd.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,maxTransformFeedbackSeparateAttribs:Bd.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,maxTransformFeedbackSeparateComponents:Bd.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,maxUniformBlockSize:Bd.MAX_UNIFORM_BLOCK_SIZE,maxUniformBufferBindings:Bd.MAX_UNIFORM_BUFFER_BINDINGS,maxVaryingComponents:Bd.MAX_VARYING_COMPONENTS,maxVertexOutputComponents:Bd.MAX_VERTEX_OUTPUT_COMPONENTS,maxVertexUniformBlocks:Bd.MAX_VERTEX_UNIFORM_BLOCKS,maxVertexUniformComponents:Bd.MAX_VERTEX_UNIFORM_COMPONENTS,minProgramTexelOffset:Bd.MIN_PROGRAM_TEXEL_OFFSET};return{"for":function(h){var i=h._info;return i||(h._info=i=G(h,i)),i}}}(),Hg=function(){function k($,X,n){return{def:$,getter:n?function(H){var d=Jg.for(H);return d.version>1?H.getParameter(X):$}:function(j){return j.getParameter(X)},setter:n?function(n,q){var j=Jg.for(n);j.version>1&&n.pixelStorei(X,q)}:function(h,i){h.pixelStorei(X,i)}}}function L(e){return"string"==typeof e?Tj(e):e.r!==_?(D[0]=e.r,D[1]=e.g,D[2]=e.b,D[3]=e.a,D):e.red!==_?(D[0]=e.red,D[1]=e.green,D[2]=e.blue,D[3]=e.alpha,D):e}function I(n){return W(n)?Array.prototype.slice.call(n,0):n}function Z(t,v,e){this.gl=v,this._record=e||{},this._branches={},this._leafSync={},this._struct=t;for(var y=t.children,g=y.length;g--;){var k=y[g],M=k.name;k.isLeaf?(this._leafSync[M]=!1,this._record[M]=I(k.desc.def)):this._record[M]={}}}function m(B){function S(u,F){Z.call(this,B,u,F);for(var g=y.length;g--;){var b=y[g];this._branches[b._name]=new b._type(u,this._record[b._name])}}function t(d,f){function $(X,m){for(var J=I,a=!1;J--;)X[J]!==m[J]&&(X[J]=m[J],a=!0);return a}var o=d.name,O=W(d.desc.def),I=O&&d.desc.def.length;if(d.isLeaf){var x=d.desc.setter,L=d.desc.parse;j.defineProperty(f,o,{configurable:!1,enumerable:!0,get:function(){return this._record[o]},set:O?function(E){L&&(E=L(E)),($(this._record[o],E)||!this._leafSync[o])&&(x(this.gl,this._record[o]),this._leafSync[o]=!0)}:function(L){this._record[o]===L&&this._leafSync[o]||(x(this.gl,L),this._record[o]=L,this._leafSync[o]=!0)}})}else y.push({_name:o,_type:m(d)}),j.defineProperty(f,o,{configurable:!1,enumerable:!0,get:function(){return this._branches[o]},set:function(M){this._branches[o].apply(M)}})}var y=[];return U(S,Z),B.forEach(t,S.prototype),S}var D="undefined"!=typeof Float32Array&&new Float32Array(4),h={viewport:{def:[0,0,0/0,0/0],getter:function(V){return V.getParameter(V.VIEWPORT)},setter:function(K,L){var e=L[2]!==L[2]?K.drawingBufferWidth-L[0]:L[2],N=L[3]!==L[3]?K.drawingBufferHeight-L[1]:L[3];K.viewport(L[0],L[1],e,N)}},dither:{def:!1,getter:function(i){return i.isEnabled(i.DITHER)},setter:function(Q,x){x?Q.enable(Q.DITHER):Q.disable(Q.DITHER)}},rasterizerDiscard:{def:!1,getter:function(n){var m=Jg.for(n);return m.version>1&&n.isEnabled(n.RASTERIZER_DISCARD)},setter:function(b,i){var W=Jg.for(b);1!==W.version&&(i?b.enable(b.RASTERIZER_DISCARD):b.disable(b.RASTERIZER_DISCARD))}},lineWidth:{def:1,getter:function(Y){return Y.lineWidth?Y.getParameter(Y.LINE_WIDTH):1},setter:function(q,e){q.lineWidth&&q.lineWidth(e)}},color:{clear:{def:[0,0,0,0],getter:function(L){return L.getParameter(L.COLOR_CLEAR_VALUE)},setter:function(A,p){A.clearColor(p[0],p[1],p[2],p[3])},parse:L},mask:{def:[!0,!0,!0,!0],getter:function(d){return d.getParameter(d.COLOR_WRITEMASK)},setter:function(T,p){T.colorMask(p[0],p[1],p[2],p[3])}}},blend:{enabled:{def:!1,getter:function(k){return k.isEnabled(k.BLEND)},setter:function(L,P){P?L.enable(L.BLEND):L.disable(L.BLEND)}},color:{def:[0,0,0,0],getter:function(V){return V.getParameter(V.BLEND_COLOR)},setter:function(z,T){z.blendColor(T[0],T[1],T[2],T[3])},parse:L},equation:{def:[Bd.FUNC_ADD,Bd.FUNC_ADD],getter:function(S){return[S.getParameter(S.BLEND_EQUATION_RGB),S.getParameter(S.BLEND_EQUATION_ALPHA)]},setter:function(b,O){b.blendEquationSeparate(O[0],O[1])},parse:function(N){var _=N.length;return _>1?N:1===_?(D[1]=D[0]=N[0],D):(D[1]=D[0]=N,D)}},func:{def:[Bd.ONE,Bd.ZERO,Bd.ONE,Bd.ZERO],getter:function(e){return[e.getParameter(e.BLEND_SRC_RGB),e.getParameter(e.BLEND_DST_RGB),e.getParameter(e.BLEND_SRC_ALPHA),e.getParameter(e.BLEND_DST_ALPHA)]},setter:function(O,n){O.blendFuncSeparate(n[0],n[1],n[2],n[3])},parse:function(G){var I=G.length;return I>3?G:(D[2]=D[0]=G[0],D[3]=D[1]=G[1],D)}}},cullFace:{enabled:{def:!1,getter:function(p){return p.isEnabled(p.CULL_FACE)},setter:function(z,F){F?z.enable(z.CULL_FACE):z.disable(z.CULL_FACE)}},mode:{def:Bd.BACK,getter:function(e){return e.getParameter(e.CULL_FACE_MODE)},setter:function(j,w){j.cullFace(w)}},frontFace:{def:Bd.CCW,getter:function(U){return U.getParameter(U.FRONT_FACE)},setter:function(m,i){m.frontFace(i)}}},scissor:{enabled:{def:!1,getter:function(w){return w.isEnabled(w.SCISSOR_TEST)},setter:function(s,K){K?s.enable(s.SCISSOR_TEST):s.disable(s.SCISSOR_TEST)}},box:{def:[0,0,0/0,0/0],getter:function(J){return J.getParameter(J.SCISSOR_BOX)},setter:function(e,n){var J=n[2]!==n[2]?e.drawingBufferWidth-n[0]:n[2],R=n[3]!==n[3]?e.drawingBufferHeight-n[1]:n[3];e.scissor(n[0],n[1],J,R)}}},depth:{enabled:{def:!1,getter:function(u){return u.isEnabled(u.DEPTH_TEST)},setter:function(j,m){m?j.enable(j.DEPTH_TEST):j.disable(j.DEPTH_TEST)}},clear:{def:1,getter:function(c){return c.getParameter(c.DEPTH_CLEAR_VALUE)},setter:function(N,B){N.clearDepth(B)}},mask:{def:!0,getter:function(w){return w.getParameter(w.DEPTH_WRITEMASK)},setter:function(y,$){y.depthMask($)}},range:{def:[-1,1],getter:function(N){return N.getParameter(N.DEPTH_RANGE)},setter:function(H,k){H.depthRange(k[0],k[1])}},func:{def:Bd.LESS,getter:function(Y){return Y.getParameter(Y.DEPTH_FUNC)},setter:function(q,i){q.depthFunc(i)}}},stencil:{enabled:{def:!1,getter:function(R){return R.isEnabled(R.STENCIL_TEST)},setter:function(m,D){D?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST)}},clear:{def:0,getter:function(u){return u.getParameter(u.STENCIL_CLEAR_VALUE)},setter:function(k,z){k.clearStencil(z)}},frontMask:{def:255,getter:function(L){return L.getParameter(L.STENCIL_WRITEMASK)},setter:function(k,W){k.stencilMaskSeparate(k.FRONT,W)}},frontOp:{def:[Bd.KEEP,Bd.KEEP,Bd.KEEP],getter:function(r){return[r.getParameter(r.STENCIL_FAIL),r.getParameter(r.STENCIL_PASS_DEPTH_FAIL),r.getParameter(r.STENCIL_PASS_DEPTH_PASS)]},setter:function(y,q){y.stencilOpSeparate(y.FRONT,q[0],q[1],q[2])}},frontFunc:{def:[Bd.ALWAYS,0,255],getter:function(f){return[f.getParameter(f.STENCIL_FUNC),f.getParameter(f.STENCIL_REF),f.getParameter(f.STENCIL_VALUE_MASK)]},setter:function(s,q){s.stencilFuncSeparate(s.FRONT,q[0],q[1],q[2])}},backMask:{def:255,getter:function(o){return o.getParameter(o.STENCIL_BACK_WRITEMASK)},setter:function(l,C){l.stencilMaskSeparate(l.BACK,C)}},backOp:{def:[Bd.KEEP,Bd.KEEP,Bd.KEEP],getter:function(T){return[T.getParameter(T.STENCIL_BACK_FAIL),T.getParameter(T.STENCIL_BACK_PASS_DEPTH_FAIL),T.getParameter(T.STENCIL_BACK_PASS_DEPTH_PASS)]},setter:function(m,Q){m.stencilOpSeparate(m.BACK,Q[0],Q[1],Q[2])}},backFunc:{def:[Bd.ALWAYS,0,255],getter:function(g){return[g.getParameter(g.STENCIL_BACK_FUNC),g.getParameter(g.STENCIL_BACK_REF),g.getParameter(g.STENCIL_BACK_VALUE_MASK)]},setter:function(p,E){p.stencilFuncSeparate(p.BACK,E[0],E[1],E[2])}}},hint:{generateMipmap:{def:Bd.DONT_CARE,getter:function(X){return X.getParameter(X.GENERATE_MIPMAP_HINT)},setter:function(M,l){M.hint(M.GENERATE_MIPMAP_HINT,l)}},fragmentShaderDerivative:{def:Bd.DONT_CARE,getter:function(o){var Q=Jg.for(o);return 1!==Q.version||Q.extensions.OES_standard_derivatives?o.getParameter(Bd.FRAGMENT_SHADER_DERIVATIVE_HINT):Bd.DONT_CARE},setter:function(C,L){var m=Jg.for(C);return m.version>1||m.extensions.OES_standard_derivatives?(C.hint(Bd.FRAGMENT_SHADER_DERIVATIVE_HINT,L),void 0):void 0}}},pixelStore:{packAlignment:k(4,Bd.PACK_ALIGNMENT,!1),unpackAlignment:k(4,Bd.UNPACK_ALIGNMENT,!1),unpackFlipY:k(!1,Bd.UNPACK_FLIP_Y_WEBGL,!1),unpackPremultiplyAlpha:k(!1,Bd.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),unpackColorspaceConversion:k(Bd.BROWSER_DEFAULT_WEBGL,Bd.UNPACK_COLORSPACE_CONVERSION_WEBGL,!1),packRowLength:k(0,Bd.PACK_ROW_LENGTH,!0),packSkipPixels:k(0,Bd.PACK_SKIP_PIXELS,!0),packSkipRows:k(0,Bd.PACK_SKIP_ROWS,!0),unpackRowLength:k(0,Bd.UNPACK_ROW_LENGTH,!0),unpackImageHeight:k(0,Bd.UNPACK_IMAGE_HEIGHT,!0),unpackSkipPixels:k(0,Bd.UNPACK_SKIP_PIXELS,!0),unpackSkipRows:k(0,Bd.UNPACK_SKIP_ROWS,!0),unpackSkipImages:k(0,Bd.UNPACK_SKIP_IMAGES,!0)},polygonOffset:{enabled:{def:!1,getter:function(T){return T.isEnabled(T.POLYGON_OFFSET_FILL)},setter:function(E,Y){Y?E.enable(E.POLYGON_OFFSET_FILL):E.disable(E.POLYGON_OFFSET_FILL)}},value:{def:[0,0],getter:function(h){return[h.getParameter(h.POLYGON_OFFSET_FACTOR),h.getParameter(h.POLYGON_OFFSET_UNITS)]},setter:function(n,y){n.polygonOffset(y[0],y[1])}}},sampleCoverage:{enabled:{def:!1,getter:function(n){return n.isEnabled(n.SAMPLE_COVERAGE)},setter:function(I,O){O?I.enable(I.SAMPLE_COVERAGE):I.disable(I.SAMPLE_COVERAGE)}},alpha:{def:!1,getter:function(k){return k.isEnabled(k.SAMPLE_ALPHA_TO_COVERAGE)},setter:function(o,C){C?o.enable(o.SAMPLE_ALPHA_TO_COVERAGE):o.disable(o.SAMPLE_ALPHA_TO_COVERAGE)}},value:{def:[1,!1],getter:function(p){return[p.getParameter(p.SAMPLE_COVERAGE_VALUE),p.getParameter(p.SAMPLE_COVERAGE_INVERT)]},setter:function(e,c){e.sampleCoverage(c[0],c[1])}}}},M=Af.create(h,function(G){return"def"in G});Z.prototype.reset=function(){for(var d=this._struct.children,M=d.length;M--;){var t=d[M],s=t.name;t.isLeaf?this[s]=t.desc.def:this._branches[s].reset()}},Z.prototype.save=function(p){p==_&&(p={});for(var Z=this._struct.children,T=Z.length;T--;){var t=Z[T],C=t.name;if(t.isLeaf)p[C]=I(this._record[C]);else{var O=p[C];O==_&&(p[C]=O={}),this._branches[C].save(O)}}return p},Z.prototype.sync=function(W,r){for(var z=this._struct.children,o=z.length;o--;){var I=z[o],C=I.name;I.isLeaf?(r||!this._leafSync[C])&&(W?(this._record[C]=I.desc.getter(this.gl),this._leafSync[C]=!0):(I.desc.setter(this.gl,this._record[C]),this._leafSync[C]=!0)):this._branches[C].sync(W,r)}},Z.prototype.syncLoss=function(){for(var S=this._struct.children,E=S.length;E--;){var R=S[E];R.isLeaf?this._leafSync[R.name]=!1:this._branches[R.name].syncLoss()}},Z.prototype.apply=function(o){for(var L=this._struct.children,h=L.length;h--;){var g=L[h],k=g.name;k in o&&(g.isLeaf?this[k]=o[k]:this._branches[k].apply(o[k]))}},Z.prototype.append=function(i){var w=this._struct.childMap;for(var N in i){var l=w[N];l&&(l.isLeaf?this[N]=i[N]:this._branches[N].append(i[N]))}};var i=m(M);return function(I){var C=I._state;return C||(I._state=C=new i(I)),C}}(),od=function(){function C(E,U,j,Q){if(E){var R=E.length;if(R!=_)for(var F=0;Q>F;++F)U[j+F]=E[F];else E.toArray&&E.toArray(U,j)}else for(var F=0;Q>F;++F)U[j+F]=0}function z(Y,K,I){var A=Y[0];if(0>=A||A>0)return Y;var o=K*I,p=h[o];if(p==_&&(h[o]=p=new Float32Array(o)),0!==K){C(A,p,0,I);for(var $=1,N=0;$!==K;++$)N+=I,C(Y[$],p,N,I)}return p}function D(J,K){J.uniform1f(this.addr,K)}function M(D,I){D.uniform1fv(this.addr,I)}function v(P,V){if(V.x!=_)P.uniform2f(this.addr,V.x,V.y);else{var i=h[2];i.set(V,0),P.uniform2fv(this.addr,i)}}function p($,a){$.uniform2fv(this.addr,z(a,this.size,2))}function G(y,x){if(x.x!=_)y.uniform3f(this.addr,x.x,x.y,x.z);else if(x.r!=_)y.uniform3f(this.addr,x.r,x.g,x.b);else if(x.red!=_)y.uniform3f(this.addr,x.red,x.green,x.blue);else{var G=h[3];G.set(x,0),y.uniform3fv(this.addr,G)}}function O(O,V){O.uniform3fv(this.addr,z(V,this.size,3))}function e(H,i){if("string"==typeof i&&(i=Tj(i)),i.x!=_)H.uniform4f(this.addr,i.x,i.y,i.z,i.w);else if(i.r!=_)H.uniform4f(this.addr,i.r,i.g,i.b,i.a);else if(i.red!=_)H.uniform4f(this.addr,i.red,i.green,i.blue,i.alpha);else{var v=h[4];v.set(i,0),H.uniform4fv(this.addr,v)}}function o(N,s){N.uniform4fv(this.addr,z(s,this.size,4))}function x(c,K){c.uniform1i(this.addr,K)}function P(S,b){S.uniform1iv(this.addr,b)}function c(f,J){f.uniform2iv(this.addr,J)}function V(P,$){P.uniform3iv(this.addr,$)}function K(G,H){G.uniform4iv(this.addr,H)}function k(Z,y){Z.uniform1i(this.addr,I[y?1:0])}function A(D,Y){var i=h[4];i.set(Y,0),D.uniformMatrix2fv(this.addr,!1,i)}function y(B,U){B.uniformMatrix2fv(this.addr,!1,z(U,this.size,4))}function $(V,q){var Y=h[9];Y.set(q,0),V.uniformMatrix3fv(this.addr,!1,Y)}function n(n,$){n.uniformMatrix3fv(this.addr,!1,z($,this.size,9))}function H(k,o){var f=h[16];f.set(o,0),k.uniformMatrix4fv(this.addr,!1,f)}function W(P,J){P.uniformMatrix4fv(this.addr,!1,z(J,this.size,16))}function q(y,L){y.uniform1i(this.addr,this.slots[0]),y.activeTexture(y.TEXTURE0+this.slots[0]),y.bindTexture(y.TEXTURE_2D,L||y._emptyTexture)}function i(G,S){G.uniform1iv(this.addr,this.slots);for(var H=this.slots.length;H--;)G.activeTexture(G.TEXTURE0+this.slots[H]),G.bindTexture(G.TEXTURE_2D,S[H]||G._emptyTexture)}function l(y,w){y.uniform1i(this.addr,this.slots[0]),y.activeTexture(y.TEXTURE0+this.slots[0]),y.bindTexture(y.TEXTURE_CUBE_MAP,w||y._emptyCubeTexture)}function Q(p,M){p.uniform1iv(this.addr,this.slots);for(var W=this.slots.length;W--;)p.activeTexture(p.TEXTURE0+this.slots[W]),p.bindTexture(p.TEXTURE_CUBE_MAP,M[W]||p._emptyCubeTexture)}function R(O,M,R){X[O]=[M,R]}function t(X,M,v){switch(X.type){case 35678:case 35680:if("uSampler"===v)return[0];if("uBlendSampler"===v)return[1];for(var w=X.size,A=new Int32Array(w),T=0;w>T;++T)A[T]=M.usedTextureSlot++;return A}return _}function J(F,h,s,T,A){this.name=F,this.addr=h,this.size=T?s.size:0,this.activeInfo=s,this.setter=X[s.type][T?1:0],this.slots=t(s,A,F),rr(this)}function f(y,t,z,Y){var Q=y.name,W=Q.length;for(Z.lastIndex=0;;){var c=Z.exec(Q),M=Z.lastIndex,L=c[1],r="]"===c[2],n=c[3];if(r&&(L=0|L),n===_||"["===n&&M+2===W){z[L]=new J(L,t,y,n!==_,Y);break}var p=z[L];p==_&&(z[L]=p={}),z=p}}function r(Z,Q,f){this.gl=Q,this._program=f,this._leaves={},this._branches={},this._struct=Z}function T(E){function o(P,K){r.call(this,E,P,K);for(var J=C.length;J--;){var d=C[J];this._branches[d._name]=new d._type(P,K)}this.uuid=ym.generateUUID()}function P($,z){var q=$.name;if($.isLeaf){var d=N("d.setter(this.gl, v);",["v"],["d"],[$.desc]);j.defineProperty(z,q,{configurable:!1,enumerable:!0,get:function(){return d},set:d})}else C.push({_name:q,_type:T($)}),j.defineProperty(z,q,{configurable:!1,enumerable:!0,get:function(){return this._branches[q]},set:function(r){this._branches[q].apply(r)}})}var C=[];return U(o,r),E.forEach(P,o.prototype),o}function u(K,e){for(var k=K.getProgramParameter(e,K.ACTIVE_UNIFORMS),g={},l={usedTextureSlot:2};k--;){var b=K.getActiveUniform(e,k),o=b.name,a=K.getUniformLocation(e,o);f(b,a,g,l)}var $=Af.create(g,function(i){return"addr"in i}),V=T($);return j.defineProperty(V.prototype,"textureCount",{configurable:!1,enumerable:!1,writable:!1,value:l.usedTextureSlot}),new V(K,e)}var h=[];if("function"==typeof Float32Array)for(var S=1;17>S;++S)h[S]=new Float32Array(S);var I=[0,1],X=[];R(Bd.FLOAT,D,M),R(Bd.FLOAT_VEC2,v,p),R(Bd.FLOAT_VEC3,G,O),R(Bd.FLOAT_VEC4,e,o),R(Bd.INT,x,P),R(Bd.INT_VEC2,c,c),R(Bd.INT_VEC3,V,V),R(Bd.INT_VEC4,K,K),R(Bd.BOOL,k,P),R(Bd.BOOL_VEC2,c,c),R(Bd.BOOL_VEC3,V,V),R(Bd.BOOL_VEC4,K,K),R(Bd.FLOAT_MAT2,A,y),R(Bd.FLOAT_MAT3,$,n),R(Bd.FLOAT_MAT4,H,W),R(Bd.SAMPLER_2D,q,i),R(Bd.SAMPLER_CUBE,l,Q);var Z=/([\w\d_]+)(\])?(\[|\.)?/g;return r.prototype.apply=function(i){for(var E=this._struct.children,t=E.length;t--;){var e=E[t],K=e.name;K in i&&(e.isLeaf?this[K]=i[K]:this._branches[K].apply(i[K]))}},r.prototype.append=function(d){var h=this._struct.childMap;for(var a in d){var n=h[a];n&&(n.isLeaf?this[a]=d[a]:this._branches[a].append(d[a]))}},function(l,W){var X=W._uniforms;return X||(W._uniforms=X=u(l,W)),X}}(),Dg=function(){function g(p,X,l){X.vertexAttrib1f(p.addr,l)}function R(K,c,M){if(M.x!=_)c.vertexAttrib2f(K.addr,M.x,M.y);else{var m=Y[2];m.set(M,0),c.vertexAttrib2fv(K.addr,m)}}function z(o,V,a){if(a.x!=_)V.vertexAttrib3f(o.addr,a.x,a.y,a.z);else if(a.r!=_)V.vertexAttrib3f(o.addr,a.r,a.g,a.b);else if(a.red!=_)V.vertexAttrib3f(o.addr,a.red,a.green,a.blue);else{var W=Y[3];W.set(a,0),V.vertexAttrib3fv(o.addr,W)}}function D(e,C,B){if("string"==typeof B&&(B=Tj(B)),B.x!=_)C.vertexAttrib4f(e.addr,B.x,B.y,B.z,B.w);else if(B.r!=_)C.vertexAttrib4f(e.addr,B.r,B.g,B.b,B.a);else if(B.red!=_)C.vertexAttrib4f(e.addr,B.red,B.green,B.blue,B.alpha);else{var K=Y[4];K.set(B,0),C.vertexAttrib4fv(e.addr,K)}}function o(C,V,_){_=_.el||_;for(var K=0,q=0;2>K;++K)V.vertexAttrib2f(C.addr,_[q++],_[q++])}function I(L,K,P){P=P.el||P;for(var _=0,j=0;3>_;++_)K.vertexAttrib3f(L.addr,P[j++],P[j++],P[j++])}function s(Z,O,v){v=v.el||v;for(var R=0,n=0;4>R;++R)O.vertexAttrib4f(Z.addr,v[n++],v[n++],v[n++],v[n++])}function A(d,I,z,n,q,E,K){I.bindBuffer(I.ARRAY_BUFFER,z),I.vertexAttribPointer(d.addr,1,n||I.FLOAT,!!q,E||0,K||0),I.bindBuffer(I.ARRAY_BUFFER,null)}function Q(h,H,d,I,E,K,Z){H.bindBuffer(H.ARRAY_BUFFER,d),H.vertexAttribPointer(h.addr,2,I||H.FLOAT,!!E,K||0,Z||0),H.bindBuffer(H.ARRAY_BUFFER,null)}function q(T,d,k,A,Y,R,K){d.bindBuffer(d.ARRAY_BUFFER,k),d.vertexAttribPointer(T.addr,3,A||d.FLOAT,!!Y,R||0,K||0),d.bindBuffer(d.ARRAY_BUFFER,null)}function t(K,i,X,g,p,n,H){i.bindBuffer(i.ARRAY_BUFFER,X),i.vertexAttribPointer(K.addr,4,g||i.FLOAT,!!p,n||0,H||0),i.bindBuffer(i.ARRAY_BUFFER,null)}function F(S,W,I,B,T,w,i){var w=w||4,i=i||0;W.bindBuffer(W.ARRAY_BUFFER,I),W.vertexAttribPointer(S.addr,2,B||W.FLOAT,!!T,w,i),W.vertexAttribPointer(S.addr+1,2,B||W.FLOAT,!!T,w,i+2),W.bindBuffer(W.ARRAY_BUFFER,null)}function V(k,f,M,t,o,z,L){var z=z||9,L=L||0;f.bindBuffer(f.ARRAY_BUFFER,M),f.vertexAttribPointer(k.addr,3,t||f.FLOAT,!!o,z,L),f.vertexAttribPointer(k.addr+1,3,t||f.FLOAT,!!o,z,L+3),f.vertexAttribPointer(k.addr+2,3,t||f.FLOAT,!!o,z,L+6),f.bindBuffer(f.ARRAY_BUFFER,null)}function S(Y,N,o,O,a,U,n){var U=U||16,n=n||0;N.bindBuffer(N.ARRAY_BUFFER,o),N.vertexAttribPointer(Y.addr,4,O||N.FLOAT,!!a,U,n),N.vertexAttribPointer(Y.addr+1,4,O||N.FLOAT,!!a,U,n+4),N.vertexAttribPointer(Y.addr+2,4,O||N.FLOAT,!!a,U,n+8),N.vertexAttribPointer(Y.addr+3,4,O||N.FLOAT,!!a,U,n+12),N.bindBuffer(N.ARRAY_BUFFER,null)}function m(r,K,s){Z[r]=function(d,O,H,P,j,S){this.addr==_||this.addr<0||(O==_||O===!1?d.disableVertexAttribArray(this.addr):Ud(O)===$?(d.enableVertexAttribArray(this.addr),s(this,d,O,H,P,j,S)):(d.disableVertexAttribArray(this.addr),K(this,d,O)))}}function x(e,N,F){this.name=e,this.addr=N,this.activeInfo=F,this.setter=Z[F.type],rr(this)}function K(h,s,E){this.gl=s,this.program=E,this._branches={},this._struct=h}function u(f){function d(w,q){K.call(this,f,w,q);for(var p=$.length;p--;){var k=$[p];this._branches[k._name]=new k._type(w,q)}}function b(y,Y){var v=y.name;if(y.isLeaf){var U=N("d.setter(this.gl, v);",["v"],["d"],[y.desc]);j.defineProperty(Y,v,{configurable:!1,enumerable:!0,get:function(){return U},set:U})}else $.push({_name:v,_type:u(y)}),j.defineProperty(Y,v,{configurable:!1,enumerable:!0,get:function(){return this._branches[v]},set:function(Q){this._branches[v].apply(Q)}})}var $=[];return U(d,K),f.forEach(b,d.prototype),d}function d(Z,z){for(var N=Z.getProgramParameter(z,Z.ACTIVE_ATTRIBUTES),m={};N--;){var C=Z.getActiveAttrib(z,N),$=C.name,B=Z.getAttribLocation(z,$);m[$]=new x($,B,C)}var r=Af.create(m,function(G){return"addr"in G}),M=u(r);return new M(Z,z)}for(var Y=[],f=1;17>f;++f)Y[f]=new _p(f);var Z=[],$="undefined"!=typeof WebGLBuffer&&WebGLBuffer.prototype;return m(Bd.FLOAT,g,A),m(Bd.FLOAT_VEC2,R,Q),m(Bd.FLOAT_VEC3,z,q),m(Bd.FLOAT_VEC4,D,t),m(Bd.FLOAT_MAT2,o,F),m(Bd.FLOAT_MAT3,I,V),m(Bd.FLOAT_MAT4,s,S),K.prototype.disable=function(){for(var U=this._struct.children,g=U.length;g--;){var I=U[g],V=I.name;I.isLeaf?this.gl.disableVertexAttribArray(I.desc.addr):this._branches[V].disable()}},K.prototype.apply=function(S){for(var J=this._struct.children,l=J.length;l--;){var h=J[l],G=h.name;G in S&&(h.isLeaf?this[G]=S[G]:this._branches[G].apply(S[G]))}},K.prototype.append=function(z){var S=this._struct.childMap;for(var u in z){var Q=S[u];Q&&(Q.isLeaf?this[u]=z[u]:this._branches[u].append(z[u]))}},function(n,w){var e=w._attribs;return e||(w._attribs=e=d(n,w)),e}}(),qb=function(V){var i=this;j.defineProperties(this,{gl:{configurable:!1,enumerable:!1,value:V,writable:!1},glState:{configurable:!1,enumerable:!1,value:Hg(V),writable:!1}}),i._currProgram=_,i._currUniforms=_,i._currAttribs=_,i._sync=!0};j.defineProperties(qb.prototype,{program:{configurable:!1,enumerable:!1,get:function(){return this._currProgram},set:function($){var y=this;y._sync&&$===y._currProgram||(y.gl.useProgram($),y._currProgram=$,y._currUniforms=od(y.gl,$),y._currAttribs=Dg(y.gl,$),y._sync=!0)}},uniforms:{configurable:!1,enumerable:!1,get:function(){var y=this;return y._currProgram&&!y._sync&&(y.gl.useProgram(y._currProgram),y._sync=!0),y._currUniforms},set:function(K){var z=this;z._currUniforms&&(z._currProgram&&!z._sync&&(z.gl.useProgram(z._currProgram),this._sync=!0),z._currUniforms.apply(K))}},attribs:{configurable:!1,enumerable:!1,get:function(){var d=this;return d._currProgram&&!d._sync&&(d.gl.useProgram(d._currProgram),d._sync=!0),d._currAttribs},set:function(I){var S=this;S._currUniforms&&(S._currProgram&&!S._sync&&(S.gl.useProgram(S._currProgram),this._sync=!0),S._currAttribs.apply(I))}}}),qb.prototype.useProgram=function(k){var r=this;r._sync&&k===r._currProgram||(r.gl.useProgram(k),r._currProgram=k,r._currUniforms=od(r.gl,k),r._currAttribs=Dg(r.gl,k),r._sync=!0)},qb.prototype.directState=function(){return this.glState},qb.prototype.directUniforms=function(){return this._currUniforms},qb.prototype.directAttribs=function(){return this._currAttribs},qb.prototype.syncLoss=function(){this._sync=!1,this.glState.syncLoss()},qb.for=function(d){var V=d._renderState;return V||(d._renderState=V=new qb(d)),V};var Xk="directional",Dc="point",ds="spot",Ml="light.color",cs=4294967295,Ak=0,Tr={},Ti=[],vk=0,Fe=function($,M){Fp(M)&&Rb.test(M)?Cn($,M):qf(M)&&M.modelType?Kc($,M):M===_?delete Pi[$]:Pi[$]=M},Qr=function(O){return O},jo=function(r){r=z.convertShape3dModelName(r);var u;if(qf(r)){if(r.modelType){if(r.uuid){if(u=Pi[r.uuid])return u}else r.uuid=A.Math.generateUUID();return u===_&&(Gr&&Gr[r.uuid]||Kc(r.uuid,r)),_}return r}return u=Pi[r],r&&u===_&&Rb.test(r)&&(Gr&&Gr[r]||Cn(r,r)),u},he=function(v,r){v.frameStack?v.frameStack.push(r):v.frameStack=[r],v.bindFramebuffer(v.FRAMEBUFFER,r)},Ur=function(d){var T=d.frameStack;if(T){if(T.pop(),T.length)return d.bindFramebuffer(d.FRAMEBUFFER,T[T.length-1]),void 0;d.frameStack=null}d.bindFramebuffer(d.FRAMEBUFFER,null)};Xi(z,{graph3dViewAttributes:I,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:h/60,graph3dViewSortable:!1,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:rs,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewRotateMaxPhi:h,graph3dViewRotateMinPhi:0,graph3dViewShadowDisabled:!0,graph3dViewShadowQuality:"high",graph3dViewShadowIntensity:.3,graph3dViewShadowBias:-.005,graph3dViewShadowRadius:.1,graph3dViewShadowType:"hard",graph3dViewShadowDegreeX:30,graph3dViewShadowDegreeZ:-10,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewSyncEyeWithOrthoWidth:!1,graph3dViewFovy:h/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewDataNumWarningLine:1e4,graph3dViewHeadlightRange:0,graph3dViewHeadlightGroup:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogMode:"linear",graph3dViewFogDensity:5e-4,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dViewEnvmapType:"legacy",graph3dMaxVectorCacheTime:50,graph3dEnvmapCapabilityRequire:8,setShape3dModel:Fe,getShape3dModel:jo,convertShape3dModelName:Qr,getShape3dModelMap:function(){return Pi},getCachedShape3dModelMap:function(){return ve},createMatrix:function(x,c){gc(x)||(x=[x]);for(var e=x.length-1;e>=0;e--){var a=x[e];c=dd(a.mat,a.s3,a.r3,a.rotationMode,a.t3,c)}return c},transformVec:function(Y,E){return xl(Y,E)},glBindFrame:he,glUnbindFrame:Ur,createBoxModel:function(){return{vs:Vf,ns:Cb,uv:lm,is:ap}},createRoundRectModel:function(S,V){return Zl.roundRect(S,V)},createStarModel:function(j,Z){return Zl.star(j,Z)},createRectModel:function(b,L){return Zl.rect(b,L)},createTriangleModel:function(Q,f){return Zl.triangle(Q,f)},createRightTriangleModel:function(a,z){return Zl.rightTriangle(a,z)},createParallelogramModel:function(e,$){return Zl.parallelogram(e,$)},createTrapezoidModel:function(V,h){return Zl.trapezoid(V,h)},createSmoothSphereModel:function(H,u,N,h,z,M,Y){return Df(new po(H,u,N,h,z,M,Y))},createSphereModel:function(c,k,p,R,P,A,J){return c?Zh(c,k,p,R,P,A,J):z.createSmoothSphereModel()},createSmoothConeModel:function(o,r,I,D,u){return Bp(o,r,I,D,u)},createConeModel:function(d,D,K,N,O,k,M,W){return d?Ni(d,D,K,N,O,k,M,W):Bp(k)},createSmoothCylinderModel:function(f,Z,m,S,h,p,D,c){return Df(new kb(f,Z,m,S,h,p,D,c))},createCylinderModel:function(D,P,M,J,r,x,p,T){return D?qp(D,P,M,J,r,x,p,T):uh(x,p)},createSmoothTorusModel:function(O,y,q,v,$,Y){return Df(new vi(O,y,q,v,$,Y))},createTorusModel:function(B,J,G,I,o,O,N,c){return B?fq(B,J,G,I,o,O,N,c):hh(O,N)},createExtrusionModel:function(A,L,g,H,j,G,p,S){return db(A,L,g,H,j,G,p,S)},createSmoothRingModel:function(M,p,_,o,U,Q){for(var D=[],y=0;y<M.length-1;y+=2)D.push({x:M[y],y:M[y+1]});for(M=rb(D,p,_)[0],D=[],y=0;y<M.length;y++){var f=M[y];D.push(new Eb(f.x,0,f.y))}return Df(new Cd(D,Q,o,U))},createTextGeometry:function(J,M){var g=Df(new vj(J,M));if(M.cube)for(var r=pl(g),k=r.min,A=r.max,L=k.x,l=k.y,K=k.z,h=A.x-L||1,F=A.y-l||1,e=A.z-K||1,Q=["vs","top_vs","bottom_vs"],n=0,O=Q.length;O>n;n++){var H=g[Q[n]];if(H)for(var u=0,Z=H.length;Z>u;u+=3)H[u]=(H[u]-L)/h-.5,H[u+1]=(H[u+1]-l)/F-.5,H[u+2]=(H[u+2]-K)/e-.5}return g},loadFontFace:function(O,c){z.xhrLoad(O,function(P){if(!P)return c();var M;try{M=JSON.parse(P)}catch(F){M=JSON.parse(P.substring(65,P.length-2))}Ap.loadFace(M),c&&c(M.familyName.toLowerCase())},c?null:{sync:!0})},getShaderErrorLog:function(){return Ti.join("\n")},createRingModel:function(x,C,c,$,f,g,F,O,B,E){for(var U=[],o=0;o<x.length-1;o+=2)U.push({x:x[o],y:x[o+1]});g=g||z.shapeSide,F=F||0,O=O||g;var X,k,t,J,R,y,L,m,j,s,o,r,h,Z,v,e,Y,q,K=[],u=[],W=B?[]:I,V=B?[]:I,p=E?[]:I,H=E?[]:I,D=$?[]:I,P=$?[]:I,S=f?[]:I,w=f?[]:I,x=rb(U,C,c),i=Pg(x),b=0,G=2*Math.PI/g;return x.forEach(function(M){if(t=M.length,t>1){if(J=M[0],$)for(y=J.x,m=J.y,o=F;O>o;o++)r=o+1,h=o*G,Z=r*G,v=l(h),e=d(h),Y=l(Z),q=d(Z),D.push(v*y,m,-e*y,Y*y,m,-q*y,0,m,0),P.push(.5-.5*v,.5-.5*e,.5-.5*Y,.5-.5*q,.5,.5);for(s=0;t>s;s++){for(R=M[s],y=J.x,L=R.x,m=J.y,j=R.y,X=b/i,b+=Hd(J,R),k=b/i,o=F;O>o;o++)r=o+1,h=o*G,Z=r*G,v=l(h),e=d(h),Y=l(Z),q=d(Z),K.push(v*L,j,-e*L,Y*L,j,-q*L,v*y,m,-e*y,Y*L,j,-q*L,Y*y,m,-q*y,v*y,m,-e*y),u.push(o/g,k,r/g,k,o/g,X,r/g,k,r/g,X,o/g,X),B&&o===F&&(W.push(0,m,0,0,j,0,v*L,j,-e*L,v*L,j,-e*L,v*y,m,-e*y,0,m,0),V.push(0,.5-m,0,.5-j,2*L,.5-j,2*L,.5-j,2*y,.5-m,0,.5-m)),E&&r===O&&(p.push(0,m,0,Y*L,j,-q*L,0,j,0,Y*L,j,-q*L,0,m,0,Y*y,m,-q*y),H.push(1,.5-m,1-2*L,.5-j,1,.5-j,1-2*L,.5-j,1,.5-m,1-2*y,.5-m));J=R}if(f)for(y=J.x,m=J.y,o=F;O>o;o++)r=o+1,h=o*G,Z=r*G,v=l(h),e=d(h),Y=l(Z),q=d(Z),S.push(Y*y,m,-q*y,v*y,m,-e*y,0,m,0),w.push(.5-.5*Y,.5+.5*q,.5-.5*v,.5+.5*e,.5,.5)}}),{vs:K,uv:u,bottom_vs:S,bottom_uv:w,top_vs:D,top_uv:P,from_vs:W,from_uv:V,to_vs:p,to_uv:H}}},!0),Xi(s,{"3d.move.mode":_,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"3d.reflectable":!0,"shape.border.gradient.color":_,"edge.gradient.color":_,"edge.source.t3":_,"edge.target.t3":_,"light.type":Dc,"light.group":0,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":h/4,"light.range":0,"light.exponent":1,"light.intensity":1,"light.mask":cs,"headlight.ambientIntensity":_,"wf.visible":!1,"wf.width":1,"wf.color":lf,"wf.short":!1,"wf.mat":_,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:_,"transparent.mask":!1,brightness:_,"select.brightness":.7,"repeat.uv.length":_,"shadow.cast":!0,"shadow.receive":!0,"3d.clipbox":_,"3d.clipbox.mask":cs,"3d.clipbox.group":0,"effect.flow":!1,"effect.flow.gradient":"spread.horizontal","effect.flow.uvshape":"rect","effect.flow.size":512,"effect.flow.group":0,"effect.flow.intensity":1,"effect.flow.blend":_,"effect.flow.mask":cs,bloom:!1,envmap:0,"envmap.probe":0,roughness:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,"texture.cache":!1,"hide.overlapping.group":_,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.type":"hard","highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","highlight.glow":.8,"highlight.strength":2,"color.empty":[0,0,0,0],"label.face":Pd,"label.t3":_,"label.r3":_,"label.texture.scale":2,"label.rotationMode":zs,"label.light":!1,"label.blend":_,"label.reverse.flip":!1,"label.reverse.color":hd,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Pd,"label2.t3":_,"label2.r3":_,"label2.texture.scale":2,"label2.rotationMode":zs,"label2.light":!1,"label2.blend":_,"label2.reverse.flip":!1,"label2.reverse.color":hd,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Pd,"note.t3":_,"note.r3":_,"note.texture.scale":2,"note.rotationMode":zs,"note.light":!1,"note.blend":_,"note.reverse.flip":!1,"note.reverse.color":hd,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Pd,"note2.t3":_,"note2.r3":_,"note2.texture.scale":2,"note2.rotationMode":zs,"note2.light":!1,"note2.blend":_,"note2.reverse.flip":!1,"note2.reverse.color":hd,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:_,"shape3d.color":Gp,"shape3d.top.color":_,"shape3d.bottom.color":_,"shape3d.from.color":_,"shape3d.to.color":_,"shape3d.image":_,"shape3d.image.projection":_,"shape3d.top.image":_,"shape3d.bottom.image":_,"shape3d.from.image":_,"shape3d.to.image":_,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":_,"shape3d.side.to":_,"shape3d.smooth":_,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":_,"shape3d.opacity":_,"shape3d.reverse.flip":!1,"shape3d.reverse.color":hd,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":_,"shape3d.uv.scale":_,"shape3d.uv.rotation":_,"shape3d.uv.anchor":_,"shape3d.top.uv.offset":_,"shape3d.top.uv.scale":_,"shape3d.top.uv.rotation":_,"shape3d.top.uv.anchor":_,"shape3d.bottom.uv.offset":_,"shape3d.bottom.uv.scale":_,"shape3d.bottom.uv.rotation":_,"shape3d.bottom.uv.anchor":_,"shape3d.from.uv.offset":_,"shape3d.from.uv.scale":_,"shape3d.from.uv.rotation":_,"shape3d.from.uv.anchor":_,"shape3d.to.uv.offset":_,"shape3d.to.uv.scale":_,"shape3d.to.uv.rotation":_,"shape3d.to.uv.anchor":_,"shape3d.top.cap":_,"shape3d.bottom.cap":_,"shape3d.start.angle":0,"shape3d.sweep.angle":$,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.blur":0,"shape3d.reflector.blur.iterations":1,"shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"shape3d.reflector.shadow":"scene","camera.type":"perspective","camera.aspect":1,"camera.fovy":_,"camera.ortho.width":_,"camera.near":_,"camera.far":_,"camera.background":0,"camera.renderSky":!0,"camera.renderAxis":!1,"camera.renderGrid":!1,"camera.renderEdit":!1,"camera.onlySky":!1,"texture.mipmap.max":_,"texture.filter":_,"texture.filter.min":_,"texture.filter.mag":_,"texture.wrap":_,"points.image":"rect","points.color":"white","points.transparent":!1,"points.size":20,"points.opacity":1,"points.uv.scale":[1,1],"points.uv.offset":[0,0],"points.discard.selectable":!1,"all.light":!0,"all.visible":!0,"all.color":Gp,"all.image":_,"all.blend":_,"all.opacity":_,"all.reverse.flip":!1,"all.reverse.color":hd,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":_,"all.uv.offset":_,"all.uv.scale":_,"all.uv.rotation":_,"all.uv.anchor":_,"all.discard.selectable":!0,mat:_,"left.mat":_,"right.mat":_,"top.mat":_,"bottom.mat":_,"front.mat":_,"back.mat":_,"edge.source.anchor.elevation":_,"edge.target.anchor.elevation":_,"edge.source.offset.elevation":0,"edge.target.offset.elevation":0},!0);
var Qk,xj=!1,Kl=[0,0,0,0],pe=function(a){return a instanceof xi},_i=function(L){return[L.x,L.e||0,L.y]},_h=function(I,m,X){for(var m=Tj(m||0),Y=m[0],W=m[1],b=m[2];X--;)I.push(Y,W,b)},Qo=function(L,r,c){for(var r=Tj(r||0),v=r[0],D=r[1],s=r[2],F=r[3];c--;)L.push(v,D,s,F)},Od=function($,i,M){if(i)for(var e,d,r,k=i[0],q=i[1],B=i[2],m=i[4],K=i[5],R=i[6],n=i[8],Y=i[9],v=i[10],J=i[12],C=i[13],Q=i[14],w=M.length,N=0,N=0;w>N;N+=3)e=M[N],d=M[N+1],r=M[N+2],$.push(k*e+m*d+n*r+J,q*e+K*d+Y*r+C,B*e+R*d+v*r+Q);else Gf($,M)},$g=function(Y,i,O){var L=i.s("light.intensity"),S=Tj(i.s(Ml)),m=S[0],w=S[1],B=S[2];1!==L&&(m*=L,w*=L,B*=L);var z=i.s("light.disabled");Y.push(m,w,B,z?1:0),O.c.push(m,w,B),O.g.push(z?-1:i.s("light.group")),O.e.push(z?1:0)},nj=function(F,X){var c=qb.for(X),M=c.directUniforms(),G=F._lastLightUploadInfo={c:[],g:[],e:[]};M.uHeadlightRange=F._headlightRange;var H=M.uHeadlightAmbientIntensity=F._headlightAmbientIntensity,D=F._headlightIntensity,O=Tj(F._headlightColor);1!==D&&(O=[O[0]*D,O[1]*D,O[2]*D]);var q;M.uHeadlightColor=[O[0],O[1],O[2],(q=F._headlightDisabled)?1:0],G.c.push(O[0],O[1],O[2]),G.g.push(q?-1:F._headlightGroup),G.e.push(q?1:0);var u=F._59O,W=F._spots,C=F._dirs;if(u.length){var R=[],x=[],Z=[];u.forEach(function(C){$g(R,C,G),Gf(x,F._transformPointToViewSpace(C.p3())),Z.push(C.s("light.range"))}),M.uPointColor=R,M.uPointRange=Z,M.uPointPosition=x}if(W.length){var w=[],f=[],v=[],T=[],k=[],I=[];W.forEach(function(s){$g(w,s,G),Gf(f,F._transformPointToViewSpace(s.p3())),Gf(k,F._transformDirectionToViewSpace(s.p3(),s.s("light.center"))),v.push(s.s("light.range")),T.push(l(s.s("light.angle")/2)),I.push(s.s("light.exponent"))}),M.uSpotColor=w,M.uSpotRange=v,M.uSpotAngle=T,M.uSpotExponent=I,M.uSpotPosition=f,M.uSpotDirection=k}if(C.length){var U=[],d=[];C.forEach(function(j){$g(U,j,G),Gf(d,F._transformDirectionToViewSpace(j.p3()))}),M.uDirColor=U,M.uDirDirection=d}F._lastLightMask=cs,F._lastHeadlightAmbientIntensity=H},dk=function(W,U,J,m){if(m===_&&(m=W._headlightAmbientIntensity),m!==W._lastHeadlightAmbientIntensity&&(U.uHeadlightAmbientIntensity=W._lastHeadlightAmbientIntensity=m),J!==W._lastLightMask){W._lastLightMask=J;var B=W._lastLightUploadInfo;if(B){var $,g,y,e=B.g,o=B.e,Q=e.length,G=new Array(Q),w=!1;for(g=0;Q>g;g++)$=e[g],y=0>$||$>=32?1:J&1<<$?0:1,G[g]=y,y!==o[g]&&(w=!0);if(w){B.e=o=G;var v=B.c;U.uHeadlightColor=[v[0],v[1],v[2],o[0]];var E,C=W._59O,N=W._spots,I=W._dirs,Y=3,F=1;if(Q=C.length){for(g=0,E=[];Q>g;g++)E.push(v[Y++],v[Y++],v[Y++],o[F++]);U.uPointColor=E}if(Q=N.length){for(g=0,E=[];Q>g;g++)E.push(v[Y++],v[Y++],v[Y++],o[F++]);U.uSpotColor=E}if(Q=I.length){for(g=0,E=[];Q>g;g++)E.push(v[Y++],v[Y++],v[Y++],o[F++]);U.uDirColor=E}}}}},mf=function(J,_){return Math.max(J.getRotateMinPhi()+Nm,Math.min(J.getRotateMaxPhi()-Nm,_))},Up=function(){return.05+wk()/2},Kq=function(u,Y,o,M){var f,l=u.getEye();return u.isOrtho()?(f=_d(u.getCenter(),l),f[0]+=M[0],f[1]+=M[1],f[2]+=M[2]):f=l,ib(Y,o,M,f)},ib=function(H,M,K,G){var p=Id(H,M),S=_d(G,K,!0),e=Id(S,M);if(f(e)<Nm)return I;var W=(p-Id(K,M))/e;return[K[0]+S[0]*W,K[1]+S[1]*W,K[2]+S[2]*W]},ie=function(T,m){return{x:2*T.x-m.x,y:2*T.y-m.y}},Ko=function(M,I,p,$){var m,V;if(!M)return m=id(I.y-p.y,p.x-I.x),{x:I.x+$*d(m),y:I.y+$*l(m)};if(!p)return m=id(M.y-I.y,I.x-M.x),{x:I.x+$*d(m),y:I.y+$*l(m)};var A=_d([M.x,M.y,0],[I.x,I.y,0],!0),Z=_d([p.x,p.y,0],[I.x,I.y,0],!0),j=-(A[0]+Z[0])/2,k=-(A[1]+Z[1])/2,B=w(j*j+k*k);if(Nm>B)return m=id(M.y-I.y,I.x-M.x),{x:I.x+$*d(m),y:I.y+$*l(m)};var L=M.x-I.x,q=M.y-I.y,f=p.x-I.x,U=p.y-I.y,X=w(L*L+q*q),H=w(f*f+U*U);m=E(Id(A,Z))/2,V=A[1]*Z[0]-A[0]*Z[1]>0?-1:1,j/=B,k/=B;var T=$/d(m),D=i(X,H)/l(m);B=Math.min(T,D);var s={x:I.x+V*B*j,y:I.y+V*B*k};return p.b&&T>H/l(m)&&(s.adjust=!0),s},Wc=function(V){var _=V[1],t=V[2],q=V[3],m=V[6],z=V[7],H=V[11];V[1]=V[4],V[2]=V[8],V[3]=V[12],V[4]=_,V[6]=V[9],V[7]=V[13],V[8]=t,V[9]=m,V[11]=V[14],V[12]=q,V[13]=z,V[14]=H},Sq=function(s){var P=s[0],C=s[1],H=s[2],o=s[3],e=s[4],v=s[5],y=s[6],S=s[7],u=s[8],A=s[9],t=s[10],U=s[11],B=s[12],E=s[13],Y=s[14],T=s[15],F=P*v-C*e,c=P*y-H*e,w=P*S-o*e,K=C*y-H*v,O=C*S-o*v,$=H*S-o*y,Z=u*E-A*B,R=u*Y-t*B,D=u*T-U*B,k=A*Y-t*E,j=A*T-U*E,g=t*T-U*Y,p=F*g-c*j+w*k+K*D-O*R+$*Z;return p?(p=1/p,s[0]=(v*g-y*j+S*k)*p,s[1]=(H*j-C*g-o*k)*p,s[2]=(E*$-Y*O+T*K)*p,s[3]=(t*O-A*$-U*K)*p,s[4]=(y*D-e*g-S*R)*p,s[5]=(P*g-H*D+o*R)*p,s[6]=(Y*w-B*$-T*c)*p,s[7]=(u*$-t*w+U*c)*p,s[8]=(e*j-v*D+S*Z)*p,s[9]=(C*D-P*j-o*Z)*p,s[10]=(B*O-E*w+T*F)*p,s[11]=(A*w-u*O-U*F)*p,s[12]=(v*R-e*k-y*Z)*p,s[13]=(P*k-C*R+H*Z)*p,s[14]=(E*c-B*K-Y*F)*p,s[15]=(u*K-A*c+t*F)*p,void 0):I},oi=function(K,t){if(t){var p=t[0],N=t[1],T=t[2];K[12]=K[0]*p+K[4]*N+K[8]*T+K[12],K[13]=K[1]*p+K[5]*N+K[9]*T+K[13],K[14]=K[2]*p+K[6]*N+K[10]*T+K[14],K[15]=K[3]*p+K[7]*N+K[11]*T+K[15]}},yi=function(h,r){if(r){var U=r[0],l=r[1],V=r[2];h[0]=h[0]*U,h[1]=h[1]*U,h[2]=h[2]*U,h[3]=h[3]*U,h[4]=h[4]*l,h[5]=h[5]*l,h[6]=h[6]*l,h[7]=h[7]*l,h[8]=h[8]*V,h[9]=h[9]*V,h[10]=h[10]*V,h[11]=h[11]*V}},Vb=function(B,v,W){var q=v[0],O=v[1],Y=v[2],a=v[3],N=v[4],L=v[5],P=v[6],i=v[7],G=v[8],Z=v[9],S=v[10],Q=v[11],E=v[12],u=v[13],g=v[14],z=v[15],o=W[0],h=W[1],F=W[2],_=W[3];return B[0]=o*q+h*N+F*G+_*E,B[1]=o*O+h*L+F*Z+_*u,B[2]=o*Y+h*P+F*S+_*g,B[3]=o*a+h*i+F*Q+_*z,o=W[4],h=W[5],F=W[6],_=W[7],B[4]=o*q+h*N+F*G+_*E,B[5]=o*O+h*L+F*Z+_*u,B[6]=o*Y+h*P+F*S+_*g,B[7]=o*a+h*i+F*Q+_*z,o=W[8],h=W[9],F=W[10],_=W[11],B[8]=o*q+h*N+F*G+_*E,B[9]=o*O+h*L+F*Z+_*u,B[10]=o*Y+h*P+F*S+_*g,B[11]=o*a+h*i+F*Q+_*z,o=W[12],h=W[13],F=W[14],_=W[15],B[12]=o*q+h*N+F*G+_*E,B[13]=o*O+h*L+F*Z+_*u,B[14]=o*Y+h*P+F*S+_*g,B[15]=o*a+h*i+F*Q+_*z,B},hp=function(p,z,h,t){var J,x,n,l,m,H,o,F,b,C,i=z[0],I=z[1],P=z[2],D=t[0],j=t[1],T=t[2],S=h[0],R=h[1],M=h[2];return f(i-S)<Nm&&f(I-R)<Nm&&f(P-M)<Nm?Dp(p):(o=i-S,F=I-R,b=P-M,C=1/w(o*o+F*F+b*b),o*=C,F*=C,b*=C,J=j*b-T*F,x=T*o-D*b,n=D*F-j*o,C=w(J*J+x*x+n*n),C?(C=1/C,J*=C,x*=C,n*=C):(J=0,x=0,n=0),l=F*n-b*x,m=b*J-o*n,H=o*x-F*J,C=w(l*l+m*m+H*H),C?(C=1/C,l*=C,m*=C,H*=C):(l=0,m=0,H=0),p[0]=J,p[1]=l,p[2]=o,p[3]=0,p[4]=x,p[5]=m,p[6]=F,p[7]=0,p[8]=n,p[9]=H,p[10]=b,p[11]=0,p[12]=-(J*i+x*I+n*P),p[13]=-(l*i+m*I+H*P),p[14]=-(o*i+F*I+b*P),p[15]=1,p)},ph=function(A,X,V,s,w){var k=1/Bl(X/2),g=1/(s-w);return A[0]=k/V,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=k,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=(w+s)*g,A[11]=-1,A[12]=0,A[13]=0,A[14]=2*w*s*g,A[15]=0,A},ij=function(X,q,t,k,N,m,h){var J=1/(q-t),n=1/(k-N),O=1/(m-h);return X[0]=-2*J,X[1]=0,X[2]=0,X[3]=0,X[4]=0,X[5]=-2*n,X[6]=0,X[7]=0,X[8]=0,X[9]=0,X[10]=2*O,X[11]=0,X[12]=(q+t)*J,X[13]=(N+k)*n,X[14]=(h+m)*O,X[15]=1,X},lk=function(n,Y){var r=Y[0],N=Y[1],o=Y[2],g=Y[3],f=r*r+N*N+o*o+g*g,k=f?1/f:0;return n[0]=-r*k,n[1]=-N*k,n[2]=-o*k,n[3]=g*k,n},Mm=function(h,M){var A=M[0]+M[5]+M[10],n=0;return A>0?(n=2*Math.sqrt(A+1),h[3]=.25*n,h[0]=(M[6]-M[9])/n,h[1]=(M[8]-M[2])/n,h[2]=(M[1]-M[4])/n):M[0]>M[5]&M[0]>M[10]?(n=2*Math.sqrt(1+M[0]-M[5]-M[10]),h[3]=(M[6]-M[9])/n,h[0]=.25*n,h[1]=(M[1]+M[4])/n,h[2]=(M[8]+M[2])/n):M[5]>M[10]?(n=2*Math.sqrt(1+M[5]-M[0]-M[10]),h[3]=(M[8]-M[2])/n,h[0]=(M[1]+M[4])/n,h[1]=.25*n,h[2]=(M[6]+M[9])/n):(n=2*Math.sqrt(1+M[10]-M[0]-M[5]),h[3]=(M[1]-M[4])/n,h[0]=(M[8]+M[2])/n,h[1]=(M[6]+M[9])/n,h[2]=.25*n),h},Br=function(S,q,y){var t=q[0],w=q[1],A=q[2],_=q[3],W=t+t,F=w+w,z=A+A,Z=t*W,D=t*F,e=t*z,U=w*F,O=w*z,k=A*z,m=_*W,i=_*F,f=_*z;return S[0]=1-(U+k),S[1]=D+f,S[2]=e-i,S[3]=0,S[4]=D-f,S[5]=1-(Z+k),S[6]=O+m,S[7]=0,S[8]=e+i,S[9]=O-m,S[10]=1-(Z+U),S[11]=0,S[12]=y[0],S[13]=y[1],S[14]=y[2],S[15]=1,S},Ar=function(U,Y){if(U.isVREnabled()){var _=U.vr.getViewMatrix(Y);if(_)return _}return U._camera?U._camera.getViewMatrix(Y):hp(Y?Y:dq(),U._eye,U._center,U._up)},Cr=function(F,S){if(F.isVREnabled()){var X=F.vr.getProjectMatrix();if(X)return X}if(F._camera)return F._camera.getProjectMatrix();if(!S&&F._computedProjectMatrix)return yj(F._computedProjectMatrix);var Z=F.getAspect(),g=F._near,U=F._far,x=dq();if(F._ortho){var E=F._orthoWidth/2,w=E/Z;ij(x,-E,E,-w,w,g,U)}else ph(x,F._fovy,Z,g,U);return x},Sl=function(U,X){if(!U)return I;var j=0,_=1,Z=2,D=[],d=0,e=U.length,t=e/3;if(X){for(;e>d;d++)D[d]=0;for(d=0;d<X.length;d+=3){var z=[],O=[],u=[];z[j]=U[3*X[d+1]+j]-U[3*X[d]+j],z[_]=U[3*X[d+1]+_]-U[3*X[d]+_],z[Z]=U[3*X[d+1]+Z]-U[3*X[d]+Z],O[j]=U[3*X[d+2]+j]-U[3*X[d+1]+j],O[_]=U[3*X[d+2]+_]-U[3*X[d+1]+_],O[Z]=U[3*X[d+2]+Z]-U[3*X[d+1]+Z],u[j]=z[_]*O[Z]-z[Z]*O[_],u[_]=z[Z]*O[j]-z[j]*O[Z],u[Z]=z[j]*O[_]-z[_]*O[j];for(var R=0;3>R;R++)D[3*X[d+R]+j]+=u[j],D[3*X[d+R]+_]+=u[_],D[3*X[d+R]+Z]+=u[Z]}}else for(d=0;t>d;d+=3){var z=[],O=[],u=[];z[j]=U[3*(d+1)+j]-U[3*d+j],z[_]=U[3*(d+1)+_]-U[3*d+_],z[Z]=U[3*(d+1)+Z]-U[3*d+Z],O[j]=U[3*(d+2)+j]-U[3*(d+1)+j],O[_]=U[3*(d+2)+_]-U[3*(d+1)+_],O[Z]=U[3*(d+2)+Z]-U[3*(d+1)+Z],u[j]=z[_]*O[Z]-z[Z]*O[_],u[_]=z[Z]*O[j]-z[j]*O[Z],u[Z]=z[j]*O[_]-z[_]*O[j];for(var R=0;3>R;R++)D[3*(d+R)+j]=u[j],D[3*(d+R)+_]=u[_],D[3*(d+R)+Z]=u[Z]}for(d=0;e>d;d+=3){var E=[];E[j]=D[d+j],E[_]=D[d+_],E[Z]=D[d+Z];var s=w(E[j]*E[j]+E[_]*E[_]+E[Z]*E[Z]);0===s&&(s=Nm),E[j]=E[j]/s,E[_]=E[_]/s,E[Z]=E[Z]/s,D[d+j]=E[j],D[d+_]=E[_],D[d+Z]=E[Z]}return new _p(D)},Gg=function(A,b,G,v){if(G||(G=A.createTexture()),b){var q=A.TEXTURE_2D,s=A.REPEAT,z=A.CLAMP_TO_EDGE,y=A.TEXTURE_MIN_FILTER;v=v||sd;var Q=v.minFilter||v.filter||A.LINEAR,H=v.magFilter||v.filter||A.LINEAR;A.activeTexture(A.TEXTURE0),rf(A,G),A.texImage2D(q,0,A.RGBA,A.RGBA,A.UNSIGNED_BYTE,b),bk(A,A.TEXTURE_MAG_FILTER,H);var l=b.naturalWidth||b.width,U=b.naturalHeight||b.height;ym.isPOT(l)&&ym.isPOT(U)&&!v.clampToEdge&&!b.clampToEdge?(bk(A,A.TEXTURE_WRAP_S,s),bk(A,A.TEXTURE_WRAP_T,s),bk(A,y,Q===A.NEAREST?A.NEAREST_MIPMAP_NEAREST:A.LINEAR_MIPMAP_LINEAR),v.mipmapMaxLevel!==_&&bk(A,A.TEXTURE_MAX_LEVEL,v.mipmapMaxLevel),A.generateMipmap(q)):(bk(A,A.TEXTURE_WRAP_S,z),bk(A,A.TEXTURE_WRAP_T,z),bk(A,y,Q)),rf(A,I)}return G},Cc=function(P,H,p){var i=new Uint8Array(p||4);return H=H||P.createTexture(),P.activeTexture(P.TEXTURE0),rf(P,H),bk(P,P.TEXTURE_MIN_FILTER,P.LINEAR),P.texImage2D(P.TEXTURE_2D,0,P.RGBA,1,1,0,P.RGBA,P.UNSIGNED_BYTE,i),H},Ef=function(j,w,J){var a=new Uint8Array(J||4);return w=w||j.createTexture(),j.activeTexture(j.TEXTURE0),j.bindTexture(j.TEXTURE_CUBE_MAP,w),j.texParameteri(j.TEXTURE_CUBE_MAP,j.TEXTURE_MAG_FILTER,j.LINEAR),j.texParameteri(j.TEXTURE_CUBE_MAP,j.TEXTURE_MIN_FILTER,j.LINEAR),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,j.RGBA,1,1,0,j.RGBA,j.UNSIGNED_BYTE,a),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,j.RGBA,1,1,0,j.RGBA,j.UNSIGNED_BYTE,a),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,j.RGBA,1,1,0,j.RGBA,j.UNSIGNED_BYTE,a),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,j.RGBA,1,1,0,j.RGBA,j.UNSIGNED_BYTE,a),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,j.RGBA,1,1,0,j.RGBA,j.UNSIGNED_BYTE,a),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,j.RGBA,1,1,0,j.RGBA,j.UNSIGNED_BYTE,a),w},Jn=function(v){v._26I&&v._prg&&(v._26I.deleteProgram(v._prg),v._prg=I)},ue=function(){function A($){if($.match(M))return Fq($);var W=R[$];if(W)return W;var Q=new RegExp("#define\\s+"+$+"\\s+(\\d+)"),Y=U.match(Q);return R[$]=Y?Fq(Y[1]):0}function y(c){R={},U=c;var C=c.replace(v,V).replace(_,o);return U=null,R=null,C}function V(k,G,z){z=A(z);for(var H="",p=0;z>p;p++)H+=G+p+";";return H}function o(k,C,_,t){for(var r="",i=A(C);i<A(_);i++)r+=t.replace(/\[\s*i\s*\]/g,"["+i+"]").replace(/\[\s*I\s*\]/g,i);return r}var R,U,v=/(uniform\s+sampler2D\s+\w+)\[([\S\d]+)\];/g,_=/#UNROLL_LOOP_START\s+for\s*\(\s*int\s+i\s*=\s*([\S\d]+)\s*;\s*i\s*<\s*([\S\d]+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#UNROLL_LOOP_END/g,M=/^\d+$/;return function(I){return y(I)}}(),Bq=function(C,V,v,T){var L=C.createShader(v);return C.shaderSource(L,ue(T)),C.compileShader(L),C.attachShader(V,L),L},Zr=function(l){return l.createBuffer()},rf=function(A,l){A.bindTexture(A.TEXTURE_2D,l||A._emptyTexture)},bk=function(f,n,b){f.texParameteri(f.TEXTURE_2D,n,b)},bm=function(r,$){var O=qb.for(r).directState();O.polygonOffset.enabled=!0,O.polygonOffset.value=$},bf=function(Q){var B=qb.for(Q).directState();B.polygonOffset.enabled=!1},Il=function(X,r){if(r){var t=qb.for(X).directState();t.color.clear=Tj(r)}},Ad=function(D,I,i){if(i!==I._lastClipboxEnabled){var k=D._boxClipperGroups,P=k?k.length:0,x=new Array(P);if(i)for(var V=0;P>V;V++)i&1<<k[V]&&(x[V]=!0);I._lastClipboxEnabled=i,I.uEnableBoxClip=x}},vo=Ad,xk=function(R){var $=qb.for(R),p=$.directUniforms(),E=$.directAttribs();p.uFix=!0,E.aNormal=!1},kc=function(m){var x=qb.for(m),l=x.directUniforms();x.directAttribs(),l.uFix=!1},gd=function(z,$,j,D,c,Z,N,f){var y=qb.for(z),p=y.directState(),X=y.directUniforms();z._picking||(j?(X.uBlend=!0,X.uBlendColor=j):X.uBlend=!1,X.uLight=D==I?!0:D,Cp(c)&&1!==c&&(X.uPartOpacity=c),X.uReverseFlip=Z==I?!1:Z,X.uFixPickReverseColor=N||hd),p.cullFace.enabled=f?!0:!1},Rr=function(h){if(!h._picking){var H=qb.for(h),g=H.directUniforms();g.uPartOpacity=1}},gk=function(){var H=new A.Math.Matrix2d,j=[1,0,0,0,1,0,0,0,0];return function(J,e,Y,c,B,p,S,_,U,r,l){var t=qb.for(J),W=t.directUniforms(),M=t.directAttribs();return Y?(W.uTexture=!0,W.uDiscardSelectable=Je(c)?c:!0,M.aUv=Pp(J,B,p,I,2),l?(W.uBlendTexture=!0,W.uBlendSampler=l):(W.uBlendTexture=!1,W.uBlendSampler=J._emptyBlendTexture),W.uSampler=Y,W.uUvMatrix=S||_||U||r?ef(U,S,_,r,H).toArray9():j,void 0):(W.uSampler=J._emptyTexture,W.uBlendSampler=J._emptyBlendTexture,void 0)}}(),ah=function(s,e,P){var H=qb.for(s),y=H.directUniforms(),c=H.directAttribs();s.activeTexture(s.TEXTURE0),rf(s,I),s.activeTexture(s.TEXTURE1),rf(s,I),P&&(c.aUv=!1,y.uTexture=!1,y.uSampler=s._emptyTexture,y.uBlendTexture=!1,y.uBlendSampler=s._emptyBlendTexture)},fg=function(W,T,K,f,v,r){var k=qb.for(W),g=k.directUniforms(),$=k.directAttribs();!K||jn||ob||W.lineWidth(K),f&&!W._picking&&(g.uFixPickReverseColor=f),v&&($.aPosition=Pp(W,v,r,I))},bj=function(H,p,z,K){Qk&&(K=H[Qk]),H.drawArrays(K==I?H.TRIANGLES:K,p,z);var e=H._renderInfo;e&&(e.calls++,e.vertices+=z,(K==I||K===H.TRIANGLES)&&(e.faces+=z/3),K===H.LINES&&(e.lines+=z/2),K===H.POINTS&&(e.points+=z))},cd=function(A,d,M,o,y){Qk&&(o=A[Qk]),A.drawElements(o==I?A.TRIANGLES:o,M,y==I?A.UNSIGNED_SHORT:y,d==I?0:2*d);var $=A._renderInfo;$&&($.calls++,$.vertices+=M,(o==I||o===A.TRIANGLES)&&($.faces+=M/3),o===A.LINES&&($.lines+=M/2),o===A.POINTS&&($.points+=M))},Wh=function(_,s,A){var B=_.ARRAY_BUFFER;return _.bindBuffer(B,s),A&&_.bufferData(B,A,_.STATIC_DRAW),s},Pp=function(L,b,S,Y,j){return S?rg(L,L.ARRAY_BUFFER,b,S):Wh(L,b,S,Y,j)},di=function(c,R,_){var f=c.ELEMENT_ARRAY_BUFFER;c.bindBuffer(f,R),_&&c.bufferData(f,_,c.STATIC_DRAW)},Ce=function(o,G,P){rg(o,o.ELEMENT_ARRAY_BUFFER,G,P)},rg=function(V,p,h,Y){var _=Y._bufId;_||(_=Y._bufId=A.Math.generateIncreasingID());var h,o=V._bufPool;return(h=o[_])&&h._buf?V.bindBuffer(p,h._buf):(h=o[_]={_buf:Zr(V)},V.bindBuffer(p,h._buf),V.bufferData(p,Y,V.STATIC_DRAW)),h._fid=V._renderInfo.frame,h._buf},Jl=function(c,q){q!=I&&q>=0&&c.enableVertexAttribArray(q)},Ep=function(F,v){v!=I&&v>=0&&F.disableVertexAttribArray(v)},Lg=function(y,k){var P=y.getGL(),m=qb.for(P),a=m.directUniforms();y._7O=y._8O.pop(),k&&(a.uMVMatrix=y._7O,y._6O=k,a.uNMatrix=k)},qj=function(N,s){return s||(s=dq()),Lh(s,N),Sq(s),Wc(s),s},$n=function(w,y){var p=w.getGL(),d=w._7O,h=qb.for(p),H=h.directUniforms();y?(w._8O.push(yj(d)),H.uMMatrix=y,Vb(d,d,y),w._7O=d):H.uMMatrix=Jm,H.uMVMatrix=d,H.uNMatrix=qj(d,w._6O)},Dr={body:0,label:1,label2:2,note:3,note2:4,symbol:5},Zk=10,Rm=function(k,A,J,b,G,q){var V;if(J){var I=b._pickId;I||(I=b._pickId=A._pickIdUsed,A._pickIdUsed+=Zk);var K,W=Dr[G];if(null!=W)K=I+W;else{var Q=b._pickExtraPartMap;Q||(Q=b._pickExtraPartMap={}),(K=Q[G])||(K=Q[G]=A._pickIdUsed++)}A[K]||(A[K]={data:b.data,part:G}),V=Ks(K)}else V=Kl;if(!q){var U=qb.for(k),t=U.directUniforms();t.uFixPickReverseColor=V}return V},Qb=Rm,Kj=function(D,l,y){"target"!==y&&(y="source");var h="target"===y?l.getTargetAgent():l.getSourceAgent(),b="edge."+y+".";if(Fg(h)){var q=l.s(b+"anchor.x"),g=l.s(b+"anchor.elevation"),Z=l.s(b+"anchor.y"),V=Gq(h,D.getMat(h)),H=h.getAnchor3d(),I=xl([(q===_?.5:q)-H.x,(g===_?.5:g)-H.y,(Z===_?.5:Z)-H.z],V);return I[1]+=l.s(b+"offset.elevation"),I}var f=l.s(b+"index"),c=D.getData3dUI(h);if(!c.info||!c.info.list)return!1;if(f>=0){var G,J,k,K,u,P=c.info._lastPointsSegments,S=P.points,B=P.segments,A=-1,M=-1;for(k=0,K=B?B.length:S.length;K>k;k++){if(J=B?B.get(k):1,3===J)u=2;else if(4===J)u=3;else{if(5===J)continue;u=1}if(A+=u,M++,M===f){G=S.get(A);break}}return G||(G=S.get(S.length-1)),[G.x,(G.e||0)+l.s(b+"offset.elevation"),G.y]}var X=l.s(b+"percent")||.5;if(X=Math.max(0,Math.min(X,1)),!c||!c.getCache)return!1;var C=c.getCache(),K=C[C.length-1].length,P=D.getLineOffset(h,X*K),I=P.point;return[I.x,I.y+l.s(b+"offset.elevation"),I.z]},Vj=function(){var V={center:function(G,$,Y,l,r){var h=-$[1]/2,K={x:-$[0]/2,y:h,width:$[0],height:$[1]},A=ni(G,K,Y);return[A.x+l,-A.y-r,z.getPosition3dGap()]},front:function(n,X,F,G,Y){var b=-X[1]/2,K={x:-X[0]/2,y:b,width:X[0],height:X[1]},k=ni(n,K,F);return[k.x+G,-k.y-Y,X[2]/2+z.getPosition3dGap()]},back:function(j,i,e,u,I){var C=-i[0]/2,k=-i[1]/2,R={x:C,y:k,width:i[0],height:i[1]},W=ni(j,R,e);return[-W.x-u,-W.y-I,-i[2]/2-z.getPosition3dGap()]},left:function(s,k,p,E,G){var S=-k[1]/2,l={x:-k[2]/2,y:S,width:k[2],height:k[1]},F=ni(s,l,p);return[-k[0]/2-z.getPosition3dGap(),-F.y-G,F.x+E]},right:function(G,V,I,t,q){var F=-V[2]/2,Y=-V[1]/2,y={x:F,y:Y,width:V[2],height:V[1]},L=ni(G,y,I);return[V[0]/2+z.getPosition3dGap(),-L.y-q,-L.x-t]},top:function(d,b,G,k,B){var n={x:-b[0]/2,y:-b[2]/2,width:b[0],height:b[2]},$=ni(d,n,G);return[$.x+k,b[1]/2+z.getPosition3dGap(),$.y+B]},bottom:function(C,K,b,u,v){var S=-K[2]/2,h={x:-K[0]/2,y:S,width:K[0],height:K[2]},O=ni(C,h,b);return[O.x+u,-K[1]/2-z.getPosition3dGap(),-O.y-v]}};return function(B,P,I,a,T,v){return V[a](B,P,I,T||0,v||0)}}(),Pb=function(O,E,n,c,Z,S,b,P,m,K){if(Z&&(E[0]+=Z[0],E[1]+=Z[1],E[2]+=Z[2]),oi(O,n),P){var q=dq();if(Vd(q,m,K),xl(E,q),oi(O,E),O.auto=P,O.pos=xl([0,0,0],O),S){var i=O.mat2=dq();Vd(i,S,b)}}else Vd(O,m,K),oi(O,E),c===iq?Bi(O,-Rg):c===bq?Bi(O,Rg):c===wg?re(O,-Rg):c===wn?re(O,Rg):c===rm&&Bi(O,h),Vd(O,S,b);return O},jh=function(C,_){var h=_.auto,I=_.mat2,d=C.gv;if(h){var l,p=dq(),j=[0,0,0,0];l="string"==typeof h?[h.indexOf("x")<0?d._eye[0]:d._center[0],h.indexOf("y")<0?d._eye[1]:d._center[1],h.indexOf("z")<0?d._eye[2]:d._center[2]]:d._eye,Mm(j,hp(dq(),l,d._center,d._up)),Br(p,lk(j,j),_.pos),I&&Vb(p,p,I),$n(d,p)}else $n(d,_)},dm=function(j,f,G,r,N){var m=j.s,R=j.gv,n=R.getGL(),$=R._prg,w=R._buffer,i=R._1O,v=qb.for(n),J=v.directAttribs();Gg(n,Xj,i),jh(j,G),gd(n,$,m(f+".blend"),m(f+".light"),m(f+".opacity"),m(f+".reverse.flip"),m(f+".reverse.color"),m(f+".reverse.cull")),gk(n,$,i,N,w.uv,bs),J.aPosition=Pp(n,w.vs,r,I),J.aNormal=Pp(n,w.ns,ln,I),Ce(n,w.is,Db),cd(n,0,Db.length),ah(n,$,i),Rr(n,$),Lg(R)},Ym=function(q,t,G){var Y=q.gv,R=q.data,a=q[t]={blend:Y.getBodyColor(R)||Y.getFaceBlend(R,t),light:Y.getFaceLight(R,t),color:Y.getFaceColor(R,t),opacity:Y.getFaceOpacity(R,t),transparent:Y.getFaceTransparent(R,t),reverseFlip:Y.getFaceReverseFlip(R,t),reverseColor:Y.getFaceReverseColor(R,t),reverseCull:Y.getFaceReverseCull(R,t),texture:Y.getFaceImage(R,t),blendTexture:Y.getFaceBlendImage(R,t),discardSelectable:Y.getFaceDiscardSelectable(R,t)};if("csg"!==t){a.uv=Y.getFaceUv(R,t)||G&&G[t+"Uv"],a.uvScale=Y.getFaceUvScale(R,t)||G&&G[t+"UvScale"],a.uvOffset=Y.getFaceUvOffset(R,t)||G&&G[t+"UvOffset"],a.uvRotation=Y.getFaceUvRotation(R,t)||G&&G[t+"uvRotation"],a.uvAnchor=Y.getFaceUvAnchor(R,t)||G&&G[t+"uvAnchor"];var A=Y.getFaceMat(R,t);if(A){var g=Gq(R,A);R.appendAnchorMatrix3d(g),a.mat=g}}return a},lb=function(K,c,v,n,R){var p=K[n];if(p){if(!R(p.transparent))return;var o=K.data,Y=K.gv,N=Y._buffer,Q=Y.getTexture(p.texture,o,n),J=Y.getTexture(p.blendTexture,o),$=qb.for(c),C=$.directUniforms(),H=$.directAttribs();gk(c,v,Q,p.discardSelectable,N.uv,p.tuv,p.uvOffset,p.uvScale,p.uvRotation,p.uvAnchor,J),gd(c,v,p.blend,p.light,p.opacity,p.reverseFlip,p.reverseColor,p.reverseCull),p.cs&&!Y._batchColorDisabled?(C.uBatchColor=!0,H.aBatchColor=Pp(c,N.batchColor,p.cs,v.aBatchColor,4)):C.uDiffuse=p.color||s["color.empty"],H.aPosition=Pp(c,N.vs,p.vs,I),H.aNormal=Pp(c,N.ns,p.ns,I),bj(c,0,p.vs.length/3),p.cs&&!Y._batchColorDisabled&&(C.uBatchColor=!1,Ep(c,v.aBatchColor)),Rr(c,v),ah(c,v,Q)}},ms=function($,C,i){gc($)?$.forEach(function(A){ms(A,C,i)}):Fp($)?ms(bg(C,$),C,i):qf($)?$.shape3d?ms($.shape3d,C,i):i.push($):i.push($)},Bc=function(){for(var N=50,i=arguments.length,g=[],I=0;i>I;I++)g[I]=arguments[I];Ti[vk]="Time : "+(new Date).toLocaleString()+", Info :"+g.join(", "),vk=(vk+1)%N,console.error("Failed to create shader.")},ef=function(){var j=new ym.Matrix2d;return function(M,S,B,x,l){return l||(l=j),l.identity(),x&&l.translate(-x[0],-x[1]),B&&l.scale(B[0],B[1]),M&&l.rotate(M),x&&l.translate(x[0],x[1]),S&&l.translate(S[0],S[1]),l}}(),Nk=function(Y,i,w,P,t,s){var z,v,G,J,$,O,c,u,B,F,K,r=[P-i,t-w],N=Y?Y.length:0;for(G=0;N>G;G++){for(J=2,z=Y[G],$=z[0],O=z[1];J+1<z.length;){if(c=z[J],u=z[J+1],v=ip(i,w,P,t,$,O,c,u,!0)){B=[c-$,u-O],F=Hd(B),B[0]/=F,B[1]/=F,F=Id(r,B),F=F>0?s:-s,K=[B[0]*F,B[1]*F];break}$=c,O=u,J+=2}if(K)break}if(K)for(P=i+K[0],t=w+K[1],G=0;N>G;G++)for(J=2,z=Y[G],$=z[0],O=z[1];J+1<z.length;){if(c=z[J],u=z[J+1],v=ip(i,w,P,t,$,O,c,u,!0))return[0,0];$=c,O=u,J+=2}return K?K:[P-i,t-w]},Qm=function(y){return"nearest"===y?Bd.NEAREST:"linear"===y?Bd.LINEAR:y},Ac=A.graph3d={WebGLConstants:Bd},ci=function(Y,i,A){Ag(e+".graph3d."+Y,i,A)},hj="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<6/1!,!*{/mbdpMwVxpmg!,!z/mbdpMwVxpmg!-y/mbdpMwVxpmg)3dfw!>!^j]wVxpmg<{zy/**1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!^j]yjsubNxpmg)!>!mbdpMwVxpmg|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1>j!uoj)spg<mbdpMwVxpmg!4dfw1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!<*1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw!gjeof$!~!1!>>!SFQQJMD`YPC`YBN!gj$!<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!gjeof$!|*ldjQva!%%!yjGva)gj!1!>>!SFQQJMD`YPC`YBN!gj$!<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw<^UDFKCP`XPMG`YBN]yjsubNxpmg!5ubn!nspgjov1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!<esppDxpebit!5dfw!hojzsbw<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<yjsubNwVv!4ubn!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",dl="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVw!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!gjeof$!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!ftmf$!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!3QYF`HPG!gfegj$!<{/yfusfWw.!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!!EOF`QPPM`MMPSOV$!~<chs/*^j]wVxpmg!-^J]fsvuyfUxpmg)E3fsvuyfu!!>,!chs/eJ!****1/1)3dfw!-^j]wVxpmg)obiUsfubfsh)mmb!%%!***1/2)3dfw!-^j]wVxpmg)obiUttfm)mmb!%%!^j]efmcboFxpmg)!gj|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1>j!uoj)!spg!USBUT`QPPM`MMPSOV$!!1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ!gjeof$!<*spmpDwof)sbfojMpUmfyfUqbNwof!>!spmpDwof<**{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv)fcvDfsvuyfu!>!spmpDwof!5dfw!ftmf$!<**ttfoihvps!-*{z/dfWudfmgfs!-y/dfWudfmgfs.)4dfw!-qbNwoFv)WVfcvDfsvuyfu)CHStpUsbfojM!>!spmpDwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!<*mbnspOemspx!-yfusfWpUbsfnbd)udfmgfs!>!dfWudfmgfs!4dfw<*yjsubNxfjWv!-O)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*opjujtpQbsfnbDv!.!emspXw)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!!<osvufs!<esbdtje!!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*fdobutjEitbEv!?!*fdobutjEqbHitbEv!-fdobutjEfojMw)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj!gjeof$!~~!<osvufs!<esbdtje!|!****ojNqjmd!-mbdpMw)obiUsfubfsh)mmb!%%!**ybNqjmd!-mbdpMw)obiUttfm)mmb)!>a!^j]sfooJqjmDsfqqjmDv!%%!^j]qjmDypCfmcboFv)!gj<**1/2!-emspXw)5dfw!+!^j]yjsubNsfqqjmDv)4dfw!>!mbdpMw|!*,,j!<SFQQJMD`YPC`YBN!=!j!<1>j!uoj)spg<mbdpMw!4dfw!1!?!SFQQJMD`YPC`YBN!gj$!~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw<uvpldbmc!mppc!nspgjov!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw<^UDFKCP`XPMG`YBN]efmcboFxpmg!mppc!nspgjov<^UDFKCP`XPMG`YBN]fsvuyfUxpmg!E3sfmqnbt!nspgjov!1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!!gjeof$!!~~<*1/2!-*Gqjn!-2spmpd!-1spmpd)yjn)5dfw!osvufs<*1/2!,!uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!2spmpd!4dfw|!ftmf!~<*1/2!-1spmpd)5dfw!osvufs|!*1/1!>>!Gqjn)!gj<*uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!1spmpd!4dfw<*qjn)sppmg!>!uoJqjn!ubpmg<*qjn)udbsg!>!Gqjn!ubpmg<*mfwfMqjNybn`WVfcvd!-1n!-*ttfoihvps)qjNpUttfoihvps)qnbmd!>!qjn!ubpmg|!*ttfoihvps!ubpmg!-sjEfmqnbt!4dfw!-qbNwof!E3sfmqnbt)WVfcvDfsvuyfu!5dfw!~<qjn!osvufs~<*ttfoihvps!+!72/2)3hpm!+!1/3!.!>!qjn|!ftmf!~<6n!,!*7s!.!6s)!0!*6n!.!7n)!+!*ttfoihvps!.!6s)!>!qjn|!*7s!>?!ttfoihvps)!gj!ftmf!~<5n!,!*6s!.!5s)!0!*5n!.!6n)!+!*ttfoihvps!.!5s)!>!qjn|!*6s!>?!ttfoihvps)!gj!ftmf!~<2n!,!*5s!.!2s)!0!*2n!.!5n)!+!*ttfoihvps!.!2s)!>!qjn|!*5s!>?!ttfoihvps)!gj!ftmf!~<1n!,!*2s!.!1s)!0!*1n!.!2n)!+!*ttfoihvps!.!1s)!>!qjn|!*2s!>?!ttfoihvps)!gj<1/1!>!qjn!ubpmg|!*ttfoihvps!ubpmg)qjNpUttfoihvps!ubpmg!1/5!7n!fojgfe$!9411/1!7w!fojgfe$!23/1!7s!fojgfe$!1/4!6n!fojgfe$!721/1!6w!fojgfe$!614/1!6s!fojgfe$!1/3!5n!fojgfe$!751/1!5w!fojgfe$!5/1!5s!fojgfe$!1/2!.!2n!fojgfe$!783/1!2w!fojgfe$!9/1!2s!fojgfe$!1/3!.!1n!fojgfe$!:44/1!1w!fojgfe$!1/2!1s!fojgfe$!~<*z/g!-nc!-nu)yjn!osvufs<*y/g!-sc!-mc)yjn!>!nc!4dfw<*y/g!-su!-mu)yjn!>!nu!4dfw<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mc!4dfw<f{jTmfyfu!>.!y/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!sc!4dfw<f{jTmfyfu!>,!z/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!su!4dfw<f{jTmfyfu!>,!y/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mu!4dfw<f{jTmfyfu!>+!wv<*f{jTfdbg!+!1/3!.!f{jTfmjUybn`WVfcvd!-1/1)ybn!+!1/4!>,!y/wv<f{jTfmjUojn`WVfcvd!+!1/3!+!uoJsfumjg!>,!z/wv~<f{jTfmjUybn`WVfcvd!+!1/3!>,!z/wv|!*mfwfMqjNybn`WVfcvd!=!uoJqjn)!gj<f{jTfdbg!+!fdbg!>,!y/wv~<1/4!>.!fdbg<f{jTfdbg!>,!z/wv|!*1/3!?!fdbg)!gj<g!.!6/1!>,!wv<*wv)udbsg!>!g!3dfw<*1/2!.!f{jTfdbg)!+!*fdbg!-opjudfsje)WVufh!>!wv!3dfw<*f{jTfmjUybn`WVfcvd!+!1/4)!0!1/2!>!f{jTmfyfu!ubpmg<*uoJqjn)3qyf!>!f{jTfdbg!ubpmg<*mfwfMqjNojn`WVfcvd!-uoJqjn)ybn!>!uoJqjn<*1/1!-uoJqjn!.!mfwfMqjNojn`WVfcvd)ybn!>!uoJsfumjg!ubpmg<*opjudfsje)fdbGufh!>!fdbg!ubpmg|!*uoJqjn!ubpmg!-opjudfsje!4dfw!-qbNwof!E3sfmqnbt)WVfcvDsbfojmjc!4dfw!~<*1/2!,!wv)!+!6/1!osvufs~<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje)3dfw!>!wv|!ftmf!~<*z/opjudfsje)tcb!0!*{/opjudfsje!-y/opjudfsje!.)3dfw!>!wv|!*1/5!>>!fdbg)!gj!ftmf!~<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje!.)3dfw!>!wv|!*1/4!>>!fdbg)!gj!ftmf!~<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje!.)3dfw!>!wv|!*1/3!>>!fdbg)!gj!ftmf!~<*z/opjudfsje)tcb!0!*{/opjudfsje!.!-y/opjudfsje!.)3dfw!>!wv|!*1/2!>>!fdbg)!gj!ftmf!~<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje)3dfw!>!wv|!*1/1!>>!fdbg)!gj<wv!3dfw|!*fdbg!ubpmg!-opjudfsje!4dfw)WVufh!3dfw!~<fdbg!osvufs~<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/6!;!1/3!@!1/1!?!{/opjudfsje!>!fdbg!*z/opjudfsjEtcb!?!{/opjudfsjEtcb)!gj|!ftmf!~<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/4!;!1/1!@!1/1!?!y/opjudfsje!>!fdbg*z/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj|!*{/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj<1/2!.!>!fdbg!ubpmg<*opjudfsje)tcb!>!opjudfsjEtcb!4dfw|!*opjudfsje!4dfw)fdbGufh!ubpmg!1/72!f{jTfmjUojn`WVfcvd!fojgfe$!1/763!f{jTfmjUybn`WVfcvd!fojgfe$!1/5!mfwfMqjNojn`WVfcvd!fojgfe$!1/9!mfwfMqjNybn`WVfcvd!fojgfe$!WV`FCVD`FQZU`QBNWOF!gfegj$!~<*{zy/*yjsubn!+!*1/1!-sje)5dfw))f{jmbnspo!osvufs|!*yjsubn!5ubn!oj!-sje!4dfw!oj)opjudfsjEnspgtobsUftsfwoj!4dfw!gjeof$!~!<*x/fvmbw!-**SPUDBG`BNNBH)4dfw!-{zy/fvmbw)xpq)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!ftmf$!~<*!b/fvmbw!-*!*!*!*!9142411/1!)4dfw!-chs/fvmbw!)mbvrFobiUttfm!)4dfw!-3:/32!+!chs/fvmbw!-*!661/1!)4dfw!.!661/2!+!*!*!77725/1!)4dfw!-chs/fvmbw!)xpq!)yjn!)5dfw!osvufs!|!*!fvmbw!5dfw!oj!)CHStpUsbfojM!5dfw~!<*b/fvmbw!-****65151/1)4dfw!-chs/fvmbw)mbvrFobiUttfm)4dfw!-9194::4881/1!+!chs/fvmbw!-**5/3)4dfw!-*5218342361/1)4dfw!,!79:387985:/1!+!chs/fvmbw)xpq)yjn)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!QBNWOF`FTV!gfegj$!!gjeof$!~!!!!!!!!gjeof$!!!!!!!!!!!!<*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!osvufs!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*qe!-*z/f{jTmfyfu!-yyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!osvufs!!!!!!!!!!!!!!!!<z/f{jTmfyfu!+!tvjebSxpebit!+!*2!-2!.)3dfw!>!uftggp!3dfw!!!!!!!!!!!!!!!!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!}}!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!!!!!!!!!!!!<*opjujtpQpUuihjm)f{jmbnspo!>!E4ec!4dfw!!!!!!!!!!!!<tbjCxpebit!>,!qe!!!!!!!!<*sbfObsfnbDxpebit!.!sbGbsfnbDxpebit)!0!*sbfObsfnbDxpebit!.!*opjujtpQpUuihjm)iuhofm)!>!qe!ubpmg!!!!!!!!!!!!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!!!!!!!!!!!!<**1/3!-1/5)3dfw!+!f{jTqbNxpebit)!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!|!*sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTuojpQufh!ubpmg!!!!!!!!~!!!!!!!!<*68/1!-684/1)3dfw!,!sbobmq!+!*63/1!-632/1)3dfw!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!!!!!!!!!!!!!!!!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*z/w)ohjt!>!Zohjt!ubpmg!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!z/Wtcb)!gj!ftmf!~!!!!!!!!!!!!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*y/w)ohjt!>!Yohjt!ubpmg!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!y/Wtcb)!gj!ftmf!~!!!!!!!!!!!!<y/w!.!1/5!>!y/sbobmq!!!!!!!!!!!!!!!!!!!!*1/1!?!{/w)!gj!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!{/Wtcb)!gj!!!!!!!!!!!!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!!!!!!!!!!!!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!!!!!!!!!!!!<zy/w!>!sbobmq!3dfw!!!!!!!!!!!!<*Zf{jTmfyfu!+!1/3!.!1/2)!+!fcvDpUfmbdt!>+!w!!!!!!!!!!!!<fcvDpUfmbdt!>+!Wtcb!!!!!!!!!!!!<**{/Wtcb!-z/Wtcb)ybn!-y/Wtcb)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!!!!!!!!!!!!<*w)tcb!>!Wtcb!4dfw!!!!!!!!!!!!|!*Zf{jTmfyfu!ubpmg!-w!4dfw)WVpUfcvd!3dfw!!!!!!!!~!!!!!!!!<xpebit!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!gjeof$!!!!!!!!!!!!<*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!>!xpebit!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!gjmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!!!!!!!!!!!!|!*utfUnvutvsg)!gj!!!!!!!!!!!!<*dfWutfUnvutvsg)mmb!>!utfUnvutvsg!mppc!!!!!!!!!!!!<*1/2!>=!{/esppDxpebit!-nvutvsGoj)3dfwc!>!dfWutfUnvutvsg!3dfwc!!!!!!!!!!!!<*dfWnvutvsGoj)mmb!>!nvutvsGoj!mppc!!!!!!!!!!!!<*1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit)!5dfwc!>!dfWnvutvsGoj!5dfwc!!!!!!!!!!!!<tbjCxpebit!>,!{/esppDxpebit!!!!!!!!!!!!<x/esppDxpebit!>0!{zy/esppDxpebit!!!!!!!!!!!!<1/2!>!xpebit!ubpmg!!!!!!!!!!!!|!*esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTufh!ubpmg!!!!!!!!~!!!!!!!!<d!osvufs!!!!!!!!!!!!<*y/g!-c!-b)yjn!>!d!ubpmg!!!!!!!!!!!!<*z/g!-us!-cs)yjn!>!c!ubpmg!!!!!!!!!!!!<*z/g!-um!-cm)yjn!>!b!ubpmg!!!!!!!!!!!!<*6/1!,!f{jt!+!wv)udbsg!>!g!3dfw!!!!!!!!!!!!<*fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!us!ubpmg!!!!!!!!!!!!<*fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cs!ubpmg!!!!!!!!!!!!<*fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!um!ubpmg!!!!!!!!!!!!<*fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cm!ubpmg!!!!!!!!!!!!<f{jt!0!*6/1!,!f{jt!+!wv)sppmg!>!WVejpsuofd!3dfw!!!!!!!!!!!!<f{jt!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!<*1/2!-1/1)3dfw!>!uftggp!3dfw!utopd!!!!!!!!!!!!|!*fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt)qsfMxpebiTE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<***wv!-tiuqfe)E3fsvuyfu)iuqfEpUBCHSldbqov!-fsbqnpd)qfut!osvufs!!!!!!!!!!!!|!*fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt)fsbqnpDE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*tspudbGldbqoV!-w)upe!osvufs|!*w!5dfw!oj!utopd)iuqfEpUBCHSldbqov!ubpmg!!!!!!!!<*/2!-tspudbGldbQ)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!!!!!!!!<*/763!!-/763!+!/763!-/763!+!/763!+!/763)4dfw!>!tspudbGldbQ!4dfw!utopd!!!!!!!!<*2!hojevmdyf)!opjudbsg!?.!2//1!00!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!!!!!!!!<*2!hojevmdoj)!2//1!?.!opjudbsg!00!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!!!!!!!!<esppDxpebit!5dfw!hojzsbw<fwjfdfSxpebit!mppc!nspgjov<tvjebSxpebit!ubpmg!nspgjov<tbjCxpebit!ubpmg!nspgjov<zujtofuoJxpebit!ubpmg!nspgjov<f{jTxpebit!3dfw!nspgjov<qbNxpebit!E3sfmqnbt!nspgjov<mmvDxpebit!mppc!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov!ftmf$!<zujtofEhpGv!ubpmg!nspgjov!3QYF`HPG!gfegj$!<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<*6/1!-6/1!-6/1)4dfw!>!ybNqjmd!4dfw!utopd<*6/1.!-6/1.!-6/1.)4dfw!>!ojNqjmd!4dfw!utopd<^SFQQJMD`YPC`YBN]yjsubNsfqqjmDv!5ubn!nspgjov<^SFQQJMD`YPC`YBN]sfooJqjmDsfqqjmDv!mppc!nspgjov<^SFQQJMD`YPC`YBN]qjmDypCfmcboFv!mppc!nspgjov!1!?!SFQQJMD`YPC`YBN!gj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!!gjeof$!<qbNwoFv!fcvDsfmqnbt!nspgjov!ftmf$!<ttfoihvps!ubpmg!nspgjov<qbNwoFv!E3sfmqnbt!nspgjov!WV`FCVD`FQZU`QBNWOF!gfegj$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";
Xi(z,{setBatchInfo:function(t,I){Ll[t]=I},getBatchInfo:function(m){return Ll[m]},getBatchInfoMap:function(){return Ll},setBatchInfoMap:function(t){Ll=t}},!0);var eg=[1,1,1],qh=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],zf=[1,0,0,0,0,1,0,1,1,1,1,0],De=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Rq=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Ir=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Aj=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],uj=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],_o=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Mq=function(o,K){var M=o._40Q;M.each(function(x){x.ivBatch(K)})},nd=function(E,p,z){var l=z._id,w=p[l];if(w){var X=w.batch,b=E[X],J=b.ds,n=w.index;if(b.invalidate=!0,delete p[l],J.splice(n,1),ks(J))return delete E[X],void 0;for(var C=w.begin,Z=w.size,c=3*C,m=3*Z,x=4*C,G=4*Z,Y=b.vs,g=b.ps,k=b.uv,v=b.cs,s=b.bs,I=b.rs,D=b.ns,K=b.ls;n<J.length;n++)w=p[J[n]._id],w.index--,w.begin-=Z;Y.splice(c,m),g.splice(x,G),k&&k.splice(2*C,2*Z),v&&v.splice(x,G),s&&s.splice(c,m),I&&I.splice(C,Z),D&&D.splice(c,m),K&&K.splice(C,Z)}},Md=function(k,m,t,V,e){if(!V)return I;var u=m[V];if(!u){var X=e.getBatchInfo(V)||sd,f=X.image?[]:I;u=m[V]={vs:[],ns:[],uv:f,cs:f?I:X.color?I:[],bs:X.blend?[]:I,ps:[],rs:X.brightness?[]:I,ds:[]}}return u.invalidate=!0,k[t._id]={index:u.ds.length,begin:u.vs.length/3,batch:V},u.ds.push(t),u},eh=function(g,C){return C!=I&&1!==C?[g[0]*C,g[1]*C,g[2]*C,g[3]]:g},bp=function(t){var j=t.shapeModel;j||(j=bg(t)),j&&(j._ctlineModel=[],j._lineModel=_)},nc=function(){var I;return function(O,o,V){var m=O.getData3dUI(o),C=m.shapeModel;if(C||(C=bg(m)),C||!m.shapeName){var r,g=o.s("wf.combineTriangle");if(V.geometry){if(!C&&(o instanceof A.Node&&!(o instanceof A.Shape)?(I||(I={vs:Vf,is:ap,uv:lm}),C=I):C=[m.left,m.front,m.right,m.back,m.top,m.bottom],!C))return _;if(g){var F=o.s("wf.normEpsilon");isNaN(F)&&(F=2),g=0|Math.min(3,Math.max(1,isNaN(g)?1:g)),r=Lo[g-1](C,m,180/(Math.PI*F))}else r=Um(C,m);if(!r||0===r.length)return}else r=V.short?Ng:ri;var k,t=O.getBrightness(o),b=o.s("bloom"),h=o.s("3d.reflectable"),P=Tj(V.color||"white"),Q=P[3]<1,W=Math.ceil(V.width)||1,E=o.s("3d.clipbox")?Ak:o.s("3d.clipbox.mask"),y=o.getRenderLayer(),q=O._40Q.get(y),n=q.wireframeIndexMap,v=q.wireframeModelMap,U=o.s("batch");k=U?(Q?"T":"O")+U:(Q?"T":"O")+(b?"_1":"_0")+(h?"1_":"0_")+E+"_"+W;var z=v[k];z||(z=v[k]={vs:[],cs:[],ps:[],ds:[],T:Q,B:b,clipboxMask:E,reflectable:!!h,W:W,batch:U}),z.invalidate=!0;var B=z.vs,D=z.cs,T=z.ds,c=n[o._id]={index:T.length,begin:B.length/3,batch:k};T.push(o);var l=m.mat;o instanceof A.Edge||!(!l||!V.geometry&&o instanceof A.Shape)||(l=Gq(o,V.mat),o.appendAnchorMatrix3d(l)),Od(B,l,r);var S=c.size=B.length/3-c.begin;Qo(D,eh(P,t),S)}}}(),zj=function(c,U,b,d,D,s,O,u,$){var A=c.getBrightness(U);A==I&&(A=1);var o=eh(Tj(d),A),F=o[3]<1;s=Math.ceil(s)||1;var H=(F?"T":"O")+s;if(O){var p=O[0],w=(O[1]||p)+p;H+="-"+p+"-"+w,$&&(H+="-"+Yc($)+"-"+A,$=eh(Tj($),A))}var P=U.getRenderLayer(),T=c._40Q.get(P),S=T.polylineIndexMap,W=T.polylineModelMap,B=W[H];B||(B=W[H]={vs:[],cs:[],ps:[],ds:[],ls:O?[]:I,T:F,W:s},O&&(B.D=p,B.G=w,B.A=$)),B.invalidate=!0;var E,g=B.vs,r=B.cs,K=B.ds,L=B.ls,f=S[U._id]={index:K.length,begin:g.length/3,batch:H};K.push(U),Gf(g,b);var C,Z=f.size=g.length/3-f.begin,Q=b.length,X=0,j=[];if(O||D)for(E=0;Q>E;E+=6)C=Hd([b[E],b[E+1],b[E+2]],[b[E+3],b[E+4],b[E+5]]),j.push(C),X+=C;if(X&&D){var q,t=eh(Tj(D),A),z=[t[0]-o[0],t[1]-o[1],t[2]-o[2],t[3]-o[3]],m=0;for(E=0;Q>E;E+=6)q=m/X,Qo(r,[o[0]+z[0]*q,o[1]+z[1]*q,o[2]+z[2]*q,o[3]+z[3]*q],1),m+=j[E/6],q=m/X,Qo(r,[o[0]+z[0]*q,o[1]+z[1]*q,o[2]+z[2]*q,o[3]+z[3]*q],1)}else Qo(r,o,Z);if(O)for(m=u||0,E=0;Q>E;E+=6)L.push(m),m+=j[E/6],L.push(m)},kj=function(L,N,B){if(N){var K=4*N.begin,h=B[N.batch].ps;if(h[K]!==L[0]||h[K+1]!==L[1]||h[K+2]!==L[2]||h[K+3]!==L[3]){for(var y=0;y<N.size;y++)h[K++]=L[0],h[K++]=L[1],h[K++]=L[2],h[K++]=L[3];h._invalidateThisFrame=!0}}},tf=function(){var Y=new A.Math.Vector3,a=new A.Math.Vector3;return function(n,T){var k=T+["32"],g=n[T],N=n[k];if(g){if(z.extractBatchTranslation&&"vs"===T){a.set(0,0,0);for(var E=g.length,R=0;E>R;R+=3)a.add(Y.fromArray(g,R));a.divideScalar(E/3);for(var u=a.x,b=a.y,h=a.z,V=new Array(E),R=0;E>R;R+=3)V[R]=g[R]-u,V[R+1]=g[R+1]-b,V[R+2]=g[R+2]-h;g=V,n.translate=[u,b,h]}N&&N.length===g.length?(N.set(g),N._bufId=null):n[k]=new _p(g)}else delete n[k]}}(),Ae=function(x,p,S,Z,H,V,U,g){if(gc(S))S.forEach(function(k){Ae(x,p,k,Z,H,V,U,g)});else if(Fp(S))Ae(x,p,bg(Z,S),Z,H,V,U,g);else if(qf(S)){var b,s=ui(S.mat,p,x),F=ui(S.s3,p,x),M=ui(S.t3,p,x),f=ui(S.r3,p,x);if((F||f||M||s)&&(b=dd(s,F,f,ui(S.rotationMode,p,x),M),V.push(b)),S.shape3d)Ae(x,p,S.shape3d,Z,H,V,U,S);else{var D=Z.s;g=g||sd;var t=V[0],R=V.length,e=D("shape3d.color",S.color,g.color);if(H||(H=D("shape3d.blend",S.blend,g.blend)),R>1){t=yj(t);for(var i=1;R>i;i++)Vb(t,t,V[i])}var G=t?qj(t):I;S.vs&&D(er,S.visible,g.visible)&&Ej(t,U,S.vs,S.uv,S.is,S.ns,G,H,e),S.top_vs&&D(Sm,S.topVisible,g.topVisible)&&Ej(t,U,S.top_vs,S.top_uv,S.top_is,S.top_ns,G,H,D("shape3d.top.color",S.topColor,g.topColor)||e),S.bottom_vs&&D(Ig,S.bottomVisible,g.bottomVisible)&&Ej(t,U,S.bottom_vs,S.bottom_uv,S.bottom_is,S.bottom_ns,G,H,D("shape3d.bottom.color",S.bottomColor,g.bottomColor)||e),S.from_vs&&D(xq,S.fromVisible,g.fromVisible)&&Ej(t,U,S.from_vs,S.from_uv,S.from_is,S.from_ns,G,H,D("shape3d.from.color",S.fromColor,g.fromColor)||e),S.to_vs&&D(pf,S.toVisible,g.toVisible)&&Ej(t,U,S.to_vs,S.to_uv,S.to_is,S.to_ns,G,H,D("shape3d.to.color",S.toColor,g.toColor)||e)}b&&V.pop()}},Ej=function(l,S,L,I,T,J,b,K,y){var U,g=S.cs,N=S.uv,i=S.bs,Q=S.ns,e=S.vs;if(J&&0!==J.length||(J=Sl(L,T)),T){U=T.length;for(var O=0;U>O;O++){var p=T[O],d=3*p;Od(e,l,[L[d],L[d+1],L[d+2]]),Od(Q,b,[J[d],J[d+1],J[d+2]]),N&&Gf(N,[I[2*p],I[2*p+1]])}}else U=L.length/3,Od(e,l,L),Od(Q,b,J),N&&Gf(N,I);g&&Qo(g,y,U),i&&(K?_h(i,K,U):Gf(i,eg,U))},Qg=function(B,x,z,h){h?Ae(B.gv,B.data,h,B,B.getBodyColor(),[x],z):(zq(B,iq,x,z),zq(B,bq,x,z),zq(B,Pd,x,z),zq(B,rm,x,z),zq(B,wg,x,z),zq(B,wn,x,z),zq(B,"csg",x,z))},zq=function(w,y,D,W){var T=w[y];if(T){var v=T.tuv;if(v){var $=T.uvScale,o=T.uvOffset,k=T.uvRotation,u=T.uvAnchor;if($||o||k){var Y,L,n,E=ef(k,o,$,u),M=E.a,p=E.b,h=E.c,S=E.d,O=E.tx,F=E.ty,q=v.length;for(n=0;q>n;n+=2)Y=v[n],L=v[n+1],v[n]=M*Y+h*L+O,v[n+1]=p*Y+S*L+F}}Ej(D,W,T.vs,v,I,I,D?qj(D):I,T.blend,T.color)}},no=function(g,G,b,O,z,E,I,i){var R,C=b.cs,m=b.uv,M=b.bs,Q=b.vs,H=b.ns,s=Sl(i);if(g.getFaceVisible(G,I)){var h=g.getFaceMat(G,I);if(h&&(z=Gq(G,h),E=qj(z)),Od(Q,z,i),Od(H,E,s),C&&Qo(C,g.getFaceColor(G,I),6),m){var Y=g.getFaceUv(G,I)||O[I+"Uv"],l=g.getFaceUvScale(G,I)||O[I+"UvScale"],A=g.getFaceUvOffset(G,I)||O[I+"UvOffset"],k=g.getFaceUvRotation(G,I)||O[I+"UvRotation"],f=g.getFaceUvAnchor(G,I)||O[I+"UvAnchor"];Y=Y?[Y[6],Y[7],Y[0],Y[1],Y[2],Y[3],Y[2],Y[3],Y[4],Y[5],Y[6],Y[7]]:zf;var Z=Y[0],B=Y[1],p=Y[2],a=Y[3],L=Y[4],x=Y[5],X=Y[6],y=Y[7],U=Y[8],V=Y[9],w=Y[10],_=Y[11];if(l||A||k||f){var r=ef(k,A,l,f),c=r.a,S=r.b,j=r.c,t=r.d,N=r.tx,K=r.ty;Z=c*Z+j*B+N,B=S*Z+t*B+K,p=c*p+j*a+N,a=S*p+t*a+K,L=c*L+j*x+N,x=S*L+t*x+K,X=c*X+j*y+N,y=S*X+t*y+K,U=c*U+j*V+N,V=S*U+t*V+K,w=c*w+j*_+N,_=S*w+t*_+K}m.push(Z,B,p,a,L,x,X,y,U,V,w,_)}M&&(R=g.getBodyColor(G)||g.getFaceBlend(G,I),R?_h(M,R,6):Gf(M,eg,6))}},qq=function(l,x,r,u){var r=l._picking?l.pickColorMap:null,Y=l.getGL(),d=l._prg,W=l._buffer;if(!Ze(x)){$n(l,qh),xk(Y,d);for(var f in x){var b,Q,M,T,R=x[f];if(R.batch){var J=l.getBatchInfo(R.batch)||sd;b=J.wfBloom===_?J.bloom:J.wfBloom,Q=J.wfReflectable===_?J.reflectable:J.wfReflectable,M=J.wfClipboxMask===_?J.clipboxMask:J.wfClipboxMask,T=J.width}else b=R.B,Q=R.reflectable,M=R.clipboxMask,T=R.W;if(!(u&&!R.T||!u&&R.T||l.isReflecting(Y)&&Q===!1)){R.invalidate?(R.invalidate=!1,tf(R,"vs"),tf(R,"cs"),tf(R,"ls"),tf(R,"ps")):r&&R.ps&&R.ps._invalidateThisFrame&&(R.ps._invalidateThisFrame=!1,tf(R,"ps"));var z=R.translate;z&&$n(l,[1,0,0,0,0,1,0,0,0,0,1,0,z[0],z[1],z[2],1]);var v=R.vs32,F=r?R.ps32:R.cs32;fg(Y,d,T,I,W.vs,v);var w=qb.for(Y),S=w.directUniforms(),y=w.directAttribs(),Z=R.D,E=!l._dashDisabled&&Z;S.uAlphaTest=s.alphaTest,Y._blooming&&!b&&(S.blackout=!0),vo(l,S,M===_?cs:M),E&&(S.uDash=!0,S.uDashDistance=Z,S.uDashGapDistance=R.G,S.uDiffuse=R.A||s["color.empty"],y.aLineDistance=Pp(Y,W.lineDistance,R.ls32,I,1));var L=!l._batchColorDisabled;L&&F.length?(S.uBatchColor=!0,y.aBatchColor=Pp(Y,W.batchColor,F,I,4)):(S.uBatchColor=!1,y.aBatchColor=!1),gk(Y),bj(Y,0,v.length/3,Y.LINES),ah(Y),L&&(S.uBatchColor=!1,y.aBatchColor=!1),E&&(S.uDash=!1,y.aLineDistance=!1),Y._blooming&&!b&&(S.blackout=!1),z&&Lg(l)}}kc(Y,d),Lg(l)}},Uc=function(S){S.invalidate=!1,tf(S,"vs"),tf(S,"ns"),tf(S,"cs"),tf(S,"rs"),tf(S,"ps"),tf(S,"bs"),tf(S,"uv")},Wf=function(w,k,r,Q,R){var M,F,L,Z,h,v,G,O,c,A,J,t,r=w._picking?w.pickColorMap:null,U=w.getGL(),E=w._prg,p=qb.for(U),b=p.directUniforms(),y=p.directAttribs(),m=w._buffer;if(!Ze(k)&&!w.drawFilter){$n(w,qh);for(M in k)if(F=w.getBatchInfo(M)||sd,F.visible!==!1&&!(Q&&!F.transparent||!Q&&F.transparent||w.isReflecting(U)&&F.reflectable===!1)){var $=F.renderLayerMask;if($==I&&($=kg),R==I&&(R=kg),Ne(R,$)&&(L=k[M],r||!F.transparentMask)){var z=Q&&F.autoSort===!0&&(w._33Q||L.invalidate);if(L.invalidate?Uc(L):r&&L.ps&&L.ps._invalidateThisFrame&&(L.ps._invalidateThisFrame=!1,tf(L,"ps")),h=L.vs32,v=r?L.ps32:L.cs32,c=L.uv32,G=L.bs32,O=L.rs32,J=h.length/3,z){var H=sp(h,w.getEye(),w);H?(L.is=H.is,L.elementTypeUint=H.useUint32):(L.is=null,L.elementTypeUint=null)}if(J){t=L.translate,t&&$n(w,[1,0,0,0,0,1,0,0,0,0,1,0,t[0],t[1],t[2],1]),Z=F.light,A=w.getTexture(F.image),gd(U,E,I,F.light,F.opacity,F.reverseFlip,F.reverseColor,F.reverseCull),v?w._batchColorDisabled?(b.uBatchColor=!1,y.aBatchColor=!1):(b.uBatchColor=!0,y.aBatchColor=Pp(U,m.batchColor,v,I,4)):(b.uBatchColor=!1,b.uDiffuse=F.color||s["color.empty"]);var x=F.alphaTest;b.uAlphaTest=x===_?s.alphaTest:x,b.shadowReceive=!r&&F.shadowReceive!==!1,vo(w,b,F.clipboxMask===_?cs:F.clipboxMask),dk(w,b,F.lightMask===_?cs:F.lightMask,F.headlightAmbientIntensity),U._blooming&&!F.bloom&&(b.blackout=!0),F.envmap!==_?(b.uUseEnvMap=!0,b.uReflectivity=F.envmap,b.roughness=F.roughness||0,w._setEnvmapByProbeId(b,F.envmapProbe||0)):(b.uUseEnvMap=!1,b.uReflectivity=0);var q=G&&!w._batchBlendDisabled;q&&(b.uBatchBlend=!0,y.aBatchBlend=Pp(U,m.batchBlend,G,I));var P=O&&!w._batchBrightnessDisabled;P&&(b.uBatchBrightness=!0,y.aBatchBrightness=Pp(U,m.batchBrightness,O,I,1)),c?gk(U,E,A,F.discardSelectable,m.uv,c,F.uvOffset,F.uvScale,F.uvRotation,F.uvAnchor):gk(U),y.aPosition=Pp(U,m.vs,h,I),y.aNormal=Pp(U,m.ns,L.ns32,I),L.is?(di(U,m.is,L.is),cd(U,0,J,null,L.elementTypeUint?U.UNSIGNED_INT:null)):bj(U,0,J),c?ah(U,E,A):ah(U),v&&!w._batchColorDisabled&&(b.uBatchColor=!1,y.aBatchColor=!1),q&&(b.uBatchBlend=!1,y.aBatchBlend=!1),P&&(b.uBatchBrightness=!1,y.aBatchBrightness=!1),U._blooming&&!F.bloom&&(b.blackout=!1),Rr(U,E),t&&Lg(w)}}}Lg(w)}},sp=function(n,j,q){var Y=n.length/3,D=Y>65535,p=q._glCapabilities.elementTypeUint&&D;if(!p&&D)return null;for(var I=new Array(Y),V=Y/3,l=new Array(V),G=0;V>G;G++)l[G]=G;l.sort(function(w,a){var G=9*w,D=[(n[G]+n[G+3]+2*n[G+6])/4,(n[G+1]+n[G+4]+2*n[G+7])/4,(n[G+2]+n[G+5]+2*n[G+8])/4];G=9*a;var u=[(n[G]+n[G+3]+2*n[G+6])/4,(n[G+1]+n[G+4]+2*n[G+7])/4,(n[G+2]+n[G+5]+2*n[G+8])/4],b=Hd(j,D)-Hd(j,u);return b>0?-1:0>b?1:0});for(var G=0;V>G;G++){var m=3*G,S=3*l[G];I[m]=S,I[m+1]=S+1,I[m+2]=S+2}return{useUint32:p,is:p?new Uint32Array(I):new Xg(I)}},fs={obj:function(c,S){var $={mat:c.mat,s3:c.s3,r3:c.r3,rotationMode:c.rotationMode,t3:c.t3,cube:c.cube==I?!0:c.cube,center:c.center==I?!0:c.center,ignoreMtls:c.ignoreMtls,ignoreTransparent:c.ignoreTransparent,ignoreColor:c.ignoreColor,ignoreImage:c.ignoreImage,ignoreNormal:c.ignoreNormal,prefix:c.prefix,flipY:c.flipY,flipFace:c.flipFace,reverseFlipMtls:c.reverseFlipMtls,finishFunc:function(F,o){if(F){var o=[];for(var h in F){var X=F[h];o.rawS3=X.rawS3,X.center&&(o.center=X.center),o.push(X),c.eachModel&&c.eachModel(h,X)}o.json=c,S(o)}else S()}};z.loadObj(c.obj,c.mtl,$)},bin:function(p,c){var k={finishFunc:function(e){e?c(e):c()}};z.loadBin(p.url,k)}};z.getModelTypeHandlers=function(){return fs},z.setModelTypeHandler=function(r,K){fs[r]=K},z.getModelTypeHandler=function(t){return fs[t]},z.handleModelLoaded=function(){},z.handleUnfoundModel=function(){};var Gr=I,$r=I,gf=function(M){Gr&&!M._loadingModelView_&&($r||($r={}),$r[M._loadingModelView_=Nr()]=M)},Cn=function(L,N){Gr||(Gr={});var q=Gr[L];if(q){if(q.url===N)return;q.request.onload=jb,q.request.onerror=jb}if(N.indexOf(".bin")===N.length-4)return Kc(L,{modelType:"bin",url:N},N);if(N=z.beforeLoadURL(N),N.data){var l=z.parse(N.data);Kc(L,l,N)}else{var E=new ld;Gr[L]={request:E,url:N},E.onload=function(){if(200===this.status||0===this.status){delete Gr[L];var c=z.parse(E.getResponseText());Kc(L,c,N)}else Sk(L,z.handleUnfoundModel(L,N)||I)},E.onerror=function(){Sk(L,z.handleUnfoundModel(L,N)||I)};var A={};A.url=encodeURI(N),A.sync=!1,E.send(A)}},Kc=function(A,m,U){var B=m.modelType;if(!B)return Sk(A,m),z.handleModelLoaded(A,m),void 0;var F=z.getModelTypeHandler(B);if(F){if(Gr||(Gr={}),Gr[A])return;Gr[A]=!0;var L=function(v){v?(Sk(A,v),z.handleModelLoaded(A,v)):Sk(A,z.handleUnfoundModel(A,U,m)||I)};F(m,L)}else Sk(A,z.handleUnfoundModel(A,U,m)||I)},Sk=function(g,H){if(delete Gr[g],Fp(H)&&Rb.test(H))return Cn(g,H),void 0;if(Pi[g]=H,Ze(Gr)&&(Gr=I,$r)){for(var E in $r){var e=$r[E];e.invalidateAll&&e.invalidateAll(_,"modelLoaded",g),e.redraw&&e.redraw(),e.iv(),delete e._loadingModelView_}$r=I}if(H&&$r)for(var E in $r){var e=$r[E];e.invalidateAll&&e.invalidateAll(_,"modelLoading",g),e.redraw&&e.redraw(),e.iv()}},bs=new _p([0,0,0,1,1,1,1,0]),ln=new _p([0,0,1,0,0,1,0,0,1,0,0,1]),Db=new Xg([0,1,2,2,3,0]),Vf=new _p([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),ap=new Xg([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),lm=new _p([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Cb=Sl(Vf,ap),lj=(new _p([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Xg([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[iq,Pd,bq,rm,wg,wn]),ri=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Ng=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Zh=function(F,e,a,U,N,p,v){p=p||16,F=F||16,e=e||0,a=a||F;var A,i,M,b,n,z,j,u,E,f=.5,O=[],K=[],s=$/F,V=h/p;for(A=0;p>A;A++)for(z=A+1,b=A*V,E=z*V,i=e;a>i;i++)j=i+1,M=i*s,u=j*s,O.push(f*d(b)*l(M),f*l(b),-f*d(b)*d(M),f*d(E)*l(u),f*l(E),-f*d(E)*d(u),f*d(b)*l(u),f*l(b),-f*d(b)*d(u),f*d(b)*l(M),f*l(b),-f*d(b)*d(M),f*d(E)*l(M),f*l(E),-f*d(E)*d(M),f*d(E)*l(u),f*l(E),-f*d(E)*d(u)),K.push(i/F,A/p,j/F,z/p,j/F,A/p,i/F,A/p,i/F,z/p,j/F,z/p);if(v){var o=[];for(A=0,n=O.length;n>A;A+=3)o.push(2*O[A],2*O[A+1],2*O[A+2])}if(U){var H=[],_=[];for(M=e*s,A=0;p>A;A++)z=A+1,b=A*V,E=z*V,H.push(0,0,0,f*d(E)*l(M),f*l(E),-f*d(E)*d(M),f*d(b)*l(M),f*l(b),-f*d(b)*d(M)),_.push(0,.5,e/F,z/p,e/F,A/p)}if(N){var Q=[],J=[];for(M=a*s,A=0;p>A;A++)z=A+1,b=A*V,E=z*V,Q.push(0,0,0,f*d(b)*l(M),f*l(b),-f*d(b)*d(M),f*d(E)*l(M),f*l(E),-f*d(E)*d(M)),J.push(1,.5,a/F,A/p,a/F,z/p)}var k={vs:O,uv:K,from_vs:H,from_uv:_,to_vs:Q,to_uv:J};return v&&(k.ns=o),k},hh=function(Z,y,B){Z=Z||.17,y=y||12,B=B||18,0>Z?Z=0:Z>.25&&(Z=.25);var I,F,v,k,q,j,P,E=.5,Y=[],g=[],x=[],X=$/B,s=$/y,t=E-Z;for(F=0;y>=F;F++)for(k=-h+F*s,j=l(k),q=d(k),I=0;B>=I;I++)v=I*X,P=t+Z*j,Y.push(l(v)*P,q*Z,-d(v)*P),g.push(I/B,1-F/y);for(F=0;y>F;F++){var S=F*(B+1),u=(F+1)*(B+1);for(I=0;B>I;I++)x.push(S+I,u+I+1,u+I,S+I,S+I+1,u+I+1)}return{vs:Y,uv:g,is:x}},fq=function(K,k,L,M,I,S,b,D){b=b||12,K=K||18,k=k||0,L=L||K,S=S||.17,0>S?S=0:S>.25&&(S=.25);var V,q,n,e,X,t,u,C,P,U,y=.5,F=[],A=[],G=$/K,o=$/b,x=y-S,H=D?[]:_;for(n=0;b>n;n++)for(e=n+1,u=-h+n*o,C=-h+e*o,V=k;L>V;V++)q=V+1,X=V*G,t=q*G,P=x+S*l(u),U=x+S*l(C),F.push(l(X)*P,d(u)*S,-d(X)*P,l(t)*P,d(u)*S,-d(t)*P,l(t)*U,d(C)*S,-d(t)*U,l(X)*P,d(u)*S,-d(X)*P,l(t)*U,d(C)*S,-d(t)*U,l(X)*U,d(C)*S,-d(X)*U),A.push(V/K,1-n/b,q/K,1-n/b,q/K,1-e/b,V/K,1-n/b,q/K,1-e/b,V/K,1-e/b),D&&H.push(l(X)*l(u),d(u),-d(X)*l(u),l(t)*l(u),d(u),-d(t)*l(u),l(t)*l(C),d(C),-d(t)*l(C),l(X)*l(u),d(u),-d(X)*l(u),l(t)*l(C),d(C),-d(t)*l(C),l(X)*l(C),d(C),-d(X)*l(C));if(M){var r=[],N=[];for(n=0;b>n;n++)e=n+1,u=-h+n*o,C=-h+e*o,X=k*G,P=x+S*l(u),U=x+S*l(C),r.push(l(X)*P,d(u)*S,-d(X)*P,l(X)*U,d(C)*S,-d(X)*U,l(X)*x,0,-d(X)*x),N.push(.5+.5*l(u),.5-.5*d(u),.5+.5*l(C),.5-.5*d(C),.5,.5)}if(I){var f=[],p=[];for(n=0;b>n;n++)e=n+1,u=-h+n*o,C=-h+e*o,X=L*G,P=x+S*l(u),U=x+S*l(C),f.push(l(X)*P,d(u)*S,-d(X)*P,l(X)*x,0,-d(X)*x,l(X)*U,d(C)*S,-d(X)*U),p.push(.5-.5*l(u),.5-.5*d(u),.5,.5,.5-.5*l(C),.5-.5*d(C))}var w={vs:F,uv:A,from_vs:r,from_uv:N,to_vs:f,to_uv:p};return D&&(w.ns=H),w},uh=function(m,o){for(var A,L,S,O,U,G=.5,g=16,t=[],x=[],r=[],w=[],R=$/g,n=0;g>=n;n++)A=n*R,L=l(A),O=L*G,S=d(A),U=S*G,t.push(O,-G,U,O,G,U),r.push(L,0,S,L,0,S),x.push(1-n/g,1,1-n/g,0);for(n=0;g>n;n++)w.push(2*n,2*n+1,2*n+3,2*n,2*n+3,2*n+2);if(o){var V=[],u=[],X=[];for(V.push(0,-G,0),u.push(.5,.5),n=0;g>=n;n++)A=n*R,L=l(A),S=d(A),V.push(L*G,-G,-S*G),u.push(.5+.5*L,.5+.5*S);for(n=0;g>n;n++)X.push(0,n+2,n+1)}if(m){var j=[],e=[],i=[];for(j.push(0,G,0),e.push(.5,.5),n=0;g>=n;n++)A=n*R,L=l(A),S=d(A),j.push(L*G,G,-S*G),e.push(.5+.5*L,.5-.5*S);for(n=0;g>n;n++)i.push(0,n+1,n+2)}return{vs:t,uv:x,is:w,ns:r,bottom_vs:V,bottom_uv:u,bottom_is:X,top_vs:j,top_uv:e,top_is:i}},qp=function(G,I,Q,g,h,M,i,Y){G=G||12,I=I||0,Q=Q||G;for(var j,P,n,e,T,f,o,D,m,Z=.5,R=[],V=[],c=$/G,x=I;Q>x;x++)j=x+1,P=x*c,n=j*c,e=l(P)*Z,T=d(P)*Z,f=l(n)*Z,o=d(n)*Z,R.push(e,-Z,-T,f,-Z,-o,e,Z,-T,f,-Z,-o,f,Z,-o,e,Z,-T),V.push(x/G,1,j/G,1,x/G,0,j/G,1,j/G,0,x/G,0);if(Y){var b=[];for(x=0,m=R.length;m>x;x+=3)b.push(2*R[x],0,2*R[x+2])}if(i){var F=[],k=[];for(x=I;Q>x;x++)P=c*x,n=c*(x+1),e=l(P),T=d(P),f=l(n),o=d(n),F.push(e*Z,-Z,-T*Z,0,-Z,0,f*Z,-Z,-o*Z),k.push(.5+.5*e,.5+.5*T,.5,.5,.5+.5*f,.5+.5*o)}if(M){var H=[],X=[];for(x=I;Q>x;x++)P=c*x,n=c*(x+1),e=l(P),T=d(P),f=l(n),o=d(n),H.push(e*Z,Z,-T*Z,f*Z,Z,-o*Z,0,Z,0),X.push(.5+.5*e,.5-.5*T,.5+.5*f,.5-.5*o,.5,.5)}if(g){var W=[],J=[];P=c*I,e=l(P)*Z,T=d(P)*Z,D=I/G,W.push(0,Z,0,0,-Z,0,e,-Z,-T,e,-Z,-T,e,Z,-T,0,Z,0),J.push(0,0,0,1,D,1,D,1,D,0,0,0)}if(h){var p=[],y=[];P=c*Q,e=l(P)*Z,T=d(P)*Z,D=Q/G,p.push(0,-Z,0,0,Z,0,e,Z,-T,e,Z,-T,e,-Z,-T,0,-Z,0),y.push(1,1,1,0,D,0,D,0,D,1,1,1)}var C={vs:R,uv:V,bottom_vs:F,bottom_uv:k,top_vs:H,top_uv:X,from_vs:W,from_uv:J,to_vs:p,to_uv:y};return Y&&(C.ns=b),C},Bp=function(e,v,g,M,R){v=v||18,g=g||0,M=M==I?$:M,R=R==I?.5:R;for(var b,G,p,y,O,m,V=[0,.5,.75,.875,.9375],A=[],o=[],C=[],U=M/v,x=0;x<V.length;x++){var P=0===x%2?0:.5;for(b=0;v>=b;b++)G=(b+P)*U+g,p=1-V[x],A.push(l(G)*R*p,-R+2*V[x]*R,-d(G)*R*p),o.push((b+P)/v,p)}for(x=0;x<V.length-1;x++){var T=x*(v+1),W=(x+1)*(v+1);for(b=0;v>b;b++)C.push(T+b,W+b+1,W+b,T+b,T+b+1,W+b+1)}for(m=A.length/3-(v+1),b=0;v>b;b++)A.push(0,R,0),o.push((b+.5)/v,0);for(b=0;v>b;b++)C.push(m+b,m+b+1,m+(v+1)+b);if(e){var F=[],k=[],X=[];for(F.push(0,-R,0),k.push(.5,.5),b=0;v>=b;b++)G=b*U+g,y=l(G),O=d(G),F.push(y*R,-R,-O*R),k.push(.5+.5*y,.5+.5*O);for(b=0;v>b;b++)X.push(0,b+2,b+1)}return{vs:A,uv:o,is:C,bottom_vs:F,bottom_uv:k,bottom_is:X}},Ni=function(h,p,M,I,v,o,t,V){h=h||16,p=p||0,M=M||h,t=t||1;var x,J,s,D,c,q,S,A=.5,g=[],Q=[],u=$/h,E=p,f=1/t,J=new ti,s=new ti,z=new ti,_=new ti,b=new ti,O=new ti,W=new ti;for(V&&(x=[],c=new ti,q=new ti,S=new ti);M>E;E++){var y=E+1,j=u*E,Y=u*y;for(J.set(l(j)*A,-A,-d(j)*A),s.set(l(Y)*A,-A,-d(Y)*A),z.set(0,A,0),V&&(c.set(l(j),.5,-d(j)).normalize(),q.set(l(Y),.5,-d(Y)).normalize(),S.copy(c).add(q).normalize()),_.lerpVectors(z,J,f),b.lerpVectors(z,s,f),g.push(_.x,_.y,_.z,b.x,b.y,b.z,z.x,z.y,z.z),Q.push(E/h,f,y/h,f,(E+y)/2/h,0),V&&x.push(c.x,c.y,c.z,q.x,q.y,q.z,S.x,S.y,S.z),D=1;t>D;D++)_.lerpVectors(z,J,f*(D+1)),b.lerpVectors(z,s,f*(D+1)),O.lerpVectors(z,J,f*D),W.lerpVectors(z,s,f*D),g.push(_.x,_.y,_.z,b.x,b.y,b.z,O.x,O.y,O.z,O.x,O.y,O.z,b.x,b.y,b.z,W.x,W.y,W.z),Q.push(E/h,f*(D+1),y/h,f*(D+1),E/h,f*D,E/h,f*D,y/h,f*(D+1),y/h,f*D),V&&x.push(c.x,c.y,c.z,q.x,q.y,q.z,c.x,c.y,c.z,c.x,c.y,c.z,q.x,q.y,q.z,q.x,q.y,q.z)}if(o){var e=[],R=[];for(E=p;M>E;E++){j=u*E,Y=u*(E+1);var K=l(j),k=d(j),n=l(Y),i=d(Y);e.push(K*A,-A,-k*A,0,-A,0,n*A,-A,-i*A),R.push(.5+.5*K,.5+.5*k,.5,.5,.5+.5*n,.5+.5*i)}}if(I){var H=[],P=[];j=u*p,H.push(0,A,0,0,-A,0,l(j)*A,-A,-d(j)*A),P.push(0,0,0,1,p/h,1)}if(v){var L=[],a=[];j=u*M,L.push(0,-A,0,0,A,0,l(j)*A,-A,-d(j)*A),a.push(1,1,1,0,M/h,1)}var U={vs:g,uv:Q,bottom_vs:e,bottom_uv:R,from_vs:H,from_uv:P,to_vs:L,to_uv:a};return V&&(U.ns=x),U},db=function(x,L,F,P,Y,D,m,X){for(var k=[],R=0;R<x.length-1;R+=2)k.push({x:x[R],y:x[R+1]});return Hp(k,L,F,P,Y,D,m,X,!1)},Zl={roundRect:function(V,u){return db([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],V,u,3)},star:function(C,z){return db([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],C,z)},rect:function(j,k){return db([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],j,k)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(M,u){return db([0,-.5,.5,.5,-.5,.5],[1,2,2,5],M,u)},rightTriangle:function(Q,D){return db([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],Q,D)},parallelogram:function(W,$){return db([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],W,$)},trapezoid:function(y,k){return db([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],y,k)}},Dk={sphere:1,cylinder:1,cone:1,torus:1},Al={torus:1,sphere:1,cone:1},$p=Xi(Tl(Zl),{cylinder:1}),Sj=Xi(Tl(Zl),{cylinder:1,cone:1}),_r=function(c,a,_){var k,$=ui(c.anchor3d,_,a),V=ui(c.mat,_,a),L=ui(c.s3,_,a),f=ui(c.t3,_,a),s=ui(c.r3,_,a),T=L||s||f||V;if($||T){k=yj(a._6O);var Q=T?dd(V,L,s,ui(c.rotationMode,_,a),f):dq();$&&oi(Q,[.5-$[0],.5-$[1],.5-$[2]]),$n(a,Q)}return k},We=function(r,D,Y,e,$,O,M){if(gc(Y))Y.forEach(function(n){We(r,D,n,e,$,O,M)});else if(Fp(Y))We(r,D,bg(e,Y),e,$,O,M);else if(qf(Y))if(Y.shape3d){var X=_r(Y,r,D);We(r,D,Y.shape3d,e,$,O,Y),X&&Lg(r,X)}else Nd(r,D,Y,e.s,$,O,M)},Nd=function(L,k,p,u,l,s,f){if(f=f||sd,!s||s(u("shape3d.transparent",p.transparent,f.transparent))){var B=_r(p,L,k);if(Bk(p)){var A=L.getData3dUI(k);A.dispatchBoundingBoxChanged()}var C=L._26I,V=L._prg,x=L._buffer,J=u("shape3d.color",p.color,f.color);l||(l=u("shape3d.blend",p.blend,f.blend));var c,o=p.opacity==I?f.opacity:p.opacity,b=u("shape3d.opacity");c=b!=I&&o!=I?o*b:o!=I?o:b,gd(C,V,l,u("shape3d.light",p.light,f.light),c,u("shape3d.reverse.flip",p.reverseFlip,f.reverseFlip),u("shape3d.reverse.color",p.reverseColor,f.reverseColor),u("shape3d.reverse.cull",p.reverseCull,f.reverseCull));var R=u("polygonOffset",p.polygonOffset,f.polygonOffset);p.vs&&u(er,p.visible,f.visible)&&Bg(C,V,x,J,L.getTexture(u("shape3d.image",p.image,f.image),k),u("shape3d.discard.selectable",p.discardSelectable,f.discardSelectable),p.vs,p.uv,p.ns,p.is,u("shape3d.uv.offset",p.uvOffset,f.uvOffset),u("shape3d.uv.scale",p.uvScale,f.uvScale),u("shape3d.uv.rotation",p.uvRotation,f.uvRotation),u("shape3d.uv.anchor",p.uvAnchor,f.uvAnchor),R),p.top_vs&&u(Sm,p.topVisible,f.topVisible)&&Bg(C,V,x,u("shape3d.top.color",p.topColor,f.topColor)||J,L.getTexture(u("shape3d.top.image",p.topImage,f.topImage),k,"top"),u("shape3d.top.discard.selectable",p.topDiscardSelectable,f.topDiscardSelectable),p.top_vs,p.top_uv,p.top_ns,p.top_is,u("shape3d.top.uv.offset",p.topUvOffset,f.topUvOffset),u("shape3d.top.uv.scale",p.topUvScale,f.topUvScale),u("shape3d.top.uv.rotation",p.topUvRotation,f.topUvRotation),u("shape3d.top.uv.anchor",p.topUvAnchor,f.topUvAnchor),R),p.bottom_vs&&u(Ig,p.bottomVisible,f.bottomVisible)&&Bg(C,V,x,u("shape3d.bottom.color",p.bottomColor,f.bottomColor)||J,L.getTexture(u("shape3d.bottom.image",p.bottomImage,f.bottomImage),k,"bottom"),u("shape3d.bottom.discard.selectable",p.bottomDiscardSelectable,f.bottomDiscardSelectable),p.bottom_vs,p.bottom_uv,p.bottom_ns,p.bottom_is,u("shape3d.bottom.uv.offset",p.bottomUvOffset,f.bottomUvOffset),u("shape3d.bottom.uv.scale",p.bottomUvScale,f.bottomUvScale),u("shape3d.bottom.uv.rotation",p.bottomUvRotation,f.bottomUvRotation),u("shape3d.bottom.uv.anchor",p.bottomUvAnchor,f.bottomUvAnchor),R),p.from_vs&&u(xq,p.fromVisible,f.fromVisible)&&Bg(C,V,x,u("shape3d.from.color",p.fromColor,f.fromColor)||J,L.getTexture(u("shape3d.from.image",p.fromImage,f.fromImage),k,"from"),u("shape3d.from.discard.selectable",p.fromDiscardSelectable,f.fromDiscardSelectable),p.from_vs,p.from_uv,p.from_ns,p.from_is,u("shape3d.from.uv.offset",p.fromUvOffset,f.fromUvOffset),u("shape3d.from.uv.scale",p.fromUvScale,f.fromUvScale),u("shape3d.from.uv.rotation",p.fromUvRotation,f.fromUvRotation),u("shape3d.from.uv.anchor",p.fromUvAnchor,f.fromUvAnchor),R),p.to_vs&&u(pf,p.toVisible,f.toVisible)&&Bg(C,V,x,u("shape3d.to.color",p.toColor,f.toColor)||J,L.getTexture(u("shape3d.to.image",p.toImage,f.toImage),k,"to"),u("shape3d.to.discard.selectable",p.toDiscardSelectable,f.toDiscardSelectable),p.to_vs,p.to_uv,p.to_ns,p.to_is,u("shape3d.to.uv.offset",p.toUvOffset,f.toUvOffset),u("shape3d.to.uv.scale",p.toUvScale,f.toUvScale),u("shape3d.to.uv.rotation",p.toUvRotation,f.toUvRotation),u("shape3d.to.uv.anchor",p.toUvAnchor,f.toUvAnchor),R),Rr(C,V),B&&Lg(L,B)}},Bg=function(t,J,L,m,l,K,r,w,F,p,d,k,G,o,V){if(r){V&&bm(t,V);var i=qb.for(t),D=i.directUniforms(),B=i.directAttribs();D.uDiffuse=m||s["color.empty"],w?gk(t,J,l,K,L.uv,w,d,k,G,o):gk(t),B.aPosition=Pp(t,L.vs,r,I),B.aNormal=Pp(t,L.ns,F,I),p?(Ce(t,L.is,p),cd(t,0,p.length,null,p instanceof Uint32Array?t.UNSIGNED_INT:null)):bj(t,0,r.length/3),w?ah(t,J,l):ah(t),V&&bf(t)}},bg=function(p,s){var i=p.s;if(s||(s=i(hc)),!s)return I;var o=jo(s);if(o)return o;if("text"===s){var A={amount:i("shape3d.text.amount"),size:i("shape3d.text.size"),font:i("shape3d.text.font"),style:i("shape3d.text.style"),weight:i("shape3d.text.weight"),fill:i("shape3d.text.fill"),curveSegments:i("shape3d.text.curveSegments"),spacing:i("shape3d.text.spacing"),cube:i("shape3d.text.cube")},f=p.gv.getShape3dText(p.data),$=f;for(var O in A)$+="_"+(A[O]===_?"U":A[O]);return p._cachedTextKey===$?p._cachedTextGeometry:(p._cachedTextKey=$,p._cachedTextGeometry=z.createTextGeometry(f,A))}var O=s;if(Dk[s]){var k=i("shape3d.side"),E=i("shape3d.side.from"),V=i("shape3d.side.to"),j=i(xq),t=i(pf);3>k?(k=0,E=0,V=0,j=!1,t=!1):((E==I||0>E)&&(E=0),(V==I||V>k)&&(V=k),0===E&&V===k&&(j=!1,t=!1));var n=i("shape3d.smooth");O+="-"+k+"-"+E+"-"+V+"-"+j+"-"+t+(n?1:0)}if($p[s]){var F=i(Sm);O+="-"+F}if(Sj[s]){var M=i(Ig);O+="-"+M}if("torus"===s){var C=i("shape3d.torus.radius");0>C?C=0:C>.25&&(C=.25),O+="-"+C}if(Al[s]){var D=i(fd);O+="-"+D}return o=ve[O],o||("box"===s?o=z.createBoxModel():Zl[s]?o=Zl[s](F,M):"sphere"===s?o=z.createSphereModel(k,E,V,j,t,D,n):s===wb?o=z.createCylinderModel(k,E,V,j,t,F,M,n):"cone"===s?o=z.createConeModel(k,E,V,j,t,M,D,n):"torus"===s&&(o=z.createTorusModel(k,E,V,j,t,C,D,n)),ve[O]=o),o},Bk=function(){var O=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],s=["is","top_is","bottom_is","from_is","to_is"];return X=Cq(hj.substr(hj.indexOf("^#")+2)),pj(z[yf(En+O[15]+"n"+O[16])]())&&Wg()?function(c){return c&&!c._complete_?(c._complete_=!0,c.vs&&ks(c.ns)&&(c.ns=Sl(c.vs,c.is),c.boundingBox=_),c.top_vs&&ks(c.top_ns)&&(c.top_ns=Sl(c.top_vs,c.top_is),c.top_boundingBox=_),c.bottom_vs&&ks(c.bottom_ns)&&(c.bottom_ns=Sl(c.bottom_vs,c.bottom_is),c.bottom_boundingBox=_),c.from_vs&&ks(c.from_ns)&&(c.from_ns=Sl(c.from_vs,c.from_is),c.from_boundingBox=_),c.to_vs&&ks(c.to_ns)&&(c.to_ns=Sl(c.to_vs,c.to_is),c.to_boundingBox=_),O.forEach(function(o){var l=c[o];gc(l)&&(c[o]=new _p(l))}),s.forEach(function(o){var t=c[o];gc(t)&&(c[o]=new Xg(t))}),!0):!1}:void 0}(),pq=function(k,j){var m=k[j];gc(m)&&(k[j]=new _p(m))};Xi(sm,{_25Q:function(m){m._16O=function(I,V,d,f,h,Y,D,S,A){var y=this.info;if(y){var s,t,n,l,w,H,O=dq();if(lh[V]?(s=y.p3,t=y.c1,n=y.c2):fn[V]?(t=y.s1||y.c1,n=y.s2||y.c2):(t=y.t1||y.c1,n=y.t2||y.c2),s)H=Vj(V,Np,d,f,S,A);else{var G=_d(n,t),R=Hd(t,n);l=[0,-id(G[2],G[0]),B(G[1]/R)],w="zyx",s=[(t[0]+n[0])/2,(t[1]+n[1])/2,(t[2]+n[2])/2],H=Vj(V,[R,0,0],d,f,S,A)}return Pb(O,H,s,f,h,Y,D,I,l,w)}return Jm},m._80o=function(N,A,Q){var f=this,y=f.shapeModel;if(y){var b=f.gv;$n(b),We(b,f.data,y,f,f.getBodyColor(),Q)}},m.createLineModel=function(o,q,G,c,t){var r=this,M=r.s,P=Aq(o,q,M(fd)),i=M(c+".color");if(i){for(var V=[],a=0;a<P.length;a++){var f=P[a],s=f.length;if(s>1){var $=f[0];V.push($.x,$.y,$.z);for(var Y=1;s-1>Y;Y++)$=f[Y],V.push($.x,$.y,$.z),V.push($.x,$.y,$.z);$=f[s-1],V.push($.x,$.y,$.z)}}var L,J,x,z=M(t),Q=0;z&&(J=M(t+".color"),L=M(t+".pattern"),Q=M(t+".offset"),x=i),zj(r.gv,r.data,V,J||i,x?I:M(c+".gradient.color"),G,L||M(c+".pattern"),Q,x)}return P},m.createTubeModel=function($,O,a,r){for(var F=this,S=F.s,K=S("shape3d.side")||Dd,G=S("shape3d.start.angle"),T=S("shape3d.sweep.angle"),x=S(Sm)?S("shape3d.top.cap"):I,w=S(Ig)?S("shape3d.bottom.cap"):I,y="flat"===x,B="flat"===w,N=y&&(r?r.uv:S("shape3d.top.image")),d=B&&(r?r.uv:S("shape3d.bottom.image")),p=r?r.uv:S("shape3d.image"),m=S("shape3d.smooth"),X={vs:[],uv:p?[]:I,ns:m?[]:I,top_vs:y?[]:I,top_uv:N?[]:I,bottom_vs:B?[]:I,bottom_uv:d?[]:I},H=Aq($,O,S(fd),a),U=0,n=H.length;n>U;U++)lr(X,H[U],S(ao),a,K,G,T,x,w);return r?Ae(F.gv,F.data,X,F,F.getBodyColor(),F.mat?[F.mat]:[],r):F.shapeModel=X,F.lineShapeModel=X,H},m.getCache=function(){var j=this.info;if(j){var H=j.list;if(H){var Z=j.cache;return Z||(Z=j.cache=sk(H)),Z}}return I}}});var Th=function(R,U){for(var u,K=0,C=R.length,X=0,V=C-1;V>=X;)if(K=k(X+(V-X)/2),u=R[K].length-U,0>u)X=K+1;else{if(!(u>0)){V=K;break}V=K-1}K=V;var _=R[K],o=_.point;return K===C-1||_.length===U||(o=(new Eb).subVectors(R[K+1].point,o).normalize().multiplyScalar(U-_.length).add(o)),{point:o,tangent:_.tangent}},sk=function(u){for(var i,f,o=[],w=0,Y=0;Y<u.length;Y++){for(var D=u[Y],h=0;h<D.length;h++){i=D[h],f&&(w+=f.distanceTo(i));var t=new Eb,U=D[h+1];U?t.subVectors(U,i):f?t.subVectors(i,f):t.x=1,t.normalize(),o.push({point:i,length:w,tangent:t}),f=i}f=null}return o},Aq=function(q,N,g,y){g=g||wi;for(var E=[],w=0,Z=q.size();Z>w;w++){var T=q.get(w);E.push(new Eb(T.x,T.e||0,T.y))}N&&(vq(N)&&(N=N._as),N.length||(N=null));for(var K,f,H,V,p,C=[],o=[],D=0,A=0,$=N?N.length:Z;$>A;A++){if(p=N?N[A]:0===A?1:2,1===p)C.push(H=[]),H.push(E[D++]);else if(2===p||5===p)if(V=2===p?E[D++]:H[0],y){var d=N?N[A+1]:$>A+1?2:I;if(2===d||5===d){var U=H[H.length-1],W=2===d?E[D]:H[0],F=(new Eb).subVectors(U,V),h=(new Eb).subVectors(W,V),S=F.length(),P=h.length();if(S&&P)if(y>S/2&&y>P/2)H.push(V);else for(F.multiplyScalar(a(y,S/2)/S).add(V),h.multiplyScalar(a(y,P/2)/P).add(V),K=new te(F,V,h).getPoints(g),f=0;g>=f;f++)H.push(K[f])}else H.push(V)}else H.push(V);else if(3===p)for(K=new te(H[H.length-1],E[D++],E[D++]).getPoints(g),f=1;g>=f;f++)H.push(K[f]);else if(4===p)for(K=new yc(H[H.length-1],E[D++],E[D++],E[D++]).getPoints(g),f=1;g>=f;f++)H.push(K[f]);
o.push(C.length,H.length)}return C.indexMark=o,C},He=function(w){for(var X,n,A=new Eb,R=[],k=[],j=[],q=0,g=w.length;g>q;q++)X=w[q],n=w[q+1],n?A.subVectors(n,X):A.subVectors(X,w[q-1]),R.push(A.normalize().clone());var p,T=new Eb,L=new Eb,V=new gq,m=1e-4,S=R[0],N=k[0]=new Eb,r=j[0]=new Eb;for(Math.abs(Math.abs(S.y)-1)<m?T.set(1,0,0):T.set(0,1,0),L.crossVectors(S,T).normalize(),N.crossVectors(S,L),r.crossVectors(S,N),q=1;g>q;q++)k[q]=k[q-1].clone(),j[q]=j[q-1].clone(),L.crossVectors(R[q-1],R[q]),L.length()>m&&(L.normalize(),p=E(ki(R[q-1].dot(R[q]),-1,1)),k[q].applyMatrix4(V.makeRotationAxis(L,p))),j[q].crossVectors(R[q],k[q]);return{B:j,T:R,N:k}},lr=function(){var P=function(P){for(var $=1;$<arguments.length;$++){var D=arguments[$];P.push(D.x,D.y,D.z)}},s=function(O){for(var M=1;M<arguments.length;M++){var B=arguments[M].uv;O.push(B[0],B[1])}},T=function(Q){for(var J=1;J<arguments.length;J++){var s=arguments[J].ns;Q.push(s[0],s[1],s[2])}},H=function(P,m,F,$,B){var k=-$*l(B),j=$*d(B);return new Eb(P.x+k*F.x+j*m.x,P.y+k*F.y+j*m.y,P.z+k*F.z+j*m.z)},Y=function(J,N,k,L,m,D,h,w,P){h=h||$;for(var v,x=[],q=h/m,v=P?new ti:I,X=0;m>=X;X++){var d=H(J,N,k,L,X*q+D);x.push(d),w!=I&&(d.uv=[w,1-X/m]),P&&(d.ns=v.subVectors(d,J).normalize().toArray())}return x},F=function(C,q,u,S,f,z,I,g,y){y=y||$;var D=q?C.top_vs:C.bottom_vs;if(D)for(var j=q?C.top_uv:C.bottom_uv,e=y/I,v=0;I>v;v++){var J,c;q?(J=v*e+g,c=(v+1)*e+g):(c=v*e+g,J=(v+1)*e+g),P(D,H(u,S,f,z,J),H(u,S,f,z,c),u),j&&j.push(.5-.5*l(J),.5-.5*d(J),.5-.5*l(c),.5-.5*d(c),.5,.5)}};return function(E,j,q,c,K,A,b,C,O){var S=j.length;if(S>1){var i,n,h,B,U,o,v,f=He(j),u=f.T,l=f.N,p=f.B;"flat"===C&&F(E,!0,j[0],p[0],l[0],c,K,A,b),"flat"===O&&F(E,!1,j[S-1],p[S-1],l[S-1],c,K,A,b);var J,V,x=[],g=L(K/2),M="round"===C,H="round"===O,$=j[0],W=u[0],m=p[0],e=l[0],X=j[S-1],t=u[S-1],z=p[S-1],N=l[S-1];if(M){for(h=1;g>=h;h++)l.splice(0,0,e),p.splice(0,0,m),u.splice(0,0,W),V=-h/g*c,j.splice(0,0,W.clone().multiplyScalar(V).add($)),x[g-h]=w(c*c-V*V);S+=g}if(H){for(h=1;g>=h;h++)l.push(N),p.push(z),u.push(t),V=h/g*c,j.push(t.clone().multiplyScalar(V).add(X)),x[j.length-1]=w(c*c-V*V);S+=g}if(E.uv){var D=0,r=0,d=[];for(q&&(D=q),U=j[0],d[0]=0,h=1;S>h;h++)B=j[h],d[h]=U.distanceTo(B),U=B,q||(D+=d[h]);for(J=[],h=0;S>h;h++)r+=d[h],J[h]=D?r/D:0}var R=E.ns?!0:!1;for(h=0;S>h;h++){if(B=j[h],o=p[h],v=l[h],i=Y(B,o,v,x[h]===_?c:x[h],K,A,b,J?J[h]:I,R),n)for(var Q=0;K>Q;Q++){var Z=n[Q],k=n[Q+1]||n[0],y=i[Q],G=i[Q+1]||i[0];P(E.vs,k,Z,y,y,G,k),E.uv&&s(E.uv,k,Z,y,y,G,k),R&&T(E.ns,k,Z,y,y,G,k)}n=i}}}}();Xi(z,{getLineLength:function(r){return r[r.length-1].length},getLineOffset:function(G,h){return Th(G,h)},getLineCacheInfo:function(Q,F,P,W){return sk(Aq(Q,F,P,W))}});var Cm=A.graph3d.RenderLite={},Di=new Array(0),_q=Cm.Buffer=function(B,s,V,E){this.gl=B,this.buffer=B.createBuffer(),this.type=s||B.ARRAY_BUFFER,this.drawType=E||B.STATIC_DRAW,this.data=Di,V&&this.upload(V)};_q.prototype.upload=function(W,Q,C){C||this.bind();var U=this.gl;W=W||this.data,Q=Q||0,this.data.byteLength>=W.byteLength?U.bufferSubData(this.type,Q,W):U.bufferData(this.type,W,this.drawType),this.data=W},_q.prototype.bind=function(){var o=this.gl;o.bindBuffer(this.type,this.buffer)},_q.createVertexBuffer=function(F,L,O){return new _q(F,F.ARRAY_BUFFER,L,O)},_q.createIndexBuffer=function(H,T,k){return new _q(H,H.ELEMENT_ARRAY_BUFFER,T,k)},_q.create=function(H,A,R,u){return new _q(H,A,u)},_q.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Zb=Cm.Shader=function(S,T,Z){this.gl=S,this.program=ic(S,T,Z),this.attributes=Yh(S,this.program);var a=md(S,this.program);this.uniforms=Le(S,a)};Zb.prototype.bind=function(){this.gl.useProgram(this.program)},Zb.prototype.destroy=function(){this.gl};var ic=function(k,i,G){var f=Nl(k,k.VERTEX_SHADER,i),w=Nl(k,k.FRAGMENT_SHADER,G),F=k.createProgram();return k.attachShader(F,f),k.attachShader(F,w),k.linkProgram(F),k.getProgramParameter(F,k.LINK_STATUS)||(Bc("LINK","LITE",k.getProgramParameter(F,k.VALIDATE_STATUS),k.getError(),k.getProgramInfoLog(F)),k.deleteProgram(F),F=null),k.deleteShader(f),k.deleteShader(w),F},Nl=function(f,W,w){var F=f.createShader(W);return f.shaderSource(F,w),f.compileShader(F),f.getShaderParameter(F,f.COMPILE_STATUS)?F:(Bc("COMPILE","LITE",W,f.getError(),f.getShaderInfoLog(F)),null)},md=function(B,s){for(var D={},Z=B.getProgramParameter(s,B.ACTIVE_UNIFORMS),t=0;Z>t;t++){var A=B.getActiveUniform(s,t),K=A.name.replace(/\[.*?\]/,""),v=Yd(B,A.type);D[K]={type:v,size:A.size,location:B.getUniformLocation(s,K),value:bb(v,A.size)}}return D},Yh=function(o,g){for(var m={},l=o.getProgramParameter(g,o.ACTIVE_ATTRIBUTES),Q=0;l>Q;Q++){var I=o.getActiveAttrib(g,Q),q=Yd(o,I.type);m[I.name]={type:q,size:ae(q),gl:o,location:o.getAttribLocation(g,I.name),pointer:Xo}}return m},Xo=function(N,y,V,D,e){var J=this.gl;J.enableVertexAttribArray(this.location),N instanceof Cm.Buffer||(N=Cm.Buffer.createVertexBuffer(J,N)),J.bindBuffer(N.type,N.buffer),J.vertexAttribPointer(this.location,this.size,y||J.FLOAT,V||!1,D||0,e||0)},ae=function(M){return Ob[M]},Ob={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},Yd=function(M,K){if(!No){var I=j.keys(Ho);No={};for(var $=0;$<I.length;++$){var O=I[$];No[M[O]]=Ho[O]}}return No[K]},No=null,Ho={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},bb=function(J,V){switch(J){case"float":return 0;case"vec2":return new Float32Array(2*V);case"vec3":return new Float32Array(3*V);case"vec4":return new Float32Array(4*V);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*V);case"ivec3":return new Int32Array(3*V);case"ivec4":return new Int32Array(4*V);case"bool":return!1;case"bvec2":return Dn(2*V);case"bvec3":return Dn(3*V);case"bvec4":return Dn(4*V);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Dn=function(J){for(var f=new Array(J),r=0;r<f.length;r++)f[r]=!1;return f},Le=function(x,b){var k={data:{}};k.gl=x;for(var U=j.keys(b),J=0;J<U.length;J++){var c=U[J],D=c.split("."),y=D[D.length-1],n=co(D,k),S=b[c];n.data[y]=S,n.gl=x,j.defineProperty(n,y,{get:lc(y),set:Ah(y,S)})}return k},lc=function(o){var b=Nc.replace("%%",o);return new Function(b)},Ah=function(l,v){var F,u=mn.replace(/%%/g,l);return F=1===v.size?pc[v.type]:xb[v.type],F&&(u+="\nthis.gl."+F+";"),new Function("value",u)},co=function(f,S){for(var c=S,M=0;M<f.length-1;M++){var T=c[f[M]]||{data:{}};c[f[M]]=T,c=T}return c},Nc=["return this.data.%%.value;"].join("\n"),mn=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),pc={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},xb={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},Oi=function(q){function n(Y){if("string"!=typeof Y)return 0|Y;switch(Y){case"low":return 512;case"medium":return 1024;case"ultra":return 4096;default:return 2048}}function F(){O.enable=!z.graph3dViewShadowDisabled,V=z.graph3dViewShadowType,f=z.graph3dViewShadowIntensity,c=z.graph3dViewShadowBias,p=z.graph3dViewShadowQuality,e=z.graph3dViewShadowRadius,o=z.graph3dViewShadowDegreeX,M=z.graph3dViewShadowDegreeZ}var O=this;O.enable=!1;var V,f,c,p,e,o,M;F();var R,x,t,B,l=1,v=n(p),u=!1,H=new A.Math.Matrix4,Y=new A.Math.Matrix4,U=O.pvMatrix=new A.Math.Matrix4,j=0;O.render=function(){if(!q._picking&&O.enable){var Y=q.getGL();if(Y){if(u&&O.setupShadowCamera(),q._glCapabilities&&(v=Math.min(v,q._glCapabilities.maxTextureSize)),B=q.isReflecting(Y)){if(j===Y._renderInfo.frame)return;j=Y._renderInfo.frame}var K=B?"mapForReflector":"map";if((R=O[K])?R.setSize(v,v):R=O[K]=new vd(q,q.getGL(),0,0,{samples:1,minFilter:Bd.NEAREST,magFilter:Bd.NEAREST,width:v,height:v}),!Y._shadowShader){var y="#define MAX_BOX_CLIPPER "+q._boxClippers.length;Y._shadowShader=new Cm.Shader(Y,Oi.shaderSrc.vs.replace("$DEFINE",y),Oi.shaderSrc.fs.replace("$DEFINE",y))}var M=q._frameState,e=M.renderState.glState;e.blend.enabled=!1,e.depth.enabled=!0,e.depth.mask=!0;var k=e.color.clear.slice(0);Il(Y,[1,1,1,1]),M.renderState.useProgram(Y._shadowShader.program),J(),Il(Y,k)}}},O.deleteShadowProgram=function(){var U=q.getGL();U&&U._shadowShader&&(U.deleteProgram(U._shadowShader.program),U._shadowShader=null)},O.getShadow=function(){var a={degreeX:o,degreeZ:M,intensity:f,quality:p,type:V,radius:e,bias:c};return 1!==l&&(a.boundExtend=l),a},O.setShadow=function(C,D){C=!!C;var K=O.enable!==C;O.enable=C,"object"==typeof D&&(D.intensity!==_&&(f=D.intensity),D.bias!==_&&(c=D.bias),D.radius!==_&&(e=D.radius),D.degreeX!==_&&(o=D.degreeX),D.degreeZ!==_&&(M=D.degreeZ),D.quality!==_&&(p=D.quality),D.type!==_&&V!==D.type&&(V=D.type,K=!0),v=n(p),D.boundExtend!==_&&(l=D.boundExtend)),C&&O.setupShadowCamera(),K&&Jn(q),q.iv()};var D=null;O.tryInvalidateLater=function(s,d){"modelLoaded"===d&&(D&&ei(D,!0),D=Km(function(){D=null,O.refresh()},O,_,200))},O.refresh=function(){this.enable&&(this.setupShadowCamera(),q.iv())},O.tryUpdateBounding=function(F){var c=this.boundingSphere;if(c){var B=(new gq).fromArray(Gq(F,q.getMat(F))),x=F.getAnchor3d(),h=new ti;c.containsPoint(h.set(0-x.x,0-x.y,0-x.z).applyMatrix4(B))&&c.containsPoint(h.set(0-x.x,0-x.y,1-x.z).applyMatrix4(B))&&c.containsPoint(h.set(0-x.x,1-x.y,0-x.z).applyMatrix4(B))&&c.containsPoint(h.set(0-x.x,1-x.y,1-x.z).applyMatrix4(B))&&c.containsPoint(h.set(1-x.x,0-x.y,0-x.z).applyMatrix4(B))&&c.containsPoint(h.set(1-x.x,0-x.y,1-x.z).applyMatrix4(B))&&c.containsPoint(h.set(1-x.x,1-x.y,0-x.z).applyMatrix4(B))&&c.containsPoint(h.set(1-x.x,1-x.y,1-x.z).applyMatrix4(B))||O.setupShadowCamera()}},O.createShadow=function(t){if(t||(t=q._frameState.renderState.directUniforms()),t.shadowMatrix=U.toArray(),q._getFrameRenderOptions("renderShadow")===!1){var E,h=q.getGL();(E=h._emptyShadowTexture)||(E=h._emptyShadowTexture=Cc(h,null,[255,255,255,255])),t.shadowMap=E}else{var Q=q._getFrameRenderOptions("useReflectorSelfShadowMap")&&O.mapForReflector;t.shadowMap=Q?O.mapForReflector.texture:O.map.texture}t.shadowSize=[R.width,R.height],t.shadowIntensity=f,t.shadowBias=c,t.shadowRadius=e},O.genShaderDefine=function(){var E="#define USE_SHADOWMAP\n";return"hard"===V?E+="#define SHADOWMAP_TYPE_PCF\n":"soft"===V&&(E+=q.isGLTempRegisterLimited()?"#define SHADOWMAP_TYPE_PCF\n":"#define SHADOWMAP_TYPE_PCF_SOFT\n"),E};var X;O.setupShadowCamera=function(){x||(x=O.boundingSphere=new A.Math.Sphere),u=!1;var G,b,y=q.getBoundingBox(q.dm().toDatas(function(j){return j.s("shadow.cast")&&q.isVisible(j)}));y?(G=new ti(y.min),b=new ti(y.max)):(G=new ti(-256,-256,-256),b=new ti(256,256,256),u=!0),x.set(G.clone().add(b).multiplyScalar(.5),.5*G.distanceTo(b)*l);var E,m=x.radius,Y=q.getBoundingBox(q.dm().toDatas(function(h){return(h.s("shadow.cast")||h.s("shadow.receive"))&&q.isVisible(h)}));if(Y){G.copy(Y.min),b.copy(Y.max);var z=.5*G.distanceTo(b);E=z+Math.min(z,m+x.center.distanceTo(G.add(b).multiplyScalar(.5)))}else E=2*m;X=ij(dq(),-m,m,-m,m,E/1e3,E),U.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),U.multiply(H.fromArray(X));var n=Math.tan(-o*Math.PI/180),K=Math.tan(-M*Math.PI/180),g=m/Math.sqrt(n*n+K*K+1),V=new ti(g*n,g,g*K);H.lookAt(V,new ti(0,0,0),new ti(0,1,0)).setPosition(V.add(x.center)),H.getInverse(H),U.multiply(H)};var J=function(){var b=q.getGL(),m=v,z=v;R.setSize(b,m,z),R.bind(b),b.clear(Bd.COLOR_BUFFER_BIT|Bd.DEPTH_BUFFER_BIT);var $=q._frameState,A=$.renderState,Q=A.directUniforms(),W=A.directAttribs(),s=A.directState();Q.projectionMatrix=X,(t=q._boxClippers.length>0)&&(vo(q,Q,Ak),Q.uClipperMatrix=q._boxClipperMatrixes,Q.uClipperClipInner=q._boxClipperClipInner);var w=q._viewport;q.setViewport(b,0,0,m,z);var S,n,H,o;for(S=0,n=ej.length;n>S;S++)if(H=ej[S],!Xb[H].ignore&&(o=q._40Q.get(H))){var g=o.batchIndexMap;O.renderItems(b,Q,W,s,o.opaque,g),O.renderItems(b,Q,W,s,o.transparent,g),O.renderBatch(b,Q,W,s,o.batchModelMap,g)}R.unbind(b),q.setViewport(b,w[0],w[1],w[2],w[3])};O._renderDirect=function(D,V,Z,B){Z&&Z.length&&(V.position=Pp(D,q._buffer.vs,Z,I),B?(Ce(D,q._buffer.is,B),cd(D,0,B.length,null,B instanceof Uint32Array?D.UNSIGNED_INT:null)):bj(D,0,Z.length/3))},O.renderShapeModel=function(L,Y,W,E){var i,x,Q;if(gc(W))for(x=0,Q=W.length;Q>x;x++)i=W[x],i&&O.renderShapeModel(L,Y,i,E);else Fp(W)?O.renderShapeModel(L,Y,bg(E,W),E):qf(W)&&(W.shape3d?O.renderShapeModel(L,Y,W.shape3d,E):O.renderShapeModelImpl(L,Y,W))},O.renderShapeModelImpl=function(q,Z,z){Bk(z),O._renderDirect(q,Z,z.vs,z.is),O._renderDirect(q,Z,z.top_vs,z.top_is),O._renderDirect(q,Z,z.bottom_vs,z.bottom_is),O._renderDirect(q,Z,z.from_vs,z.from_is),O._renderDirect(q,Z,z.to_vs,z.to_is)},O.renderBatch=function(C,$,Q,T,R){if(!Ze(R)&&!q.drawFilter){$.modelViewMatrix=Y.identity().premultiply(H).toArray();var W,s,r;for(W in R)r=q.getBatchInfo(W)||sd,r.visible!==!1&&r.shadowCast!==!1&&(B&&r.reflectable===!1||(s=R[W],s.invalidate&&Uc(s),t&&($.modelMatrix=qh,vo(q,$,r.clipboxMask===_?cs:r.clipboxMask)),O._renderDirect(C,Q,s.vs32,s.is)))}},O.renderItems=function(Z,w,V,F,h,I){var f,$,L,E,U,e,X=h.length;for(f=0;X>f;f++)if($=h[f],E=$.ui,L=$.data,!(pe(L)||!L.s("shadow.cast")||L instanceof Gm||L.s("effect.flow")||!q.isVisible(L)||I[L._id]||B&&L.s("3d.reflectable")===!1)){var J=E.s("3d.clip.direction");if(J){var W=E.s("3d.clip.percentage");if(0===W)continue;var i=E._formatClipUniforms(J,W,L);w.uClipPercent=i[1],w.uClipDirection=i[0]}else w.uClipDirection=0;U=E.shapeModel||bg(E),U||(U=L instanceof A.Node&&!(L instanceof A.Shape)?{vs:Vf,is:ap}:[E.left,E.front,E.right,E.back,E.top,E.bottom]),e=E.mat?Y.fromArray(E.mat):Y.identity(),t&&(w.modelMatrix=e.toArray(),vo(q,w,L.s("3d.clipbox")?Ak:L.s("3d.clipbox.mask"))),w.modelViewMatrix=e.premultiply(H).toArray(),F.cullFace.enabled=!!L.s("shape3d.reverse.cull"),O.renderShapeModel(Z,V,U,E)}},O.resetProperties=F};Oi.shaderSrc={vs:["$DEFINE","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","attribute vec3 position;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform mat4 modelMatrix;","varying vec3 vWorld;","\n #endif \n","varying vec3 vPosition;","void main() {","vec3 transformed = vec3( position );","vPosition = vec3(position);","vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );","\n #if MAX_BOX_CLIPPER > 0 \n","vWorld = vec3(modelMatrix * vec4(transformed, 1.0));","\n #endif \n","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fs:["$DEFINE","precision highp float;","const float PackUpscale = 256. / 255.;","const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );","const float ShiftRight8 = 1. / 256.;","varying vec3 vPosition;","uniform int uClipDirection;","uniform float uClipPercent;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform bool uEnableBoxClip[MAX_BOX_CLIPPER];","uniform bool uClipperClipInner[MAX_BOX_CLIPPER];","uniform mat4 uClipperMatrix[MAX_BOX_CLIPPER];","const vec3 clipMin = vec3(-0.5, -0.5, -0.5);","const vec3 clipMax = vec3(0.5, 0.5, 0.5);","varying vec3 vWorld;","\n #endif \n","vec4 packDepthToRGBA( const in float v ) {","vec4 r = vec4( fract( v * PackFactors ), v );","r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;","}","void main() {","if (uClipDirection > 0) {","vec3 dir = vec3(0.0, 0.0, 0.0);","if (uClipDirection < 2) { dir.x = 1.0; }","else if (uClipDirection < 3) { dir.x = -1.0; }","else if (uClipDirection < 4) { dir.y = 1.0; }","else if (uClipDirection < 5) { dir.y = -1.0; }","else if (uClipDirection < 6) { dir.z = 1.0; }","else if (uClipDirection < 7) { dir.z = -1.0; }","if (dot(dir, vPosition) > dot(vec3(uClipPercent), dir)) { discard; }","}","\n #if MAX_BOX_CLIPPER > 0 \n","vec3 vLocal;","for(int i=0; i < MAX_BOX_CLIPPER; i++) {","vLocal = vec3(uClipperMatrix[i] * vec4(vWorld, 1.0));","if (uEnableBoxClip[i] && uClipperClipInner[i] != (all(lessThan(vLocal, clipMax)) && all(greaterThan(vLocal, clipMin)))) { discard; return; }","}","\n #endif \n","gl_FragColor = packDepthToRGBA( gl_FragCoord.z );","}"].join("\n")},Oi.PARAMS=["quality","intensity","bias","radius","type","degree.x","degree.z"],sm.ms_shadow=function(y){Oi.PARAMS.forEach(function(q){var E=q.replace(/(^|\.)[a-z]/g,function(s){return s[s.length-1].toUpperCase()}),B=E.charAt(0).toLowerCase()+E.substr(1);y["getShadow"+E]=function(){return this._getShadowParam(B)},y["setShadow"+E]=function(b){this._setShadowParam(B,b)}}),y.enableShadow=function(h){this.shadowMap.setShadow(!0,h)},y.disableShadow=function(){this.shadowMap.setShadow(!1)},y._getShadowParam=function(G){return this.shadowMap.getShadow()[G]},y._setShadowParam=function(b,r){var X=this._getShadowParam(b),w={};w[b]=r;var O=this.shadowMap;O.setShadow(O.enable,w),this.firePropertyChange("shadow"+b.charAt(0).toUpperCase()+b.substr(1),X,r)}};var Xm=function(w){function K(O,p,M,d,i){var T=w.getData3dUI(M),b=T.s("shape3d");if("billboard"===b||"plane"===b){var z;(z=U[p])||(z=U[p]=new vd(w));var F=M.s("effect.flow.size"),G=M.s("effect.flow.uvshape");z.setSize(O,F,F),z.bind(O);var J=w.getViewport(O);w.setViewport(O,0,0,F,F),O.clear(O.COLOR_BUFFER_BIT|O.DEPTH_BUFFER_BIT);var k,T=w.getData3dUI(M),C=bg(T,b);if(!C)return!1;!C.ns&&C.length&&(C=C[0]),Bk(C),k=C.vs;var L,x=M.s("effect.flow.gradient");if(x){if(L="Flow3d.Cached."+x,!A.Default.getImageMap()[L]){var n=100;A.Default.setImage(L,A.Default.toCanvas({width:n,height:n,comps:[{type:"rect",background:"rgb(0,0,0)",gradient:x,rect:[0,0,n,n]}]},n,n))}}else L=M.s("shape3d.image");d.useXZ="plane"===b,d.image=w.getTexture(L,M),d.blend=M.s("effect.flow.blend")||N,d.uvMatrix=ef(T.s("shape3d.uv.rotation"),T.s("shape3d.uv.offset"),T.s("shape3d.uv.scale"),T.s("shape3d.uv.anchor"),Y).toArray9(),d.intensity=M.s("effect.flow.intensity");var D=B.indexOf(G);-1===D&&0===G.indexOf("polygon")&&(D=Am(1*G.substring(7),3,1024)-1),d.shape=D,i.position=Pp(O,null,k,I,3),bj(O,0,k.length/3),z.unbind(O),w.setViewport(O,J[0],J[1],J[2],J[3]);var R=M.getMatrix4();R.getInverse(R);var y=R.getElements();"plane"===b?y[1]=y[5]=y[9]=y[13]=0:y[2]=y[6]=y[10]=y[14]=0,W[p]={matrix:R,group:M.s("effect.flow.group")}}}var Y,G=this,U=this.renderTargetPool=[],W=[],B=["rect","circle","polygon"];G.render=function(){if(!w._picking){var Y=w._flowObjects;if(Y.length){var W=w.getGL();if(W){var u;(u=W._flowShader)||(u=W._flowShader=new Cm.Shader(W,Xm.shaderSrc.vs,Xm.shaderSrc.fs));var z=w._frameState.renderState,T=z.glState;T.blend.enabled=!1,T.depth.enabled=!1,T.cullFace.enabled=!1;var d=T.color.clear.slice(0);Il(W,[0,0,0,1]),z.useProgram(u.program);var n,o,S=z.directUniforms(),y=z.directAttribs();for(n=0,o=Y.length;o>n;n++)K(W,n,Y[n],S,y);Il(W,d),U.length!==o&&U.splice(o,U.length-o)}}}},G.createFlow=function(k){var u;if(u=U.length){k||(k=w._frameState.renderState.directUniforms());for(var E=[],H=[],y=[],Z=0;u>Z;Z++)E[Z]=W[Z].matrix.toArray(),H[Z]=U[Z].texture,y[Z]=!1;k.flowMatrix=E;for(var Z=0;u>Z;Z++)k["flowTexture"+Z]=H[Z];k.flowEnabled=y}},G.disableFlow=function(l){var P;if(P=U.length){l||(l=w._frameState.renderState.directUniforms());for(var J=[],Z=0;P>Z;Z++)J[Z]=!1;l.flowEnabled=J}},G.resetDataFlowEnabld=function(L,R){var B=L.s("effect.flow.mask"),X=U.length,D=new Array(X);if(B)for(var Z=0;X>Z;Z++)B&1<<W[Z].group&&(D[Z]=!0);R.flowEnabled=D};var N="white"};Xm.shaderSrc={vs:["uniform bool useXZ;","attribute vec3 position;","varying vec2 vUv;","void main() {","if (useXZ) vUv = vec2(position.x, position.z);","else vUv = vec2(position.x, position.y);","gl_Position = vec4(vUv * 2.0, 0.0, 1.0);","}"].join("\n"),fs:["precision highp float;","const float pi2 = 6.2831853;","uniform sampler2D image;","uniform mat3 uvMatrix;","uniform int shape;","uniform vec4 blend;","uniform float intensity;","varying vec2 vUv;","void main() {","vec2 uv;","float angle = atan(vUv.y, vUv.x) / pi2 + 0.5;","if (shape == 0) {","uv = vUv + 0.5;","}","else if (shape == 1) {","uv = vec2(length(vUv) * 2.0, angle);","}","else {","float step = 1.0 / float(shape + 1);","float modAngle = mod(angle, step) - step * 0.5;","uv = vec2(length(vUv) * 2.0 * cos(modAngle * pi2) , angle);","}","vec4 color = texture2D(image, vec2((uvMatrix * vec3(uv, 1.0)).xy)) * blend;","gl_FragColor = color * color.a * intensity;","}"].join("\n")};var hr=function(k){this.gv=k,this.onMouseOver=this.onMouseOver.bind(this),this.resetProperties()};hr.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},sm.ms_highlight=function(o){o.setHighlightMode=function(A){var J;J="selection"===A||"selected"===A?hr.Mode.Selection:"mouseover"===A||"hover"===A?hr.Mode.MouseOver:"style"===A?hr.Mode.Style:hr.Mode.Disable;var d=this.getHighlightMode();this._highlightHelper.mode=J,this.firePropertyChange("highlightMode",d,A)},o.getHighlightMode=function(){var b=this._highlightHelper.mode;return b===hr.Mode.Selection?"selected":b===hr.Mode.MouseOver?"hover":b===hr.Mode.Style?"style":"disabled"},["type","color","width","glow","strength"].forEach(function(C){var d=C.replace(/(^|\.)[a-z]/g,function(z){return z[z.length-1].toUpperCase()});o["getHighlight"+d]=function(){return this._highlightHelper[C]},o["setHighlight"+d]=function(X){var U=this._highlightHelper,k=U[C];X!==k&&(U[C]=X,this.firePropertyChange("highlight"+d,k,X))}})},Ag(hr,j,{onMouseOver:function(l){z.preventDefault(l);var s=this.gv;if(!s._48Q){var X=s.getDataAt(l);X!==this.mouseOverData&&(this.mouseOverData=X,s.iv())}},setFetchTargetFunc:function(L){this.fetchTargetFunc=L},_42:function(m,F){var O,w,o=this,H=o._mode,k=o.gv;if(!m._renderInfo.reflectDepth&&H!==hr.Mode.Disable){if(H===hr.Mode.Selection?O=k.sm().getSelection().toArray(function(A){return A.s("highlight.visible")}):H===hr.Mode.MouseOver&&o.mouseOverData&&o.mouseOverData.s("highlight.visible")&&(O=[o.mouseOverData]),o.fetchTargetFunc&&(O=o.fetchTargetFunc(O)),H===hr.Mode.Style)O=O||[],w=function(i){if(O.indexOf(i)>=0)return!1;var j=k.getDataHighlightMode(i);return j===!1?!0:j===!0?!1:"selected"===j?k.isSelected(i)?!1:!0:"hover"===j?i===o.mouseOverData?!1:!0:!0};else{if(!O||!O.length)return;w=function(l){return O.indexOf(l)<0?!0:void 0}}var a=k.isVRPresenting(),L=k.getWidth();if(a){var i=k.getWidth;L/=2,k.getWidth=function(){return L};var g=k.getViewport()}var p,b=k.getDevicePixelRatio(),f=Math.floor(L*b),Z=Math.floor(k.getHeight()*b);(p=o._renderTarget)?p.setSize(m,f,Z):o._renderTarget=p=new Ac.RenderTarget(k,m,f,Z);var r="soft"===o.type;if(p.bind(m),r){var M=m.getParameter(m.COLOR_CLEAR_VALUE);Il(m,[1,1,1,1]),m.clear(m.COLOR_BUFFER_BIT),Il(m,M)}else m.clear(m.COLOR_BUFFER_BIT);k.setViewport(m,0,0,f,Z),k.drawFilter=w,Rm=function(v,V,k,g,n,R){var T=[k?0:1,1,1,1];return R||(qb.for(v).directUniforms().uFixPickReverseColor=T),T},k.renderPickScene(),Rm=Qb,k.drawFilter=null,p.unbind(m),jn&&Ep(m,F.aPosition),Ep(m,F.aNormal),a&&(k.getWidth=i,k.setViewport(m,g[0],g[1],g[2],g[3]));var X=k.getHighlightColor();if(o._lastHighlightColor!==X){var I=Yc(o._lastHighlightColor=X);o._highlightColorData=[I[0]/255,I[1]/255,I[2]/255,I[3]/255]}return r?o.renderSoftOutline(m,f,Z):o.renderHardOutline(m,f,Z),m.useProgram(F=k._prg),jn&&Jl(m,F.aPosition),!0}},_assureShader:function(e,G){var n=e._compiledShader[G];return n||(n=e._compiledShader[G]=new Cm.Shader(e,hr.CommonShaderVs,hr[G].fs)),n},renderHardOutline:function(L,h,q){var o=this,R=o.gv,p=R._postProcessing,x=qb.for(L),E=x.directState();E.blend.enabled=!0,E.depth.enabled=!1,p.blitScreen(null,o._renderTarget.texture,o._assureShader(L,"HighlightHard"),{textureSize:[h,q],edgeWidth:R.getHighlightWidth(),edgeColor:o._highlightColorData},{clear:!1}),E.blend.enabled=!1,E.depth.enabled=!0},renderSoftOutline:function(E,u,P){var G,Q,l,p,B,y=this,T=y.gv,k=T._postProcessing,n=Math.floor(u/2),F=Math.floor(P/2),Z=Math.floor(u/4),K=Math.floor(P/4),W=y._downSampleRenderTarget;W?(G=y._edgeDetectionRenderTarget,Q=y._blurV2,l=y._blurH2,p=y._blurV4,B=y._blurH4,(W.width!==n||W.height!==F)&&(W.setSize(n,F),G.setSize(n,F),Q.setSize(n,F),l.setSize(n,F),p.setSize(Z,K),B.setSize(Z,K))):(W=y._downSampleRenderTarget=new Ac.RenderTarget(T,E,n,F),G=y._edgeDetectionRenderTarget=new Ac.RenderTarget(T,E,n,F),Q=y._blurV2=new Ac.RenderTarget(T,E,n,F),l=y._blurH2=new Ac.RenderTarget(T,E,n,F),p=y._blurV4=new Ac.RenderTarget(T,E,Z,K),B=y._blurH4=new Ac.RenderTarget(T,E,Z,K));var t=E.getParameter(E.COLOR_CLEAR_VALUE),U=T.getViewport(),o=y.width,S=y.strength,Y=y.glow,z=qb.for(E).glState,R=z.depth,V=z.blend,g=R.enabled;Il(E,[1,1,1,1]),R.enabled=!1,V.apply({func:[E.SRC_ALPHA,E.ONE]}),k.blitScreen(W,y._renderTarget.texture),k.blitScreen(G,W.texture,y._assureShader(E,"EdgeDetection"),{texSize:[n,F],color:y._highlightColorData}),k.blitScreen(l,G.texture,y._assureShader(E,"Blur"),{direction:[1,0],texSize:[n,F],radius:o}),k.blitScreen(Q,l.texture,y._assureShader(E,"Blur"),{direction:[0,1],texSize:[n,F],radius:o}),k.blitScreen(B,Q.texture,y._assureShader(E,"Blur"),{direction:[1,0],texSize:[Z,K],radius:o}),k.blitScreen(p,B.texture,y._assureShader(E,"Blur"),{direction:[0,1],texSize:[Z,K],radius:o}),V.apply({enabled:!0}),T.setViewport(E,U[0],U[1],U[2],U[3]),k.blitScreen(null,y._renderTarget.texture,y._assureShader(E,"BlendTogether"),{edgeTexture1:Q.texture,edgeTexture2:p.texture,edgeStrength:S*o,edgeGlow:Y},{clear:!1}),V.apply({func:[E.SRC_ALPHA,E.ONE_MINUS_SRC_ALPHA,E.ONE,E.ONE_MINUS_SRC_ALPHA]}),R.enabled=g,Il(E,t)},resetProperties:function(){this.mode=hr.Mode.Style,this.type=s["highlight.type"],this.color=s["highlight.color"],this.width=s["highlight.width"],this.glow=s["highlight.glow"],this.strength=s["highlight.strength"]}}),j.defineProperties(hr.prototype,{mode:{get:function(){return this._mode},set:function(M){var o=this._mode;if(M!==o){this._mode=M;var n=o===hr.Mode.MouseOver||o===hr.Mode.Style,T=M===hr.Mode.MouseOver||M===hr.Mode.Style;T&&n||(n&&g(this.gv.getView(),"mousemove",this.onMouseOver),T&&p(this.gv.getView(),"mousemove",this.onMouseOver))}}}}),hr.CommonShaderVs=["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),hr.HighlightHard={fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},hr.EdgeDetection={fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","uniform vec2 texSize;","uniform vec4 color;","void main() {","vec2 invSize = 1.0 / texSize;","vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);","vec4 c1 = texture2D( image, vUv + uvOffset.xy);","vec4 c2 = texture2D( image, vUv - uvOffset.xy);","vec4 c3 = texture2D( image, vUv + uvOffset.yw);","vec4 c4 = texture2D( image, vUv - uvOffset.yw);","float diff1 = (c1.r - c2.r)*0.5;","float diff2 = (c3.r - c4.r)*0.5;","float d = length( vec2(diff1, diff2) );","gl_FragColor = color * vec4(d);","}"].join("\n")},hr.Blur={fs:["#define MAX_RADIUS 4","precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform vec2 texSize;","uniform vec2 direction;","uniform float radius;","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float weightSum = gaussianPdf(0.0, radius);","vec4 diffuseSum = texture2D( image, vUv) * weightSum;","vec2 delta = direction * invSize * radius/float(MAX_RADIUS);","vec2 uvOffset = delta;","for( int i = 1; i <= MAX_RADIUS; i ++ ) {","float w = gaussianPdf(uvOffset.x, radius);","vec4 sample1 = texture2D( image, vUv + uvOffset);","vec4 sample2 = texture2D( image, vUv - uvOffset);","diffuseSum += ((sample1 + sample2) * w);","weightSum += (2.0 * w);","uvOffset += delta;","}","gl_FragColor = diffuseSum/weightSum;","}"].join("\n")},hr.BlendTogether={fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform sampler2D edgeTexture1;","uniform sampler2D edgeTexture2;","uniform float edgeStrength;","uniform float edgeGlow;","void main() {","vec4 edgeValue1 = texture2D(edgeTexture1, vUv);","vec4 edgeValue2 = texture2D(edgeTexture2, vUv);","vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;","float vv = texture2D(image, vUv).r;","vec4 finalColor = edgeStrength * vv * edgeValue;","gl_FragColor = finalColor;","}"].join("\n")};var xi=A.Light=function(){nk(xi,this),this.s(Ml,s[Ml]),this.s(hc,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};Og("Light",jr,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(f,C,$){xi.superClass.onStyleChanged.apply(this,arguments),f===Ml&&this.s("shape3d.color",$)}});var zd=Ac.FrameState=function(L,T){this.renderState=qb.for(T),this.picking=!1,this.envmapReflectivity=.5,this.cameraPosition=_,this.projectMatrix=_,this.viewMatrix=_,this.view=L,this.defaultProgram=_,this.pickColorMap=_,this._pvStack=[],this._renderStateStack=[]};zd.prototype.savePV=function(){var z=this.view;this._pvStack.push([yj(this.projectMatrix),yj(this.viewMatrix),z._18Q,yj(z._7O)])},zd.prototype.restorePV=function(){var d=this._pvStack.pop();if(d){var s=this.view;this.projectMatrix=s._projectMatrix=d[0],this.viewMatrix=s._viewMatrix=d[1],s._18Q=d[2],s._7O=d[3]}},zd.prototype.setPV=function(N,A){var Y=this.view,S=!1;if(N&&(this.projectMatrix=Y._projectMatrix=N,S=!0),A&&(this.viewMatrix=Y._viewMatrix=A,Y._7O=yj(A),S=!0),S){var H=Y.getWidth(),U=Y.getHeight(),M=yj(this.projectMatrix);Y._18Q=Vb(M,M,A),Y._18Q._wh=H/U}},zd.prototype.syncEnv=function(I){var t=this,S=t.view;t.envmapReflectivity=S._envmapReflectivity||.5,t.cameraPosition=S.getEye(),t.projectMatrix=S._projectMatrix,t.viewMatrix=S._viewMatrix,t.pickColorMap=I,t.picking=S.getGL()._picking},zd.prototype.setGLState=function(){var R=[0,0,0,0],k=[!0,!0,!0,!0],T=[-1,1],p=[Bd.FUNC_ADD,Bd.FUNC_ADD],N=[Bd.SRC_ALPHA,Bd.ONE_MINUS_SRC_ALPHA,Bd.ONE,Bd.ONE_MINUS_SRC_ALPHA];return function(r,L){var q=this,J=q.renderState.gl,G=q.renderState.glState;G.dither=!1,L?G.color.mask=k:G.color.reset(),G.pixelStore.reset(),G.blend.color=R,G.blend.equation=p,G.blend.func=N,G.cullFace.enabled=!1,G.scissor.enabled=!1,G.depth.enabled=!0,G.depth.clear=1,G.depth.func=J.LEQUAL,G.depth.range=T,G.stencil.enabled=!1,G.polygonOffset.enabled=!1,r?(G.depth.mask=!1,G.blend.enabled=!0):(G.depth.mask=!0,G.blend.enabled=!1)
}}(),zd.prototype.setUniforms=function(A){var n=this,e=n.view,I=n.renderState,q=I.gl,g=I.uniforms;g.uBrightness=1,g.uOpacity=1,g.uPartOpacity=1,g.uPick=n.picking,g.uTexture=!1,g.uBlendTexture=!1,g.uAlphaTest=s.alphaTest,g.uTransparent=!!A,g.uFix=!1,g.uBatchColor=!1,g.uBatchBlend=!1,g.uBatchBrightness=!1,g.uReflectivity=n.envmapReflectivity||.5,g.uCameraPosition=n.cameraPosition,g.uPMatrix=n.projectMatrix,g.uViewMatrix=n.viewMatrix,g.uEnvMap=null,vo(e,g,Ak),g.uClipperMatrix=e._boxClipperMatrixes,g.uClipperClipInner=e._boxClipperClipInner,e._envmapRenderer.resetUniformCache(),n.picking||(nj(e,q,_),e._fogDisabled||(g.uFogColor=e._fogColor,g.uFogDensity=e._fogDensity,g.uFogNear=e._fogNear,g.uFogFar=e._fogFar))},zd.prototype.drawLayer=function(t){return this.view.renderLayers(t,!0)},zd.prototype.drawData=function(y,_,W){var z=this.view;if(z.isVisible(y)){var O=this.renderState,c=O.uniforms,u=z.getData3dUI(y);if(u){var a=O.gl,U=a._picking,N=z._picking,n=u._pickId;W&&(u._pickId=W),c.uPick=a._picking=z._picking=!!W,c.uTransparent=!!_,u._42(O.gl,O.program,_?x:o),c.uPick=a._picking=U,z._picking=N,u._pickId=n}}};var Jc=Ac.Graph3dView=function(J,l){var E=this;E.resetHeadlightProperties(),E.resetFogProperties(),E._webGLVersion=1,E._attributes=l||z.graph3dViewAttributes,E._25I={},E._view=nh(1,E);var c=E._canvas=th(E._view);p(c,"webglcontextlost",function(j){j.preventDefault(),Jn(E),E._26I&&E._doBufferGC(E._26I,!0),E._26I=I,E._1o.onContextLost(),E._35O=!0}),p(c,"webglcontextrestored",function(){E._35O=!1,E.iv()}),E._40Q=new Mh,E._43Q={},E._44Q=-1,E._batchIndexMap={},E._batchModelMap={},E._wireframeIndexMap={},E._wireframeModelMap={},E._wireframeIndexMapSwap={},E._wireframeModelMapSwap={},E._polylineIndexMap={},E._polylineIndexMap={},E._polylineIndexMapSwap={},E._polylineIndexMapSwap={},E._8O=[],E._7O=dq(),E._6O=dq(),E._1o=new Ls(E),E._30O=new Os(E),E._31O=new Ms(E),E._32O=new Ns(E),E._raycaster=new Zs(E),E._highlightHelper=new hr(E),E._postProcessing=new ht(E),E._41Q=[],E._42Q=0,E._frameRenderOptionStack=[],Ac.VR?(E.vr=new Ac.VR(E),E.isVREnabled=function(){return this.vr.enable},E.isVRPresenting=function(){return this.vr.isPresenting()}):(E.vr={enable:!1,isPresenting:v},E.isVREnabled=v,E.isVRPresenting=v),E.shadowMap=new Oi(E),E.flowMap=new Xm(E),E._33Q=!0,E._eye=Tl(z.graph3dViewEye),E._center=Tl(z.graph3dViewCenter),E._up=Tl(z.graph3dViewUp),E._lightChanged=!1,E._59O=[],E._spots=[],E._dirs=[],E._boxClippers=[],E._flowObjects=[],E._frameId=0,E._picking=!1,E._batchInfoMap={},E.overlappingBox=new Fc(E),E.dm(J?J:new Tf),E._coreInteractor=new wq(this),E._envmapRenderer=new Ac.EnvmapRenderer(this),E.setInteractors([new Es(E)]),E._initView()},yd={fogDisabled:1,fogMode:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},qs=0;ci("Graph3dView",j,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_shadow:1,ms_highlight:1,ms_quickVisible:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",On,Vn,"firstPersonMode",Jo,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","headlightGroup","ortho","orthoWidth","syncEyeWithOrthoWidth","fovy","near","far",Mj,Cj,"up","aspect","fogDisabled","fogMode","fogDensity","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay","batchInfoMap","rotateMinPhi","rotateMaxPhi","sortable","sortFunc"],_editable:!1,_sortable:z.graph3dViewSortable,_editHelperDisabled:z.graph3dViewEditHelperDisabled,_blockSelectable:z.graph3dViewBlockSelectable,_devicePixelRatio:_,_boundaries:_,_moveStep:z.graph3dViewMoveStep,_rotateStep:z.graph3dViewRotateStep,_rotateMinPhi:z.graph3dViewMinPhi===_?z.graph3dViewRotateMinPhi:z.graph3dViewMinPhi,_rotateMaxPhi:z.graph3dViewMaxPhi===_?z.graph3dViewRotateMaxPhi:z.graph3dViewMaxPhi,_pannable:z.graph3dViewPannable,_rotatable:z.graph3dViewRotatable,_walkable:z.graph3dViewWalkable,_resettable:z.graph3dViewResettable,_zoomable:z.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:z.graph3dViewFirstPersonMode,_mouseRoamable:z.graph3dViewMouseRoamable,_gridVisible:z.graph3dViewGridVisible,_gridSize:z.graph3dViewGridSize,_gridGap:z.graph3dViewGridGap,_gridColor:z.graph3dViewGridColor,_originAxisVisible:z.graph3dViewOriginAxisVisible,_centerAxisVisible:z.graph3dViewCenterAxisVisible,_axisXColor:z.graph3dViewAxisXColor,_axisYColor:z.graph3dViewAxisYColor,_axisZColor:z.graph3dViewAxisZColor,_ortho:z.graph3dViewOrtho,_orthoWidth:z.graph3dViewOrthoWidth,_syncEyeWithOrthoWidth:z.graph3dViewSyncEyeWithOrthoWidth,_fovy:z.graph3dViewFovy,_near:z.graph3dViewNear,_far:z.graph3dViewFar,_rectSelectable:z.graph3dViewRectSelectable,_rectSelectBackground:z.graph3dViewRectSelectBackground,_editSizeColor:z.graph3dViewEditSizeColor,_autoMakeVisible:Un,_pickerResolution:z.graph3dViewPickerResolution,_dashDisabled:z.graph3dViewDashDisabled,_batchColorDisabled:z.graph3dViewBatchColorDisabled,_batchBlendDisabled:z.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:z.graph3dViewBatchBrightnessDisabled,addCamera:function(R){var L=this,p=j.freeze({id:L._42Q++,priority:R.priority||0,ignoreInPick:!!R.ignoreInPick,render:R.render});R.switch3DStatus&&(L._43Q[p.id]=!0),L._41Q.push(p),L._41Q.sort(function(N,y){return N.priority!==y.priority?N.priority-y.priority:N.id-y.id})},setEye:function(B,G,O){1===arguments.length&&(G=B[1],O=B[2],B=B[0]);var l=this._eye;l[0]=B,l[1]=G,l[2]=O,this.fp(Mj,I,l)},setCenter:function(S,T,E){1===arguments.length&&(T=S[1],E=S[2],S=S[0]);var r=this._center;r[0]=S,r[1]=T,r[2]=E,this.fp(Cj,I,r)},setUp:function(H,E,z){1===arguments.length&&(E=H[1],z=H[2],H=H[0]);var i=this._up;i[0]=H,i[1]=E,i[2]=z,this.fp("up",I,i)},getDevicePixelRatio:function(){return this._picking?this._1o._resolution:this._devicePixelRatio||Ch},isTransparentMask:function(C){return C.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var M=this,F=M._aspect;return F?F:(F=M.getWidth()/M.getHeight(),F||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(p){var $=this,J=$._dataModel,H=$._selectionModel;J!==p&&(J&&(J.ump($.handleDataModelPropertyChange,$),J.umm($.handleDataModelChange,$),J.umd($.handleDataPropertyChange,$),H||J.sm().ums($.handleSelectionChange,$)),$._dataModel=p,p.mp($.handleDataModelPropertyChange,$),p.mm($.handleDataModelChange,$),p.md($.handleDataPropertyChange,$),H?H._21I(p):p.sm().ms($.handleSelectionChange,$),$._postProcessing.handleDataModleChange(J,p),$._tryInvalidateEnvmap(),$.invalidateAll(!0),$.invalidateLight(),$.invalidateboxClipper(),$.invalidateFlowObjects(),$._49Q(),$.fp(Vi,J,p),$._canvas.style.background=p.getBackground()||"")},handleDataModelPropertyChange:function(P){var $=P.property;if("background"===$){var l=this._canvas.style.background,s=P.newValue||"";this._canvas.style.background=s,this.fp("canvasBackground",l,s)}else"envmapType"===$?this._tryInvalidateEnvmap():"envmap"===$&&this.iv()},handleDataPropertyChange:function(Z){var y=Z.data;this.invalidateData(y);var c=Z.property;pe(y)&&"s:light.type"===c?this.invalidateLight():"s:3d.clipbox"===c?this.invalidateboxClipper(y,!0):"s:effect.flow"===c?this.invalidateFlowObjects(y,!0):"s:shadow.cast"===c?this.shadowMap.tryUpdateBounding(y):"s:3d.visible"===c&&this.invalidateQuickVisible(y)},invalidateboxClipper:function(k,W){var B=this._boxClippers,U=B.length;if(k){var M=!!k.s("3d.clipbox");if(W=!!W,M===W)B.indexOf(k)<0&&B.push(k);else{var m=B.indexOf(k);m>=0&&B.splice(m,1)}}else B=this._boxClippers=[],this.dm().each(function(n){n.s("3d.clipbox")&&B.push(n)});var T=B.length;U!==T&&(Jn(this),this.shadowMap.deleteShadowProgram(),this._updateBoxClipperMatrix(),vo=T?Ad:jb),this.iv()},_updateBoxClipperMatrix:function(){for(var s,$,O=this._boxClippers,y=this._boxClipperMatrixes=[],K=this._boxClipperClipInner=[],N=this._boxClipperGroups=[],U=new gq,m=0,Z=O.length;Z>m;m++)s=O[m],s.appendAnchorMatrix3d($=Gq(s,this.getMat(s))),y.push(U.getInverse(U.fromArray($)).toArray()),K.push("inner"===s.s("3d.clipbox")),N.push(s.s("3d.clipbox.group"))},_49Q:function(){this._4AQ||this._48Q||this.dm().size()<z.graph3dViewDataNumWarningLine||(this._48Q=!0,console.log("Too many datas so than disable some feature to speed up.\nYou can set global Default.graph3dViewDataNumWarningLine to largeEnoughNum to avoid this, or call graph3dView.quitDataNumWarning() to quit.\n"),this.enableQuickVisibleMode(),this.getHighlightHelper().mouseOverData=null)},quitDataNumWarning:function(){this.disableQuickVisibleMode(),this._48Q=!1,this._4AQ=!0},invalidateFlowObjects:function(S,$){var M=this._flowObjects,F=M.length;if(S){var n=!!S.s("effect.flow");if($=!!$,n===$)M.indexOf(S)<0&&M.push(S);else{var W=M.indexOf(S);W>=0&&M.splice(W,1)}}else M=this._flowObjects=[],this.dm().each(function(A){A.s("effect.flow")&&M.push(A)});F!==M.length&&Jn(this),this.iv()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(Y){var z=this,l=Y.property;z.iv(),z._18Q=I,"eye"===l?z._33Q=!0:"devicePixelRatio"===l?z._42(z.getDevicePixelRatio()):yd[l]&&Jn(z)},_5O:function(p){var q=p._22Q();return q?new q(this,p):I},getData3dUI:function(P){var B=this._25I[P._id];return B===_&&(B=this._5O(P),this._25I[P._id]=B),B},invalidateAll:function(L,g){var $=this;if(L){for(var z in $._25I){var k=$._25I[z];k&&k.dispose()}$._25I={},$.iv(),Mq($)}else Mq($),$.dm().each(function(b){$.invalidateData(b)});$.shadowMap.tryInvalidateLater(L,g)},invalidateSelection:function(){var r=this;r.sm().each(function(c){r.invalidateData(c)})},invalidateData:function(r){var G=this,m=G.getData3dUI(r);m&&(m.iv(),G.iv()),Mq(G,r)},getShape3dText:function(H){return H.getStyle("shape3d.text")||this.getLabel(H)},invalidateBatch:function(A){var M=this,F=M._40Q;F.each(function(e){M._invalidateBatch(A,e.batchModelMap,e.batchIndexMap),M._invalidateBatch("T"+A,e.wireframeModelMap,e.wireframeIndexMap),M._invalidateBatch("O"+A,e.wireframeModelMap,e.wireframeIndexMap),e.markBatchInvalid()}),M.iv()},_invalidateBatch:function(t,J,H){var G=this,q=J[t];q&&(q.ds.forEach(function(w){var I=G.getData3dUI(w);I&&I.iv(),delete H[w._id]}),delete J[t])},handleDataModelChange:function(w){var X=this,W=w.kind,n=w.data;if("add"===W)X.invalidateData(n),Rn(n)&&n.getEdgeGroup()&&n.getEdgeGroup().eachSiblingEdge(X.invalidateData,X),pe(n)&&X.invalidateLight(),n.s("3d.clipbox")&&X.invalidateboxClipper(n,!0),n.s("effect.flow")&&X.invalidateFlowObjects(n,!0),X._49Q();else if(W===Oe){var q=n._id,c=X._25I[q];c&&(c.dispose(),delete X._25I[q],X.iv()),n===X._currentSubGraph&&X.setCurrentSubGraph(I),Mq(X,n),pe(n)&&X.invalidateLight(),n.s("3d.clipbox")&&X.invalidateboxClipper(n,!1),n.s("effect.flow")&&X.invalidateFlowObjects(n,!1)}else W===gs&&(X.invalidateAll(!0),X.setCurrentSubGraph(I),Mq(X),X.invalidateLight(),X.invalidateboxClipper(),X.invalidateFlowObjects())},toCanvas:function(X,x,K){var H=this,Y=H.getGL();if(H.validate(),X){var m=Y.getParameter(Y.COLOR_CLEAR_VALUE);Il(Y,X)}H._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var h=H.getWidth()||1,$=H.getHeight()||1,p=new Uint8Array(4*h*$),Q=th(),M=Q.getContext("2d");Y.readPixels(0,0,h,$,Y.RGBA,Y.UNSIGNED_BYTE,p),Pq(Q,h,$,1);for(var y=M.getImageData(0,0,h,$),A=y.data,b=0;b<A.length;b+=4){var t=b/4,s=k(t/h),I=t-s*h;t=4*(($-1-s)*h+I),A[t]=p[b],A[t+1]=p[b+1],A[t+2]=p[b+2],A[t+3]=p[b+3]}if(M.putImageData(y,0,0),X&&Il(Y,m),H._42(H.getDevicePixelRatio()),x&&K){var e=th(),U=e.getContext("2d");return Pq(e,x,K,1),z.drawImage(U,Q,0,0,x,K),e}return Q},toDataURL:function(Z,s){var n=this,O=n.getGL();if(n.validate(),Z){var L=O.getParameter(O.COLOR_CLEAR_VALUE);Il(O,Z)}n._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var x=n._canvas.toDataURL(s||"image/png",1);return Z&&Il(O,L),n._42(n.getDevicePixelRatio()),x},isWebGL2:function(){return 2===this._webGLVersion},getGL:function(){var Z=this._26I;if(Z)return this.acquireProgram(),Z;if(!this._35O){var u=this,g=u._canvas,v=u._attributes;if(!v||v.requestWebGL2!==!1)try{Z=g.getContext("webgl2",v)||g.getContext("experimental-webgl2",v),Z&&(u._webGLVersion=2,u._26I=Z)}catch(x){}if(!Z)try{Z=g.getContext("webgl",v)||g.getContext("experimental-webgl",v)}catch(x){throw new Error("WebGL not supported")}if(!Z)throw new Error("WebGL not supported");u._26I=Z;var t=u._frameState=new zd(this,Z);u._glExtensions=new O(Z),u._glCapabilities=new G(Z,u._glExtensions),u._2O={},Z._emptyCubeTexture=Ef(Z),Z._compiledShader={},Z._emptyTexture=Cc(Z),Z._emptyBlendTexture=Cc(Z),Z._bufPool={},Z._id=++qs,t.setGLState(),u._buffer={vs:Zr(Z),ns:Zr(Z),is:Zr(Z),uv:Zr(Z),batchColor:Zr(Z),batchBlend:Zr(Z),batchBrightness:Zr(Z),lineDistance:Zr(Z)},u._1O=Gg(Z);var K=u._cube={vs:Zr(Z),ns:Zr(Z),is:Zr(Z),uv:Zr(Z)};return Wh(Z,K.vs,Vf),Wh(Z,K.ns,Cb),Wh(Z,K.uv,lm),di(Z,K.is,ap),u.acquireProgram(),Z._renderInfo={calls:0,vertices:0,faces:0,lines:0,points:0,frame:0,cacheTimeCost:0},Z}},getGLCapabilities:function(){var g=this.getGL();return g?this._glCapabilities:void 0},getGLExtensions:function(){var N=this.getGL();return N?this._glExtensions:void 0},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<z.graph3dEnvmapCapabilityRequire?null:this.dm().getEnvmap()},getEnvmapType:function(){var n,o=this.dm();return o&&(n=o.getEnvmapType()),n||"legacy"},invalidateEnvmap:function(i){return this._envmapRenderer.invalidateEnvmap(i)},_setEnvmapByProbeId:function(m,c){return this._envmapRenderer.setEnvmapByProbeId(m,c)},_tryInvalidateEnvmap:function(){var Y=this.getEnvmapType();Y!==this._lastProgramEnvmapType&&(Jn(this),this.iv())},acquireProgram:function(){var w=this,i=w._26I;if(i&&!w._prg){var r=w._prg=i.createProgram();if(!r)return I;var E=w._dirs.length,d=w._spots.length,$=w._59O.length,Z=w._boxClippers.length,A=w._flowObjects.length,H=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uUvMatrix","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogDensity","uFogNear","uFogFar"];E&&H.push("uDirColor","uDirDirection"),d&&H.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),$&&H.push("uPointColor","uPointRange","uPointPosition"),xj||(hj=Cq(hj.substring(0,hj.indexOf("^#"))),dl=Cq(dl),xj=!0);var h=w.getEnvmapType(),n=["#define MAX_DIR "+E,"#define MAX_SPOT "+d,"#define MAX_POINT "+$,"#define MAX_BOX_CLIPPER "+Z,"#define MAX_FLOW_OBJECT "+A,w._fogDisabled?"":"#define FOG","exp2"===w.getFogMode()?"#define FOG_EXP2":"",w._dashDisabled?"":"#define DASH","#define USE_ENVMAP","legacy"!==h?"#define ENVMAP_TYPE_CUBE_UV":"",w.isOrtho()?"#define ORTHOGRAPHIC":"",w._batchColorDisabled?"":"#define BATCHCOLOR",w._batchBlendDisabled?"":"#define BATCHBLEND",w._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",w.shadowMap.enable?w.shadowMap.genShaderDefine():"",""].join("\n"),R=Bq(i,r,i.VERTEX_SHADER,hj.replace("PREFIX",n));i.getShaderParameter(R,i.COMPILE_STATUS)||Bc("COMPILE",i.VERTEX_SHADER,i.getError(),i.getShaderInfoLog(R));var B=Bq(i,r,i.FRAGMENT_SHADER,dl.replace("PREFIX",n));if(i.getShaderParameter(B,i.COMPILE_STATUS)||Bc("COMPILE",i.FRAGMENT_SHADER,i.getError(),i.getShaderInfoLog(B)),jn?H.push("aPosition"):(r.aPosition=0,i.bindAttribLocation(r,0,"aPosition")),i.linkProgram(r),!i.getProgramParameter(r,i.LINK_STATUS)){var e=i.getProgramInfoLog(r);return w._prg=I,e.indexOf("maximum temp register")>=0&&!w._glTempRegisterLimited?(w._glTempRegisterLimited=!0,i.deleteProgram(r),w.acquireProgram()):(Bc("LINK",i.getProgramParameter(r,i.VALIDATE_STATUS),i.getError(),e),i.deleteProgram(r),I)}H.forEach(function(W){r[W]=/^u/.test(W)?i.getUniformLocation(r,W):i.getAttribLocation(r,W)});var q=w._frameState;q.renderState.program=q.defaultProgram=r,w._envmapRenderer.changeEnvmapType(w._lastProgramEnvmapType=h),i.deleteShader(R),i.deleteShader(B)}},isGLTempRegisterLimited:function(){return this._glTempRegisterLimited},getBrightness:function(E){var s=E.s("brightness"),z=this.isSelected(E)?E.s("select.brightness"):I;return s==I?z:z==I?s:s*z},getDataHighlightMode:function(X){return X.s("highlight.mode")},getWireframe:function(S){var K=S.s("wf.visible"),q=S.s("wf.width");return K===!0||q>0&&"selected"===K&&this.isSelected(S)?{color:S.s("wf.color"),width:q,"short":S.s("wf.short"),mat:S.s("wf.mat")}:void 0},_transformPointToViewSpace:function(T){var B=[T[0],T[1],T[2]];return xl(B,this._viewMatrix),B},_transformDirectionToViewSpace:function(V,e){var v=[V[0],V[1],V[2]];xl(v,this._viewMatrix);var I=e?[e[0],e[1],e[2]]:[0,0,0];xl(I,this._viewMatrix);var M=I[0]-v[0],p=I[1]-v[1],w=I[2]-v[2],K=Math.sqrt(M*M+p*p+w*w);return K?[M/K,p/K,w/K]:[M,p,w]},getWireframeGeometry:function(y){return y.s("wf.geometry")?{color:y.s("wf.color"),width:y.s("wf.width"),mat:y.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(w){return w.s("body.color")},getMat:function(l){return l.getMat?l.getMat():l.s("mat")},getFaceMat:function(J,e){return J.getFaceMat?J.getFaceMat(e):J.s(e+".mat")},getFaceBlend:function(X,v){return X.s(v+".blend")||X.s("all.blend")},getFaceColor:function($,I){return $.s(I+".color")||$.s("all.color")},getFaceImage:function(Y,A){return Y.s(A+".image")||Y.s("all.image")},getFaceBlendImage:function($,O){return $.s(O+".blend.image")||$.s("all.blend.image")},getFaceDiscardSelectable:function(i,J){var z=i.s(J+".discard.selectable");return z==I?i.s("all.discard.selectable"):z},getFaceUv:function(D,u){return D.s(u+".uv")||D.s("all.uv")},getFaceUvOffset:function(J,t){return J.s(t+".uv.offset")||J.s("all.uv.offset")},getFaceUvScale:function(V,B){return V.s(B+".uv.scale")||V.s("all.uv.scale")},getFaceUvRotation:function(I,H){return I.s(H+".uv.rotation")||I.s("all.uv.rotation")},getFaceUvAnchor:function(X,I){return X.s(I+".uv.anchor")||X.s("all.uv.anchor")},getFaceLight:function(z,F){var L=z.s(F+".light");return L==I?z.s("all.light"):L},getFaceVisible:function(j,J){var Z=j.s(J+".visible");return Z==I?j.s("all.visible"):Z},getFaceOpacity:function(c,i){var v=c.s(i+".opacity");return v==I?c.s("all.opacity"):v},getFaceTransparent:function(E,a){var $=E.s(a+".transparent");return $==I?E.s("all.transparent"):$},getFaceReverseColor:function(B,U){return B.s(U+".reverse.color")||B.s("all.reverse.color")},getFaceReverseFlip:function(r,N){var c=r.s(N+".reverse.flip");return c==I?r.s("all.reverse.flip"):c},getFaceReverseCull:function(q,R){var t=q.s(R+".reverse.cull");return t==I?q.s("all.reverse.cull"):t},getTextureMap:function(){return this._2O},_2Oi:function(F,p,S){S=S||"";var R;(R=this._2O[F])||(R=this._2O[F]={}),R[S]=p},deleteTexture:function(R){var e=this,U=e._2O[R];if(U){delete e._2O[R];var i=e.getGL();for(var n in U)i.deleteTexture(U[n])}},renderPickScene:function(){var q=this.getGL();this.syncRenderState(),this._picking=q._picking=!0,this.renderScene(),this._picking=q._picking=!1},invalidateCachedTexture:function(J){var C=this.getData3dUI(J);C.invalidateCachedTexture(this.getGL()),this.invalidateData(J)},invalidateShape3dCachedImage:function(r){this.invalidateCachedTexture(r)},invalidateCachedGeometry:function(y){var l=this.getData3dUI(y);l.invalidateCachedGeometry(),this.invalidateData(y)},isInteractive:function(M){return M.s("interactive")},getTexture:function(y,k,B,U){if(!y)return I;var X,s,h=this,t=h.getGL(),$=h._2O[y];if($&&(k&&(s=k.s("texture.mipmap.max")),X=$[s||""]||$.default),!X){var E=Gj(y);if(U||(U={}),!E)return t._emptyTexture;if(k){U.mipmapMaxLevel=s=k.s("texture.mipmap.max");var C=k.s("texture.wrap");U.clampToEdge="clampToEdge"===C?!0:"repeat"===C?!1:_}if(E.uuid||(E.uuid=A.Math.generateUUID()),E.tagName){if(E.dynamic)return Gg(t,E,h._1O,U);X=Gg(t,E,_,U),h._2Oi(y,X,s)}else{var L,R=k&&(k.s("texture.cache")||k.s("shape3d.image.cache")||E.textureCache),g=h.isVRPresenting();if(g&&(k._textureUpdateFrame===t._renderInfo.frame?R=!0:k._textureUpdateFrame=t._renderInfo.frame),R&&(L=h.getData3dUI(k),X=L.getCachedTexture(B),X&&L.interactiveInfo&&X.interactiveInfo&&(L.interactiveInfo[X.interactiveInfo.key]=X.interactiveInfo.info)),!X){var v=t._renderInfo.textureCache;if(R){if(v.time>z.graph3dMaxVectorCacheTime)return h.redraw(),t._emptyTexture;if(!$c(E,k))return t._emptyTexture}var J;k&&(1!==k.s("texture.scale")?J=k.s("texture.scale"):1!==k.s("shape3d.texture.scale")&&(J=k.s("shape3d.texture.scale"))),J||(J=1);var b=k&&(k.s("fixSizeOnScreen")||k.s("shape3d.fixSizeOnScreen")),e=b?t.NEAREST:t.LINEAR;b?"number"==typeof b&&(J*=0>b?1:b):k&&(k.s("vector.dynamic")||k.s("shape3d.vector.dynamic"))&&(L||(L=h.getData3dUI(k)),b=L.getVectorDynamicSize());var S,D,f,F=k&&k.s("shape3d");"billboard"===F?f=k.getTall()/k.getWidth():"plane"===F&&(f=k.getHeight()/k.getWidth());var x=bi(E,k);if(b){var G;G=R?h._devicePixelRatio||Ch:h.getDevicePixelRatio(),S=b[0]>0?b[0]*G:J*x*G,D=b[1]>0?b[1]*G:J*(f?Eg(E,k,h,Math.min(4096,x*f)):Eg(E,k))*G}else S=J*x,D=J*(f?Eg(E,k,h,Math.min(4096,x*f)):Eg(E,k));if(S>=1&&D>=1){var N=0;(R||g)&&(N=Date.now());var w=h._glCapabilities.maxTextureSize;S=Math.min(S,w),D=Math.min(D,w);var H=ys(S,D);if(!L&&k&&(L=h.getData3dUI(k)),L&&L.interactiveInfo){var c=y;"object"==typeof c&&(c=c.uuid||(c.uuid=A.Math.generateUUID()));var q=L.interactiveInfo[c]={};H.interactiveInfo=q.bodyInfo={compInfos:[],matrix:new ab,rect:{x:0,y:0,width:S,height:D}}}jp(H,E,0,0,S,D,k,h),H.interactiveInfo&&(H.interactiveInfo=null),H.restore(),v.count++,v.pixels+=S*D,k?(U.minFilter=Qm(k.s("texture.filter.min")||k.s("texture.filter"))||e,U.magFilter=Qm(k.s("texture.filter.mag")||k.s("texture.filter"))||e):U.minFilter=U.magFilter=e,R||g?(X=Gg(t,Xj,null,U),L.setCachedTexture(X,B),v.time+=Date.now()-N,q&&(X.interactiveInfo={key:c,info:q}),Xj=null):X=Gg(t,Xj,h._1O,U)}}}}return X},redraw:function(){this.iv()},validateImpl:function(){var N=this;if(N._lightChanged){N._lightChanged=!1;var v=[],h=[],b=[];N.dm().each(function(C){if(pe(C)){var U=C.s("light.type");U===Dc?v.push(C):U===ds?h.push(C):U===Xk&&b.push(C)}}),(v.length!==N._59O.length||h.length!==N._spots.length||b.length!==N._dirs.length)&&Jn(N),N._59O=v,N._spots=h,N._dirs=b}var s=N.getAspect();s!==N.__cachedAspect__&&(N._updateSkybox({property:"asceptChanged"}),N.__cachedAspect__=s),N._42(),N._1o.iv()},getRenderInfo:function(){var F=this.getGL();return F?F._renderInfo:void 0},getDebugTip:function(){var t=this,p=t.getRenderInfo();if(p){var Q=t.getGL()._validBufCount||0,s="Draw Calls: "+p.calls+"<br/>"+"Vertices: "+p.vertices+"<br/>"+"Faces: "+p.faces+"<br/>"+"Lines: "+p.lines+"<br/>"+(p.points?"Points: "+p.points+"<br/>":"")+"Buffers: "+Q+"<br/>"+"Cache Models: "+j.keys(ve).length+"<br/>"+"Shape3d Models: "+j.keys(Pi).length;if(t.isVRPresenting()&&(s+="<br/>VR fps: "+t.vr.getFps()),p.textureCache){var Z=p.textureCache.count;if(s+="<br/>2D Dynamic Textures: "+p.textureCache.count,Z>0){var R,x=p.textureCache.pixels;R=x>1e6?Math.round(x/1e6)+"M":x>1e3?Math.round(x/1e3)+"K":Math.round(x),s+="<br/>2D Dynamic pixels: "+R}}return s}},getFrameState:function(){return this._frameState},isBoundingBoxInView:function(){var n=new A.Math.Box3,e=new A.Math.Matrix4;return function(b){var I=b;if(I instanceof A.Data&&(I=this.getData3dUI(I)),!I.mat)return!0;var z=I.getBoundingBox();n.copy(z).applyMatrix4(e.fromArray(I.mat));var N=this.getFrustum();return N.intersectsBox(n)}}(),updateScene:function(){var z=this;z._81O=I,z.overlappingBox.clear();var N=z._40Q;N.init();var r=z.getGL(),B=z.dm();if(B.isHierarchicalRendering())B.eachByHierarchical(function(k){var q=z.getData3dUI(k);q&&q.update(z,r,N)});else{var L,S,J,F=B.getDatas().getArray(),m=F.length;for(L=0;m>L;L++)S=F[L],J=z.getData3dUI(S),J&&J.update(z,r,N)}this._updateBoxClipperMatrix(),N.onUpdated()},_pushFrameRenderOptions:function(M){this._frameRenderOptionStack.push(this._currentFrameRenderOptions),this._currentFrameRenderOptions=M},_popFrameRenderOptions:function(){this._currentFrameRenderOptions=this._frameRenderOptionStack.pop()},_getFrameRenderOptions:function(o){var P=this._currentFrameRenderOptions;return P&&P[o]},getRenderLists:function(){return this._40Q},renderScene:function(K){function O(l,W){V.setGLState(l,W),V.setUniforms(l),V.renderState.attribs.disable(),a=E.directUniforms(),d=E.directAttribs(),d.disable()}function t(R){for(;k>q;q++){var b=y[q];if(!Y||!b.ignoreInPick){if(b.priority>=R)break;(!M._43Q[M._44Q=b.id]||Fl[lq.length])&&(b.render(e,M,V),O())}}}var M=this;M._pushFrameRenderOptions(K),M._getFrameRenderOptions("createShadowMap")!==!1&&M.shadowMap.render(),M.flowMap.render();var e=M.getGL();M._envmapRenderer.onBeforeRender(e),M._44Q=-1;var a,d,V=M._frameState,E=V.renderState,W=E.glState,T=M._prg;M._projectMatrix=Cr(M),Ar(M,M._7O),M._viewMatrix=yj(M._7O),M.isReflecting(e)||Vb(M._projScreenMatrix=dq(),M._projectMatrix,M._viewMatrix),V.syncEnv(this._picking?this.pickColorMap:_),E.useProgram(T),O(!1,!0),e.clear(e.DEPTH_BUFFER_BIT);var Y=M._picking,y=this._41Q,q=0,k=y.length;if(t(z.cameraPriority.skybox),Y){var m=W.color.clear.slice(0);Il(e,[0,0,0,0])}else Il(e,[0,0,0,0]),W.blend.enabled=!1,W.depth.enabled=!1,W.depth.mask=!1,M._camera&&M._camera.s("camera.renderSky")===!1||M.drawSky(e,T),M._getFrameRenderOptions("renderReflector")!==!1&&M.drawReflectors(e)&&(M._projectMatrix=Cr(M),Ar(M,M._7O),M._viewMatrix=yj(M._7O),V.syncEnv(),O()),W.blend.enabled=!1,W.depth.enabled=!0,W.depth.mask=!0,a.uTransparent=!1,M._getFrameRenderOptions("renderGrid")!==!1&&M._31O._42(e,T);if(!e.textureBatch||Fl[(ONE_FRAME_TIME-6)/2]){Y||(M.shadowMap.enable&&M.shadowMap.createShadow(a),M.flowMap.createFlow(a));for(var C=0,h=ej.length;h>C;C++){var c=ej[C],B=Xb[c];if(!(!M._camera&&B.ignore||M._camera&&!M._camera.isLayerVisible(c))){var x=B.priority;t(x),this.renderLayer(c)}}t(z.cameraPriority.infinity),Y||M.flowMap.disableFlow(a),dk(M,a,0,z.graph3dViewHeadlightAmbientIntensity),a.uHeadlightColor=[1,1,1,0],a.uUseEnvMap=!1,W.depth.enabled=!1,a.uTransparent=!1,a.shadowReceive=!1,vo(M,a,Ak),Y?M.drawFilter||M._30O._42(e,T):(M._highlightHelper._42(e,T),this._renderAxisAndEditHelper(M._getFrameRenderOptions("renderAxis")!==!1,M._getFrameRenderOptions("renderEdit")!==!1),W.blend.enabled=!1,W.depth.mask=!0),W.depth.enabled=!0,Y&&Il(e,m),Wh(e,I),di(e,I),M._44Q=-1,M._popFrameRenderOptions(null)}},_renderAxisAndEditHelper:function(O,t){if(O||t){var G=this,f=G.getGL(),T=G._prg,C=G._frameState,V=C.renderState,W=V.glState,J=V.directUniforms();C.renderState.attribs.disable(),W.depth.enabled=!1,J.uTransparent=!1,J.shadowReceive=!1,W.blend.enabled=!1,W.depth.mask=!0,J.uPick=G._picking,O&&G._32O._42(f,T),t&&G._30O._42(f,T),Wh(f,I),di(f,I)}},renderLayers:function(d,p){p&&(d=Yq(d));for(var G=0,m=d.length;m>G;G++)this.renderLayer(d[G])},renderSky:function(){var p=this,m=p._frameState,u=m.renderState,r=u.glState,B=p.getGL(),Q=p._prg;p._projectMatrix=Cr(p),Ar(p,p._7O),p._viewMatrix=yj(p._7O),Vb(p._projScreenMatrix=dq(),p._projectMatrix,p._viewMatrix),m.syncEnv(),u.useProgram(Q),m.setGLState(!1,!0),m.setUniforms(!1),m.renderState.attribs.disable(),B.clear(B.DEPTH_BUFFER_BIT),Il(B,[0,0,0,0]),r.blend.enabled=!1,r.depth.enabled=!1,r.depth.mask=!1,p.drawSky(B,Q),r.depth.mask=!0,r.depth.enabled=!0,Wh(B,I),di(B,I)},addRenderLayerListener:function(z,g,f){var T=this;T._renderLayerNotifier||(T._renderLayerNotifier=new jc),T._renderLayerNotifier.add(z,g,f)},removeRenderLayerListener:function(P,x){this._renderLayerNotifier&&this._renderLayerNotifier.remove(P,x)},fireRenderLayerEvent:function(K,a){var k=this._renderLayerNotifier;k&&k.fire({layer:K,phase:a})},renderLayer:function(E){var p=this,Y=p._picking,T=p._40Q.get(E);if(T){p.fireRenderLayerEvent(E,"prepare");var F=p.getGL(),l=Xb[E],j=p._frameState,h=j.renderState,I=h.glState,O=h.directUniforms();!Y&&p.isSortable()&&T.sort(p._sortFunc,p._projScreenMatrix);var W,s,r,P=T.opaque,c=T.transparent,_=T.batchModelMap,A=T.polylineModelMap,v=T.wireframeModelMap,F=p.getGL(),f=p._prg;Y||(I.blend.enabled=!1,I.depth.enabled=!0,I.depth.mask=!0),O.uTransparent=!1,l.clearDepth!==!1&&F.clear(F.DEPTH_BUFFER_BIT);var d=this.drawFilter;if(d)for(r=P,W=0,s=r.length;s>W;W++)d(r[W].data)!==!0&&r[W].ui._42(F,f,o);else{for(r=P,W=0,s=r.length;s>W;W++)r[W].ui._42(F,f,o);if(Y)for(r=c,W=0,s=r.length;s>W;W++)r[W].ui._46Q(F);Wf(p,_),qq(p,A),qq(p,v)}if(Y||(I.blend.enabled=!0,I.depth.mask=!1),p._45Q=O.uTransparent=!0,d)for(r=c,W=0,s=r.length;s>W;W++)d(r[W].data)!==!0&&r[W].ui._42(F,f,x);else{for(r=c,W=0,s=r.length;s>W;W++)r[W].ui._42(F,f,x);Wf(p,_,null,!0),qq(p,A,null,!0),qq(p,v,null,!0)}p._45Q=null,p.fireRenderLayerEvent(E,"post")}},_42:function(c,w){var h=this;if(!h._35O&&(!So||Fl(So))){var B=h.getWidth(),q=h.getHeight();if(B&&q){var F=h.getGL();if(F){var S,O=h._canvas;if(c?S=!0:c=h.getDevicePixelRatio(),!h._picking&&(S||B!==O.clientWidth||q!==O.clientHeight)){Pq(O,B,q,c);var N=c;B&&Math.abs(F.drawingBufferWidth-B*c)>1&&(N=Math.min(N,F.drawingBufferWidth/B)),q&&Math.abs(F.drawingBufferHeight-q*c)>1&&(N=Math.min(N,F.drawingBufferHeight/q)),N!==c&&(h.setDevicePixelRatio(c=N),Pq(O,B,q,c)),h._18Q=null}F.clear(F.COLOR_BUFFER_BIT);var R=F._renderInfo;R.calls=0,R.vertices=0,R.faces=0,R.lines=0,R.points=0,R.textureCache={time:0,count:0,pixels:0},R.frame=++h._frameId,R.cacheTimeCost=0,R.reflectDepth=0,B*=c,q*=c,this.syncRenderState();do{if(h.isVREnabled()&&h.vr.render(F,B,q,w))break;if(h.updateScene(),h._postProcessing.render(F,B,q,w))break;h.setViewport(F,0,0,B,q),h.renderScene(w)}while(!1);h._33Q=!1,h.countFrame(),h._doBufferGC(F)}}}},syncRenderState:function(){var M,r;(M=this._frameState)&&(r=M.renderState)&&r.syncLoss()},drawReflectors:function(b){b._renderInfo.reflectDepth++;var q,S,Y,M=this,W=M._dataModel.getReflectors(),C=!1;for(q in W)S=W[q],M.isVisible(S)&&(Y=M.getData3dUI(S),Y&&Y.drawReflector(b)&&(C=!0));return b._renderInfo.reflectDepth--,C},isReflecting:function(_){return _._renderInfo.reflectDepth},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(Z,x){return this._postProcessing.enableModule(Z,x)},getPostProcessingModule:function(w){return this._postProcessing.getModule(w)},getPostProcessingValue:function(I,q){var Z=this._postProcessing.getModule(I);return Z?Z[q]:_},setPostProcessingValue:function(S,v,d){var o=this.getPostProcessingValue(S,v),l=this._postProcessing.getModule(S);l&&o!==d&&("enable"===v?this.enablePostProcessing(S,d):l[v]=d,this.firePropertyChange("postProcessing."+S+"."+v,o,d))},setDofImageFromGraphView:function(Y,J,w){return this._postProcessing.getModule("Dof").setImageFromGraphView(Y,J,w)},setViewport:function(Y,R,i,v,b){this._viewport=[R,i,v,b],qb.for(Y).directState().viewport=this._viewport},getRenderState:function(){return qb.for(this._26I)},getViewport:function(){return this._viewport},setBufferGCInterval:function(K){this._bufferGCInterval=K},_doBufferGC:function(H,o){var D,c,b=H._bufPool,A=0,B=0,u=H._renderInfo.frame,n=this._bufferGCInterval||10;for(D in b)A++,c=b[D],c&&(o||u-c._fid>n?(H.deleteBuffer(c._buf),c._buf=null,b[D]=null):B++);if(A/2>B&&A>128){var N={};for(D in b)b[D]&&(N[D]=b[D]);H._bufPool=N}H._validBufCount=B},_swapLineMap:function(){var E=this;pd=E._polylineModelMap,E._polylineModelMap=E._polylineModelMapSwap,E._polylineModelMapSwap=pd,pd=E._wireframeModelMap,E._wireframeModelMap=E._wireframeModelMapSwap,E._wireframeModelMapSwap=pd,pd=E._polylineIndexMap,E._polylineIndexMap=E._polylineIndexMapSwap,E._polylineIndexMapSwap=pd,pd=E._wireframeIndexMap,E._wireframeIndexMap=E._wireframeIndexMapSwap,E._wireframeIndexMapSwap=pd
},_updateSkybox:function(D){if(this._skybox&&D){var p=D.property,e=!1,R=this._skybox;if("eye"===p||"forceUpdate"===p){var L=this._eye;R.p3(L[0],L[1],L[2]),e=!0}if("near"===p||"far"===p||"forceUpdate"===p||"asceptChanged"===p){var F=R.__cachedS3__;F||(F=R.__cachedS3__=R.getFinalScale3d());var Y=Math.sqrt(3),r=1/0,H=-1/0;F.forEach(function(e){e/=2,r=a(e,r),H=i(e,H)}),H*=Y;var s=this._near,O=this._far,B=Math.tan(this.getFovy()/2)*s,M=this.getAspect()*B,b=1.1*Math.sqrt(M*M+B*B+s*s),Q=1;if(b>r)Q=b/r;else if(H>=O){var g=O*O/(s+O);Q=g/H}if(1!==Q){R.__updatingSkybox__=!0;var U=F.map(function(x){return Q*x});R.s3(U),R.setScale3d(1,1,1),e=!0,delete R.__updatingSkybox__}}e&&this.invalidateData(R)}},getSkyBox:function(){return this.getSkybox()},setSkyBox:function(E){return this.setSkybox(E)},getSkybox:function(){return this._skybox},setSkybox:function(r){var I=this._skybox;if(I===r)return r&&this._updateSkybox({property:"forceUpdate"}),void 0;if(I&&(this._skyboxStyleMap&&I.setStyleMap(this._skyboxStyleMap),this._skyboxStyleMap=null,this._skyboxAnchor3d&&I.setAnchor3d(this._skyboxAnchor3d),this._skyboxAnchor3d=null,this._skyboxP3&&I.p3(this._skyboxP3),this._skyboxP3=null,this.handleDataModelChange({kind:Oe,data:I})),this._skybox=r,this.ump(this._updateSkybox,this),r){r.dm()&&r.dm().remove(r),this._skyboxStyleMap=A.Default.clone(r.getStyleMap()),this._skyboxAnchor3d=r.getAnchor3d(),r.setAnchor3d(.5,.5,.5),this._skyboxP3=r.p3().slice(0),r.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1});var L=r.onPropertyChanged;r.onPropertyChanged=function(p){L.call(r,p),!r.__updatingSkybox__&&["width","height","tall","scale","scaleTall"].indexOf(p.property)>=0&&(r.__cachedS3__=_)},this.mp(this._updateSkybox,this),this._updateSkybox({property:"forceUpdate"})}this.fp("skybox",I,r)},drawSky:function(H,S){var O=this,U=O._skybox;if(U){var x=qb.for(H).directUniforms(),z=O._headlightIntensity,y=Tj(O._headlightColor),S=O._prg;1!==z&&(y=[y[0]*z,y[1]*z,y[2]*z]),x.uHeadlightColor=[y[0],y[1],y[2],1];var o=O.getData3dUI(U);if(o){var l=O.isOrtho(),j=l||this._computedProjectMatrix;if(j){var Z=O._projectMatrix;l&&(O._ortho=!1),x.uPMatrix=O._projectMatrix=Cr(O,!0)}var p=U.p3(),E=this.getEye();(p[0]!==E[0]||p[1]!==E[1]||p[2]!==E[2])&&(U._position.x=E[0],U._54O=E[1],U._position.y=E[2]),o.validate(),o._42(H,S,u),j&&(l&&(O._ortho=!0),x.uPMatrix=O._projectMatrix=Z)}H.clear(H.DEPTH_BUFFER_BIT),x.uHeadlightColor=[y[0],y[1],y[2],O._headlightDisabled?1:0]}},getLogicalPoint:function(Y){return Qe(Y,this._canvas)},isRectOverlapping:function(E){var i=this.getData3dUI(E);return i._rectOverlapping},getHitFaceInfo:function(j){j.target&&(j=this.lp(j));var v=this.getDataInfoAt(j);if(v){var G=this.intersectObject(j,v.data);if(G)return{data:v.data,face:G.part}}return I},unproject:function(O,G){var L=this,a=L.getWidth(),U=L.getHeight(),Z=O.target?L.lp(O):O,j=Z.x-a/2,P=Z.y-U/2,E=2*(j/a),c=2*(-1*P/U);G=G||0;var K=dq(),n=Cr(L),e=Ar(L);Vb(K,n,e),Sq(K);var I=Fb([E,c,G,1],K);return[I[0]/I[3],I[1]/I[3],I[2]/I[3]]},getDataAt:function(g){var v=this.getDataInfoAt(g);return v?v.data:I},getDataInfoAt:function(R,D,U){return R.target&&(R=this.lp(R)),this._1o.get(rd(R.x,R.y,D),!0,U)},getDatasInRect:function(U,V){return this._1o.get(U,!1,V)},setEditable:function(C){var L=this,e=L._editable;L._editable=C,this.fp(ug,e,C)},isEditable:function(V){var P=this;return V?P._editable?Fg(V)?V.s("3d.editable")?P._editableFunc?P._editableFunc(V):!0:!1:!1:!1:P._editable},isSelectable:function(k){return k.s("3d.selectable")&&this.sm().isSelectable(k)},isMovable:function(Y){var G=this;return Rn(Y)&&Y.getStyle(hs)!==Wq?!1:Y.s("3d.movable")?G._movableFunc?G._movableFunc(Y):!0:!1},isSizeEditable:function(I){return Fg(I)?this._sizeEditableFunc?this._sizeEditableFunc(I):!0:!1},isRotationEditable:function(P){return Fg(P)&&P.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(P):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(M){this.setZoom(cr,M)},zoomOut:function(I){this.setZoom(1/cr,I)},setZoom:function(){var Y=new ti,W=new ti,L=new ti,h=new ti;return function(l,m){if(1!==l){var $=this;$._14o&&$._14o.stop(!0);var O,y=1/l;Y.copy($.getCenter()),W.copy($.getEye());var q=$._ortho;if(q){if(O=$._orthoWidth,O<$._moveStep&&l>1)return}else if(Y.distanceTo(W)<$._moveStep&&1>y)return;var u=!1;return $._zoomToCenter===!1&&$._lastZoomLP&&(L.copy(W).sub(Y).normalize(),$._81O=null,h.copy($.getHitPosition($._lastZoomLP,Y.toArray(),L.toArray())),u=!0,$._lastZoomHit=h),(m=Zq(m))?(m.action=function(f){$.fi({kind:$._zooming?"betweenZoom":"beginZoom"}),$._zooming=1;var n=(y-1)*f+1;q&&$.setOrthoWidth(O*n),u?($.setEye(L.lerpVectors(h,W,n).toArray()),$.setCenter(L.lerpVectors(h,Y,n).toArray())):q||$.setEye(L.lerpVectors(Y,W,n).toArray())},m._37o=function(){delete $._14o,delete $._zooming,$.fi({kind:"endZoom"}),$.onZoomEnded()},$._14o=un(m)):(q&&$.setOrthoWidth(O*y),u?($.setEye(L.lerpVectors(h,W,y).toArray()),$.setCenter(L.lerpVectors(h,Y,y).toArray())):q||$.setEye(L.lerpVectors(Y,W,y).toArray()),void 0)}}}(),setOrthoZoom:function(B,y){return this.setZoom(B,y)},getPositionInfo:function(V){var e=this,v=e._eye,I=e._center,$=e.getAspect(),c=V?Id(_d(I,v,!0),_d(V,v)):Hd(v,I);if(e._ortho){var F=e._orthoWidth;return{length:c,height:F/$,width:F}}var G=2*Bl(e._fovy/2)*c;return{length:c,height:G,width:G*$}},getCenterInfo:function(){var g=this;return g._81O||(g._81O=g.getPositionInfo()),Tl(g._81O)},rotate:function(i,Y,u,t){var V=this;if(i||Y){t==I&&(t=V._firstPersonMode),V._88O&&V._88O.stop(!0);var x=V._center,W=V._eye,p=V.getCenterInfo().length,n=t?x:W,M=t?W:x,G=_d(n,M),g=id(G[0],G[2]),k=id(w(G[0]*G[0]+G[2]*G[2]),G[1]),K=t?Cj:Mj;return t&&(Y=-Y),(u=Zq(u))?(u.action=function(F){V.fi({kind:V._rotating?"betweenRotate":"beginRotate"}),V._rotating=1;var J=g+i*F,T=k+Y*F;T=t?h-mf(V,h-T):mf(V,T),G[0]=p*d(T)*d(J),G[1]=p*l(T),G[2]=p*d(T)*l(J),n[0]=M[0]+G[0],n[1]=M[1]+G[1],n[2]=M[2]+G[2],V.fp(K,I,n)},u._37o=function(){delete V._88O,delete V._rotating,V.fi({kind:"endRotate"}),V.onRotateEnded()},V._88O=un(u)):(g+=i,k+=Y,k=t?h-mf(V,h-k):mf(V,k),G[0]=p*d(k)*d(g),G[1]=p*l(k),G[2]=p*d(k)*l(g),n[0]=M[0]+G[0],n[1]=M[1]+G[1],n[2]=M[2]+G[2],V.fp(K,I,n),void 0)}},pan:function(K,T,B,$){if(K||T){var j=this;$==I&&($=j._firstPersonMode),j._89O&&j._89O.stop(!0);var S=Ar(j),C=[S[0]*K,S[4]*K,S[8]*K],p=[S[1]*T,S[5]*T,S[9]*T],_=C[0]+p[0],o=C[1]+p[1],e=C[2]+p[2],l=j._center,d=j._eye;if($){var c=Nk(j.getBoundaries(),d[0],d[2],d[0]+_,d[2]+e,w(_*_+e*e));_=c[0],e=c[1]}if(B=Zq(B)){var a=Tl(d),X=Tl(l);return B.action=function(q){j.fi({kind:j._panning?"betweenPan":"beginPan"}),j._panning=1,l[0]=X[0]+_*q,l[1]=X[1]+o*q,l[2]=X[2]+e*q,d[0]=a[0]+_*q,d[1]=a[1]+o*q,d[2]=a[2]+e*q,j.fp(Mj,I,d),j.fp(Cj,I,l)},B._37o=function(){delete j._89O,delete j._panning,j.fi({kind:"endPan"}),j.onPanEnded()},j._89O=un(B)}l[0]+=_,l[1]+=o,l[2]+=e,d[0]+=_,d[1]+=o,d[2]+=e,j.fp(Mj,I,d),j.fp(Cj,I,l)}},walk:function(z,c,W){if(z){var D=this;W==I&&(W=D._firstPersonMode),D._90O&&D._90O.stop(!0);var r=D._center,A=D._eye,k=_d(r,A,!0);if(W){var N=Nk(D.getBoundaries(),A[0],A[2],A[0]+k[0]*z,A[2]+k[2]*z,f(z));if(z=Hd(N),!z)return;k=[N[0]/z,0,N[1]/z]}if(c=Zq(c)){var H=Tl(A),i=Tl(r);return c.action=function(p){D.fi({kind:D._walking?"betweenWalk":"beginWalk"}),D._walking=1;var Z=z*p;A[0]=H[0]+k[0]*Z,A[1]=H[1]+k[1]*Z,A[2]=H[2]+k[2]*Z,r[0]=i[0]+k[0]*Z,r[1]=i[1]+k[1]*Z,r[2]=i[2]+k[2]*Z,D.fp(Mj,I,A),D.fp(Cj,I,r)},c._37o=function(){delete D._90O,delete D._walking,D.fi({kind:"endWalk"}),D.onWalkEnded()},D._90O=un(c)}A[0]+=k[0]*z,A[1]+=k[1]*z,A[2]+=k[2]*z,r[0]+=k[0]*z,r[1]+=k[1]*z,r[2]+=k[2]*z,D.fp(Mj,I,A),D.fp(Cj,I,r)}},handleScroll:function(d,D){um(d);var B=this,Y=B._moveStep,Q=B.getDataInfoAt(d);if(Q){var g=Q.data;if(g&&B.isInteractive(g)){var x=B.intersectObject(d,g);if(x){var b=x.part,j=Gj(g.s(b+".image")||g.s("shape3d."+b+".image")||g.s("all.image")||g.s("shape3d.image"));if(j&&ui(j.scrollable,g,B))return}}}return B.isFirstPersonMode()?(B.isPannable()&&B.pan(0,D>0?Y:-Y),void 0):(B.isZoomable()&&(B._lastZoomLP=B.lp(d),B.setZoom(0>D?1/jl:jl),B._lastZoomLP=B._lastZoomHit=null),void 0)},handlePinch:function(l,P){if(this.isZoomable()){if(Math.abs(l-P)<z.pinchZoomThreshold)return;this.setZoom(P>l?1/Tc:Tc)}},reset:function(U){this.setUp(z.graph3dViewUp),this.moveCamera(z.graph3dViewEye,z.graph3dViewCenter,U)},moveSelection:function(v,M,Q){var q=this;q.dm().beginTransaction(),ed(this.sm().toSelection(this.isMovable,this),v,M,Q),q.dm().endTransaction()},getMoveMode:function(x,T){var $=T.s("3d.move.mode");if($)return $;var e="88",m="89",l="90";return Io(x)||Yk[e]&&Yk[m]&&Yk[l]?"xyz":Yk[e]&&Yk[m]?"xy":Yk[e]&&Yk[l]?"xz":Yk[m]&&Yk[l]?"yz":Yk[e]?"x":Yk[m]?"y":Yk[l]?"z":"xz"},handleTick:function(){var T=this,N=!1,b=T._moveStep,F=b,w=!1,Z=!0,H=T._rotateStep*(Z?-1:1);if(T.isWalkable()||(F=0),T.isPannable()||(b=0),T.isRotatable()||(H=0),T._32Q){var V=(Jd()-T._32Q)/50;F*=V,b*=V,H*=V}T._31Q&&(ei(T._31Q),delete T._31Q,delete T._32Q),pb()&&(N=!0,T.pan(-b,0,w,Z)),mi()&&(N=!0,T.pan(b,0,w,Z)),_n()&&(N=!0,Io()?T.pan(0,b,w,Z):T.walk(F,w,Z)),mb()&&(N=!0,Io()?T.pan(0,-b,w,Z):T.walk(-F,w,Z)),li()&&(N=!0,T.rotate(-H,0,w,Z)),ar()&&(N=!0,T.rotate(H,0,w,Z)),mq()&&(N=!0,T.rotate(0,-H/2,w,Z)),si()&&(N=!0,T.rotate(0,H/2,w,Z)),N&&(T._32Q=Jd(),T._31Q=Km(T.handleTick,T))},handleKeyDown:function(R){var i=this;!Ro(R)&&on[R.keyCode]?i.handleTick():Kf(R)?i.selectAll():yq(R)?i.handleDelete(R):Ui(R)&&this.isResettable()&&i.reset()},checkDoubleClickOnNote:function(g,B,j){var e=this;if(j===Zf){if(B.s("note.toggleable"))return B.s(Vk,!B.s(Vk)),e.fi({kind:"toggleNote",event:g,data:B,part:j}),!0}else if(j===gi&&B.s("note2.toggleable"))return B.s(Ph,!B.s(Ph)),e.fi({kind:"toggleNote2",event:g,data:B,part:j}),!0;return!1},checkDoubleClickOnRotation:function(j,m,Z){return Z===Ss?(m.setRotationX(0),!0):Z===Ts?(m.setRotationY(0),!0):Z===Us?(m.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(O){var K=this;if(K.isOrtho())return K.getWidth()/K.getOrthoWidth();var R=K.getCenter(),f=K.getHeight(),u=K.getEye(),P=[R[0]-u[0],R[1]-u[1],R[2]-u[2]],S=[O[0]-u[0],O[1]-u[1],O[2]-u[2]],y=Math.sqrt(P[0]*P[0]+P[1]*P[1]+P[2]*P[2]),M=1/Math.tan(K.getFovy()/2);return f*y*M/(S[0]*P[0]+S[1]*P[1]+S[2]*P[2])},inViewSpace:function(i){var e,D=this,y=D._transformPointToViewSpace(i),P=D.getAspect(),g=D.getNear(),m=D.getFar();return-y[2]<g||-y[2]>m?!1:D.isOrtho()?(e=D.getOrthoWidth()/2,Math.abs(y[0])<=e&&Math.abs(y[1]*P)<=e):(e=Math.sqrt(y[0]*y[0]+y[1]*y[1]+y[2]*y[2])*Math.tan(D.getFovy()/2),Math.abs(y[1]<=e)&&Math.abs(y[0])<=e*P)},getPVMatrix:function(){var i,b=this;return(i=b._18Q)||(i=Cr(b),b._18Q=Vb(i,i,Ar(b)),b._18Q._wh=b.getWidth()/2/b.getHeight()),i},getFrustum:function(){var s=new gq,u=new $i,V=new Array(16);return function(){for(var L=this.getPVMatrix(),T=!1,G=0;16>G;G++)L[G]!==V[G]&&(T=!0,V[G]=L[G]);return T&&u.setFromMatrix(s.fromArray(L)),u}}(),toViewPosition:function(A){var T=this,F=T.getWidth()/2,O=T.getHeight()/2,g=T.getPVMatrix();return A=Fb([A[0],A[1],A[2],1],g),{x:F+F*A[0]/A[3],y:O-O*A[1]/A[3],z:A[2]/A[3]}},getHitPosition:function(i,g,h){var U=this,E=U.getWidth(),V=U.getHeight(),d=i.target?U.lp(i):i,p=d.x-E/2,s=d.y-V/2,N=U.getCenterInfo(),e=Ar(U);g=g?g:[0,0,0],h=h?h:[0,1,0],p=p/E*N.width,s=-1*s/V*N.height;var T=[e[0]*p,e[4]*p,e[8]*p],Z=[e[1]*s,e[5]*s,e[9]*s],y=[T[0]+Z[0],T[1]+Z[1],T[2]+Z[2]],F=U.getCenter(),Q=Kq(U,g,h,[y[0]+F[0],y[1]+F[1],y[2]+F[2]]);return Q?Q:[0,0,0]},intersectObject:function(_,l){return this._raycaster.intersectObject(_,l)},intersectObjects:function(T,k,i){return this._raycaster.intersectObjects(T,k,i)},getLineLength:function(x){this.validate();var P=this.getData3dUI(x);if(P&&P.getCache){var Z=P.getCache();if(Z)return Z[Z.length-1].length}return 0},getLineOffset:function(j,B){var M=this.getData3dUI(j);if(M&&M.getCache){var G=M.getCache();if(G){var N=Th(G,B);if(!j.r3)return N;var m=j.r3();if(0===m[0]&&0===m[1]&&0===m[2])return N;var x=new ti(j.p3()),b=new ti(N.point).sub(x),s=new ti(N.tangent).add(b),T=(new Uk).setFromEuler(new bd(m,j.getRotationMode(),!0));return b.applyQuaternion(T),s.applyQuaternion(T),{point:b.add(x),tangent:s.sub(b).normalize()}}}return I},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(r,x,a){var d=this,n=d.getEye();n=[n[0],n[1],n[2]];var G=d.getCenter();if(G=[G[0],G[1],G[2]],r||(r=n),x||(x=G),d._flyAnim&&d._flyAnim.stop(!0),a=Zq(a),!a)return d.setEye(r[0],r[1],r[2]),d.setCenter(x[0],x[1],x[2]),delete d._flyAnim,!0;var D=[r[0]-n[0],r[1]-n[1],r[2]-n[2]],Q=[x[0]-G[0],x[1]-G[1],x[2]-G[2]];return a.action=function(w){d.setCenter(G[0]+Q[0]*w,G[1]+Q[1]*w,G[2]+Q[2]*w),d.setEye(n[0]+D[0]*w,n[1]+D[1]*w,n[2]+D[2]*w)},a._37o=function(){delete d._flyAnim},d._flyAnim=un(a)},flyTo:function(){function i(D,p,$){if($ instanceof A.Node){B.fromArray(Gq($,p.getMat($)));var E=$.getAnchor3d();D.push((new ti).set(0-E.x,0-E.y,0-E.z).applyMatrix4(B)),D.push((new ti).set(0-E.x,0-E.y,1-E.z).applyMatrix4(B)),D.push((new ti).set(0-E.x,1-E.y,0-E.z).applyMatrix4(B)),D.push((new ti).set(0-E.x,1-E.y,1-E.z).applyMatrix4(B)),D.push((new ti).set(1-E.x,0-E.y,0-E.z).applyMatrix4(B)),D.push((new ti).set(1-E.x,0-E.y,1-E.z).applyMatrix4(B)),D.push((new ti).set(1-E.x,1-E.y,0-E.z).applyMatrix4(B)),D.push((new ti).set(1-E.x,1-E.y,1-E.z).applyMatrix4(B))}}var f=new ti,K=new ti,d=new ti,g=new ti,I=new ti,B=new gq,N=new A.Math.Quaternion,M=new bd,W=new Sb;return function(w,G,e){var p=this;"boolean"==typeof G&&(G={animation:G}),G=G||{};var v=G.center,x=G.distance,h=G.direction,C=G.worldDirection,$=e||G.ratio||.8,a=G.xRatio||$,y=G.yRatio||$;(e!==_||G.duration||G.frames)&&(G={animation:G});var t,n,U=[],Z=x===_;if(v&&d.fromArray(v),!v||Z)if(w||(w=p.dm().getDatas()),1===w.length&&(w=vq(w)?w.get(0):w[0]),w instanceof A.Node)v||d.fromArray(w.p3()),Z&&(i(U,p,w),t=U.length);else{if(!w.length)return;if((Z||!v)&&(U=[],w.forEach(function(C){i(U,p,C)}),t=U.length,!t))return;v||(W.setFromPoints(U),d.copy(W.min).add(W.max).multiplyScalar(.5))}if(p._flyAnim&&p._flyAnim.stop(!0),f.fromArray(p.getEye()),K.fromArray(p.getCenter()),p.setCenter(d.x,d.y,d.z),g.subVectors(f,K),h||C){!C&&w instanceof A.Node?N.setFromEuler(M.set(w.r3(),w.getRotationMode(),!0)):N.set(0,0,0,1);var R=g.length();g.fromArray(C||h).applyQuaternion(N).setLength(R)}var c=new ti(p.getUp()),u=ym.fequal(c.x,0,1e-5)&&ym.fequal(c.z,0,1e-5);if(u&&0===g.x&&0===g.z){var O=.001,D=g.y;g.y=D*(1-O),g.z=Math.sign(D)*O}var T=0;if(Z){var J,m,P,r=a,q=y;if(I.copy(g),p.isOrtho()){var Y=-1/0;for(p._eye[0]=g.x+d.x,p._eye[1]=g.y+d.y,p._eye[2]=g.z+d.z,J=Cr(p),Vb(J,J,Ar(p)),n=0;t>n;n++)P=U[n],m=Fb([P.x,P.y,P.z,1],J),Y=Math.max(Y,Math.max(Math.abs(m[0])/r,Math.abs(m[1])/q));T=p.getOrthoWidth()*Y}else{for(var k,E,s=p.getNear(),S=10;S--;){for(p._eye[0]=g.x+d.x,p._eye[1]=g.y+d.y,p._eye[2]=g.z+d.z,J=Cr(p),Vb(J,J,Ar(p)),k=!0,E=-1/0,n=0;t>n;n++){if(P=U[n],m=Fb([P.x,P.y,P.z,1],J),m[3]<s&&S){g.multiplyScalar(2),k=!1;break}E=Math.max(E,Math.max(Math.abs(m[0])/r,Math.abs(m[1])/q)-m[3])}if(k)break}g.setLength(E+g.length())}g.manhattanLength()<1e-6&&g.copy(I)}else g.setLength(x);var F=g.add(d),X=Zq(G.animation);if(X){p.setEye(f.x,f.y,f.z),p.setCenter(K.x,K.y,K.z);var H=F.clone().sub(d),l=H.length();l&&H.multiplyScalar(1/l);var L=f.clone().sub(K),B=L.length();B&&L.multiplyScalar(1/B);var b=(new gq).lookAtDirection(L,c),Q=(new gq).lookAtDirection(H,c),V=(new Uk).setFromRotationMatrix(b),o=(new Uk).setFromRotationMatrix(Q),j=(new ti).subVectors(d,K);if(T)var ms=p.getOrthoWidth();var kr=new ti,ne=new ti,lh=new ti,Hq=X.action,Op=X._37o,Af=K.clone();return X.action=function(N,x){ne.copy(Af).addScaledVector(j,N);var c=V.clone().slerp(o,N);kr.set(0,0,1).applyQuaternion(c).setLength(B+(l-B)*N).add(ne),lh.set(0,1,0).applyQuaternion(c),p.setCenter(ne.x,ne.y,ne.z),p.setEye(kr.x,kr.y,kr.z),p.setUp(lh.x,lh.y,lh.z),T&&p.setOrthoWidth((T-ms)*N+ms),Hq&&Hq(N,x)},X._37o=function(){delete p._flyAnim;var J=p.getUp(),g=u?z.graph3dViewUp:c.toArray();(J[0]!==g[0]||J[1]!==g[1]||J[2]!==g[2])&&p.setUp(g),Op&&Op()},{lastEye:f,lastCenter:K,eye:F,center:d,orthoWidth:T,animation:p._flyAnim=un(X)}}return p.setEye(F.x,F.y,F.z),p.setCenter(d.x,d.y,d.z),T&&p.setOrthoWidth(T),delete p._flyAnim,{lastEye:f,lastCenter:K,eye:F,center:d,orthoWidth:T}}}(),getBoundingBox:function(){function S(b,A,G){D.fromArray(Gq(G,A.getMat(G)));var x=G.getAnchor3d();b.push((new ti).set(0-x.x,0-x.y,0-x.z).applyMatrix4(D)),b.push((new ti).set(0-x.x,0-x.y,1-x.z).applyMatrix4(D)),b.push((new ti).set(0-x.x,1-x.y,0-x.z).applyMatrix4(D)),b.push((new ti).set(0-x.x,1-x.y,1-x.z).applyMatrix4(D)),b.push((new ti).set(1-x.x,0-x.y,0-x.z).applyMatrix4(D)),b.push((new ti).set(1-x.x,0-x.y,1-x.z).applyMatrix4(D)),b.push((new ti).set(1-x.x,1-x.y,0-x.z).applyMatrix4(D)),b.push((new ti).set(1-x.x,1-x.y,1-x.z).applyMatrix4(D))}var D=new gq;return function(o){if(o=o||this.sm().getSelection(),o instanceof A.Node&&(o=[o]),0===o.length)return I;var q=[];o.forEach(function($){Fg($)&&S(q,this,$)},this);var r=[1/0,1/0,1/0],d=[-1/0,-1/0,-1/0];return q.forEach(function(j){r[0]=Math.min(j.x,r[0]),r[1]=Math.min(j.y,r[1]),r[2]=Math.min(j.z,r[2]),d[0]=Math.max(j.x,d[0]),d[1]=Math.max(j.y,d[1]),d[2]=Math.max(j.z,d[2])}),{min:r,max:d}}}(),setBatchInfo:function(f,G){var n=this._batchInfoMap[f];this._batchInfoMap[f]=G,this.fp("batchInfo",n,G)},getBatchInfo:function(c){return this._batchInfoMap[c]||Ll[c]},setOrthoWidth:function(n){var z=this._orthoWidth;if(this._orthoWidth=n,this._syncEyeWithOrthoWidth){var B=n/this.getAspect(),y=B/2/Bl(this.getFovy()/2),l=(new ti).fromArray(this.getEye()),G=(new ti).fromArray(this.getCenter());l.sub(G).setLength(y).add(G),this.setEye(l.toArray())}this.fp("orthoWidth",z,n)},getCamera:function(P){var G=this;P||(P=G._mainCamera,P||(P=G._mainCamera=new A.Camera)),P.s({"camera.type":G.isOrtho()?"ortho":"perspective","camera.aspect":G.getAspect(),"camera.fovy":G.getFovy(),"camera.ortho.width":G.getOrthoWidth(),"camera.near":G.getNear(),"camera.far":G.getFar()});var V=G.getEye();return P.p3(V.slice()),P.lookAt(G.getCenter(),G.getUp()),P},resetHeadlightProperties:function(){this._headlightColor=z.graph3dViewHeadlightColor,this._headlightIntensity=z.graph3dViewHeadlightIntensity,this._headlightRange=z.graph3dViewHeadlightRange,this._headlightGroup=z.graph3dViewHeadlightGroup,this._headlightAmbientIntensity=z.graph3dViewHeadlightAmbientIntensity,this._headlightDisabled=z.graph3dViewHeadlightDisabled},resetFogProperties:function(){this._fogDisabled=z.graph3dViewFogDisabled,this._fogMode=z.graph3dViewFogMode,this._fogDensity=z.graph3dViewFogDensity,this._fogColor=z.graph3dViewFogColor,this._fogNear=z.graph3dViewFogNear,this._fogFar=z.graph3dViewFogFar}}),function(){function K(p,a,t){var S=p[a];S&&S.releaseTexture(),p[a]=t}function X(){return["\n #ifdef ENVMAP_TYPE_CUBE_UV \n","#define cubeUV_maxMipLevel 8.0 \n","#define cubeUV_minMipLevel 4.0 \n","#define cubeUV_maxTileSize 256.0 \n","#define cubeUV_minTileSize 16.0 \n","float getFace(vec3 direction) {","vec3 absDirection = abs(direction);","float face = - 1.0;","if (absDirection.x > absDirection.z) {","if (absDirection.x > absDirection.y)","face = direction.x > 0.0 ? 0.0 : 3.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","} else {","if (absDirection.z > absDirection.y) ","face = direction.z > 0.0 ? 2.0 : 5.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","}","return face;","} ","vec2 getUV(vec3 direction, float face) {","vec2 uv;","if (face == 0.0) {","uv = vec2(direction.z, direction.y) / abs(direction.x);","} else if (face == 1.0) {","uv = vec2(- direction.x, - direction.z) / abs(direction.y);","} else if (face == 2.0) {","uv = vec2(- direction.x, direction.y) / abs(direction.z);","} else if (face == 3.0) {","uv = vec2(- direction.z, direction.y) / abs(direction.x);","} else if (face == 4.0) {","uv = vec2(- direction.x, direction.z) / abs(direction.y);","} else {","uv = vec2(direction.x, direction.y) / abs(direction.z);","}","return 0.5 * (uv + 1.0);","} ","vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {","float face = getFace(direction);","float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);","mipInt = max(mipInt, cubeUV_minMipLevel);","float faceSize = exp2(mipInt);","float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);","vec2 uv = getUV(direction, face) * (faceSize - 1.0);","vec2 f = fract(uv);","uv += 0.5 - f;","if (face > 2.0) {","uv.y += faceSize;","face -= 3.0;","}","uv.x += face * faceSize;","if (mipInt < cubeUV_maxMipLevel) {","uv.y += 2.0 * cubeUV_maxTileSize;","}","uv.y += filterInt * 2.0 * cubeUV_minTileSize;","uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);","uv *= texelSize;","vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x += texelSize;","vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.y += texelSize;","vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x -= texelSize;","vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","vec3 tm = mix(tl, tr, f.x);","vec3 bm = mix(bl, br, f.x);","return mix(tm, bm, f.y);","}","\n #define r0 1.0 \n","#define v0 0.339 \n","#define m0 - 2.0 \n","#define r1 0.8 \n","#define v1 0.276 \n","#define m1 - 1.0 \n","#define r4 0.4 \n","#define v4 0.046 \n","#define m4 2.0 \n","#define r5 0.305 \n","#define v5 0.016 \n","#define m5 3.0 \n","#define r6 0.21 \n","#define v6 0.0038 \n","#define m6 4.0 \n","float roughnessToMip(float roughness) {","float mip = 0.0;","if (roughness >= r1) {","mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;","} else if (roughness >= r4) {","mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;","} else if (roughness >= r5) {","mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;","} else if (roughness >= r6) {","mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;","} else {","mip = - 2.0 * log2(1.16 * roughness);","}","return mip;","} ","vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {","float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);","float mipF = fract(mip);","float mipInt = floor(mip);","vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);","if (mipF == 0.0) {","return vec4(color0, 1.0);","} else {","vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);","return vec4(mix(color0, color1, mipF), 1.0);","}","} ","\n #endif \n"].join("")}function E(){return["vec4 sRGBToLinear( in vec4 value ) {","return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );","}","vec4 LinearTosRGB( in vec4 value ) {","return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );","}","vec4 inputTexelToLinear( vec4 value ) { return sRGBToLinear( value ); }","vec4 linearToOutputTexel( vec4 value ) { return LinearTosRGB( value ); }","vec4 envMapTexelToLinear( vec4 color ) { return inputTexelToLinear( color ); }"].join("")}function U(){return["precision mediump float;\n","precision mediump int;\n","attribute vec3 position;","attribute vec2 uv;","attribute float faceIndex;","varying vec3 vOutputDirection;","vec3 getDirection( vec2 uv, float face ) {","uv = 2.0 * uv - 1.0;","vec3 direction = vec3( uv, 1.0 );","if ( face == 0.0 ) { direction = direction.zyx; } ","else if ( face == 1.0 ) { direction = direction.xzy; direction.xz *= -1.0; } ","else if ( face == 2.0 ) { direction.x *= -1.0; }","else if ( face == 3.0 ) { direction = direction.zyx; direction.xz *= -1.0; } ","else if ( face == 4.0 ) { direction = direction.xzy; direction.xy *= -1.0; } ","else if ( face == 5.0 ) { direction.z *= -1.0; }","return direction;","}","void main() {","vOutputDirection = getDirection( uv, faceIndex );","gl_Position = vec4( position, 1.0 );","}"].join("")}function n(){return{vs:U(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform samplerCube envMap;\n",E(),"\n void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3(- vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function T(){return{vs:U(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform vec2 texelSize;\n",E(),"\n #define RECIPROCAL_PI 0.3183098861837907 \n","\n #define RECIPROCAL_PI2 0.15915494309189535 \n","vec2 equirectUv( in vec3 dir ) {","float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;","float v = 0.5 - asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI;","return vec2( u, v );","}","void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","vec3 outputDirection = normalize( vOutputDirection );","vec2 uv = equirectUv( outputDirection );","vec2 f = fract( uv / texelSize - 0.5 );","uv -= f * texelSize;","vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x += texelSize.x;","vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.y += texelSize.y;","vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x -= texelSize.x;","vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","vec3 tm = mix( tl, tr, f.x );","vec3 bm = mix( bl, br, f.x );","gl_FragColor.rgb = mix( tm, bm, f.y );","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function d(u){return{vs:U(),fs:["precision mediump float;\n","precision mediump int;\n","#define n "+u+"\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform int samples;","uniform float weights[ n ];","uniform bool latitudinal;","uniform float dTheta;","uniform float mipInt;","uniform vec3 poleAxis; \n",E(),"\n #define ENVMAP_TYPE_CUBE_UV \n",X(),"\n vec3 getSample( float theta, vec3 axis ) {","float cosTheta = cos( theta );","vec3 sampleDirection = vOutputDirection * cosTheta + cross(axis, vOutputDirection) * sin(theta) + axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);","return bilinearCubeUV( envMap, sampleDirection, mipInt );","}","void main() {","vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );","if ( all( equal( axis, vec3( 0.0 ) ) ) ) {","axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );","}","axis = normalize( axis );","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );","for ( int i = 1; i < n; i++ ) {","if ( i >= samples ) { break; }","float theta = dTheta * float( i );","gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );","gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );","}","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}var V=Ac.EnvmapRenderer=function(w){this.gv=w,this._envmaps={},this._envmapHash={},this._probeCaptureTime={},this._pingPongRenderTarget=null,this._equirectShader=null,this._cubemapShader=null,this._blurMaterial=null,this._lastCaptureFrame=0};V.prototype={},V.prototype.constructor=V,V.prototype.changeEnvmapType=function(V){"legacy"===V?(this.setEnvmapByProbeId=this.setEnvmapLegacy,this.onBeforeRender=this.onBeforeRenderLegacy):(this.setEnvmapByProbeId=this.setEnvmap,this.onBeforeRender=this.onBeforeRenderNew)},V.prototype.invalidateEnvmap=function(P){var E=this.gv;if("legacy"!==E.getEnvmapType()){var Y=E.getGL();Y&&(P?(delete this._envmapHash[P],delete this._probeCaptureTime[P]):(this._envmapHash={},this._probeCaptureTime={}),E.iv())}},V.prototype.onBeforeRenderLegacy=function(V){this.assureTextureLegacy(V)},V.prototype.assureTextureLegacy=function(i){var V=this,B=V.gv,j=B.getEnvmap();if(j!==V._lastLegacyImage){if(V._envmapLegacy&&(i.deleteTexture(V._envmapLegacy),V._envmapLegacy=null),!j)return V._lastLegacyImage=j,void 0;var y=z.getImage(j);if(y&&y.tagName){y=z.resizeImagePOT(y,!0);var S=V._envmapLegacy=i.createTexture();i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_CUBE_MAP,S),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,y),i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,y),i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,y),i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,y),i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,y),i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,y),i.bindTexture(i.TEXTURE_CUBE_MAP,i._emptyCubeTexture),V._lastLegacyImage=j}}},V.prototype.setEnvmapLegacy=function(M){M.uEnvMap=this._envmapLegacy},V.prototype.onBeforeRenderNew=function(I){this.assureTextureNew(I),this.resetUniformCache()},V.prototype.assureTextureNew=function(r){var g=this,j=g.gv,h=j.getEnvmap(),f=g._envmapHash,i=g._envmaps,Z=r._renderInfo.frame;if(!(this._lastCaptureFrame>=Z||j._picking))for(var m in h){var O,M=h[m],e=M.type;switch(e){case"sphere":O=M.image,O!==f[m]&&(Zo=z.getImage(O),Zo&&(f[m]=O,K(i,m,g.fromEquirectangular(O))));break;case"cube":var y=M.images;if(y&&6===y.length&&(O=y.join(","),O!==f[m])){for(var u=!0,n=0;6>n;n++)if(!z.getImage(y[n])){u=!1;break}u&&(f[m]=O,K(i,m,g.fromCubemap(y)))}break;case"skybox":var F=j.getSkybox();if(F){var W=F.s("shape3d");if(O="sphere"===W?F._id+"_"+F.s("shape3d.image"):F._id+"_"+F.s("front.image"),O!==f[m]){var u;if("sphere"===W)u=z.getImage(F.s("shape3d.image"));else{u=!0;for(var D=["front","back","left","right","top","bottom"],n=0;6>n;n++)if(!z.getImage(F.s(D[n]+".image"))){u=!1;break}}u&&(f[m]=O,K(i,m,g.fromSkybox()))}}break;case"probe":var $=M.pos,E=M.size;if(O=$[0]+"_"+$[1]+"_"+$[2]+"_"+E,O!==f[m]){var H=this._probeCaptureTime[O],q=Date.now();H||(this._probeCaptureTime[O]=H=q),q-H>z.envmapProbeMinWaitTime&&!Vp&&!Gr||q-H>z.envmapProbeMaxWaitTime?(delete this._probeCaptureTime[O],f[m]=O,K(i,m,g.fromSceneProbe($,E,M.filter))):j.iv()}}}},V.prototype.resetUniformCache=function(){this._frameUniformCache={}},V.prototype.setEnvmap=function(V,l){var S=V.uuid,T=this._frameUniformCache,e=this._envmaps[l];e&&(e=e.texture),T[S]!==e&&(T[S]=e,V.uEnvMap=e)},V.prototype.fromEquirectangular=function(G){var l=A.Default.getImage(G);return this.rectSize=[1/l.width,1/l.height],G=this.gv.getTexture(G),this.fromTexture(G)},V.prototype.fromCubemap=function(i){var o=this.gv.getGL(),N=o.createTexture();o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_CUBE_MAP,N),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MIN_FILTER,o.LINEAR);for(var O=[],V=S/3,T=0;6>T;T++)O[T]=z.resizeImage(A.Default.getImage(i[T]),V);return o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,O[0]),o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,O[1]),o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,O[2]),o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,O[3]),o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,O[4]),o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,O[5]),o.bindTexture(o.TEXTURE_CUBE_MAP,o._emptyCubeTexture),this.fromTexture(N,!0)},V.prototype.fromTexture=function(w,O){var Y=this._allocateTargets();this._pingPongRenderTarget||(this._pingPongRenderTarget=this._allocateTargets());var n=this.gv,S=n.getGL(),d=qb.for(S).directState(),W=d.depth.enabled;d.scissor.enabled=!0,d.depth.enabled=!1;var q=n.getViewport(S);return this._textureToCubeUV(w,Y,O),this._applyPMREM(Y),Y.unbind(S),n.setViewport(S,q[0],q[1],q[2],q[3]),d.depth.enabled=W,d.scissor.enabled=!1,Y
},V.prototype.fromSkybox=function(){return this._fromCamera(function(A){A.s({"camera.onlySky":!0})})},V.prototype.fromScene=function(u){return this._fromCamera(function(E){E.s({"camera.onlySky":!1}),u&&u(E)})},V.prototype.fromNode=function(I){var E=this.gv.getData3dUI(I),j=E._42;E._42=jb;var s=this.gv.getSkybox(),C=I.p3();if(s){var P=s.p3();s.p3(C)}var F=this.fromScene(function(Y){Y.p3(C)});return E._42=j,s&&s.p3(P),F},V.prototype.fromSceneProbe=function(z,C,j){var M=this.gv,m=M.getSkybox();if(m){var U=m.p3();m.p3(z)}if(j){var I=M.isVisible;M.isVisible=function(R){var J=j(R);return J!==_?J:I.call(M,R)}}var F=this.fromScene(function(g){g.p3(z),g.s("camera.near",C)});return j&&(M.isVisible=I),m&&m.p3(U),F},V.prototype._fromCamera=function(d){var q=this.gv,X=q.getCamera();d&&d(X);var A=new vd(q,S,S,{cube:!0}),r=q.getGL(),N=q.getViewport(r),c=this.setEnvmapByProbeId,v=this.onBeforeRender;this.setEnvmapByProbeId=function(V){V.envMap=r._emptyTexture},this.onBeforeRender=jb,X.attachRenderTarget(A),X.render(q),X.detachRenderTarget(),this.setEnvmapByProbeId=c,this.onBeforeRender=v,q.setViewport(r,N[0],N[1],N[2],N[3]);var x=this.fromTexture(A.texture,!0);return A.releaseTexture(),x},V.prototype._allocateTargets=function(){return new vd(this.gv,3*Z,3*Z,{magFilter:Bd.NEAREST,minFilter:Bd.NEAREST})},V.prototype._textureToCubeUV=function(Y,J,k){var d,F=this.gv;k?null==(d=this._cubemapShader)&&(this._cubemapShader=d=this.createShader(n())):null==(d=this._equirectShader)&&(this._equirectShader=d=this.createShader(T()));var G=F.getGL();J.bind(G),this._setViewport(J,0,0,3*Z,2*Z);var X=F.getRenderState();X.useProgram(d);var B=X.directUniforms(),y=X.directAttribs();B.envMap=Y,k||(B.texelSize=this.rectSize);var j=p[0];y.position=Pp(G,null,j.vs,I,3),y.uv=Pp(G,null,j.uv,I,2),y.faceIndex=Pp(G,null,j.faceIs,I,1),bj(G,0,j.vs.length/3)},V.prototype._applyPMREM=function(w){for(var D,k,y,D=1;e>D;D++)k=Math.sqrt(x[D]*x[D]-x[D-1]*x[D-1]),y=b[(D-1)%b.length],this._blur(w,D-1,D,k,y)},V.prototype._setViewport=function(Y,M,G,E,q){var t=this.gv;t.setViewport(t.getGL(),M,G,E,q),t.getRenderState().directState().scissor.box=[M,G,E,q]},V.prototype._blur=function(x,s,_,D,S){var $=this._pingPongRenderTarget;this._halfBlur(x,$,s,_,D,"latitudinal",S),this._halfBlur($,x,_,_,D,"longitudinal",S)},V.prototype.createShader=function(Q){var b=this.gv;return b.getPostProcessing().createShader(b.getGL(),Q).program},V.prototype._halfBlur=function(r,S,$,j,U,f,h){var c=this.gv,a=this._blurMaterial;if("latitudinal"===f||"longitudinal"===f){a||(this._blurMaterial=a=this.createShader(d(M)));var D=c.getGL();S.bind(D);var R=3,y=c.getRenderState();y.useProgram(a);var b,e,A,P=y.directUniforms(),s=y.directAttribs(),W=Y[$]-1,X=isFinite(U)?Math.PI/(2*W):2*Math.PI/(2*M-1),H=U/X,L=isFinite(U)?1+Math.floor(R*H):M,T=[],g=0;for(b=0;M>b;++b)e=b/H,A=Math.exp(-e*e/2),T.push(A),0==b?g+=A:L>b&&(g+=2*A);for(b=0;b<T.length;b++)T[b]=T[b]/g;P.envMap=r.texture,P.samples=L,P.weights=T,P.latitudinal="latitudinal"===f,h&&(P.poleAxis=h),P.dTheta=X,P.mipInt=N-$;var z=Y[j],e=3*Math.max(0,Z-2*z),K=(0===j?0:2*Z)+2*z*(j>N-F?j-N+F:0);this._setViewport(S,e,K,3*z,2*z);var Q=p[j];s.position=Pp(D,null,Q.vs,I,3),s.uv=Pp(D,null,Q.uv,I,2),s.faceIndex=Pp(D,null,Q.faceIs,I,1),bj(D,0,Q.vs.length/3),S.unbind(D)}};var F=4,N=8,Z=Math.pow(2,N),m=[.125,.215,.35,.446,.526,.582],e=N-F+1+m.length,M=20,Q=(1+Math.sqrt(5))/2,q=1/Q,b=[new ti(1,1,1),new ti(-1,1,1),new ti(1,1,-1),new ti(-1,1,-1),new ti(0,Q,q),new ti(0,Q,-q),new ti(q,0,Q),new ti(-q,0,Q),new ti(Q,q,0),new ti(-Q,q,0)],O=function(){for(var b=[],J=[],L=[],d=N,t=0;e>t;t++){var _=Math.pow(2,d);J.push(_);var M=1/_;t>N-F?M=m[t-N+F-1]:0==t&&(M=0),L.push(M);for(var Q=1/(_-1),X=-Q/2,v=1+Q/2,U=6,O=[],i=[],x=[],H=0;U>H;H++){var S=2*(H%3)/3-1,a=H>2?0:-1;O.push(S,a,0,S+2/3,a,0,S+2/3,a+1,0,S,a,0,S+2/3,a+1,0,S,a+1,0),i.push(X,X,v,X,v,v,X,X,v,v,X,v),x.push(H,H,H,H,H,H)}b.push({vs:new _p(O),uv:new _p(i),faceIs:new _p(x)}),d>F&&d--}return{_lodPlanes:b,_sizeLods:J,_sigmas:L}}(),p=O._lodPlanes,Y=O._sizeLods,x=O._sigmas,S=z.EnvmapTextureSize}();var Gh=["left","front","right","back","top","bottom"],Dl=Ac._RenderList=function(){function o(){d.length=0,h.length=0,T={}}function G(t){var Y,x,m,U,b=t.gv,f=t.data,s=t.shapeModel;if(s){var D,S,u,Q=f.s("shape3d.transparent")||f.s("points.transparent");for(gc(s)||(D=ui(s.transparent,f,b),s=[s]),m=0,U=s.length;U>m;m++)u=s[m],S=ui(u.transparent,f,b),S===_&&(S=D),S===_&&(S=Q),S?x=!0:Y=!0}for(m=0,U=Gh.length;U>m;m++){var I=t[Gh[m]];I&&(I.transparent?x=!0:Y=!0)}b.isLabelVisible(f)&&(t.labelInfo&&(f.s(rc+".transparent")?x=!0:Y=!0),t.label2Info&&(f.s(vb+".transparent")?x=!0:Y=!0)),b.isNoteVisible(f)&&(t.noteInfo&&(f.s(Zf+".transparent")?x=!0:Y=!0),t.note2Info&&(f.s(gi+".transparent")?x=!0:Y=!0)),t._38o&&(x=Y=!0),x||(Y=!0),t._renderParams={opaque:Y,transparent:x}}function C(S,F){F&&G(S);var A=S.data,U=A._id;if(!T[U]){T[U]=!0;var s=S._renderParams;s&&s.visible!==!1&&(S={ui:S,data:A,z:0,id:U},s.opaque&&d.push(S),s.transparent&&h.push(S))}}function L(b,P){if(h.length>1){for(var M,R,S=[0,0,0,0],r=0,c=h.length;c>r;r++)M=h[r].data,(R=M._position)?(S[0]=R.x,S[1]=M._54O,S[2]=R.y,S[3]=1,Fb(S,P),h[r].z=S[2]/S[3]):h[r].z=0;h.sort(b||q)}}function V(y){y?(nd(O,Q,y),nd(x,u,y),nd(n,R,y)):(O=this.batchModelMap={},Q=this.batchIndexMap={},x=this.polylineModelMap={},u=this.polylineIndexMap={},n=this.wireframeModelMap={},R=this.wireframeIndexMap={}),this.markBatchInvalid()}function v(B){B?nd(O,Q,B):(O=this.batchModelMap={},Q=this.batchIndexMap={}),this.markBatchInvalid()}function K(V){V?nd(x,u,V):(x=this.polylineModelMap={},u=this.polylineIndexMap={}),this.markBatchInvalid()}function $(M){M?nd(n,R,M):(n=this.wireframeModelMap={},R=this.wireframeIndexMap={}),this.markBatchInvalid()}function y(){return this._batchInvalid}function t(){this._batchInvalid=!0}function e(){this._batchInvalid=null}var d=[],h=[],O={},Q={},x={},u={},n={},R={},T={};return{opaque:d,transparent:h,init:o,push:C,batchModelMap:O,batchIndexMap:Q,polylineModelMap:x,polylineIndexMap:u,wireframeModelMap:n,wireframeIndexMap:R,ivBatch:V,ivModelBatch:v,ivPolylineBatch:K,ivWireframeBatch:$,markBatchInvalid:t,isBatchInvalid:y,onUpdated:e,sort:L}},Mh=Ac._RenderLists=function(){function N(){for(var i in A)A[i].init()}function V(){for(var e in A)A[e].onUpdated()}function o(j,Z){j=j||"main";var S=A[j];return!S&&Z&&(S=A[j]=new Dl),S}function D(S,G){var B=S.data.getRenderLayer(),g=o(B,!0);g.push(S,G)}function J(h){for(var k in A)h(A[k])}var A={};return{init:N,onUpdated:V,get:o,push:D,each:J,lists:A}},vd=Ac.RenderTarget=function(G,q,J,e){var N,U=this;null!=q&&q.canvas?(N=q,q=J,J=e,e=arguments[4]):N=G.getGL(),e=e||{},e.cube===!!e.cube,e.samples=e.cube?0:Math.min(G._glCapabilities.maxSamples,e.samples&&e.samples>1&&2===G._webGLVersion?e.samples:0),U.options=e,U.uuid=A.Math.generateUUID(),U.gv=G,U.init(G,N,e),U.format=e.format||Bd.RGBA,U.generateMipmaps=!!e.generateMipmaps,e.samples&&!G._glCapabilities._maxSamplesChecked?U.setSize(N,q||1,J||1):U.setSize(N,q,J)};j.assign(Ac.RenderTarget.prototype,{bind:function(g,c){var L=this.options;if(L.autoSize){var X=this.gv,T=X.getDevicePixelRatio(),q=X.getWidth()*T,U=X.getHeight()*T;this.setSize(g,q,U)}L.cube?he(g,this.frame[c]):he(g,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(y){Ur(y),this.options.samples&&(y.bindFramebuffer(y.READ_FRAMEBUFFER,this._MSAAFbo),y.bindFramebuffer(y.DRAW_FRAMEBUFFER,this.frame),y.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,y.COLOR_BUFFER_BIT,y.NEAREST),y.bindFramebuffer(y.READ_FRAMEBUFFER,null),y.bindFramebuffer(y.DRAW_FRAMEBUFFER,null))},isCube:function(){return this.options.cube},init:function(w,i,t){var C=this,k=t.samples,c=t.cube,I=C.texture=i.createTexture(),n=c?Bd.TEXTURE_CUBE_MAP:Bd.TEXTURE_2D;i.activeTexture(i.TEXTURE0),i.bindTexture(n,I),i.texParameteri(n,i.TEXTURE_WRAP_S,t.wrapS||i.CLAMP_TO_EDGE),i.texParameteri(n,i.TEXTURE_WRAP_T,t.wrapT||i.CLAMP_TO_EDGE);var E=k?i.NEAREST:i.LINEAR;if(i.texParameteri(n,i.TEXTURE_MIN_FILTER,t.minFilter||E),i.texParameteri(n,i.TEXTURE_MAG_FILTER,t.magFilter||E),i.bindTexture(n,null),c){C.depth=[],C.frame=[];for(var o=0;6>o;o++)C.depth[o]=i.createRenderbuffer(),C.frame[o]=i.createFramebuffer()}else C.depth=i.createRenderbuffer(),C.frame=i.createFramebuffer();C.assureTexture()},assureTexture:function(){var z=this;z.gv._2Oi(z.uuid,z.texture,"default")},releaseTexture:function(){this.gv.deleteTexture(this.uuid)},setSize:function(Q,b,g){var M=this;if(b=Math.round(b),g=Math.round(g),b&&g&&(M.width!==b||M.height!==g)){M.width=b,M.height=g;var J=Q.RENDERBUFFER,u=Q.FRAMEBUFFER,K=M.options.samples,s=M.options.cube,r=s?Bd.TEXTURE_CUBE_MAP:Bd.TEXTURE_2D;if(K){var $=M.gv._glCapabilities;if(!$._maxSamplesChecked){for(Q.bindRenderbuffer(J,M.depth),Q.getError();K>1&&(Q.renderbufferStorageMultisample(J,K,Q.DEPTH_COMPONENT16,b,g),Q.getError());)K=Math.floor(K>>1);1>=K&&(K=0,Q.texParameteri(r,Q.TEXTURE_MIN_FILTER,M.options.minFilter||Q.LINEAR),Q.texParameteri(r,Q.TEXTURE_MAG_FILTER,M.options.magFilter||Q.LINEAR),Q.renderbufferStorage(J,Q.DEPTH_COMPONENT16,b,g)),$._maxSamplesChecked=!0,$.maxSamples=M.options.samples=K,Q.bindRenderbuffer(J,I)}}if(K&&(M._MSAAFbo||(M._MSAAFbo=Q.createFramebuffer(),M._MSAARbO=Q.createRenderbuffer()),Q.bindRenderbuffer(J,M._MSAARbO),Q.renderbufferStorageMultisample(Q.RENDERBUFFER,K,Q.RGBA8,b,g),Q.bindFramebuffer(u,M._MSAAFbo),Q.framebufferRenderbuffer(u,Q.COLOR_ATTACHMENT0,J,M._MSAARbO),Q.framebufferRenderbuffer(u,Q.DEPTH_ATTACHMENT,J,M.depth),Q.bindFramebuffer(u,null),Q.bindRenderbuffer(J,null)),Q.activeTexture(Q.TEXTURE0),Q.bindTexture(r,M.texture),s)for(var w=Q.TEXTURE_CUBE_MAP_POSITIVE_X,U=0;6>U;U++)M.setupFrameBufferTextureAndDepth(Q,M.frame[U],M.depth[U],w+U);else M.setupFrameBufferTextureAndDepth(Q,M.frame,M.depth,Q.TEXTURE_2D);if(M.generateMipmaps&&(2===gv._webGLVersion||ym.isPOT(b)&&ym.isPOT(g))){Q.generateMipmap(r);var t=M.options.minFilter||(K?Q.NEAREST:Q.LINEAR);Q.texParameteri(r,Q.TEXTURE_MIN_FILTER,t===Q.NEAREST?Q.NEAREST_MIPMAP_NEAREST:Q.LINEAR_MIPMAP_LINEAR)}Q.bindTexture(r,null)}},setupFrameBufferTextureAndDepth:function(e,j,M,V){var N=this,l=N.format;e.texImage2D(V,0,l,this.width,this.height,0,l,e.UNSIGNED_BYTE,null),e.bindFramebuffer(e.FRAMEBUFFER,j),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,V,N.texture,0),this.setupRenderBufferStorage(e,M),e.bindFramebuffer(e.FRAMEBUFFER,null)},setupRenderBufferStorage:function(c,_){var f=this,C=c.RENDERBUFFER;c.bindRenderbuffer(C,_);var s=f.options.samples;s?c.renderbufferStorageMultisample(C,s,c.DEPTH_COMPONENT16,f.width,f.height):(c.renderbufferStorage(C,c.DEPTH_COMPONENT16,f.width,f.height),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,C,_)),c.bindRenderbuffer(c.RENDERBUFFER,null)},toCanvas:function(){var j=this,H=j.gv.getGL();he(H,j.frame);var e=j.width,k=j.height,J=new Uint8Array(4*e*k);H.readPixels(0,0,e,k,j.format,H.UNSIGNED_BYTE,J),Ur(H);var W=K.createElement("canvas");W.width=e,W.height=k;var _=W.getContext("2d"),Y=_.createImageData(e,k);return Y.data.set(J),_.putImageData(Y,0,0),W}});var Ds=Ac.Interactor=function(d){this.gv=this.g3d=d};ci("Interactor",j,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()},fi:function(Y){this.gv.fi(Y)},startDragging:function(e){Fd(this,e)}});var Es=Ac.DefaultInteractor=function(W){nk(Es,this,[W])};ci("DefaultInteractor",Ds,{getState:function(){return this._62O},setState:function(V){this._62O=V},getDataInfoAt:function(k,g){var s=this.gv,l=s.getDataInfoAt(k);if(!s.isBlockSelectable()||!l||!l.data)return l;if(!g&&s.isSelected(l.data))return l;for(var J=l.data;(J=J.getParent())&&J instanceof A.Block&&s.isSelectable(J);){var D=s.isSelected(J);if(D&&g)break;if(l={data:J,part:l.part},D&&!g)break}return l},handle_contextmenu:function(i){um(i)},handle_mousewheel:function(v){this.gv.handleScroll(v,v.wheelDelta/40)},handle_DOMMouseScroll:function($){2===$.axis&&this.gv.handleScroll($,-$.detail)},handle_keydown:function(O){this.gv.handleKeyDown(O)},handle_mousedown:function(e){this.handle_touchstart(e)},handle_touchstart:function(D){um(D);var A=this,t=A.gv,r=Uo(D),u=A.getDataInfoAt(D),o=u?u.data:I,v=u?u.part:I,n=t.sm(),X=jf(D),F=hq(D);t.setFocus(D)&&(A._62O=I,A._57I=I,A.pendingClickThrough=I,A.__lastClientPoint__=Xe(D),o?Ro(D)?n.co(o)?n.rs(o):n.as(o):n.co(o)?o instanceof dp&&o.isClickThroughEnabled()&&Uo(D)&&(A.pendingClickThrough=Xe(D)):n.ss(o):r&&(Ro(D)?t.isRectSelectable()&&(A._62O=Ab):A._57I=Xe(D)),A._31Q&&(ei(A._31Q),delete A._31Q,delete A._32Q),A._62O||(t.isFirstPersonMode()&&(Io(D)||fh(D)||F>2?A._62O="pan":t.isMouseRoamable()||Pm(D)?(A._62O="roaming",A.foward=X&&Uo(D),A._32Q=Jd(),A._31Q=Km(A.tick,A)):r||(A._62O="roaming")),A._62O||(r&&X&&Ys[v]?(A._62O=v,A.p3=o.p3()):r&&X&&Fg(o)&&t.isSelected(o)?t.isMovable(o)?(A._62O="move",A.p3=o.p3(),A.movedata=o):t._39Q(o)&&(A._62O="none"):Pm(D)&&(F>2?A._62O="pan":2===F&&(A.dist=xn(D),A._62O="pinch")))),A.point=t.lp(D),Fd(A,D),we(D)?t.handleDoubleClick(D,o,v):t.handleClick(D,o,v))},tick:function(){var v=this,a=v.gv,u=a._moveStep;v.point&&a.isWalkable()&&(v._32Q&&(u*=(Jd()-v._32Q)/50),a.walk(v.foward?u:-u),v._32Q=Jd(),v._31Q=Km(v.tick,v))},handle_mouseup:function(D){this.handle_touchend(D)},handle_touchend:function(H){var S=this._57I;if(S&&(Hd(S,Xe(H))<=1&&this.gv.sm().cs(),this._57I=I),S=this.pendingClickThrough){if(Hd(S,Xe(H))<=1){var P=this.getDataInfoAt(H);P&&P.data instanceof dp&&P.data.isClickThroughEnabled()&&(P=this.getDataInfoAt(H,!0),P&&(H.clickThrough=!0,this.gv.sm().ss(P.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(N){this.handleWindowTouchMove(N)},handleWindowTouchMove:function(e){var p,Z,V=this,T=V.gv,E=V._62O,i=V.point,O=T.dm(),F=T.lp(e),X=F.x-i.x,I=F.y-i.y,w=T.getWidth(),R=T.getHeight();if(w&&R){var m=Xe(e),C=Ii(T,m,V.__lastClientPoint__),M=Hd({x:0,y:0},C),c=-$*X/w,P=-$*I/R;if("roaming"===E)V.rotate(e,c/2,P/2);else if(E===Ss||E===Ts||E===Us)T._86O||O.beginTransaction(),T.fi({kind:T._86O?"betweenEditRotation":"beginEditRotation",event:e}),T._86O=1,T.sm().each(function(W){if(Fg(W)&&T.isRotationEditable(W)){var b=f(c)>f(P)?c:P;E===Ss?W.setRotationX(W.getRotationX()+b):E===Ts?W.setRotationY(W.getRotationY()+b):E===Us&&W.setRotationZ(W.getRotationZ()+b)}});else if("move"===E||Ys[E]){if(E===Vs||E===Ws||E===Xs)T._87O||O.beginTransaction(),T.fi({kind:T._87O?"betweenEditScale":"beginEditScale",event:e}),T._87O=1;else{if(!T._moving){if(M<z.touchMoveThreshold)return;O.beginTransaction()}T.fi({kind:T._moving?"betweenMove":"beginMove",event:e}),T._moving=1}var Y,K=V.p3,g=T.getPositionInfo(K),J=Ar(T);Y=E===Ps?"x":E===Qs?"y":E===Rs?"z":E===Vs?"sx":E===Ws?"sy":E===Xs?"sz":T.getMoveMode(e,V.movedata),X=X/w*g.width,I=-1*I/R*g.height;var h,t,y=[J[0]*X,J[4]*X,J[8]*X],A=[J[1]*I,J[5]*I,J[9]*I],d=y[0]+A[0],L=y[1]+A[1],n=y[2]+A[2],o=[K[0]+d,K[1]+L,K[2]+n],s=_d(T.getEye(),o,!0);if("xyz"===Y?(h=o,T.moveSelection(d,L,n)):"xz"===Y?(h=Kq(T,K,[0,1,0],o),h&&T.moveSelection(h[0]-K[0],0,h[2]-K[2])):"xy"===Y?(h=Kq(T,K,[0,0,1],o),h&&T.moveSelection(h[0]-K[0],h[1]-K[1],0)):"yz"===Y?(h=Kq(T,K,[1,0,0],o),h&&T.moveSelection(0,h[1]-K[1],h[2]-K[2])):"x"===Y||"sx"===Y?(s[0]=0,h=Kq(T,K,s,o),h&&(t=h[0]-K[0],"x"===Y?T.moveSelection(t,0,0):T.sm().each(function(q){Fg(q)&&T.isSizeEditable(q)&&(p=q.getScaleX()+t/100,Z=p/q.getScaleX(),q.setScaleX(p),Io(e)&&(q.setScaleY(q.getScaleY()*Z),q.setScaleTall(q.getScaleTall()*Z)))}))):"y"===Y||"sy"===Y?(s[1]=0,h=Kq(T,K,s,o),h&&(t=h[1]-K[1],"y"===Y?T.moveSelection(0,t,0):T.sm().each(function(I){Fg(I)&&T.isSizeEditable(I)&&(p=I.getScaleTall()+t/100,Z=p/I.getScaleTall(),I.setScaleTall(p),Io(e)&&(I.setScaleY(I.getScaleY()*Z),I.setScaleX(I.getScaleX()*Z)))}))):("z"===Y||"sz"===Y)&&(s[2]=0,h=Kq(T,K,s,o),h&&(t=h[2]-K[2],"z"===Y?T.moveSelection(0,0,t):T.sm().each(function(V){Fg(V)&&T.isSizeEditable(V)&&(p=V.getScaleY()+t/100,Z=p/V.getScaleY(),V.setScaleY(p),Io(e)&&(V.setScaleX(V.getScaleX()*Z),V.setScaleTall(V.getScaleTall()*Z)))}))),!h)return;V.p3=h}else if(E===Ab){var v=V.div;v||(v=V.div=_k(),Ik(V.getView(),v),v.op=i,v.style.background=T.getRectSelectBackground()),T.fi({kind:T._rectSelecting?"betweenRectSelect":"beginRectSelect",event:e}),T._rectSelecting=1,v.rect=Mc(v.op,F),zb(v,v.rect)}else if("pinch"===E&&2===hq(e)){T.fi({kind:T._pinching?"betweenPinch":"beginPinch",event:e}),T._pinching=1;var t=xn(e);T._lastZoomLP||(T._lastZoomLP=Gi(e)),T.handlePinch(t,V.dist),V.dist=t}else"pan"===E||Io(e)||fh(e)?V.pan(e,X,I):"none"===E||T.isFirstPersonMode()||V.rotate(e,c,P);V.point=F}},pan:function(J,L,k){var j=this.gv;if(j.isPannable()){var Z=j.getWidth(),X=j.getHeight();if(!Z||!X)return;var m=j.getCenterInfo(),c=L/Z*m.width,d=-1*k/X*m.height;j.fi({kind:j._panning?"betweenPan":"beginPan",event:J}),j._panning=1,j.pan(-c,-d)}},rotate:function(s,f,$){var Z=this.gv;Z.isRotatable()&&(Z.fi({kind:Z._rotating?"betweenRotate":"beginRotate",event:s}),Z._rotating=1,Z.rotate(f,$))},handleWindowMouseUp:function(G){this.handleWindowTouchEnd(G)},handleWindowTouchEnd:function(A){var T=this,K=T.gv,z=K.dm(),m=T.div;if(m){var n=K.getDatasInRect(m.rect);if(!n.isEmpty()){var x=K.sm(),l=x.toSelection(),O=Io(A),q=A.altKey;n.each(function(D){x.co(D)?(!O||O&&q)&&l.remove(D):(!q||O&&q)&&l.add(D)}),x.ss(l)}Hj(m)}K._moving&&(delete K._moving,K.fi({kind:"endMove",event:A}),K.onMoveEnded(),z.endTransaction()),K._panning&&(delete K._panning,K.fi({kind:"endPan",event:A}),K.onPanEnded()),K._rotating&&(delete K._rotating,K.fi({kind:"endRotate",event:A}),K.onRotateEnded()),K._86O&&(delete K._86O,K.fi({kind:"endEditRotation",event:A}),z.endTransaction()),K._87O&&(delete K._87O,K.fi({kind:"endEditScale",event:A}),z.endTransaction()),K._pinching&&(delete K._pinching,K.fi({kind:"endPinch",event:A}),K.onPinchEnded()),K._rectSelecting&&(delete K._rectSelecting,K.fi({kind:"endRectSelect",event:A}),K.onRectSelectEnded()),K._walking&&(delete K._walking,K.fi({kind:"endWalk",event:A}),K.onWalkEnded()),K._lastZoomLP=K._lastZoomHit=null,T.dist=T.point=T._62O=T.p3=T.movedata=T.div=T._57I=T.pendingClickThrough=T._32Q=T._31Q=T.foward=I,T.__lastClientPoint__=I}});var Fs=Ac.MapInteractor=function(m){nk(Fs,this,[m]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this._minPhi=0,this._maxPhi=5*Math.PI/12};ci("MapInteractor",Ds,{setUp:function(){Fs.superClass.setUp.call(this);var V=this.gv;this.__oldMinPhi__=V.getRotateMinPhi(),this.__oldMaxPhi__=V.getRotateMaxPhi(),V.setRotateMinPhi(this._minPhi),V.setRotateMaxPhi(this._maxPhi)},tearDown:function(){Fs.superClass.tearDown.call(this);var M=this.gv;M.setRotateMinPhi(this.__oldMinPhi__),M.setRotateMaxPhi(this.__oldMaxPhi__),delete this.__oldMinPhi__,delete this.__oldMaxPhi__},handle_contextmenu:function(M){um(M)},handle_mousewheel:function(B){this.gv.handleScroll(B,B.wheelDelta/40)},handle_DOMMouseScroll:function(t){2===t.axis&&this.gv.handleScroll(t,-t.detail)},handle_keydown:function(l){this.gv.handleKeyDown(l)},handle_mousedown:function(M){this.handle_touchstart(M)},handle_touchstart:function(l){um(l);var b=this,H=b.gv;if(H.setFocus(l)){var a=H.getDataInfoAt(l),B=a?a.data:I,C=a?a.part:I;b.__lastClientPoint__=Xe(l);var x=b.editing={point:H.lp(l),data:B,part:C};Pm(l)?x.touch=!0:(x.touch=!1,x.clickLeft=Uo(l),x.pan=fh(l)?!0:"left"===this.panButton===x.clickLeft),B&&H._39Q(B)&&(x.preventDefault=!0),Fd(b,l),we(l)?H.handleDoubleClick(l,B,C):H.handleClick(l,B,C)}},handle_mouseup:function(p){this.handle_touchend(p)},handle_touchend:function(){},handleWindowMouseMove:function(R){this.handleWindowTouchMove(R)},handleWindowTouchMove:function(X){var y=this,A=y.gv,M=y.editing;if(M){var k=A.lp(X),F=M.point,E=k.x-F.x,u=k.y-F.y;if(!M.moved){if(Math.abs(E)<y.threshold&&Math.abs(u)<y.threshold&&!(X.touches&&X.touches.length>1))return;M.moved=!0}if(!M.preventDefault){M.point=k;var c=M.part;if(Ys[c]){var D=M.data,a=A.dm(),T=A.getWidth(),V=A.getHeight(),J=-$*E/T,C=-$*u/V;if(c===Ss||c===Ts||c===Us){A._86O||a.beginTransaction(),A.fi({kind:A._86O?"betweenEditRotation":"beginEditRotation",event:X}),A._86O=1;var d=f(J)>f(C)?J:C;A.sm().each(function(n){Fg(n)&&A.isRotationEditable(n)&&(c===Ss?n.setRotationX(n.getRotationX()+d):c===Ts?n.setRotationY(n.getRotationY()+d):c===Us&&n.setRotationZ(n.getRotationZ()+d))})}else{var P=D.p3(),o=A.getPositionInfo(P);E=E/T*o.width,u=-1*u/V*o.height;var H,p=Ar(A),x=[p[0]*E,p[4]*E,p[8]*E],L=[p[1]*u,p[5]*u,p[9]*u],U=x[0]+L[0],g=x[1]+L[1],t=x[2]+L[2],R=[P[0]+U,P[1]+g,P[2]+t],q=_d(A.getEye(),R,!0);if(c===Vs||c===Ws||c===Xs){if(A._87O||a.beginTransaction(),A.fi({kind:A._87O?"betweenEditScale":"beginEditScale",event:X}),A._87O=1,H=Kq(A,P,q,R)){var j,O=0,B=["X","Y","Tall"];c===Vs?j="X":c===Ws?(j="Tall",O=1):c===Xs&&(j="Y",O=2),B.splice(B.indexOf(j),1);var K=Io(X),N=(H[O]-P[O])/100;A.sm().each(function(U){if(Fg(U)&&A.isSizeEditable(U)){var a=U["getScale"+j](),n=a+N;if(U["setScale"+j](n),K){var t=n/a;B.forEach(function(V){U["setScale"+V](U["getScale"+V]()*t)})}}})}}else if(c===Ps||c===Qs||c===Rs){if(!A._moving){var S=Xe(X),r=Ii(A,S,y.__lastClientPoint__),W=Hd({x:0,y:0},r);if(W<z.touchMoveThreshold)return;a.beginTransaction()}A.fi({kind:A._moving?"betweenMove":"beginMove",event:X}),A._moving=1;var O=0;if(c===Ps?O=0:c===Qs?O=1:c===Rs&&(O=2),q[O]=0,H=Kq(A,P,q,R)){var N=H[O]-P[O],e=[0,0,0];e[O]=N,A.moveSelection.apply(A,e)}}}}else if(M.touch){var l=X.touches.length;if(2!==l)y.pan(X,E,u);else{if(1>=l)return;var i=X.touches,m={x:i[0].clientX,y:i[0].clientY},G={x:i[1].clientX,y:i[1].clientY},Z={x:G.x-m.x,y:G.y-m.y},_=M.lastCenter,b=Math.atan2(Z.y,Z.x),Q=M.theta,w=0;Q==I?Q=M.theta=b:(w=b-Q,M.thetaStarted||Math.abs(w)>y.touchRotateThreshold?(M.thetaStarted=!0,M.theta=b):w=0);var s=h*(m.y+G.y)/2/A.getHeight(),n=M.phi,v=0;n==I?n=M.phi=s:(v=s-n,M.phiStarted||Math.abs(v)>y.touchRotateThreshold?(M.phiStarted=!0,M.phi=s):v=0);var Y,Xh=Math.sqrt(Z.x*Z.x+Z.y*Z.y),Bn=M.vlen;if(Bn){var wn=m.x-_.x,oj=m.y-_.y,Vj=G.x-_.x,sm=G.y-_.y,jn=Math.sqrt(wn*wn+oj*oj),fm=Math.sqrt(Vj*Vj+sm*sm),vq=Bn/2,kj=y._sign2(jn-vq),Eq=y._sign2(fm-vq);0>kj*Eq||0===kj&&0===Eq?(Y=1,M.vlen=Xh):(Y||(Y=Xh/Bn),M.scaleStarted||Math.abs(Y-1)>y.touchScaleThreshold?(M.vlen=Xh,M.scaleStarted=!0):Y=1)}else Bn=M.vlen=Xh,Y=1;1!==Y&&A.setZoom(Y),(v||w)&&y.rotate(X,w,-v),M.lastCenter={x:(G.x+m.x)/2,y:(G.y+m.y)/2}}}else if(M.pan)y.pan(X,E,u);else{var T=A.getWidth(),V=A.getHeight();if(!T||!V)return;var J=-$*E/T,C=-$*u/V;y.rotate(X,J,C)}}}},_sign2:function(q){return Math.abs(q)<this._touchScaleCheckAccuracy?0:q>0?1:-1},handleWindowMouseUp:function(b){this.handleWindowTouchEnd(b)},getDataInfoAt:function(U,I){var c=this.gv,m=c.getDataInfoAt(U);if(!c.isBlockSelectable()||!m||!m.data)return m;if(!I&&c.isSelected(m.data))return m;for(var F=m.data,B=m.part;(F=F.getParent())&&F instanceof A.Block&&c.isSelectable(F);){var J=c.isSelected(F);if(J&&I)break;if(m={data:F,part:B},J&&!I)break}return m},handleWindowTouchEnd:function(a){var N=this,Q=N.editing;if(N.editing=null,Q){var _=N.gv;if(Q.moved||!Q.clickLeft&&!Q.touch)_._panning=null,_._rotating=null,_.fi({kind:Q.pan?"endPan":"endRotate",event:a});else{var B=N.getDataInfoAt(a),k=B&&B.data;k instanceof dp&&k.isClickThroughEnabled()&&(B=N.getDataInfoAt(a,!0),B&&(k=B.data)),k?_.sm().setSelection([k]):_.sm().clearSelection()}var C=_.dm();_._moving&&(delete _._moving,_.fi({kind:"endMove",event:a}),_.onMoveEnded(),C.endTransaction()),_._86O&&(delete _._86O,_.fi({kind:"endEditRotation",event:a}),C.endTransaction()),_._87O&&(delete _._87O,_.fi({kind:"endEditScale",event:a}),C.endTransaction())}},pan:function(K,N,G){var f=this,E=f.gv;if(E.isPannable()){var J=E.getWidth(),O=E.getHeight();if(J&&O){var w=E.getCenterInfo(),M=-N/J*w.width,u=1*G/O*w.height;E.fi({kind:E._panning?"betweenPan":"beginPan",event:K}),E._panning=1;var F=f.keepHorizon,g=f.editing.touch;if((g&&K.touches&&K.touches.length>1||!g&&Io(K))&&(F=!F),!F)return E.pan(M,u);if(M||u){var H=Ar(E),r=[H[0]*M,H[4]*M,H[8]*M],n=[H[1],0,H[9]],C=Math.sqrt(n[0]*n[0]+n[2]*n[2]);C&&(n=[n[0]/C*u,0,n[2]/C*u]);var z=r[0]+n[0],S=r[1]+n[1],D=r[2]+n[2],y=E._center,b=E._eye;y[0]+=z,y[1]+=S,y[2]+=D,b[0]+=z,b[1]+=S,b[2]+=D,E.fp(Mj,I,b),E.fp(Cj,I,y)}}}},rotate:function(i,W,J){var v=this,p=v.gv;if(p.isRotatable()){var K=p._center,t=p._eye,H=_d(t,K),$=id(w(H[0]*H[0]+H[2]*H[2]),H[1]),f=mf(p,$+J);J=f-$,p.fi({kind:p._rotating?"betweenRotate":"beginRotate",event:i}),p._rotating=1,p.rotate(W,J)}}}),j.defineProperties(Fs.prototype,{panButton:{get:function(){return this._panButton},set:function(z){this._panButton=z}},minPhi:{get:function(){return this._minPhi},set:function(Z){this.gv.setRotateMinPhi(this._minPhi=Z)}},maxPhi:{get:function(){return this._maxPhi},set:function(C){this.gv.setRotateMaxPhi(this._maxPhi=C)}},keepHorizon:{get:function(){return this._keepHorizon},set:function(P){this._keepHorizon=P}},threshold:{get:function(){return this._threshold},set:function(S){this._threshold=S}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(B){this._touchScaleThreshold=B}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(b){this._touchRotateThreshold=b}}});var Gs,Hs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",Is=32,Js=Ac.GlobeInteractor=function(E,P){nk(Js,this,[E]);var N,_=P.radius||6378137,U=this,e=null;Gs||(Gs=_k(),Gs.style.border="",Gs.style.backgroundImage="url("+Hs+")");var s=new Uk,X=new ti,T=new ti,f=new ti,o=new Hl,J="number"==typeof _?{x:_,y:_,z:_}:_,V={center:new ti(0,0,0),radius:J},L=function($){E._81O=null;var P=E.getHitPosition($,E.getCenter(),X.copy(E.getEye()).sub(T.copy(E.getCenter())).toArray());return o.origin.copy(E.getEye()),o.direction.copy(P).sub(o.origin).normalize(),o.intersectEllipsoid(V)},Q=function(J,j){E._81O=null,o.origin.copy(E.getEye());for(var y,C,B=E.getCenter(),v=X.copy(E.getEye()).sub(T.copy(E.getCenter())).toArray(),A=1,s=16,M=0,q=1,k={x:0,y:0};s--;){if(k.x=j.x+(J.x-j.x)*A,k.y=j.y+(J.y-j.y)*A,y=E.getHitPosition(k,B,v),o.direction.copy(y).sub(o.origin).normalize(),C=o.intersectEllipsoid(V),C&&1===A)return{hit:C};C?M=A:q=A,A=(M+q)/2}return{hit:C,out:1>A}},R=function(F,$){if(e){var H=Date.now();e.deltaTime=e.lastTime?H-e.lastTime:1e3,e.lastTime=H,e.lastAxis=F,e.lastAngle=$}$&&(s.setFromAxisAngle(F,$),E.setEye(X.copy(E.getEye()).applyQuaternion(s).toArray()),E.setCenter(X.copy(E.getCenter()).applyQuaternion(s).toArray()),E.setUp(X.copy(E.getUp()).applyQuaternion(s).toArray()))};U._showCrossIcon=function(h){Ik(U.getView(),Gs),zb(Gs,{x:h.clientX-Is/2,y:h.clientY-Is/2,width:Is,height:Is})},U._hideCrossIcon=function(){Hj(Gs)},U._scrollImpl=function(V,s){e={point:E.lp(V),screen:Xe(V),hit:L(V),type:"right"},e.hitNormalize=e.hit?e.hit.clone().normalize():new ti;var j={clientX:e.screen.x,clientY:e.screen.y+10*s};U._handleMoveImpl(j),U._endMoveImpl(j)},U._startMoveImpl=function(r){N&&(N.stop(!0),N=null),e={point:E.lp(r),screen:Xe(r),hit:L(r)},e.hitNormalize=e.hit?e.hit.clone().normalize():new ti,Pm(r)?1===r.touches.length?e.hit&&(e.type="left"):2===r.touches.length&&(e.type="touch2"):(Uo(r)?e.hit&&(e.type="left"):xh(r)?e.type="right":fh(r)&&e.hit&&(e.type="middle"),!e.hit||"right"!==e.type&&"middle"!==e.type||U._showCrossIcon(r)),e.type&&Fd(U,r)},U._handleMoveImpl=function(u){if(e)switch(e.type){case"left":return U._handleLeft(u);case"right":return U._handleRight(u);case"middle":return U._handleMiddle(u);case"touch2":return U._handleTouch2(u)}},U._endMoveImpl=function(){if(e){if(this._hideCrossIcon(),"left"===e.type||"middle"===e.type){var $=1e3*(e.lastAngle/(e.deltaTime||30)),q=e.lastAxis,r=e.lastTime,S=function(){var J=Date.now(),V=(J-r)/1e3;return r=J,$*=Math.pow(Math.abs(U.decelerationRate),3*V),Math.abs($)<.01?($=0,N&&N.stop(),void 0):(R(q,$*V),void 0)};N=un({action:function(){S(arguments)},duration:5e3})}e=null}},U._handleLeft=function(A){if(!e.finished){var F=Xe(A),n=Q(F,e.lastScreen||e.screen);if(e.lastScreen=F,!n.hit)return e.finished=!0,U._endMoveImpl(A),void 0;var P=n.hit;P.normalize();var u=e.hitNormalize,v=Math.acos(P.dot(u)),Z=P.cross(u).normalize();R(Z,v),n.out&&(e.finished=!0,U._endMoveImpl(A))}},U._handleRight=function(H){var z=e.lastScreen||e.screen,j=z.y;z=e.lastScreen=Xe(H);var S=z.y,F=S-j;if(F){var D=Math.min(.5,F*U.scaleSpeed);X.copy(E.getEye());var y=e.hit;y||(y=X.clone().divide(J).normalize().multiply(J)),T.copy(X).lerp(y,D),E.setEye(T.toArray()),X.copy(E.getUp()),T.normalize();var o=X.clone().cross(T).normalize();if(f.copy(E.getCenter()),f.sub(o.multiplyScalar(f.dot(o))),E.setCenter(f.toArray()),e.hit){var v=L(e.screen),d=e.hitNormalize;if(v){v.normalize();var p=Math.acos(v.dot(d)),A=v.cross(d).normalize();p&&R(A,p)}}}};var O=function(l){return Math.abs(l)<.01?0:l>0?1:-1};U._handleTouch2=function(K){var t=K.touches.length;if(2===t){var o=K.touches,y={x:o[0].clientX,y:o[0].clientY},p={x:o[1].clientX,y:o[1].clientY},A={x:p.x-y.x,y:p.y-y.y},Z=e.lastCenter,n=Math.atan2(A.y,A.x),F=e.theta,U=0;F==I?F=e.theta=n:(U=n-F,e.thetaStarted||Math.abs(U)>.03?(e.thetaStarted=!0,e.theta=n):U=0);var j,G=Math.sqrt(A.x*A.x+A.y*A.y),b=e.vlen;if(b){var W=y.x-Z.x,M=y.y-Z.y,f=p.x-Z.x,u=p.y-Z.y,$=Math.sqrt(W*W+M*M),Y=Math.sqrt(f*f+u*u),N=b/2,i=O($-N),k=O(Y-N);0>i*k||0===i&&0===k?(j=1,e.vlen=G):(j||(j=G/b),e.scaleStarted||Math.abs(j-1)>.05?(e.vlen=G,e.scaleStarted=!0):j=1)}else b=e.vlen=G,j=1;var A=T.copy(E.getEye()).clone();1!==j&&E.setEye(A.setLength((A.length()-_)/j+_).toArray()),U&&R(A.normalize(),U),e.lastCenter={x:(p.x+y.x)/2,y:(p.y+y.y)/2}}},U._handleMiddle=function(a){var V=Xe(a),w=e.screen;e.screen=V;var i=(V.y-w.y)/180*Math.PI*U.rollSpeed;T.copy(E.getCenter()).sub(X.copy(E.getEye())).normalize(),X.copy(E.getUp()).cross(T).normalize(),T.copy(E.getEye()).sub(e.hit).applyAxisAngle(X,i).add(e.hit);var G=T.clone();T.copy(E.getCenter()).sub(e.hit).applyAxisAngle(X,i).add(e.hit);var j=T.clone(),n=T.copy(E.getUp()).applyAxisAngle(X,i).clone(),I=!1;i>0&&(f.copy(n),T.copy(j).sub(G).normalize(),X.copy(G).multiplyScalar(-1).normalize(),X.dot(f)-T.dot(f)>0&&(I=!0)),I||f.copy(e.hit).sub(G).dot(e.hitNormalize)>=0&&(I=!0),I||(E.setEye(G.toArray()),E.setCenter(j.toArray()),E.setUp(n.toArray()));var W=-(V.x-w.x)/180*Math.PI*U.rotateSpeed;R(e.hitNormalize,W)}};ci("GlobeInteractor",Ds,{handle_contextmenu:function(A){um(A)},handle_mousewheel:function(h){this._scrollImpl(h,h.wheelDelta/40)},handle_DOMMouseScroll:function(i){2===i.axis&&this._scrollImpl(i,-i.detail)
},handle_keydown:function(u){this.gv.handleKeyDown(u)},handle_mousedown:function(d){this.handle_touchstart(d)},handle_touchstart:function(o){um(o);var v=this.gv;if(v.setFocus(o)){var T=v.getDataInfoAt(o),X=T?T.data:I;X&&v.isInteractive(X)||this._startMoveImpl(o);var P=T?T.part:I;we(o)?v.handleDoubleClick(o,X,P):v.handleClick(o,X,P)}},handle_mouseup:function(t){this.handle_touchend(t)},handle_touchend:function(){},handleWindowMouseMove:function(V){this.handleWindowTouchMove(V)},handleWindowTouchMove:function(E){this._handleMoveImpl(E)},handleWindowMouseUp:function(p){this.handleWindowTouchEnd(p)},handleWindowTouchEnd:function(v){this._endMoveImpl(v)}}),j.defineProperties(Js.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(Y){this._rotateSpeed=Y}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(m){this._rollSpeed=m}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(Y){this._scaleSpeed=Y}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(t){this._decelerationRate=t}}});var Ks=function(b){var p=2147483648|b;return[(255&p>>16)/255,(255&p>>8)/255,(255&p)/255,(255&p>>24)/255]},Ls=function(o){this.gv=o,this.gv.pickColorMap={_pickIdUsed:2e3}};Ag(Ls,j,{_iv:!0,iv:function(){this._iv=!0},get:function(Q,O,u){this.validate();var K=this,L=K.gv.getGL();if(!L)return I;var m,J,D=K._resolution,C=Math.round(Q.x*D),z=Math.ceil(Q.width*D),v=Math.ceil(Q.height*D),U=K.height-Math.round(Q.y*D)-v,r=k(z/2),e=new Uint8Array(4*z*v),E=0,q=e.length,w=O?I:new Gc,G=O?I:{};if(he(L,K.frame),L.readPixels(C,U,z,v,L.RGBA,L.UNSIGNED_BYTE,e),Ur(L),O){for(;r>=E;E++)for(var i=r-E,_=r+E,n=i;_>=n;n++)for(var j=i;_>=j;j++)if((n===i||n===_||j===i||j===_)&&(m=K.info(e,4*(n*z+j)))){if(u&&u(m)===!1)continue;return m}}else for(;q>E;E+=4)if(m=K.info(e,E)){if(u&&u(m)===!1)continue;J=m.data,G[J._id]||(w.add(J),G[J._id]=J)}return w},info:function(B,W){return this.gv.pickColorMap[(B[W]<<16)+(B[W+1]<<8)+B[W+2]+((127&B[W+3])<<24)]},getResolution:function(){return this._resolution},onContextLost:function(){this.texture=null,this.width=this.height=-1},validate:function(){var N=this,m=N.gv,b=m.getGL();if(b){var q=N._resolution=m._pickerResolution*m.getDevicePixelRatio(),C=Math.round(q*m.getWidth()),j=Math.round(q*m.getHeight()),F=b.RGBA,W=b.TEXTURE_2D,V=b.RENDERBUFFER,o=b.FRAMEBUFFER;if(N.texture||(N.texture=Gg(b),N.render=b.createRenderbuffer(),N.frame=b.createFramebuffer()),(N.width!==C||N.height!==j)&&(b.activeTexture(b.TEXTURE0),rf(b,N.texture),b.texImage2D(W,0,F,C,j,0,F,b.UNSIGNED_BYTE,I),bk(b,b.TEXTURE_MIN_FILTER,b.LINEAR),b.bindRenderbuffer(V,N.render),b.renderbufferStorage(V,b.DEPTH_COMPONENT16,C,j),he(b,N.frame),b.framebufferTexture2D(o,b.COLOR_ATTACHMENT0,W,N.texture,0),b.framebufferRenderbuffer(o,b.DEPTH_ATTACHMENT,V,N.render),rf(b,I),b.bindRenderbuffer(V,I),Ur(b),N.width=C,N.height=j),N._iv){N._iv=!1;var v=!1;m._40Q.each(function(W){!v&&W.isBatchInvalid()&&(v=!0)}),v&&m.updateScene(),he(b,N.frame),b.clear(b.COLOR_BUFFER_BIT),m.overlappingBox.clear(),m.setViewport(b,0,0,C,j),m.renderPickScene(),Ur(b)}}}});var Ms=function(B){this.gv=B};Ag(Ms,j,{gap:0,size:0,_42:function(h,q){var L=this,M=L.gv,P=M._gridGap,F=M._gridSize;if(M._gridVisible){if(L.gap!==P||L.size!==F){for(var y=[],z=M._gridSize/2,Y=P*z,E=0;2*z+1>E;E++){var o=6*E,V=6*(2*z+1)+o;y[o]=-Y,y[o+1]=0,y[o+2]=-Y+E*P,y[o+3]=Y,y[o+4]=0,y[o+5]=-Y+E*P,y[V]=-Y+E*P,y[V+1]=0,y[V+2]=-Y,y[V+3]=-Y+E*P,y[V+4]=0,y[V+5]=Y}L.vs=new _p(y),L.gap=P,L.size=F}$n(M),xk(h,q),gk(h),fg(h,q,1,M._gridColor,M._buffer.vs,L.vs),bj(h,0,L.vs.length/3,h.LINES),ah(h),kc(h,q)}else L.vs=L.gap=L.size=I}});var Ns=function(x){this.gv=x};Ag(Ns,j,{_42:function(k,t){var b=this.gv,Q=b._buffer.vs,N=b._axisXColor,K=b._axisYColor,s=b._axisZColor,g=b._originAxisVisible,U=b._centerAxisVisible;if(g||U){var B=jn?k.TRIANGLES:k.TRIANGLE_FAN,W=k.LINES;if($n(b),xk(k,t),gk(k),g){var q=b.getCenterInfo(),v=a(q.width,q.height)/5,Y=.8*v,z=.05*v;fg(k,t,1.5,N,Q,new _p([0,0,0,v,0,0,Y,z,0,Y,0,z,Y,-z,0,Y,0,-z,Y,z,0,0,0,0,0,v,0,z,Y,0,0,Y,z,-z,Y,0,0,Y,-z,z,Y,0,0,0,0,0,0,v,z,0,Y,0,z,Y,-z,0,Y,0,-z,Y,z,0,Y])),bj(k,0,2,W),bj(k,1,6,B),fg(k,t,I,K),bj(k,7,2,W),bj(k,8,6,B),fg(k,t,I,s),bj(k,14,2,W),bj(k,15,6,B)}if(U){var j=b._center,p=j[0],_=j[1],$=j[2],q=b.getPositionInfo(j);v=a(q.width,q.height)/20,fg(k,t,1.5,N,Q,new _p([p,_,$,p+v,_,$,p,_,$,p,_+v,$,p,_,$,p,_,$+v])),bj(k,0,2,W),fg(k,t,I,K),bj(k,2,2,W),fg(k,t,I,s),bj(k,4,2,W)}ah(k),kc(k,t)}}});var Os=function(C){this.gv=C},Ps="edit_tx",Qs="edit_ty",Rs="edit_tz",Ss="edit_rx",Ts="edit_ry",Us="edit_rz",Vs="edit_sx",Ws="edit_sy",Xs="edit_sz",Ys={};Ys[Ps]=101,Ys[Qs]=102,Ys[Rs]=103,Ys[Ss]=104,Ys[Ts]=105,Ys[Us]=106,Ys[Vs]=107,Ys[Ws]=108,Ys[Xs]=109,Ag(Os,j,{_42:function(b,v,m){var k=this,B=k.gv,s=B.sm().ld();if(s&&B.isEditable(s)&&!B.isEditHelperDisabled()&&Fg(s)&&(!B.isFirstPersonMode()||!B.isMouseRoamable()&&!to)){$n(B);var A,o=B.isMovable(s),O=B.isRotationEditable(s),x=B.isSizeEditable(s),t=B._axisXColor,S=B._axisYColor,R=B._axisZColor,D=B._editSizeColor,z=s.p3();if(B.isOrtho()){var h=B.getCenterInfo();A=a(h.width,h.height)/8}else A=Hd(B.getEye(),z)/10;var V,I,r=A/(m?5:10),J=.7*A,N=.4*J,L=z[0],Q=z[1],K=z[2];V=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],o&&k._17O(b,v,s,m,Ps,t,V,[L,Q-r,K,L+J,Q-r,K,L+J,Q,K,L+J,Q,K,L,Q,K,L,Q-r,K,L,Q-r,K+r,L+J,Q-r,K+r,L+J,Q-r,K,L+J,Q-r,K,L,Q-r,K,L,Q-r,K+r]),I=L+J,x&&k._17O(b,v,s,m,Vs,D,V,[I,Q-r,K,I+N,Q-r,K,I+N,Q,K,I+N,Q,K,I,Q,K,I,Q-r,K,I,Q-r,K+r,I+N,Q-r,K+r,I+N,Q-r,K,I+N,Q-r,K,I,Q-r,K,I,Q-r,K+r]),I+=N,O&&k._17O(b,v,s,m,Ss,t,V,[I,Q-r,K,I+N,Q-r,K,I+N,Q,K,I+N,Q,K,I,Q,K,I,Q-r,K,I,Q-r,K+r,I+N,Q-r,K+r,I+N,Q-r,K,I+N,Q-r,K,I,Q-r,K,I,Q-r,K+r]),V=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],o&&k._17O(b,v,s,m,Qs,S,V,[L,Q,K,L,Q+J,K,L-r,Q+J,K,L-r,Q+J,K,L-r,Q,K,L,Q,K,L,Q,K,L,Q,K-r,L,Q+J,K-r,L,Q+J,K-r,L,Q+J,K,L,Q,K]),I=Q+J,x&&k._17O(b,v,s,m,Ws,D,V,[L,I,K,L,I+N,K,L-r,I+N,K,L-r,I+N,K,L-r,I,K,L,I,K,L,I,K,L,I,K-r,L,I+N,K-r,L,I+N,K-r,L,I+N,K,L,I,K]),I+=N,O&&k._17O(b,v,s,m,Ts,S,V,[L,I,K,L,I+N,K,L-r,I+N,K,L-r,I+N,K,L-r,I,K,L,I,K,L,I,K,L,I,K-r,L,I+N,K-r,L,I+N,K-r,L,I+N,K,L,I,K]),V=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],o&&k._17O(b,v,s,m,Rs,R,V,[L,Q,K,L,Q,K+J,L,Q-r,K+J,L,Q-r,K+J,L,Q-r,K,L,Q,K,L,Q-r,K,L-r,Q-r,K,L-r,Q-r,K+J,L-r,Q-r,K+J,L,Q-r,K+J,L,Q-r,K]),I=K+J,x&&k._17O(b,v,s,m,Xs,D,V,[L,Q,I,L,Q,I+N,L,Q-r,I+N,L,Q-r,I+N,L,Q-r,I,L,Q,I,L,Q-r,I,L-r,Q-r,I,L-r,Q-r,I+N,L-r,Q-r,I+N,L,Q-r,I+N,L,Q-r,I]),I+=N,O&&k._17O(b,v,s,m,Us,R,V,[L,Q,I,L,Q,I+N,L,Q-r,I+N,L,Q-r,I+N,L,Q-r,I,L,Q,I,L,Q-r,I,L-r,Q-r,I,L-r,Q-r,I+N,L-r,Q-r,I+N,L,Q-r,I+N,L,Q-r,I])}},_17O:function(J,q,u,T,L,$,S,n){var Q=this.gv,W=Q._buffer,t=qb.for(J),U=t.directUniforms(),_=t.directAttribs();if(Q._picking){T=Q.pickColorMap;var v=Ys[L];T[v]={data:u,part:L},U.uFixPickReverseColor=Ks(v)}gd(J,q,I,!0,I,!0,I,!1),U.uDiffuse=$,_.aPosition=Wh(J,W.vs,new _p(n),I),_.aNormal=Wh(J,W.ns,new _p(S),I),gk(J),bj(J,0,12),ah(J),Rr(J,q)}});var Zs=A.Raycaster=function(G){this.gv=G,this.maxTriangleTest=1/0,this.backfaceCulling=!0};Og("Raycaster",j,{intersect:function(p){var h=this,F=h.gv,m=F.getDataAt(p);return m?h.intersectObject(p,m):null},intersectObjects:function(t,d,B){var Z,k,L,H,$=this,v=1/0,j=t.origin||(new ti).fromArray($.gv.getEye()),F=$.maxTriangleTest,a=[];d.forEach(function(I){B&&B(I)===!1||I.s("intersect")!==!1&&a.push(I)});var g=j.distanceToSquared2([0,0,0]);return a.sort(function(q,Q){return(q.p3?j.distanceToSquared2(q.p3()):g)-(Q.p3?j.distanceToSquared2(Q.p3()):g)}),$.countTriangles=0,a.forEach(function(z){$.countTriangles>F||(Z=$.intersectObject(t,z),Z&&(k=j.distanceToSquared(Z.world),v>k&&(L=z,H=Z,v=k)))}),$.countTriangles=0,{data:L,intersect:H}},intersectObjectAndRecordTriangle:function(j,x){this._4GQ=!0;var p=this.intersectObject(j,x);return this._4GQ=!1,p},intersectLastTriangle:function(N,D){var e=this.getRay(N);e.applyMatrix4(D.inverseMatrix);var h=e.intersectPlane(D.plane);if(!h)return null;var G=uf.uvIntersection(h,D.p1,D.p2,D.p3,D.uv1.clone(),D.uv2.clone(),D.uv3.clone());return{world:h.clone().applyMatrix4(D.matrixWorld),local:h.clone(),uv:G}},getRay:function(M){if(M instanceof Hl)return M;var V=this,e=V.gv,c=e.unproject(M),j=new ti,Y=e.getEye(),P=new ti;if(e.isOrtho()){var F=new ti(Y);P.copy(e.getCenter()).sub(F).normalize();var Q=j.copy(c).sub(F).dot(P);j.copy(P).setLength(-Q).add(F.copy(c))}else j.copy(Y),P.copy(c).sub(j).normalize();return new A.Math.Ray(j,P)},intersectObject:function(d,t){return this._intersectObjectImpl(this.getRay(d),t)},_intersectObjectImpl:function(){function $(){var X=new ti;return X.subVectors(O,D),l.subVectors(N,D),X.cross(l).normalize(),X}var k=new gq,Y=new gq,q=new Hl,b=new ti,r=new ti,K=new ti,X=new ti,Q=new ti,N=new ti,D=new ti,O=new ti,t=new gr,S=new gr,G=new gr,l=new ti,w={vs:Vf,is:ap,uv:lm},P=lj.slice(0);return P.push("csg"),function(W,f){var n=this.gv.getData3dUI(f),V=f.mat||n.mat;V?k.fromArray(V):k.identity(),Y.getInverse(k),q.copy(W).applyMatrix4(Y);var v,p,s,H="body",x=n.shapeModel;if(!x&&(f instanceof A.Polyline||f instanceof A.Edge)&&n.lineShapeModel&&(x=n.lineShapeModel),x||(x=bg(n)),x||(A.CSGNode&&f instanceof A.CSGNode||A.CSGShape&&f instanceof A.CSGShape?(s=!0,x=[n.left,n.front,n.right,n.back,n.top,n.bottom,n.csg]):f instanceof A.Node&&!(f instanceof A.Shape)?(v=!0,x=w):(p=!0,x=[n.left,n.front,n.right,n.back,n.top,n.bottom])),!x)return console.log("Can not find shape model."),null;gc(x)||(x=[x]);var E,U,e,d,M,_,R,o,i,I,C,u,c,L,g,J,T=1/0,y=["","top_","bottom_"],l=!1,h=this.backfaceCulling,j=[];for(ms(x,n,j),E=0,U=j.length;U>E;E++)if(c=j[E])for(e=0,d=y.length;d>e;e++)if(L=y[e],R=c[L+"vs"],o=c[L+"is"],i=c[L+"uv"]||c[L+"tuv"],R){if(g=c[L+"boundingBox"]){var C=q.intersectBox(g);if(!C)continue;if(q.origin.distanceTo(C)>T)continue;J=!1}else c[L+"boundingBox"]=g=new A.Math.Box3,J=!0;for(M=0,_=o?o.length:R.length/3;_>M;M+=3)this.countTriangles++,o?(r.fromArray(R,3*o[M]),K.fromArray(R,3*o[M+1]),X.fromArray(R,3*o[M+2])):(r.fromArray(R,3*M),K.fromArray(R,3*(M+1)),X.fromArray(R,3*(M+2))),J&&(g.expandByPoint(r),g.expandByPoint(K),g.expandByPoint(X)),I=q.intersectTriangle(r,K,X,h,b),I&&(u=q.origin.distanceTo(I),T>u&&(T=u,Q.copy(I),N.copy(r),D.copy(K),O.copy(X),""!==L?H=L.slice(0,-1):v?H=lj[Math.floor(M/6)]:p?H=lj[E]:s&&(H=P[E]),i&&(l=!0,o?(t.fromArray(i,2*o[M]),S.fromArray(i,2*o[M+1]),G.fromArray(i,2*o[M+2])):(t.fromArray(i,2*M),S.fromArray(i,2*(M+1)),G.fromArray(i,2*(M+2))))))}if(!isFinite(T))return null;var a,B,F=Q.clone().applyMatrix4(k),m=this._4GQ;l&&(m&&(B={inverseMatrix:Y.clone(),matrixWorld:k.clone(),p1:N.clone(),p2:D.clone(),p3:O.clone(),uv1:t.clone(),uv2:S.clone(),uv3:G.clone(),plane:(new A.Math.Plane).setFromCoplanarPoints(N,D,O)}),a=uf.uvIntersection(Q,N,D,O,t,S,G));var Z=$(N,D,O),z=$(N.applyMatrix4(k),D.applyMatrix4(k),O.applyMatrix4(k)),cl=q.direction.dot(Z);cl>0&&(Z.multiplyScalar(-1),z.multiplyScalar(-1));var Mm={world:F,local:Q.clone(),worldNormal:z,normal:Z,uv:a,part:H};return B&&(Mm.triangleInfo=B),Mm}}()});var $s=function(W,l){this.gv=W,this.s=function(X,B,A){return B==I&&(B=A),B==I?l.getStyle(X):ui(B,l,W)},this.data=l};Ag($s,j,{I3d:!0,ms_icons:1,_iv:!0,_cacheBoundingBox:_,iv:function(){this._iv=!0},update:function(v,i,u){var s=this,a=s.data;if(v||(v=s.gv,i=v.getGL(),u=v._40Q),!s.needValidate(i)||!v.isVisible(a))return u.push(this,!1),void 0;var g,j,P,M,b,L=a._id,E=a._47Q?null:s.s("batch"),K=a.getRenderLayer(),p=u.get(K,!0),d=p.batchIndexMap,z=p.batchModelMap,o=v.getBrightness(a),x=o!=I&&1!==o;g=Md(d,z,a,E,v);var S=s.validate(g,E?v.getBatchInfo(E)||sd:I);if(g&&(j=d[L],P=j.size=g.vs.length/3-j.begin,b=g.rs))for(o=x?o:1,M=0;P>M;M++)b.push(o);var y=v.getWireframeGeometry(a);if(y)nc(v,a,y);else if(Fg(a)){var U=v.getWireframe(a);U&&nc(v,a,U)}s.labelInfo=s.label2Info=s.noteInfo=s.note2Info=s._38o=I,s._24O(rc,"getLabel"),s._24O(vb,"getLabel2"),s._26O(Zf,"getNote"),s._26O(gi,"getNote2"),s._15O(),s.interactiveInfo=v.isInteractive(a)?{}:I,p.push(this,!0),S!==!1&&(s._iv=!1)},clearWireframeGeometryCache:function(){var v=this;bp(v),v.data.iv()},_46Q:function(q){var Q=this,X=Q.data,K=Q.gv;if(K.isVisible(X)){var R=X._id,e=K._40Q.get(X._renderLayer,!0),h=e.batchIndexMap[R],N=e.polylineIndexMap[R],E=e.wireframeIndexMap[R];if(h||N||E){var i=Rm(q,K.pickColorMap,K.isSelectable(X),Q,nr,!0);i&&(kj(i,h,e.batchModelMap),kj(i,N,e.polylineModelMap),kj(i,E,e.wireframeModelMap))}}},_42:function(e,Q,L){function R(O,i,b){var D=i.getBrightness(b),V=b.s("alphaTest"),X=b.s("envmap"),L=qb.for(O),E=L.directUniforms();D!=I&&1!==D&&(E.uBrightness=D),E.uAlphaTest=V,E.uUseEnvMap=X?!0:!1,E.uReflectivity=X||.01,E.roughness=b.s("roughness"),i._setEnvmapByProbeId(E,b.s("envmap.probe")),E.shadowReceive=!q&&b.s("shadow.receive"),E.shadowCull=!q&&!!b.s("shadow.cull"),vo(i,E,b.s("3d.clipbox")?Ak:b.s("3d.clipbox.mask"));var B=h.s("3d.clip.direction");if(B){var k=h.s("3d.clip.percentage");0===k&&(y=!1);var v=h._formatClipUniforms(B,k,b);E.uClipPercent=v[1],E.uClipDirection=v[0]}else E.uClipDirection=0;O._blooming&&!b.s("bloom")&&(E.blackout=!0),q||(i._flowObjects.length&&i.flowMap.resetDataFlowEnabld(b,E),dk(i,E,b.s("light.mask"),b.s("headlight.ambientIntensity")))}var h=this,Y=h.data,i=h.gv;if(i.isVisible(Y)){var g,q=i._picking;if(q)g=i.pickColorMap;else{if(i.isTransparentMask(Y)||i.isReflecting(e)&&Y.s("3d.reflectable")===!1)return;g=_}if($s.getTitle===_){$s.getTitle=0;for(var K in z)if(K.length===vb.length+1&&K[vb.length]===xo[4].toUpperCase()&&K[vb.length-1]===xo[vb.length+1].toUpperCase()){$s.getTitle=nb;break}}if(!$s.getTitle||Fl[vb.length+2]){if($s.getHead===_){$s.getHead=0;for(var K in M){var H="box-sizing";6===K.length&&K[0]===xo[4]&&K[3]===H[0]&&K[4]===H[1]&&K[5]===H[2]&&($s.getHead=Yf)}}if(!$s.getHead||Fl[vb.length]){if($s.getTitle2===_){$s.getTitle2=0;for(var K in M){var u="uv";6===K.length&&K[0]===cn[1].toUpperCase()&&K[1]===u[0]&&($s.getTitle2=Oo)}}if(!$s.getTitle2||Fl[Jp.length]){var G,J,k=Y._id,P=i._40Q.get(Y._renderLayer,!0),N=P.batchIndexMap,o=P.batchModelMap,F=i.isSelectable(Y),W=!1,y=!0,c=N[k];if(q&&(J=Rm(e,g,F,h,nr,c),J&&!i._45Q&&(kj(J,c,o),kj(J,P.polylineIndexMap[k],P.polylineModelMap),kj(J,P.wireframeIndexMap[k],P.wireframeModelMap))),c||(W||(W=!0,R(e,i,Y)),y&&h._80o(e,Q,L)),i.isLabelVisible(Y)&&((G=h.labelInfo)&&(q&&Rm(e,g,F,h,rc),W||(W=!0,R(e,i,Y)),h._28O(G,rc,L)),(G=h.label2Info)&&(q&&Rm(e,g,F,h,vb),W||(W=!0,R(e,i,Y)),h._28O(G,vb,L))),i.isNoteVisible(Y)&&((G=h.noteInfo)&&(q&&Rm(e,g,F,h,Zf),W||(W=!0,R(e,i,Y)),h._29O(G,Zf,L)),(G=h.note2Info)&&(q&&Rm(e,g,F,h,gi),W||(W=!0,R(e,i,Y)),h._29O(G,gi,L))),(G=h._38o)&&(W||(W=!0,R(e,i,Y)),h._99O(e,Q,G,g,F,L)),W){var C=qb.for(e).directUniforms();C.uBrightness=1,C.uClipDirection=0,e._blooming&&(C.blackout=!1)}}}}}},_formatClipUniforms:function(J,l,T){switch(J){case"left":J=2;break;case"top":J=3;break;case"bottom":J=4;break;case"front":J=5;break;case"back":J=6;break;case"right":default:J=1}if(0===J%2&&(l=1-l),T instanceof A.Shape){var j=T.s3(),$=T.p3(),E=T.getAnchor3d();l=3>J?(l-E.x)*j[0]+$[0]:5>J?(l-E.y)*j[1]+$[1]:(l-E.z)*j[2]+$[2]}else l-=.5;return[J,l]},prepare:function(){var N=this,S=N.data;if(!(S instanceof dp)){var j,n,h,l,R,m=N.gv,A=m.getGL(),F=S._id,W=N.s("batch"),P=m._batchIndexMap,g=m._batchModelMap,z=m.getBrightness(S),$=z!=I&&1!==z;if(N.needValidate(A)){if(j=Md(P,g,S,W,m),N.validate(j,W?m.getBatchInfo(W)||sd:I),j&&(n=P[F],h=n.size=j.vs.length/3-n.begin,R=j.rs))for(z=$?z:1,l=0;h>l;l++)R.push(z);if(Fg(S)){var c=m.getWireframeGeometry(S);if(c)nc(m,S,c);else{var i=m.getWireframe(S);i&&nc(m,S,i)}}N.labelInfo=N.label2Info=N.noteInfo=N.note2Info=N._38o=I,N._24O(rc,"getLabel"),N._24O(vb,"getLabel2"),N._26O(Zf,"getNote"),N._26O(gi,"getNote2"),N._15O(),N.interactiveInfo=m.isInteractive(S)?{}:I,N._iv=!1}}},dispatchBoundingBoxChanged:function(){this._cacheBoundingBox=_},getBoundingBox:function(){var V,c,z,o,G,n;return function(){if(this._cacheBoundingBox)return this._cacheBoundingBox;V||(V={vs:Vf,is:ap,uv:lm},c=new ti,z=new ti,o=new ti,G=new ti,n=new ti);var N=this,q=N.data,u=N.shapeModel;if(u||q instanceof A.Shape||(u=bg(N)),!u&&q instanceof A.Shape&&(N.prepare(),u=N.shapeModel),u||(q instanceof A.Node&&!(q instanceof A.Shape)?u=V:(N.left||N.front||N.right||N.back||N.top||N.bottom)&&(u=[N.left,N.front,N.right,N.back,N.top,N.bottom])),!u)return _;gc(u)||(u=[u]);var U,$,L,S,t,J,Y,H,b,K,p,e,X=["","top_","bottom_"],F=new A.Math.Box3,M=!1;if(N._needRecoverPosition){G.set.apply(G,q.p3());var T=q.s3();n.set(1/(T[0]||1),1/(T[1]||1),1/(T[2]||1))}else G.set(0,0,0),n.set(1,1,1);for(U=0,$=u.length;$>U;U++)if(b=u[U])for(L=0,S=X.length;S>L;L++)if(K=X[L],Y=b[K+"vs"],H=b[K+"is"],Y){if(e=K+"boundingBox",p=b[e],!p)for(b[e]=p=new A.Math.Box3,t=0,J=H?H.length:Y.length/3;J>t;t+=3)H?(c.fromArray(Y,3*H[t]).sub(G).multiply(n),z.fromArray(Y,3*H[t+1]).sub(G).multiply(n),o.fromArray(Y,3*H[t+2]).sub(G).multiply(n)):(c.fromArray(Y,3*t).sub(G).multiply(n),z.fromArray(Y,3*(t+1)).sub(G).multiply(n),o.fromArray(Y,3*(t+2)).sub(G).multiply(n)),!c.isNaN()&&p.expandByPoint(c),!z.isNaN()&&p.expandByPoint(z),!o.isNaN()&&p.expandByPoint(o);F.expandByBox(p),M=!0}return M?(this._cacheBoundingBox=F,j.freeze(F),j.freeze(F.min),j.freeze(F.max),Mq(N.gv,q),F):_}}(),needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Jm},_80o:function(){},dispose:function(){var Q=this,G=Q._pickId;if(G){var B=Q.gv.pickColorMap;B[G]&&delete B[G]}},getBodyColor:function(h){var m=this.data,P=this.gv.getBodyColor(m);return P?P:h?m.getStyle(h):I},getCachedTexture:function(Y){var N=this._cachedTextures;return N?N[Y||"main"]:null},setCachedTexture:function(N,B){var J=this._cachedTextures;return J||(J=this._cachedTextures={}),J[B||"main"]=N,N},invalidateCachedTexture:function(B){var e=this._cachedTextures;if(e){for(var z in e)B.deleteTexture(e[z]);this._cachedTextures={}}},invalidateCachedGeometry:function(){},_24O:function(i,K){var q=this,T=q.data,o=q.gv,$=q.s,d=o[K](T);if(d!=I){var h=$(i+".scale"),k=$(i+".max"),M=q[i+"Info"]={label:d,textureScale:$(i+".texture.scale"),color:o[K+"Color"](T),font:$(i+".font"),align:$(i+".align"),background:o[K+"Background"](T)},Q=M.rect=sl(M,d);k>0&&k<Q.width&&(M.labelWidth=Q.width,Q.width=k),Q.x=Q.y=0,Q.width*=h,Q.height*=h,M.mat=q._16O($(i+".autorotate"),$(i+".position"),Q,$(i+".face"),$(i+".t3"),$(i+".r3"),$(i+".rotationMode"));var y=Q.width/2,V=Q.height/2;M.vs=new _p([-y,V,0,-y,-V,0,y,-V,0,y,V,0]),Q.width/=h,Q.height/=h}},_26O:function(w,H){var x=this,i=x.data,O=x.gv,K=x.s,k=O[H](i);if(k!=I){var v=K(w+".scale"),E=this[w+"Info"]={note:k,textureScale:K(w+".texture.scale"),expanded:K(w+".expanded"),font:K(w+".font"),color:K(w+".color"),align:K(w+".align"),borderWidth:K(w+".border.width"),borderColor:K(w+".border.color"),background:O[H+"Background"](i)};if(E.expanded){var z=K(w+".max"),_=sl(E,k);_.width+=6,_.height+=2,z>0&&z<_.width&&(E.labelWidth=_.width,_.width=z);var G={x:-_.width/2,y:-8-_.height,width:_.width,height:_.height+8}}else G={x:-6,y:-18,width:12,height:18};E.mat=x._16O(K(w+".autorotate"),K(w+".position"),I,K(w+".face"),K(w+".t3"),K(w+".r3"),K(w+".rotationMode")),E.rect=G,1!==v&&(G=Tl(G),G.x*=v,G.height*=v,G.y=-G.height,G.width*=v);var Y=G.x,F=G.y,q=G.width,X=G.height;E.vs=new _p([Y,-F,0,Y,-F-X,0,Y+q,-F-X,0,Y+q,-F,0])}},eachShapeModel:function(e,q){function h(H){Bk(H),H.vs&&e(H.vs,H.is,H.ns,H.uv),H.top_vs&&e(H.top_vs,H.top_is,H.top_ns,H.top_uv),H.bottom_vs&&e(H.bottom_vs,H.bottom_is,H.bottom_ns,H.bottom_uv),H.from_vs&&e(H.from_vs,H.from_is,H.from_ns,H.from_uv),H.to_vs&&e(H.to_vs,H.to_is,H.to_ns,H.to_uv)}function C(A){var B,i,L;if(gc(A))for(i=0,L=A.length;L>i;i++)B=A[i],B&&C(B);else Fp(A)?C(bg(D,A),D):qf(A)&&(A.shape3d?C(A.shape3d):h(A))}var D=this,H=D.data,q=q||D.shapeModel||bg(D);q||(q=H instanceof A.Node&&!(H instanceof A.Shape)?{vs:Vf,is:ap}:[D.left,D.front,D.right,D.back,D.top,D.bottom]),C(q)},_28O:function(x,b,o){if(o(this.s(b+".transparent"))){var h=x.rect,$=x.textureScale,q=h.width*$,z=h.height*$;if(q>=1&&z>=1){var O=ys(q,z);1!==$&&(O.translate(h.x,h.y),O.scale($,$),O.translate(-h.x,-h.y)),Yj(O,x),O.restore(),dm(this,b,x.mat,x.vs,!0)}}},_29O:function(l,u,b){if(b(this.s(u+".transparent"))){var T=l.rect,J=l.textureScale,d=T.x,C=T.y,f=T.width*J,Q=T.height*J;if(f>=1&&Q>=1){T.x=T.y=0;var x=ys(f,Q);1!==J&&x.scale(J,J),ng(x,l),x.restore(),T.x=d,T.y=C,dm(this,u,l.mat,l.vs,!1)}}},_99O:function($,_,P,C,m,p){if(P){var H=this,J=H.gv,x=H.data,D=J._buffer,N=J._1O,F=P.icons,T=qb.for($),t=T.directAttribs();for(var z in F){var y=F[z],A=P.rects[z];if(A&&p(ui(y.transparent,x,J))){J._picking&&Rm($,C,m,H,z);var g=ui(y.shape3d,x,J),V=g?[g]:ui(y.names,x,J),Y=V?V.length:0,E=ui(y.textureScale,x,J)||1,a=ui(y.light,x,J);a==I&&(a=g?!0:!1),gd($,_,ui(y.blend,x,J),a,ui(y.opacity,x,J),ui(y.reverseFlip,x,J),ui(y.reverseColor,x,J),ui(y.reverseCull,x,J));for(var w=0;Y>w;w++){var u=V[w],o=A[w];if(jh(H,o.mat),g)We(J,x,bg(H,g),H);else{var K=Gj(u);if(K){var j=o.width*E,L=o.height*E;if(j>=1&&L>=1){var s=ys(j,L);cq(s,K,ui(y.stretch,x,J),0,0,j,L,x,J),s.restore(),Gg($,Xj,N),gk($,_,N,ui(y.discardSelectable,x,J),D.uv,bs),t.aPosition=Wh($,D.vs,o.vs,I),t.aNormal=Pp($,D.ns,ln,I),Ce($,D.is,Db),cd($,0,Db.length),ah($,_,N)}}}Lg(J)}Rr($,_)}}}}});var _s=function(I,v){nk(_s,this,[I,v])};Ag(_s,$s,{_16O:function(w,B,F,s,f,S,q,k,M){var E=this.data,h=E.getFinalScale3d(),u=Vj(B,h,F,s,k,M);if(E.hasOwnProperty("_anchor")||E.hasOwnProperty("_anchorElevation")){var v=E.getAnchor3d();u[0]-=(v.x-.5)*h[0],u[1]-=(v.y-.5)*h[1],u[2]-=(v.z-.5)*h[2]}return Pb(dq(),u,E.p3(),s,f,S,q,w,E.getFinalRotation3d(),E.getRotationMode())},clear:function(){var Z=this;Z.faceMat=Z.mat=Z.shapeModel=Z.left=Z.right=Z.front=Z.back=Z.top=Z.bottom=Z.csg=I},needValidate:function($){if(this._iv)return this._validateFrameId=$._renderInfo.frame,!0;if(this.data._47Q){var i=$._renderInfo.frame;if(this._validateFrameId!==i)return this._validateFrameId=i,!0}return!1},validate:function(S,u){var K=this,C=K.gv,$=K.data,G=K.shapeName=K.s(hc),Z=bg(K,G);if(K._updateAutoRotation(),K._updateFixSize2d(),K._updateOverlapping(),K.dispatchBoundingBoxChanged(),$._47Q){var o=$.getRenderLayer(),Q=C._40Q.get(o);Q&&Q.ivWireframeBatch($)}var p=Gq($,C.getMat($),Z?K.s("shape3d.scaleable"):!0);if($.appendAnchorMatrix3d(p),K.clear(),K.mat=$.mat=p,Z||!G)if(K.shapeModel=Z,S)if(Z)Ae(C,$,Z,K,K.getBodyColor(),[p],S);else{var w=qj(p);no(C,$,S,u,p,w,iq,De),no(C,$,S,u,p,w,bq,Rq),no(C,$,S,u,p,w,wg,Ir),no(C,$,S,u,p,w,wn,Aj),no(C,$,S,u,p,w,Pd,uj),no(C,$,S,u,p,w,rm,_o)}else Z||(K._cubeUvs=null,K.vf(iq,0),K.vf(bq,16),K.vf(Pd,8),K.vf(rm,24),K.vf(wg,32),K.vf(wn,40))},_updateAutoRotation:function(){var Y=new bd,U=new gq,V=new ti,p=new ti,S=new ti;return function(){var m=this,W=m.data,g=m.s("autorotate")||m.s("shape3d.autorotate");if(!g)return W._dynamicRotation&&delete W._dynamicRotation,void 0;var C=m.gv;S.copy(m.s("shape3d.autorotate.up")||C._up);var A;A="string"==typeof g?[g.indexOf("x")<0?C._eye[0]:C._center[0],g.indexOf("y")<0?C._eye[1]:C._center[1],g.indexOf("z")<0?C._eye[2]:C._center[2]]:C._eye;var N=C._center,$=W.p3();V.copy($),p.set(A[0]-N[0],A[1]-N[1],A[2]-N[2]).add(V),U.lookAt(p,V,S),Y.set(0,0,0,W.getRotationMode(),!0).setFromRotationMatrix(U);var L=W._dynamicRotation;L&&Math.abs(L[0]-Y.x)<1e-5&&Math.abs(L[1]-Y.y)<1e-5&&Math.abs(L[2]-Y.z)<1e-5||(W._dynamicRotation=[Y.x,Y.y,Y.z])}}(),_updateFixSize2d:function(){var R=this,q=R.data,_=R.s("fixSizeOnScreen")||R.s("shape3d.fixSizeOnScreen");if(!_)return q._dynamicScale3d&&delete q._dynamicScale3d,void 0;var x=R.gv,s=Gq(q,x.getMat(q)),r=xl([0,0,0],s),V=x.toViewPosition(r);if(!isNaN(V.x)&&!isNaN(V.y)){var G=xl([1,0,0],s),L=x.toViewPosition(G),U=xl([0,1,0],s),Y=x.toViewPosition(U),J=L.x-V.x,p=Y.y-V.y;if(J&&p){var g,O,T=q._dynamicScale3d||[1,1,1],S=Gj(q.s("shape3d.image"));if(_[0]>0&&(g=_[0]),_[1]>0&&(O=_[1]),!g||!O){var K=_>0?_:1;g||(g=(bi(S,q)||q.getWidth())*K),O||(O=(Eg(S,q)||q.getTall())*K)}var d=Math.abs(J/g),y=Math.abs(p/O);Math.abs(d-1)<.001&&Math.abs(y-1)<.001||(q._dynamicScale3d=[T[0]/d,T[1]/y,T[2]])}}},_updateOverlapping:function(){var g=this,O=g.s("hide.overlapping.group");if(!O)return g._rectOverlapping&&(g._rectOverlapping=_),void 0;var e,W,A,s=g.gv,q=g.data,S=Gq(q,s.getMat(q)),z=1/0,N=1/0,j=-1/0,h=-1/0,n=q.getAnchor3d(),B=n.x,G=n.y,U=n.z;for(e=0;8>e;e++){if(W=xl([(e>>2)-B,(1&e>>1)-G,(1&e)-U],S),A=s.toViewPosition(W),isNaN(A.x)||isNaN(A.y))return;z=Math.min(z,A.x),j=Math.max(j,A.x),N=Math.min(N,A.y),h=Math.max(h,A.y)}var E={x:z,y:N,w:j-z,h:h-N};g._rectOverlapping=s.overlappingBox.isOverlapping(O,E)},getVectorDynamicSize:function(){var _,q=this,F=q.s("shape3d"),L=q.data;if("billboard"===F||"plane"===F||(_=L._currentCubeElementId)!=I){var G,f,g=q.gv,M=Gq(L,g.getMat(L)),X=L.getAnchor3d(),d=.5-X.x,u=.5-X.y,t=.5-X.z,v=Math.min(q.s("vector.dynamic.maxsize"),g._glCapabilities.maxTextureSize)/g.getDevicePixelRatio(),T=function(f,n){f[0]+=d,f[1]+=u,f[2]+=t,n[0]+=d,n[1]+=u,n[2]+=t;var m=g.toViewPosition(xl(f,M)),N=g.toViewPosition(xl(n,M)),Y=m.x-N.x,Q=m.y-N.y;return Math.min(v,Math.sqrt(Y*Y+Q*Q))};if("billboard"===F)G=T([-.5,0,0],[.5,0,0]),f=T([0,-.5,0],[0,.5,0]);else if("plane"===F)G=T([-.5,0,0],[.5,0,0]),f=T([0,0,-.5],[0,0,.5]);else if(L._currentCubeElementId!=I){var S=3*ap[_+1],s=3*ap[_],Z=3*ap[_+2];G=T([Vf[S],Vf[S+1],Vf[S+2]],[Vf[Z],Vf[Z+1],Vf[Z+2]]),f=T([Vf[S],Vf[S+1],Vf[S+2]],[Vf[s],Vf[s+1],Vf[s+2]])}return[G,f]}},vf:function(k,w){var x=this;if(x.gv.getFaceVisible(x.data,k)){var z=Ym(x,k);z.mat&&(x.faceMat=!0);var $=z.uv;if($){var K=x._cubeUvs;K||(K=x._cubeUvs=new _p([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var b=0;8>b;b++)K[w+b]=$[b]}return z}},_billboardInView:function(){var Q=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],_=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],p=new Sb,i=new ti,X=new gq;return function(V){var D=this;if(!D.mat)return!0;var f=D.gv.getFrustum(),$="billboard"===V?Q:_;p.makeEmpty(),X.fromArray(D.mat);for(var O=0,q=$.length;q>O;O+=3)p.expandByPoint(i.fromArray($,O).applyMatrix4(X));return f.intersectsBox(p)}}(),_80o:function(O,M,P){var q=this;if(q._rectOverlapping)return!0;var $=q.shapeModel;if($||!q.shapeName){var z=q.s("shape3d");if(("billboard"===z||"plane"===z)&&!q._billboardInView(z))return!0;var i=q.gv,H=q.data,J=i._cube,m=qb.for(O),K=m.directAttribs();if(ig&&!Xh){var k=q.mat;if(k)for(var L=0;L<k.length;L++)q.mat[L]=k[k.length-L-1]}$n(i,q.mat),!O._picking&&q.s("shape3d.reflector")||q.s("effect.flow")||($?We(i,H,$,q,q.getBodyColor(),P):(K.aPosition=Wh(O,J.vs,I,I),K.aNormal=Wh(O,J.ns,I,I),di(O,J.is),q._18O(O,M,"left",0,P),q._18O(O,M,"front",6,P),q._18O(O,M,"right",12,P),q._18O(O,M,"back",18,P),q._18O(O,M,"top",24,P),q._18O(O,M,"bottom",30,P))),Lg(i),q.faceMat&&(q._18O(O,M,"left",0,P,!0),q._18O(O,M,"front",6,P,!0),q._18O(O,M,"right",12,P,!0),q._18O(O,M,"back",18,P,!0),q._18O(O,M,"top",24,P,!0),q._18O(O,M,"bottom",30,P,!0))}},_18O:function(a,F,D,Y,U,z){var v=this[D];if(v){if(!U(v.transparent))return;if(z&&!v.mat||!z&&v.mat)return;var O=this.data.s("polygonOffset");O&&bm(a,O),z&&$n(this.gv,v.mat);var y=this,i=y.data,Q=qb.for(a),d=Q.directUniforms();i._currentCubeElementId=Y;var T=y.gv,E=T.getTexture(v.texture,i,D),j=v.uv,X=v.uvScale,L=v.uvOffset,u=v.uvRotation,g=v.uvAnchor,H=v.discardSelectable;E?j?gk(a,F,E,H,T._buffer.uv,y._cubeUvs,L,X,u,g):gk(a,F,E,H,T._cube.uv,I,L,X,u,g):gk(a),gd(a,F,v.blend,v.light,v.opacity,v.reverseFlip,v.reverseColor,v.reverseCull),d.uDiffuse=v.color||s["color.empty"],cd(a,Y,6),Rr(a,F),ah(a,F,E),z&&Lg(T),O&&bf(a),i._currentCubeElementId=null}},drawReflector:function(){var Q=new ti,n=new ti,q=new bd,R=new gq,k=new ti,w=new ti,W=new ti,c=new ti,o=new gq,J=new gq,m=new Wd,Z=new El,p=new El,A=function(s,k,n){s[n]=k[0],s[n+1]=k[1],s[n+2]=k[2]},a=function(b,H,Q){Q=Q||0,b[0]=H[Q],b[1]=H[Q+1],b[2]=H[Q+2]},h=function(R,B){A(R,B.getEye(),0),A(R,B.getCenter(),3),A(R,B.getUp(),6)},d=function(Z,V){a(V._eye,Z,0),a(V._center,Z,3),a(V._up,Z,6),V._18Q=I;var e=V._skybox;e&&(e.p3([Z[0],Z[1],Z[2]]),V.getData3dUI(e).iv())};return function(B){var r=this;r._reflectorInfo=null;var X=r.data;if(X._reflecting)return!1;var f=r.gv;if(f._picking)return!1;var s=X instanceof Mi,O=r._reflectorRenderTarget,u=f._canvas.width,V=f._canvas.height;if(O?O.setSize(B,u,V):O=r._reflectorRenderTarget=new Ac.RenderTarget(f,B,u,V),s){var L=X.getPointsMatrix3d().getElements(),K=X.p3();K[1]+=(1-X.getAnchorElevation())*X.getTall(),Q.copy(xl(K,L))}else Q.copy(X.p3());if(n.copy(f.getEye()),R.makeRotationFromEuler(q.set(X.r3(),X.getRotationMode(),!0)),!r._reflectNormal){var D;if(s&&X.getThickness()<0){if(!r.shapeModel||!r.shapeModel.top_vs)return!1;D={vs:r.shapeModel.top_vs,ns:r.shapeModel.top_ns}}else{if(D=bg(r,r.s("shape3d")),!D)return!1;!D.ns&&D.length&&(D=D[0])}if(!D.ns||!D.vs)return!1;r._reflectNormal=[D.ns[0],D.ns[1],D.ns[2]],r._reflectorVbuffer=Cm.Buffer.createVertexBuffer(B,new Float32Array(D.vs))}if(k.copy(r._reflectNormal),k.applyMatrix4(R),w.subVectors(Q,n),w.dot(k)>0)return!1;w.reflect(k).negate(),w.add(Q),W.copy(f.getCenter()).negate().add(Q),W.reflect(k).negate(),W.add(Q),c.copy(f.getUp()),c.reflect(k);var j=[0,0,0,0,0,0,0,0,0];h(j,f),a(f._eye,w.toArray()),a(f._center,W.toArray()),a(f._up,c.toArray()),f._18Q=I;var A=f._skybox;A&&(A.p3(f._eye),f.getData3dUI(A).iv()),he(B,O.frame),f.setViewport(B,0,0,O.width,O.height);var b=X.s("shape3d.reflector.background");if(b){var i=B.getParameter(B.COLOR_CLEAR_VALUE);Il(B,b)}else Il(B,[0,0,0,1]);qb.for(B).glState.depth.mask=!0,B.clear(B.COLOR_BUFFER_BIT|B.DEPTH_BUFFER_BIT);var E=X.s("shape3d.reflector.clip"),$=E===_?.003:E,v=Cr(f),H=Ar(f);m.setFromNormalAndCoplanarPoint(k,Q.add(k.clone().multiplyScalar($))),m.applyMatrix4(J.fromArray(H)),Z.set(m.normal.x,m.normal.y,m.normal.z,m.constant),J.fromArray(v).getInverse(J),p.set(Math.sign(Z.x),Math.sign(Z.y),1,1).applyMatrix4(J),Z.multiplyScalar(2/Z.dot(p)),v[2]=Z.x-v[3],v[6]=Z.y-v[7],v[10]=Z.z-v[11],v[14]=Z.w-v[15];var U=f._computedProjectMatrix;f._computedProjectMatrix=v,X._reflecting=!0;var e=X.s("shape3d.reflector.shadow"),N={renderAxis:!1,renderEdit:!1,renderGrid:!1};"disabled"===e?(N.createShadowMap=!1,N.renderShadow=!1):"scene"===e?N.createShadowMap=!1:N.useReflectorSelfShadowMap=!0,f.renderScene(N),f._computedProjectMatrix=U,o.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),o.multiply(J.fromArray(f._projectMatrix)),o.multiply(J.fromArray(f._viewMatrix)),b&&Il(B,i),Ur(B),d(j,f);var P=X.s("shape3d.reflector.blur");if(P){var l=f.getPostProcessingModule("Blur");l&&l.drawImpl(B,O,P,P>=3,X.s("shape3d.reflector.blur.iterations"))}var y=f.getPostProcessingModule("Glitch");y&&y.enable&&y.onlyReflector&&(O=y._42(B,O));var Y=B._compiledShader.reflector;Y||(Y=B._compiledShader.reflector=new Cm.Shader(B,Tr.Reflector.vs,Tr.Reflector.fs)),Y.bind(),B.activeTexture(B.TEXTURE0),rf(B,O.texture),Y.uniforms.tDiffuse=0,Y.uniforms.color=Tj(X.s("shape3d.reflector.color")||"rgb(128,128,128)"),Y.uniforms.textureMatrix=o.toArray(),Y.uniforms.modelMatrix=s?L:Gq(X),Y.uniforms.viewMatrix=Ar(f),Y.uniforms.projectionMatrix=Cr(f);var F=r._reflectorVbuffer;F.upload(),Y.attributes.pos.pointer(F);var M=this.s("shape3d.transparent");if(M){var T=qb.for(B).glState,S=T.depth.mask;T.depth.mask=!1}return B.drawArrays(B.TRIANGLES,0,F.data.length/3),M&&(T.depth.mask=S),X._reflecting=!1,B.useProgram(f._prg),rf(B,I),!0}}()}),Tr.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")};
var at=function(g,E){nk(at,this,[g,E])};Ag(at,_s,{_80o:function(){}});var bt=function(c,t){nk(bt,this,[c,t])};Ag(bt,$s,{_25Q:1,validate:function(J){var V=this;if(!V.s("geometry.cache")||!V.info){var X=V.gv,j=V.data,S=V.s,w=S("edge.width"),o=j._40I,D=j._41I;if(V.shapeModel=V.info=V.lineShapeModel=I,o&&D){var Y,P,p,T,v,c,G,Z,f,F,U=j.isLooped(),r=S(hs),y=z.getEdgeType(r);if(y){var e=y(j,Bn(V,X,j,U,r),X,V._19Q);if(!e.points||e.points.isEmpty())return;c=V.info={},G=e.segments,v=e.points,Z=v.size();for(var R=o.getElevation(),H=D.getElevation(),W=0;Z>W;W++){var C=v.get(W);C.e==I&&(C.e=R+(H-R)*W/(Z-1))}f=_i(v.get(0)),F=_i(v.get(Z-1));var $=Z%2;0===$?(c.c1=_i(v.get(Z/2-1)),c.c2=_i(v.get(Z/2))):c.p3=_i(v.get((Z-$)/2)),c.s1=f,c.s2=_i(v.get(1)),c.t1=_i(v.get(Z-2)),c.t2=F}else{v=new Gc,c=V.info={};var B=S("edge.offset"),M=S("edge.center"),O=S("edge.source.t3"),m=S("edge.target.t3"),i=Kj(X,j,"source"),t=Kj(X,j,"target");if(!i||!t)return X.invalidateData(j),delete V.info,!1;if(O&&(i[0]+=O[0],i[1]+=O[1],i[2]+=O[2]),m&&(t[0]+=m[0],t[1]+=m[1],t[2]+=m[2]),r===Wq){G=S("edge.segments");var _=c.points=S(Wl)||pg;if(Z=_.size()){f=_i(_.get(0)),F=_i(_.get(Z-1)),!M&&B&&(p=_d(f,i,!0),B=a(B,Hd(i,f)),i=[i[0]+p[0]*B,i[1]+p[1]*B,i[2]+p[2]*B],p=_d(t,F,!0),B=a(B,Hd(F,t)),t=[t[0]-p[0]*B,t[1]-p[1]*B,t[2]-p[2]*B]);var $=Z%2;0===$?(Y=_i(_.get(Z/2-1)),P=_i(_.get(Z/2))):c.p3=_i(_.get((Z-$)/2)),c.s1=i,c.s2=f,c.t1=F,c.t2=t}else!M&&B&&(p=_d(t,i,!0),T=Hd(i,t),B=qn(B,T),i=[i[0]+p[0]*B,i[1]+p[1]*B,i[2]+p[2]*B],t=[t[0]-p[0]*B,t[1]-p[1]*B,t[2]-p[2]*B]),Y=i,P=t;v.add({x:i[0],y:i[2],e:i[1]}),v.addAll(_),v.add({x:t[0],y:t[2],e:t[1]})}else{var k=Bn(V,X,j,U,r);if(V._19Q||(k=-k),U){var h=i[0],N=i[1],x=i[2],s=o.getTall()/2+k;Y=[h-k,N+s,x],P=[h+k,N+s,x],v.add({x:h-k,y:x,e:N}),v.add({x:h-k,y:x,e:N+s}),v.add({x:h+k,y:x,e:N+s}),v.add({x:h+k,y:x,e:N})}else{p=_d(t,i,!0),T=Hd(i,t);var E={x:i[0],y:i[2]},K={x:t[0],y:t[2]},Q=Ko(I,E,K,k),n=Q.x-E.x,A=Q.y-E.y;B=qn(B,T),p[0]*=B,p[1]*=B,p[2]*=B,Y=[i[0]+p[0]+n,i[1]+p[1],i[2]+p[2]+A],P=[t[0]-p[0]+n,t[1]-p[1],t[2]-p[2]+A],M?(v.add({x:i[0],y:i[2],e:i[1]}),v.add({x:Y[0],y:Y[2],e:Y[1]}),v.add({x:P[0],y:P[2],e:P[1]}),v.add({x:t[0],y:t[2],e:t[1]})):(v.add({x:Y[0],y:Y[2],e:Y[1]}),v.add({x:P[0],y:P[2],e:P[1]}))}}c.c1=Y,c.c2=P}c._lastPointsSegments={points:v,segments:G},c.list=S(hc)===wb?V.createTubeModel(v,G,w/2,J):V.createLineModel(v,G,w,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=I}});var ct=function(C,W){nk(ct,this,[C,W]),this._needRecoverPosition=!0};Ag(ct,_s,{_80o:function(U,r,L){var s=this,k=s.mat;if(k&&(!s.s("shape3d.reflector")||U._picking)){var d=s.gv,b=s.shapeModel;$n(d,k),b?We(d,s.data,b,s,s.getBodyColor(),L):(lb(s,U,r,"left",L),lb(s,U,r,"front",L),lb(s,U,r,"right",L),lb(s,U,r,"back",L),lb(s,U,r,"top",L),lb(s,U,r,"bottom",L)),Lg(d)}},validate:function(f,B){var n,q,v=this,V=v.s,A=v.data,M=A._thickness/2,E=A.isClosePath(),m=A.getPoints(),$=A.getSegments(),U=V(fd),Q=f&&f.uv;if(v.clear(),v.dispatchBoundingBoxChanged(),0>M){v.s("shape3d.reflector")&&(v._reflectNormal=null);try{var Z=V("shape3d.image.projection");if(Z&&Z[4]){var t=A.p3(),D=t[0],w=t[2];Z=[D+Z[0],Z[1]-w,D+Z[2],Z[3]-w]}q=v.shapeModel=Hp(m,$,V(Sm),V(Ig),U,V(ao),A.getTall(),A.getShapeElevation(),E,Z)}catch(g){q=v.shapeModel={}}V(er)?V("shape3d.image")||delete q.uv:(delete q.vs,delete q.ns,delete q.uv),V("shape3d.top.image")||delete q.top_uv,V("shape3d.bottom.image")||delete q.bottom_uv}else if(V(hc)===wb)n=rb(m,$,U,E),q=v.shapeModel={vs:[]},V("shape3d.image")&&(q.uv=[],q.sum=V(ao)||Pg(n)||1,q.len=0),V(Sm)&&!E&&(q.top_vs=[],V("shape3d.top.image")&&(q.top_uv=[])),V(Ig)&&!E&&(q.bottom_vs=[],V("shape3d.bottom.image")&&(q.bottom_uv=[])),v._12O(n,M);else{var d,F,H,J,u,X,i,p,W,P;if(n=rb(m,$,U,E),u=v.vf(Pd,Q,!1,B),M&&(X=v.vf(rm,Q,!1,B),i=E?I:v.vf(iq,Q,!1,B),p=E?I:v.vf(bq,Q,!1,B),W=v.vf(wg,Q,!1,B),P=v.vf(wn,Q,!1,B)),M){for(var K=0,a=n.length;a>K;K++)n[K]=v._tryRemoveBezierPoints(n[K],M);v._12O(n,M)}else u&&n.forEach(function(b){if(J=b.length,J>0)for(d=b[0],H=1;J>H;H++)F=b[H],v.addV(u.vs,d,F),d=F});v._20Q(n),f||(u&&(u.ns=Sl(u.vs),pq(u,"vs"),pq(u,zo)),M&&(X&&(X.ns=Sl(X.vs),pq(X,"vs"),pq(X,zo)),i&&(i.ns=Sl(i.vs),pq(i,"vs"),pq(i,zo)),p&&(p.ns=Sl(p.vs),pq(p,"vs"),pq(p,zo)),W&&(W.ns=Sl(W.vs),pq(W,"vs"),pq(W,zo)),P&&(P.ns=Sl(P.vs),pq(P,"vs"),pq(P,zo))))}var _=v.mat=A.getPointsMatrix3d().getElements();f&&(Qg(v,_,f,q),v.clear())},_20Q:function(f){var K,V,m,E,d,w,b,h=this,H=h.front,c=h.back,S=h.top,r=h.bottom,v=H?H.tuv:I,j=c?c.tuv:I,x=S?S.tuv:I,B=r?r.tuv:I,G=0;(v||j||x||B)&&(K=h.s(ao)||Pg(f)||1,f.forEach(function(X){if(V=X.length,V>0)for(w=X[0],m=1;V>m;m++)b=X[m],E=G/K,G+=Hd(w,b),d=G/K,h._14O(H,E,d),h._14O(c,1-d,1-E),h._14O(S,E,d),h._14O(r,E,d),w=b}))},_14O:function(Z,d,B){if(Z){var O=Z.uv,M=Z.tuv;if(M){if(O)var u=O[0]+(O[6]-O[0])*d,e=O[1]+(O[7]-O[1])*d,T=O[2]+(O[4]-O[2])*d,F=O[3]+(O[5]-O[3])*d,j=O[2]+(O[4]-O[2])*B,K=O[3]+(O[5]-O[3])*B,t=O[0]+(O[6]-O[0])*B,h=O[1]+(O[7]-O[1])*B;else u=d,e=0,T=d,F=1,j=B,K=1,t=B,h=0;M.push(T,F,j,K,t,h,t,h,u,e,T,F)}}},_13O:function(_){var S=_.uv,g=_.tuv;g&&(S?g.push(S[2],S[3],S[4],S[5],S[6],S[7],S[6],S[7],S[0],S[1],S[2],S[3]):g.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(A,v){var x=A.length;if(4>x)return A;var O,e,y,Q,Z,E,t=!1,r=function(O){return A[O]},B=function(y){return A[x-1-y]};for(Z=0;1>=Z;Z++)for(E=Z?B:r,e=E(0),y=E(1),O=2;x-1>O;O++)if(Q=E(O),!Q.remove)if(Q.b){var j=Ko(e,y,Q,v);j.adjust?(Q.remove=!0,t=!0):(e=y,y=Q)}else e=y,y=Q;if(!t)return A;var J=[];for(O=0;x>O;O++)A[O].remove||J.push(A[O]);return J},_12O:function(l,Q){var N,g,t,_,S,c=this.s("shape3d.point.epsilon"),x=this;l.forEach(function(B){if(S=B.length,S>0)for(N={p:B[0],n:!0},_=1;S>_;_++)g=B[_],t=S-1>_?B[_+1]:I,t&&Math.abs(g.x-t.x)<c&&Math.abs(g.y-t.y)<c||x.addPoint(N,g,t,Q,B)})},addPoint:function(C,f,w,p,Q){var N,B,P,A,g,H,c,L,q,r=this,j=C.p,O=C.f,Y=C.b,$=r.s("shape3d.side")||Dd,b=r.s("shape3d.start.angle"),k=r.s("shape3d.sweep.angle"),x=r.shapeModel,W=r.data.isClosePath();if(C.n&&(C.n=!1,O=W&&Q.length>2?Ko(Q[Q.length-2],j,f,p):Ko(I,j,f,p),Y=ie(j,O),x?x.top_vs&&r._10O(Y,O,$,b,k,x.top_vs,x.top_uv):(N=r.left)&&(r.addV(N.vs,Y,O),r._13O(N))),B=w?Ko(j,f,w,p):W&&Q.length>2?Ko(j,f,Q[1],p):Ko(j,f,I,p),P=ie(f,B),x){var U,G,z=x.vs,T=x.uv,u=x.sum;for(T&&(U=x.len/u,x.len+=Hd(j,f),G=x.len/u),H=r._9O(Y,O,$,b,k),c=r._9O(P,B,$,b,k),L=0;$>L;L++)q=L+1,Gf(z,H[q]),Gf(z,c[L]),Gf(z,H[L]),Gf(z,c[L]),Gf(z,H[q]),Gf(z,c[q]),T&&(A=L/$,g=q/$,T.push(U,g,G,A,U,A,G,A,U,g,G,g));!w&&x.bottom_vs&&r._10O(P,B,$,b,k,x.bottom_vs,x.bottom_uv,!0)}else!w&&(N=r.right)&&(r.addV(N.vs,B,P),r._13O(N)),(N=r.front)&&r.addV(N.vs,O,B),(N=r.back)&&r.addV(N.vs,P,Y),(N=r.top)&&r.addH(N.vs,O,B,P,Y,!0),(N=r.bottom)&&r.addH(N.vs,Y,P,B,O);C.p=f,C.f=B,C.b=P},_10O:function(G,B,t,u,g,k,N,J){var H,O,W=this,D=W.data,T=W._9O(G,B,t,u,g),y=(G.x+B.x)/2,C=(G.y+B.y)/2,q=D.getShapeElevation(),i=0;for(i=0;t>i;i++)J?(Gf(k,T[i]),Gf(k,T[i+1])):(Gf(k,T[i+1]),Gf(k,T[i])),Gf(k,[y,q,C]),N&&(J?(H=$*(i+1)/t+u,O=$*i/t+u):(H=$*i/t+u,O=$*(i+1)/t+u),N.push(.5-.5*l(O),.5-.5*d(O),.5-.5*l(H),.5-.5*d(H),.5,.5))},_9O:function(b,e,m,h,g){var Y,N,B=this,W=B.data,v=[],r=(b.x+e.x)/2,O=(b.y+e.y)/2,w=W.getTall()/2,V=W.getShapeElevation(),Z=0;for(g==I&&(g=$);m>=Z;Z++)Y=g*Z/m+h,N=l(Y),v.push([r+(b.x-r)*N,V+w*d(Y),O+(b.y-O)*N]);return v},addV:function(N,j,P){var Y=j.x,L=j.y,q=P.x,h=P.y,R=this.data,T=R.getShapeElevation(),d=R.getTall()/2;N.push(Y,T-d,L,q,T-d,h,q,T+d,h,q,T+d,h,Y,T+d,L,Y,T-d,L)},addH:function(i,v,k,m,D,H){var t=this.data,I=t.getTall()/2,G=t.getShapeElevation()+(H?I:-I);i.push(v.x,G,v.y,k.x,G,k.y,m.x,G,m.y,m.x,G,m.y,D.x,G,D.y,v.x,G,v.y)},vf:function(F,L,H,P){var _,W=this,G=W.gv.getFaceVisible(W.data,F);return(H||G)&&(_=Ym(W,F,P),_.vs=[],_.tuv=G&&(_.texture||L)?[]:I,_.visible=G),_}});var dt=function(Y,z){nk(dt,this,[Y,z])},et={},ft=function(V){return/\.(png|jpg|gif|jpeg|bmp|svg)$/i.test(V)};Ag(dt,_s,{validate:function(){var C=this,m=C.gv,k=C.data,R=C.s,n=Tj(R("points.color")),t=R("points.size"),r=R("points.uv.offset"),s=R("points.image");!s||ft(s)||Ul.test(s)||(et[s]||(et[s]=C._createCachedImage(s)),s=et[s]);var i,K,a=k._modelDirty,B=R("points.model");if(B){if(C._lastShapeModel!==B||!C.shapeModel){var U=bg(C,B);if(!U)return;var W=[],V={};C.eachShapeModel(function(Q){for(var T=0,k=Q.length;k>T;T+=3){var G=Q[T],Z=Q[T+1],m=Q[T+2],z=""+G+"_"+Z+"_"+m;V[z]||(V[z]=!0,W.push(G,Z,m))}},U),C._setShapeModelPoints(new _p(W)),C._lastShapeModel=B,a=!0}i=C.shapeModel.vs.length,K=i/3}else{var w=k.getPoints();if(K=i=w.length,a||k._pointsDirty||!C.shapeModel){for(var o=[],I=0;K>I;I++){var H=w[I];H&&o.push(H.x,H.e,H.y)}C._setShapeModelPoints(new _p(o)),k._pointsDirty=!1,C._lastShapeModel=null,a=!0}}if(C.info={mat:Gq(k),size:t,diffuse:n,opacity:R("points.opacity"),texture:s,alphaTest:R("points.transparent")?0:R("alphaTest"),uvScale:R("points.uv.scale"),uvOffset:r,discardSelectable:R("points.discard.selectable")},a||k._colorsDirty){var S=!1,v=k.getColors();if(v&&v.length>0)for(var D=[],I=0;K>I;I++)for(var g=v[I],Q=g?(S=!0,Tj(g)):n,N=4*I,y=0;4>y;y++)D[N+y]=Q[y];C.shapeModel.cs=S?new _p(D):null,k._colorsDirty=!1}if(a||k._sizesDirty){var $=!1,u=k.getSizes();if(u&&u.length>0)for(var A,p=[],I=0;K>I;I++)A=u[I],A>=0?(p.push(A),$=!0):p.push(t);C.shapeModel.ss=$?new _p(p):null,k._sizesDirty=!1}if(a||k._offsetsDirty){var e=!1,E=k.getUvoffsets();if(E&&E.length>0)for(var Y,L,T,M=[],I=0;K>I;I++)Y=2*I,L=E[Y],T=E[Y+1],L!=_&&T!=_?(M.push(L,T),e=!0):M.push(r[0],r[1]);C.shapeModel.os=e?new _p(M):null,k._offsetsDirty=!1}if(a||C._lastPointNumber!==K){this.dispose();var j=m.pickColorMap,d=C._startPickId=j._pickIdUsed;j._pickIdUsed=d+K;for(var o=[],I=0;K>I;I++){var x=d+I,X=Ks(x);o.push(X[0],X[1],X[2],X[3]),j[x]||(j[x]={data:k,part:I})}C.shapeModel.ps=new _p(o),C._lastPointNumber=K}k._modelDirty=!1,this.dispatchBoundingBoxChanged()},_setShapeModelPoints:function(A){var s=this,n=s.shapeModel,g=s.shapeModel={vs:A};if(!n)return g;var T=A.length,J=Math.round(T/3);return n.cs&&n.cs.length==4*J&&(g.cs=n.cs),n.ss&&n.ss.length==J&&(g.ss=n.ss),n.os&&n.os.length==2*J&&(g.os=n.os),n.ps&&n.ps.length==4*J&&(g.ps=n.ps),g},_createCachedImage:function(x){var U=128,D=th(),I=D.getContext("2d");Pq(D,U,U,1),jp(I,{width:U,height:U,comps:[{type:x,background:"white",borderWidth:0,rect:[0,0,U,U]}]},0,0,U,U);var N=A.Math.generateUUID();return Qj[N]=D,N},_80o:function(X,S){var b=this,J=b.gv,x=J._picking;if(!x||J.isSelectable(b.data)){var H=b.shapeModel,n=b.info;if(H&&H.vs&&H.vs.length){var d=qb.for(X);d.useProgram(b._asureProgram(X));var N=d.directUniforms(),o=d.directAttribs();N.modelMatrix=n.mat,N.modelViewMatrix=Vb([],J._viewMatrix,n.mat),N.projectionMatrix=J._projectMatrix,N.viewMatrix=J._viewMatrix,N.scale=J.getHeight()/2,N.size=n.size,N.diffuse=n.diffuse,N.opacity=n.opacity,N.map=J.getTexture(n.texture,b.data),N.alphaTest=n.alphaTest,N.resolution=J.getDevicePixelRatio(),N.discardSelectable=n.discardSelectable,N.uvScale=n.uvScale,o.uvOffset=!x&&H.os?Pp(X,J._buffer.os,H.os,I):n.uvOffset,N.blackout=X._blooming&&!b.data.s("bloom"),o.position=Pp(X,J._buffer.vs,H.vs,I),x?(N.picking=!0,o.pickColor=Pp(X,J._buffer.ps,H.ps,I),N.useColor=!1,o.color=null):(N.picking=!1,o.pickColor=null,H.cs?(N.useColor=!0,o.color=Pp(X,J._buffer.cs,H.cs,I)):(N.useColor=!1,o.color=null)),H.ss?(N.useSizeArray=!0,o.sizeArray=Pp(X,J._buffer.ss,H.ss,I)):(N.useSizeArray=!1,o.sizeArray=null),bj(X,0,H.vs.length/3,X.POINTS),d.useProgram(S),o.disable(),J.shadowMap.enable&&J.shadowMap.createShadow(),J.flowMap.createFlow(N)}}},_asureProgram:function(R){return R._pointsShader||(R._pointsShader=this.gv._postProcessing.createShader(R,dt.shaderSrc)),R._pointsShader.program},dispose:function(){dt.superClass.dispose.call(this);var H=this._startPickId,N=this._lastPointNumber;if(H&&N){for(var w=this.gv.pickColorMap,d=0;N>d;d++){var i=H+d;w[i]&&delete w[i]}delete this._startPickId,delete this._lastPointNumber}}}),dt.shaderSrc="!!~v!oj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<bd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<ts!fvQotjjg!p)s!ng!jn!bu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<ju!dvfoqjtgspfsQnt!jg!mmppbpuc!!tdbm~f!<<o!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<ojp!Qv`omjhg!ps|n!!fctpmpfm!!~v!tf<Doppmjpusv<mp!tbfusu!s+j!czvbusfs!Bwff{dj5t!!d>p!mfp{sj<Tu!owjbpsQz`jmohh!!w|f!d*5z!bwsDspBmfp{sj<Tft!vb)u!ugsjj!cv<uofp!jwufjdt3p!QvwwnP!g+g!tyfjus<ub!Nwobpsjzujdofhk!pwsfqd!3>!!woPpgjgutjftup<Q`m!hv!oj<goppsjnu!jctpppQmw!nq!j+d!lyjjoshu<bN!xbfujuWsmjfcevpunf!!>w!fodp5j!uqjjtdplQDwpnm!ps<<*!1!/v2o!j-gepfsnns!pggmtpobbus!ut!j){5fd<fw!!v>o!jogppjsunj!tgpmQpwbnu!!5sdfftwp!mv<u*j!poop<ju!jvtopjqg!p)s4nd!fcwp!p>m!!evftnfsTpjg{tfoBbsssub!z4<df!wb!uu<s*jucfvtugfg!Pgwmvp)b3ud!ftwj!{>f!Busfstbgzg<Pw!!c~p!pm<!sjptmQpfds!t>q!fsdpumjpwDfwN!bu|s!j*ys)p!mnpbDuf5t!vn)!!*g!j|!f!tsmffu!vs~o!!n<]s!p3m!p^D]l!d4j!q^!!>>!>s!p.m!p2D/w1!<|!!~*ho!jwlpdjjeq!)n!bgjjo!)*|!^#!!~qs~f!dj<tsjppmop!Difjthvigqg!jgem!p>b!us<pm!p$DehfbgsjGo`fm!hV!TF|`!NfBtQmf!!v~o!jg<psspnm!pwDfwd!5>!!esjpgmgpvDthfb<sG!`vmohj!gp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!qi|b!U*fhtouj<ldj!qv)o!jggjp!sn<!ecspbpdmt!jvet!f*DuptmfpUsb<iq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!gj!!vogjjgeposfn$!!cp~p!m!<q*jwdvl!j-oqhb<n!!)vEo3jfgspvsuny!fcup!p>m+!!esjptmdpbDsfetTvfgmgfjdeu!bc<muff<tgg!Pvwo!j>g,p!swnv!!cp<pfmm!bcdmTbwdvl!p+v!ue<spp!DvuoojjgppQs`nm!hw!f>d!3w!vv!w3Tddfbwm!f<|!!*wfbmsczbjuodhf!mwffTde3s!bwdPtgjgetaf!u}<}!h$ojjgl!dejfqgaj)o!fgej)!!V*T!FQ`BNNB`QF!T*V!!)veofjogjpgsfne!!tgbjn$q!mf~s!3E<!*n!bzqu<jd$bfqope!j+g!b/wfptjveg!gnjbej!o-){*z!y|/f!tjvgg!g)jcem!b)d5ldpfvwu!*>!!|s!phmmp`DGfstbvhgDgpjmep!s!|>!!fwtfmdf5!)~1!/1<-*!!1z/u1j-d!b1q/p1!-+!!2b//1s*p<m!psDfwu!v-s{oz<y!/~spm!pwDfwd!5)!5edjfgwg!v>t!fsDppmmppDsf<tv!gjggj!e)!aq|j!d*lsjpomhp!D%f%t!v";var gt=function(E,G){nk(gt,this,[E,G]),this._needRecoverPosition=!0};Ag(gt,$s,{_25Q:1,validate:function(b){var s=this,u=s.data,Y=s.s,X=u.getPoints(),Q=X.size();s.dispatchBoundingBoxChanged();var J=u.p3(),Z=s.mat=dq();oi(Z,J),Vd(Z,u.getFinalRotation3d(),u.getRotationMode());var e=u.getScale3d(),A=u._dynamicScale3d;if(A&&(e[0]*=A[0],e[1]*=A[1],e[2]*=A[2]),yi(Z,e),oi(Z,ad(J)),(!s.s("geometry.cache")||!s.shapeModel)&&(s.shapeModel=s.info=s.lineShapeModel=I,Q>1)){var F=s.info={},V=u.getSegments(),v=u.getThickness(),z=_i(X.get(0)),G=_i(X.get(Q-1)),S=Q%2;0===S?(F.c1=_i(X.get(Q/2-1)),F.c2=_i(X.get(Q/2))):F.p3=_i(X.get((Q-S)/2)),F.s1=z,F.s2=_i(X.get(1)),F.t1=_i(X.get(Q-2)),F.t2=G,F.list=Y(hc)===wb?s.createTubeModel(X,V,v/2,b):s.createLineModel(X,V,v,"shape.border","shape.dash")}},invalidateCachedGeometry:function(){this.shapeModel=this.info=this.lineShapeModel=I},_80o:function(x,X,S){var j=this,_=j.shapeModel;if(_){var $=j.gv;$n($,j.mat),We($,j.data,_,j,j.getBodyColor(),S),Lg($)}}});var ht=A.graph3d.PostProcessing=function(J){function U(){if(!M){var x=J.getGL();M=new Ac.RenderTarget(J,x,null,null,{samples:s.renderTextureSamples||1,minFilter:x.LINEAR,magFilter:x.LINEAR}),n=new Cm.Shader(x,A.vs,A.fs),I=Cm.Buffer.createIndexBuffer(x,new Uint16Array([0,2,1,1,2,3])),m=Cm.Buffer.createVertexBuffer(x,new Float32Array([0,0,1,0,0,1,1,1]))}}var M,n,I,m,t=this,E={},o=!1;!function(){j.keys(ht).forEach(function(P){E[P]=new ht[P](J)})}(),t.getModule=function(u){return u?E[u]:t},t.getModuleList=function(){return j.keys(E)},t._serializable=!0,t.handleDataModleChange=function(s,q){s&&(t._serializable&&s.setPostProcessingData(t.serialize()),s.removeSerializeListener(t.onDataModelSerialize,t)),q&&(q.addSerializeListener(t.onDataModelSerialize,t),t.deserialize(q))},t.onDataModelSerialize=function(T){"serialize"===T.type?t._serializable&&(J.dm()._postProcessingData=t.serialize()):"deserialize"===T.type&&t.deserialize(J.dm())},t.isDeserializeDisabled=function(M){return!t._serializable||M.a("sceneBloom")!==_},t.isSerializable=function(){return t._serializable},t.setSerializable=function(N){t._serializable=N,N||J.dm().setPostProcessingData(_)},t.serialize=function(){var o,T,J,G,O={};for(T in E)if(J=E[T],G=J.serializeProperties){o={},J.enable&&(o.enable=!0);for(var N in G){var M=J[N];M!=G[N]&&(o[N]=M)}j.keys(o).length&&(O[T.toLowerCase()]=o)}return O},t.deserialize=function(r){var K,D,q,M,c,F={},$={};for(K in E){q=E[K],M=q.serializeProperties;var m={},i="scene"+K,A=r.a(i);A!==_&&(m.enable=A);for(var c in M)A=r.a(i+c[0].toUpperCase()+c.slice(1)),A!==_&&A!==M[c]&&(m[c]=A);Ze(m)||($[K[0].toLowerCase()+K.slice(1)]=m)}if(Ze($)&&($=r.getPostProcessingData()),$)for(D in $)if(D&&(K=D[0].toUpperCase()+D.slice(1),q=E[K])){F[K]=!0,M=$[D];var l=!!M.enable;t.enableModule(K,l),K="scene"+K,r.a(K,l),q.resetProperties&&q.resetProperties();for(c in M)if("enable"!==c){var A=M[c];q[c]=A,r.a(K+c[0].toUpperCase()+c.slice(1),A)}}for(K in E)F[K]||(q=E[K],q.enable=!1,q.resetProperties&&q.resetProperties())},t.getRenderTarget=function(){return M},t.blitScreen=function(H,a,o,f,s){var V=J.getGL();if(V){H&&(H.bind(V),J.setViewport(V,0,0,H.width,H.height)),s&&s.clear===!1||V.clear(V.COLOR_BUFFER_BIT|V.DEPTH_BUFFER_BIT),U(),o||(o=n),o.bind(),V.activeTexture(V.TEXTURE0+0),rf(V,a||V._emptyTexture);var c=o.uniforms;c.image=0;var u=1;if(f)for(var Q in f){var $=f[Q];$ instanceof WebGLTexture&&(V.activeTexture(V.TEXTURE0+u),rf(V,$),$=u,u++),c[Q]=$}if(I.upload(),m.upload(),o.attributes.pos.pointer(m),V.drawElements(V.TRIANGLES,6,V.UNSIGNED_SHORT,0),u>1)for(;--u>=0;)V.activeTexture(V.TEXTURE0+u),rf(V,null);else rf(V,null);H&&H.unbind(V)}},t.decodeShader=function(n){var F,i,P,v="",h="";for(P=0;P<n.length;P++)F=n[P],"%"===F?F="'":"a"===F?F='"':"]"===F&&(F="\\"),i=String.fromCharCode(F.charCodeAt(0)-1),P%2?h+=i:v=i+v;return h+v},t.createShader=function(K,u,p){var $,I;if("string"==typeof u){var h=u.indexOf("^#");$=t.decodeShader(u.substr(0,h)),I=t.decodeShader(u.substr(h+2))}else $=u.vs,I=u.fs;if(p){var H=p($,I);H&&H.vs&&($=H.vs),H&&H.fs&&(I=H.fs)}return new Cm.Shader(K,$,I)},t.enableModule=function(z,O){var $,B,d,R=z.split(",");for($=0,B=R.length;B>$;$++)d=R[$].trim(),E[d]&&(E[d].enable=O);o=!1;for(d in E)if(E[d].enable){o=!0;break}o&&U()};var A=t.blitScreenShaderSrc={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};t.render=function(s,W,i,u){if(o){M.setSize(s,W,i),M.bind(s);var T=s.getParameter(s.COLOR_CLEAR_VALUE);T&&0===T[0]&&0===T[1]&&0===T[2]&&0===T[3]?T=null:Il(s,[0,0,0,0]),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),J.setViewport(s,0,0,W,i),u=u||{};var S=u.renderAxis!==!1,Z=u.renderEdit!==!1;u.renderAxis=u.renderEdit=!1,J.renderScene(u),M.unbind(s);for(var r=0,m=J._glCapabilities.maxAttributes;m>r;r++)s.disableVertexAttribArray(r);var V,w=M;for(V in E)w=E[V]._42(s,w)||w;J.setViewport(s,0,0,W,i),T&&Il(s,T);var $=t.getModule("Fxaa");return $&&$.enable?t.blitScreen(null,w.texture,$.getShader(s),{resolution:[1/W,1/i]}):t.blitScreen(null,w.texture),s.useProgram(J._prg),J._renderAxisAndEditHelper(S,Z),!0}}},it=A.graph3d.PostProcessing.HueSaturation=function(u){function A(){$=!0;var F=u.getGL();K=new Ac.RenderTarget(u,F),c=u._postProcessing.createShader(F,it.hueSaturationShader),t=Cm.Buffer.createIndexBuffer(F,new Uint16Array([0,2,1,1,2,3])),y=Cm.Buffer.createVertexBuffer(F,new Float32Array([0,0,1,0,0,1,1,1]))}var t,y,c,K,l=this,e=!1,$=!1,n=[],D=[],R=[];this.serializeProperties={hue:[0,0,0,0,0,0,0],saturation:[0,0,0,0,0,0,0],lightness:[0,0,0,0,0,0,0]},this.resetProperties=function(){var r=this.serializeProperties;for(var G in r)this[G]=r[G]},this.resetProperties(),j.defineProperties(l,{enable:{get:function(){return e},set:function(M){!!e!=!!M&&(e=M,M&&!$&&A(),u.iv())}},hue:{get:function(){return n.map(function(V){return k(180*V)})},set:function(D){if(n!==D&&7===D.length){for(var V=0;7>V;V++)n[V]=D[V]/180;u.iv()}}},saturation:{get:function(){return D.map(function(h){return k(100*h)})},set:function(g){if(D!==g&&7===g.length){for(var R=0;7>R;R++)D[R]=g[R]/100;u.iv()}}},lightness:{get:function(){return R.map(function(Z){return k(100*Z)})},set:function(U){if(R!==U&&7===U.length){for(var i=0;7>i;i++)R[i]=U[i]/100;u.iv()}}}}),l._42=function(G,f){if(e){$||A();var P=f.width,W=f.height;if(P&&W){K.setSize(G,P,W),he(G,K.frame),u.setViewport(G,0,0,K.width,K.height),G.clear(G.COLOR_BUFFER_BIT|G.DEPTH_BUFFER_BIT),c.bind(),G.activeTexture(G.TEXTURE0+0),rf(G,f.texture);var x=c.uniforms;return x.image=0,x.hue=n,x.saturation=D,x.lightness=R,t.upload(),y.upload(),c.attributes.pos.pointer(y),G.drawElements(G.TRIANGLES,6,G.UNSIGNED_SHORT,0),rf(G,null),Ur(G),K}}}};it.hueSaturationShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<<!*w!bs*zfjhoohb!Swtftdf3o!uwiVhwj<m!-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)t!t$feofugijhojfm!`SqBbOnH!F`-B*MfMh!o1bSo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<ti!)voopjjgupbssnv!ugbmtp`bqub!nt!bu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-y!/vmotjig)pfsvni!`gqmbpnb!u!)m4jdhfiwu!o>f!tmtt]iN!BY`~S!BO~H!F^<<lbf!sgcm!pb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!mp<b^us!fiuvofvSpbdo`hffv*i!]|op!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<obS!fjvgi!!)w|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2/|1!<*,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<pg!!~<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!jp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!vs~b!uj~p!oB<mlmb-f!sgcm!pb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!sb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<uo!j~)!!sgpmgp!bu!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!g<m1p!b>u!!fmhjohbisu!oufotjt!Sb<oehmfp*i!t|fs!igum`pfbvui!!wu!b>p!mmgj!hi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!oh<f*<{z!yj/gs!p)mwp!d=)!m1t/i13*ch!ss!f>u!vmstoi!!j4odWfbwm!vf<!*+w!V)ww!!-,f!h2b/n1j*)<E3!ffsmvtufyf!us!f>u!vsspom!pjdo!W5bdmfvwf!!,|!!)*w)!o+j!b)n2!/e1j!p.w!!joW~b!mv<f**m*!<-t!!~-i!)g4mdpfbwu!!oisvvfu3fssh!c)~g!mp<b1u/!7g!20-!!ig!m>p!biu!!g~3!-!<g1m/p7b!u>!,i!vif!*!||!*!1j/g1!!)=i!vif)!!=g!j1!/1*~!!i<vbfu!m,f>E!d2!/01!<*h!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2/|1!*ft!mifv!f~!!.><!b2u/m1f<Ed!!g0m!p*bsu!!.s!fct)<!,!!j1g/!3)!)>7!/i1!!+|!!i*vyfb*N!d=!!>2>/!1h*)!!gsjf!tf!t>m!fg!2~!!,!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!iv<f***!o=j!N2d/!1,*!y!bsNfdt)!!>.!!g13/<3)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!b!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*!+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!!|f!m*tofjN!ds!f?t!!y>b!Ngd2)<!g!js!fuv<s1o/!3s!f0t!<*o!j~Nd!!,w!fydb4N!di)t!m>3!smh!c)w<f*d*4c!!i-thm)*y!b|n!!-wsf)dy4b!ns!h>c!<ybN!dj!gu!b)pimtgm!/z<!*>*>c!!1-/h1)*o!j|n!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g!!~<!cf/mdt!f>!!|c!!ugbmppmbgu!!g<3h</d!!>j!gh!!)uibtpmm/g{!!=<!s1//d6!*>!!sg!3u!b>p!migt!m/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/z<*1</1!!f>m!ttf!u!bgp3m!g>!!i<t1m//2{.!!,>!!iit!mu/bzp!m.g!!it|m!/*zd!!+4!diftwm)/m{t<i3c!hgsm!p4bduf!wg!2!>~!!3/<1c!h+s!!iotsmv/u{f!s.!!g~3!<<*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*<<*!ys/hmct/ih!!->3!gi!v-f23gs)hc";var jt=A.graph3d.PostProcessing.Bloom=function(c){function H(){var $=c.getGL();if($)for(var D=c._postProcessing,l=0;A>l;l++)I[l]=D.createShader($,jt._35Q,function(d,Q){return{fs:Q.replace(/DEFINE_VALUE/g,N[l]).replace("%OVERRIDE_ALPHA_DEFINE%",i?"#define OVERRIDE_ALPHA":"")}})}function a(){var s=c.getWidth(),k=c.getHeight();if(s&&k){F=[s,k],W=!0;var $,g=c.getGL(),N=Math.round(F[0]/2),a=Math.round(F[1]/2);for(Y=new Ac.RenderTarget(c,g,N,a),$=0;A>$;$++)l.push(new Ac.RenderTarget(c,g,N,a)),D.push(new Ac.RenderTarget(c,g,N,a)),N=Math.round(N/2),a=Math.round(a/2);var T=c._postProcessing;d=T.createShader(g,jt._34Q),H(),Q=T.createShader(g,jt._36Q,function(r,F){return{fs:F.replace(/NUM_MIPS/g,A)}}),Z=T.createShader(g,jt.finalShader),J=Cm.Buffer.createIndexBuffer(g,new Uint16Array([0,2,1,1,2,3])),L=Cm.Buffer.createVertexBuffer(g,new Float32Array([0,0,1,0,0,1,1,1]))}}var o,n,G,i,K,J,L,g,q=this,_=!1,W=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0,selective:!1},this.resetProperties=function(){var S=this.serializeProperties;for(var M in S)this[M]=S[M]},j.defineProperties(q,{enable:{get:function(){return _},set:function(m){!!_!=!!m&&(_=m,m&&!W&&a(),c.iv())}},strength:{get:function(){return o},set:function(X){o!==X&&(o=X,c.iv())}},threshold:{get:function(){return n},set:function(J){n!==J&&(n=J,c.iv())}},radius:{get:function(){return G},set:function(b){G!==b&&(G=b,c.iv())}},overrideAlpha:{get:function(){return i},set:function(m){!!i!=!!m&&(i=m,W&&H(),c.iv())}},selective:{get:function(){return K},set:function(B){!!K!=!!B&&(K=!!B,c.iv())}}}),this.resetProperties();var Y,d,Q,Z,F=[256,256],l=[],D=[],A=5,N=[3,5,7,9,11],I=[];q._42=function(p,E){function B(E,V,Z,R){he(p,V.frame),c.setViewport(p,0,0,V.width,V.height),R?R(p):p.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT),S!==E&&E.bind();var m=0;for(var H in Z){var O=Z[H];O instanceof WebGLTexture&&(p.activeTexture(p.TEXTURE0+m),rf(p,O),O=m,m++),E.uniforms[H]=O}for(S!==E&&(J.upload(),L.upload(),E.attributes.pos.pointer(L),S=E),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0);m--;)p.activeTexture(p.TEXTURE0+m),rf(p,null);Ur(p)}if(_&&(W||(a(),W))){var S;if(K){g||(g=new Ac.RenderTarget(c,p)),g.setSize(p,E.width,E.height),g.bind(p);var P=p.getParameter(p.COLOR_CLEAR_VALUE);P&&0===P[0]&&0===P[1]&&0===P[2]&&1===P[3]?P=null:Il(p,[0,0,0,1]),p.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT),c.setViewport(p,0,0,E.width,E.height),p._blooming=!0,c.syncRenderState(),c.renderScene({renderAxis:!1,renderGrid:!1,renderEdit:!1}),p._blooming=!1,P&&Il(p,P),g.unbind(p)}B(d,Y,{smoothWidth:.01,luminosityThreshold:n,tDiffuse:K?g.texture:E.texture});var C,v=Y,w=Math.round(F[0]/2),k=Math.round(F[1]/2);for(C=0;A>C;C++)B(I[C],l[C],{colorTexture:v.texture,direction:[1,0],texSize:[w,k]}),B(I[C],D[C],{colorTexture:l[C].texture,direction:[0,1],texSize:[w,k]}),w=Math.round(w/2),k=Math.round(k/2),v=D[C];return B(Q,l[0],{blurTexture1:D[0].texture,blurTexture2:D[1].texture,blurTexture3:D[2].texture,blurTexture4:D[3].texture,blurTexture5:D[4].texture,bloomStrength:o,bloomRadius:G,bloomTintColor:[1,1,1]}),B(Z,E,{image:l[0].texture},function(c){qb.for(c).glState.blend.apply({enabled:!0,equation:c.FUNC_ADD,func:[c.SRC_ALPHA,c.ONE]})}),qb.for(p).glState.blend.apply({equation:p.FUNC_ADD,func:[p.SRC_ALPHA,p.ONE_MINUS_SRC_ALPHA,p.ONE,p.ONE_MINUS_SRC_ALPHA]}),E}}};jt._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",jt._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",jt._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",jt.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var kt=A.graph3d.PostProcessing.Dof=function(J){function U(){a=!0;var b=J.getGL();Y=new Ac.RenderTarget(J,b),F=J._postProcessing.createShader(b,kt._38Q),n=Cm.Buffer.createIndexBuffer(b,new Uint16Array([0,2,1,1,2,3])),v=Cm.Buffer.createVertexBuffer(b,new Float32Array([0,0,1,0,0,1,1,1]))}function r(u,f,G,L){t=null;var m=u.getCanvas(),T=m.width,g=m.height;if(G=G||1024,T>G||g>G){var q=G/Math.max(T,g);T=Math.round(T*q),g=Math.round(g*q),e||(e=th()),m=z.resizeImage(m,T,g,e)}var F=J.getGL();if(p||(p=F.createTexture()),$=Gg(F,m,p),C=f||.01,d=!0,J.iv(),L--){if(t)return;t=z.callLater(function(){r(u,f,G,L)})}}var Y,F,n,v,$,V,Z,D,e,p,t,M=this,l=!1,a=!1,C=0,d=!1,X=ym.generateUUID();this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var C=this.serializeProperties;for(var q in C)this[q]=C[q]},j.defineProperties(M,{enable:{get:function(){return l},set:function(R){!!l!=!!R&&(l=R,R&&!a&&U(),R||(d=!1),J.iv())}},image:{get:function(){return V},set:function(I){V!==I&&(V=I,d=!1,$&&(J.deleteTexture(X),$=null),J.iv())}},maxblur:{get:function(){return Z},set:function(j){Z!==j&&(Z=j,J.iv())}},aperture:{get:function(){return D},set:function(N){D!==N&&(D=N,J.iv())}}}),this.resetProperties(),M.setImageFromGraphView=function(A,p,e){this.image=null,r(A,p,e,2)},M._42=function(G,N){function S(s,u,V,y){he(G,u.frame),J.setViewport(G,0,0,u.width,u.height),y?y(G):G.clear(G.COLOR_BUFFER_BIT|G.DEPTH_BUFFER_BIT),W!==s&&s.bind();var R=0;for(var Q in V){var F=V[Q];F instanceof WebGLTexture&&(G.activeTexture(G.TEXTURE0+R),rf(G,F),F=R,R++),s.uniforms[Q]=F}for(W!==s&&(n.upload(),v.upload(),s.attributes.pos.pointer(v),W=s),G.drawElements(G.TRIANGLES,6,G.UNSIGNED_SHORT,0);R--;)G.activeTexture(G.TEXTURE0+R),rf(G,null);
Ur(G)}if(l){a||U();var W;if(!$){var T=Gj(this.image);if(!T||!T.comps&&!T.tagName)return N;A.Default.setImage(X,T),$=J.getTexture(X)}var H=N.width,m=N.height;if(H&&m)return Y.setSize(G,H,m),S(F,Y,{tColor:N.texture,tDepth:$,aspect:H/m,aperture:this.aperture,maxblur:this.maxblur,useG2d:d,threshold:C}),Y}}};kt._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vcupypfmu!!v>t,f!Hm3ped<<v*o!j5gspvsmnc!ggpmep!b+u!!*u!iusdfftsisppmdeu<dfvqotjbg!p+s!n*!!g:m3p/b1u.!!n-b:y3c/m1v.s!<)3vdofjwg!p)s!n,!!gzmyp/bwuV!wb!q-fsspumvpsDfu<!)vEo3jfgspvsuny!fgum!p>b,u!!mopfdbs<D*m!j5qs<vmvcogjpgep!s+n!!*g!mupdbfus!sgpbdsuDdmfjqqt<b!v+o!j*g!p1s/n1!!g-m5p/b1u.!!g)p3ddvftw<!)v!o,j!gzpys/nw!Vgwm!p-bsup!mbptDquf!d)uE<3fdspvoutyuf!ug!m>p,b!um!pVdoq<b*d!l5Espvxmoctgdpbem!f+!!>*!!3u6d6f/s!s0p!d3u6d7f/q<t!b0!0+!!1*/!/:23!/.1?!!-g:s3b/d1u.j!p)o3!d)ffwy!d)m!v,e!jzoyh/!w2V*w!d-psoptmup!Dwuf!d)4E!3QfbsdvluGybfduu!p>s,t!!m>p!dwf<d*4!)5!s3v6m7c/g!p+e!!3+6!7*/!!u+d!f3s6s7p/d-u!d3f6q7t/b!!++!!3*6!75//-1!.3!6-71//!1*!<)3ddpfowt!u)!!w,f!dz5y!/VwoVqwb!d-lsGpbmdpuDpus!t)!E>3!fVsovqubydfluE!p>x,o!tmdpbdmf<!*0!!5wsfvdm5c)g!pQeb!d+l!G*b!duudpfssts-p!d2u/d!f*q<tbg!m+p!b*u!!:v3o/q1b.d!l-S:H3C/B1U!p)E3fdqfuwi!))!!d,p!oztyu/!wjVow!!w-fsdp5m!pwD!u*!!)|E3!fssfvuuvysfou!!e>p,u!)m!pwd-!<V*o!q5bsdvlmGcbgdpuep!s+t!!**!<ud~fsgsmppdbuud!fhqftubE!f+q!u*i!)1!/d1p!o-t5u/!1j!o)!3wdffdw3!!)t!d,s!fzfyo/QwpVtwj!u-jsppom!p*D!u|!)\nEs3ffusvvsuoy!fvuo!q>b,d!lmSpHdCB<U*p!E5fsqvumic)g!puef!y+u!v*s!fu3dEf)s!supEdfuqdufiq-t!bt!d+s!f*f!o:Q3p/t1j!u-j:p3o/!1*!!)*3<df~w!g)m!p,b!uz!yq/fwsVtwq!f-dsupjmwpfDEuf!q)uEi3UfpsWvjufyxf[u)!!>d,p!omtpud!j<o*!!g8mspvbmuc!gjpoew!D+m!j*q![u-d!fdspsoptduu!djfoq!tgbm!p+b!u*!!o5f/b1s!--!1d/p1o!t)u3!djfow!!g)m!p,b!uz!yg/bwsV!w*!!-|sp!mspfDuuv!s)oE!3)f!sovfubysf!u+!!>g,b!sm!p*d!0<!*)!!8)s!vgmbcsg!p.e!!o+f!b*s!!u*d!f+s!sjpodwuDdmfjqqt[b!!.+!!g*b!s:!3*/<1.~!-g:m3p/b1u.!!h)f3udWfjwf!x)[!),!!dzpyo/twuV!wj!o-!sgpmmppbDuu!!e)fEq3ufis!v*u!y|fu\n!s>f,u!vmspod!q<f*s!t8qsfvdmucjgwpfeE!f+q!u*i!UupdWfjsfsxp[d)u!deffqqtubi!-+!!o*f!b1s/D1m!j-q5-/!1g.b!s)D3mdjfqw!!*)<!,~!zwyp/jweV!wn!b-jsop)m*p!D|u!w)fEd33f!sevpugycfmuv!s><,!wmfpdd3!<b*t!q8fsdvumdcpgspsef!d+u!!*>!!uwdffds3s)p!d2u/d1f-q!tbbt!q+f!d*u!!:*3</1j!g-!:)3v/t1f.E!f)q3udif*w!!|)!!,g!mzpyb/uw!Vwwj!f-xs[p!m>p!Dhuf!u)WEj3ffxs[v)u!yhffuu!E>f,q!umip)d!w<V*w!!8*s!v*m<cg!pgem!p+b!u*!!gubddfuspssp!d>u!d)f!qgtpbd!v+t!!*,!!5w/j1f.x![-!1*/<1!!)e3pdgfcwm!v)s!!,>!!zwyf/dw3V!w)!!-dsmpbmnpqD)u!!g)bEd3ufpssv!u+y!fbuq!f>s,u!vmspfd-!<.*n!b8yscvmmvcsg-p!en!b+y!c*m!vusd!f*s!s*p<du~dffqmttbf!!+|!*w!f:d35/!1u.f!y-f:m3!/>1!!u)f3ydufvws!f)3!E,)!!zuyE/fwqVuwi!--!swpfmdp3D)uw!V)wE/3yf-s!v2u/y1f!u.!!>w,V!wm/pzd*!<**<!8gsmvpmbcug!pbem!q+i!b*<!ujdgf!s)svptdfuHd3feq*t!b|!+b!m*q!i1b/!1>!!-t1n5p/p1u!i)t3udffqw)!!)u!i,s!fztyi/pwmVew-!!-usipsmfptDiup!m)eE!3,f!s1v/u1y2f-u!!u>f,y!fmmp/db!<**<!8~s!vfmmctgfp!e|!!+b!m*q!iubd!f>s!supfdyufdmf/qbt<b!!~+!!*e!p:g3c/m1v!s-!:>3!/w1f!d)33!d)f!wd!m)b!n,q!)z!yb/mwqViwb!!-+s!pbmqpfDsuu!v)sEf3-f!s.vnubyyfcum!v>s,-!!mnpbdyc<m*v!s:!s*v!m*c<gp~e!w+f!d*3!!uedpfgscsmpvdsu:d!f>q!tebp!g+c!m*v!s8!4+/!11./!:-<62w/f1d!3)!3edpfgwc!m)v!s,8!!z>y!/ewpVgwc!m-vssp!m+p!D1u/!8)<E3wffsdv3u!yefpug!c>m,v!sm5p!d>!<e*p!g:csmvvmsc!g+p!e1!/+5!<*!wufddf5s!sdppdmu!d>f!qwtfbd!5+)!!*1!/612!/*1<.!d-p8m4!/,1>.!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!16/25/!1*!!-+8!4b/t1q!f)d3uddfpws!s)f!d,u!!z*y!/+w!Vewp!g-csmpvmsp!D*u<!)dEp3mf!s,v>u!yuffuy!u>v,s!fm3pEd)!<u*D!p:mspvsm-c!gwpVew!/+y!z*!!,u!d)f!swsfpdd3u)d!f1q/t2b6!-+!!1*/!4884!/*1!!+-!6b2t/q1f.d!u)d3pdsfswf!d)u!!,*!!z+y!/ewpVgwc!m-vssp!m*p<Dud!p)mE!3,f>s!vuufyyfuuv!s>f,3!Em)p!duD<p*m!p:ss-v!mwcVgwp/ey!z+!!,*!!)u!dwffsds3p)d!u1d/f3q:t-b!!1+/!3*:!!8*4!/+1!.b!t-q6f2d/u1d.p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!6+2!/b1t.q!f-d8u4d/p1s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b6t2q/f1d!u-d8p4s/s1f.d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/:yszv!m,c!g)p!ew!f+d!3*)!!u1d/f4s8s-p!d.u1d/f2q6t!b*!!++!!*b!t8q4f/d1u!d-p6s2s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d1f/s3s:p-d!u.d1f/q3t:b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d.f1s/s2p6d-u!d.f1q/t4b8!!+*!!*+!!:b3t/q1f.d!u-d:p3s/s1f.d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d1f/s1s-p!d.u1d/f5q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!s,v!m)c!gwpfed!3+)!!*.!1u/d2f6s-s!p1d/u4d8f!q*t!b+!!+b!t*q!f1d/u1d!p-s5s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!yszv!m,c!g)p!ew!f+d!3*)!!u.d1f/s3s:p-d!u1d/f3q:t!b*!!++!!*b!t6q2f/d1u!d-p8s4s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfs";var lt=A.graph3d.PostProcessing.Blur=function(e){function J(){X=!0;var I=e.getGL();l=new Ac.RenderTarget(e,I),G=e._postProcessing.createShader(I,lt.hBlurShader),d=e._postProcessing.createShader(I,lt.vBlurShader)}var G,d,l,V,v,p,Z,b,f,Y=this,m=!1,X=!1;this.serializeProperties={value:0,downSample:!1,iterations:1,layer:"main"},this.resetProperties=function(){var Z=this.serializeProperties;for(var J in Z)this[J]=Z[J]},j.defineProperties(Y,{enable:{get:function(){return m},set:function(Z){!!m!=!!Z&&(m=Z,Z?e.addRenderLayerListener(h,this):e.removeRenderLayerListener(h,this),Z&&!X&&J(),e.iv())}},downSample:{get:function(){return Z},set:function(F){Z!==F&&(Z=F,e.iv)}},value:{get:function(){return p},set:function(d){p!==d&&(p=d,e.iv())}},iterations:{get:function(){return b},set:function(h){b!==h&&(b=h,e.iv())}},layer:{get:function(){return f},set:function(t){f!==t&&(f=t,e.iv())}}}),this.resetProperties();var h=function(C){if(m&&C.layer===f&&"post"===C.phase){var z=e.getGL();if(!e._picking&&!e.isReflecting(z)){var F=e._postProcessing.getRenderTarget();F.unbind(z);for(var t=0,y=e._glCapabilities.maxAttributes;y>t;t++)z.disableVertexAttribArray(t);Y.drawImpl(z,F),F.bind(z),z.useProgram(e._prg)}}};Y._42=function(){},Y.drawImpl=function(h,C,L,M,m){X||J();var F,S;if(C?(F=C.width,S=C.height):(F=e._viewport[2],S=e._viewport[3]),F&&S){var s=e._postProcessing;"boolean"!=typeof M&&(M=Z),L==I&&(L=p),m==I&&(m=b),m=Math.max(1,Math.round(m));var w=qb.for(h).glState.depth,$=w.enabled;if(w.enabled=!1,M){L/=2;var k=[F,S];F/=2,S/=2,V||(V=new Ac.RenderTarget(e,h),v=s.createShader(h,lt.downSampleShader)),V.setSize(h,F,S),s.blitScreen(V,C.texture,v,{texelSize:[1/k[0],1/k[1]]}),C.setSize(h,F,S)}else V&&V.setSize(0,0);l.setSize(h,F,S);for(var E=[],D=0;m>D;D++)E.push(L),L=Math.max(1,Math.floor(L/2));for(var D=0;m>D;D++){var x=E[m-D-1],H=M&&0===D?V.texture:C.texture;s.blitScreen(l,H,G,{value:x/F}),M&&D===m-1&&C.setSize(h,k[0],k[1]),s.blitScreen(C,l.texture,d,{value:x/S})}return w.enabled=$,C}}};lt.hBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<mb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!,!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm",lt.vBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w!-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/",lt.downSampleShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j1t/j5p!o0!!i*j*h*i1q/!2g!m-p1b/u1<)3!dvfowj!g+p!sfn{!jtTbmnfqymffus!3,E!!wjVnwb!h-ff<hb!nwjb)sEz3jfoshv!uwyffdu3!!w,V!w*<*1!/v2o.j!g-p1s/n1!)w3fddf3w!!u+f!yff{mjTTjm{ffy<fu!!,w!pwjVew!!n-bfjhob)n*j)!E|3f!shvmu`yGfsub!hD,p!m*p*s1!/>1!!)-u1f/y2u.v)s3fd3fEw)!j+n!bfh{fj-T!mwfVywf!u,!!,u!fwyVfwm!T-jf{hfb!n+j!)wEf3df3s)v2u/y1f-u!!1/,1!**";var mt=A.graph3d.PostProcessing.Glitch=function(R){function H(){if(u&&Q){G=Date.now(),g=0,K=1e3*Z(Q[0],Q[1]),N=[];for(var P=1,$=u.length;$>P;P+=2)N.push((P>1?N[N.length-1]:0)+K*u[P]/A)}}function d(){R.redraw()}function F(){W=!0;var Y=R.getGL();B=new Ac.RenderTarget(R,Y),m=R._postProcessing.createShader(Y,mt.Shader);for(var E=v*v,b=ys(v,v),d=b.getImageData(0,0,v,v),V=d.data,l=0;E>l;l++)V[3*l+0]=p(256),V[3*l+1]=p(256),V[3*l+2]=p(256),V[3*l+3]=p(256);b.putImageData(d,0,0),M=Gg(Y,Xj)}var B,m,K,G,g,N,M,o,Q,u,n=this,L=!1,W=!1,Z=ym.randomFloat,p=ym.randomInt,A=0,v=64;this.serializeProperties={onlyReflector:!1,period:[2,3],intensity:[3,.3,1,.1,0,.4]},this.resetProperties=function(){var f=this.serializeProperties;for(var y in f)this[y]=f[y]},j.defineProperties(n,{enable:{get:function(){return L},set:function(T){!!L!=!!T&&(L=T,T&&(H(),W||F()),R.iv())}},onlyReflector:{get:function(){return o},set:function(X){!!o!=!!X&&(o=X,R.iv())}},period:{get:function(){return Q},set:function(U){Q=U,H(),R.iv()}},intensity:{get:function(){return u},set:function(F){F||(F=[1,1]),u=F,A=0;for(var L=1,e=F.length;e>L;L+=2)A+=F[L];H(),R.iv()}}}),this.resetProperties(),n._42=function(w,I){if(L){W||F();var j=!!R.isReflecting(w);if(j===!!o){var e=I.width,Y=I.height;if(e&&Y){var p=R._postProcessing,E=qb.for(w).glState.depth,b=E.enabled;E.enabled=!1,B.setSize(w,e,Y);var k,J=Date.now();J-G>N[g]&&(g++,g>=N.length&&H()),k=u[2*g];var t={seed:Math.random(),byp:k?0:1,tDisp:M};return k&&(t.angle=Z(-Math.PI,Math.PI),t.distortion_x=Z(0,1),t.distortion_y=Z(0,1),t.amount=Math.random()/30*k,t.seed_x=Z(-1,1)*k,t.seed_y=Z(-1,1)*k),p.blitScreen(B,I.texture,m,t),E.enabled=b,requestAnimationFrame(d),B}}}}};mt.Shader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd~j!tj<p*ow!Viwj!h-ifqh!bgnmjp)b!uE<3f!svvoujygfpus>ns!pjmopuD!hcbzsqG<`m!hv!oj|g!pfstnm!ft!bn~q!mf<sx3pEo!tj!n,bshpfm<pD!hvbosjGg`pmshn!!>t!bsnpqmmpfDsh3bEs!Gu`Emjht!q<<*3!/v1o+j*g*p/s1n6!+gemfpfbtu!!+b!ntpzv-oeuf<ft!!v+o!jtgyp)s3nd!fgwm)peboub!sb)o5hdmffw<+u!ovvopjngbp+s/n1!1g3m!p>b!ux!ptoftf!e5<df!wv!ojfgtpjspno!!gemepbb0u0!!tf<f*eb`/yb<hd!!v-ocj/gcpds!n-!hg/mbphbdu!!-tsf/fsed`)z5<df!wv!o>j!gsppsmnp!DghmbpsbGu`!mehj!tu<p*suufjtpgog`py!<.!!qv!o-jfghpbsnnj!)gEm3pfbsuv!ueyjftuu!p>s!ucjdp!o5`dzf<w!!v<o*jqg!p-sfnh!bgnmjp)bEu3!fdspvmu`ytf<u!>!!wbbhsdz!j5odhf!ww!fd<3*!uwfVtwg<gp!!,d!pqo!t-uf!hgbmnpjb)uE!3VfosqvbudylfEup!x>o!tsddb!m5fd!f>w!!36<6*/*!f0m!h3o6b7)/o<jt!!d-p*oftmuh!owbf)dt4p!dQ)b3ddlfGwb!d+u!pusotv!p>n!bw!f>d!4u)f!t3g6g7p/!!3+d!f3w6!7/s!f+e!b3i6t7!/u-g!j3i6t7!/C!H+S!!3n6p7s/g-!!f3t6b7c/0!0*!<<!*d/p6o0teuf!fwtf)d+5z!`Veofqfbtd+lmGbbndsuppos>t,!z>/!qV!oq<b*d/l6E0pexfofttd)b+myf`!e0f!fwtf+dm5b)n!sQpbod>l,Gyb/dqu!ps~t!-!~2!/!<**<y`!ogpmjpubsup!uvtojqeb!d,l!SyH/CqB)U!p.E!f/q2u!i>)!!yd/pqo!tu|!!jfot!mwff!d5~!!w!<*y!`|op!jsufsupvustoj!ee>pyu/)q!!w-|!*V/o1q?bzd`leGfbfdtu)pgsjt!!*|<!*!e~fft!+gtm`pmbpud!.szb`ooep)jwufsdp3u!tdjpe*?|y/!qs!f%u%v!sto`!mgpsdb,dzu`)otpjjou)seppuut)jdep=/yy/zq!)-gwjf!d3~)!23~/!:9<:z9`-o8p9j/u3s4p4u*t*j*e!!+>!!5z4/8q6!9/|6!5f6t4m*f<!!~~!<!*wzp`joep!jnubsjpou)t*j!e|!,!!jzg/)qc)z!q.=!2/*2!!|>!!zw/fqd!3!|q*!/>1!?wyV`we<ff!tg)mgpjb!u!|y!t*!e>f!fgtm+ptp`sm)phdm.`yG`sobphjDupsppsuet/jye!?0z!/1q/!6%*%<!t!`gmmppdb,uy!`zotp!j>u!sgpmuptpjse)=hzm/`qG)sgbjh!Dp<p*s*ee/fzf!t0+!e1f/f6t*+<q!!-gqmtpjbEuu!)o!pEs3nfbsmv!u>y!fvuo)qibudqlfSEHpCUB";var nt=A.graph3d.PostProcessing.Fxaa=function(Y){var Z,O=this,s=!1;j.defineProperties(O,{enable:{get:function(){return s},set:function(z){!!s!=!!z&&(s=z,Y.iv())}}}),O.getShader=function(w){if(Z)return Z;var M=Y.getPostProcessingModule();return Z=M.createShader(w,{vs:M.blitScreenShaderSrc.vs,fs:M.decodeShader(nt.ShaderSourceFs)})},O._42=function(){}};nt.ShaderSourceFs="~!!q<sbf/d*jwtVjwp!o-!fihjbhnijq)!Eg3mfpsbvuu<yf!uv>obj/gsppsmnp!DthbbnsqGm`fmsh3!E!<j*n!bh*f1</1!)v5odjfgwp!sn-!1w/f1d!3!-s1f/t1p!mv-u1j/p1o!<-!4w4b9s1z/j1o!h!-w7f7d23/!1w!Vw-<68/!1$!ef-g*j1o/f1!)G5YdBfBw`!RV-B*M1J/U1Z)`5Qd1f!w2!/1-*!1$/e1f)g5jdoffw!!GY-BoBp`jRuVvBmMpJtUfZs`!Q2-!f2h/b6nj!!$e-ffghjbonfj!!GY-BfBh`bRnVjB!MJ-U*Z1`/Q13)!53d/f1w!!$-ewfVgwj!of)!sGfYeBbBi`TRmVfByMjJQUbZb`yQG4>!s5p/m1pD!h$besfGg`jmohf!!G|Y!B*B)`oRjVbBnM!JeUjZp`wQ!5!~2!3/<1*N!b$nevfmg!j-o{fz!yG/y*bNbtCppqp!m-!ycfpup)mqpU!y$feUfbgbjyoGf)!5GuybbpbmGGmbpbbyuG!!gomspvbuufs!!$e<foghjjoTfi!uGhyobfbmG!m+p!byuj3q!cwvfTdu3ft!g$gePfmgfjyojfq!>G,yzb/bNGtmppqb!u*4o!bwqfTd{4sp!i$!e)fggjj!of<!oGhyjbTbiGumhpobfum5!!+w!fydj5qcv!T$uefftggjgoPfm!fGyyjbqb>T,byu/)Nyt*p!qd!m*bonbqq)Ty{-s!p1i/a1)-g!j2!/1<**I!y$jeqfcgvjto!f-!eGpypbHbuUfftyg!gtPbmnfqymjfqs)3yEbn!>$yejfqgcjvoTfu!fGtygbgbPUmffyyUjpqq!)uub-p!mqG*b!buyfGy!uv<s1f/31E!);u!-u!fqt-g!g1P/m1f*yj!q$!e@f!gojboqfT!eGpypbhb>UefpypPHgugf)tug-g!Pqm-f!ypj-q!!su*b!pumfGybubvysGf!3E<)yuj-q!cqv,T)zpu!j+m!bsv*R-b!b1y/g1!*+!!HGyyjbqbcGvmtp>bIuy!jGqycbvbtM!vunbbp)mGGybbbbyGGm!pb<u65/!1s,h*c*bq*d!S|i!ushfoufvMsoob!qsth.c)b!/+z!<u!t~e)!>GuyfbtbgGgmPpmbfuy5j!qG!yubbbpQmjGybfbmyTGi!be<fGsy)jq!cGvytb!b+G!mGpybjuq3c!vqtp>tH-yj!qGcyvbtb!GumbppbmuG5b!bgyyGb!bD<pQootbpqmTfeQpppthQ!p;t!-Oo!bGqyTbebpUpfhy!!@u!fOyo-pj!uGdyfbsbjUef>yo!bgqyTbebpDppho!tmppmpfC4b7b1yUGf!yF<y*qQCujtbet!O-fOhuPtoef)-oj!nG>yubtbeU!fuyb!pgmyGbbbbDypGo!tp<mQfu4t7e1!U=f!yOFuytqeC>jObotpOjfuhdUfxspj-e!!mGpypbCbbGbmypGb!u3<!iguyhbobfRMvobbmqjtu0z1S/d2q>GqsdbSnifu-ho!fGMyobbbqGtm!pubbup5m!GgbybbybGD!po<tppsmff[SUdMqNGbsnbvnmf!P>qau!-*1!/G1y!b=b!GQmepobFub5n!vgmy)b>bQDopboqtTpempfpShd!qmGpspbCnbfbPyqGu!3-<*!OGuytbeb,GQmuptbeu)5>!iguyhbobfDMpoobtqptm!fu4b7p1mSGdbqbGysGb!nf<Ppqsuf3[-UM!NGbynbvbmG!m>pab!u*!1g/y1b!b=R!vObemojFubznTvvmc)q>jOyo-bq!TGeypbpbhG!mmppbpuC!bgbyybGb!Rv<bzm/jNutzpFqe.hzf/UQitspfqt>iQpumtee-!*!oGbyqbTb{Gsmppibau)!ggjy!bb<Rzv/bOmtjpuqz.Fze/hNftUpiqs>fOtuitpem!e*Nojboq-T{!sGpyibab)Ggmjp!bu<!yg/yNbtbpDqp.oyt/pQmtfpFqe>hQfuTtieb!suqbopfmtGtb-by!GG!yb<byG/mOptbpuq!.gyy/bNbtDppqo>tOpumtfeF!euhbfpUmiGsbfbtyiGp!me~-!!~G!yb~b!Gm<p5bQu`!ZgUyJbMbBDVpRo`tBpBmYfGF!e+h!fzU/iQsOfgtgipp>m,ezN/jQot-pq!!G*yQbfboGpmepab)ug5j!!gy<b5bQD`pZoUtJpMmBfV4R7`1BDBpYoGt!u+E!jys/Q!O*g!g|p>!,Gyy/bQbtGpmqp!b*uQ3f!oqppetaN)<gj!!qp<t*NQ/fyo>pqepat)/!y}<}!!*qOpftoNp/eza>)q>pQtO/fzo<pe!!Gy<b5bQG`mZpUbJuM5B!VsRh`cBzBNY>GG!y+b!bzU/fQyOUgpgqp)>u.fzy/-O!tqppqt!N**O<fo!p$eeaf)ggjjo!f!<m5vQn`bZNU!JsMhBcVzRN`/BzBY!GG!y+b!byG/mQpObgug!pm>v.nyb/TO>tGpyqb!b*MOvfnobp)eGay)bgbjU!fy<Pegfgm)budfTyu-o!fqjpetbNs-h!!G>y?b!b*GQmepobFub3n)v!m1)/t1c-b!>2Q/f1o*p-e!!gy<bebfRmvbbdmTjuuozfSjdeqbGsshb!n>f?/!y*zO*e*o<Fb!nGvymb)btGcmbp>bOuf!ompven!bF<>6G/y1b!b+M!vOnObb)nGvymb.bQUefoyFPbgngv)mu>fQye-o!FqbpntvNm-!!*GQyfbobpGemap)bguj3!)!<26//11-!!+1!/O1O*b-n!vgmy.bObeRovFbbmnjvumz>SOdeqoGFsbbnnvfm/!y*zO*f*o<pe!aG)ygbjb!Gm<p*b*uz!ym/vQntbpOq>!G-yybfbuM)vqnpbU)yGfyUbbbbUyfGy)Pbgngv)Mubfbyy-G!>qQpetoNF-b!nGvymb!b*GQmfpobpue3a))!g1j/!1-<.*2*/z1y*/-O!tgpyqb!b-Ryvfbum)jqupzUSydfqUGbsbbynGf)/bynzv*M*b<by!GG>yObeboGFmbpnbvum!!m*vOnfboXp>eGay)bgbjM!vn|b!)*GQyObfboUpfey)Pggjg!)u<f4yQ-`!ZqUpJtMNB-V!RG`yBbBbYGGm!p+b!uz3/)Q.O2g/g1p->!,1z//1Q*t-p!qg!y*bQbfRovpbemaj)ugzjS!dq<G4sQb`nZfU/JyMzB*V*R<`B!BGYyGb!b+G!myp/bQuO!gngbpy>T,Ny>/nQbtyp)qm!v*nQbfTo-p!emav)ngbjN!*<<*!QGfyobpbeGam)p!b}u}!!n*jOofToNp>enaj)o>)QmOvfnobpTe-!!m<v4nQb`NZ*U<JM!BGVyRb`bBGBmYpGb!u+!!nzb/yQFOTgNg>pn>b.yz)/mOvtnpbqF!-*!OnfboypTeNa*)<gj!!Gy<b4bQG`mZpUbJuM!BnVjRo`FBTBNY>Gn!j+o!)ym/vQnObgFg-p!>n.jyo/TONt*p<q!!*GOyfbobpGemap)bguj!!nb<yeXfOm>bndbTyu)omfvjnebbOs-h!!m>v?n!b*XQ*e<oF!bGnyvbmb)Gtmcpbb>uQ!fnojpoeX!O><nejfom)bmdvTnuboOf-j!embvsnhb!X>*?<!*!OGeyobFbbGnmvpmb)ut!csbb>oOhffoNpbey!>n<b6y/)1n!b+y!XOOO-b!nnvbmy.FQTeNo*F<bn!vGmy>bQbeGomFpbbnuv!ms!b*oQhffoNpjeoa>)ngjjo!)n<j6o/X1O!-+!!nOjOobFnTvNm*.<Oe!oGFybbnbvGmm>pObeuo!Fsbbnovhmf!N*bOyfTodpbemaf)eg>js!bo<h*f*Nzbyy/!Q+t!pgqy!b-byRfvub)mqjpuUzyFfeUhbfbUyiGs)fbtnivpMmbeb<yG!>GQyebobFGbmnpvbmu!!*sQbfoohpfe>as)bgojh!fN<b*y*.zsyb/oOhtfpNqj!o-<yf!uG)yqbpbUGymfpUbbub!ysGb)obhnfvNMbbybDymGb>nOqefoeF>bnnbvym)!g*yObfboRpvebam)jgujz!Fe|h!f*UQiOsffotpiep)mgejN!jo<-3!Qs`bZoUhJfMNBbVyRT`dBbBmYfGe!*+<!z!/GQyObgbgCpp>p,mz!/fQbtspmqz!F*yQjfuo>psebao)hgfj!!=!<s3bQo`hZfUNJbMyBDVmRb`nBqBfYeG<!+!!jyg/)QfObgsgmpz>F,yyj/uQ*tp!qs!f*uQvfsoop!esah)cgzjN!<<!*GQyfbobpGemap)b!u}!}m!v*nObfOoXp>eGay)b>bQMOvfnobp)eG!yb<b3UQf`yZPUgJgM)BuVfRy`-B!BqYpGt!N+-!!zG/yQbObgGgmpp>b.uz3/)O.t2p/q1!-*.O2f/o1p*e-a!)ggyjb!bR<v3bQm`jZuUzJSMdBqVGRs`bBnBfY/Gy!z+*!*y</Q!OGgygbpb>G.myp/bOut!pmqv!n*bOTfFo>pGeyab)bgMjv!nb<)eGfymbbbdUTfuyoPfgjge)busfhy!->!?q!p*tQNe-o!FGbynbvbmG)mtpcbbu>3Q)f!o2p/e1!-!<2e/f1m*b-d!TguyobfbjRevbbsmhj!u>z?S!d*qOGesobFnbfn/vymz)*t*c<b>!OGfyobpbeG!mp<b6u/!1m!v+n!bOOOFb>nGvymb.bQMevonFbb)nGvymb>bQUefoyFPbgngv)mu!f*yQ-f!oqppetaN)-g!jG!yb<b6G/m1p!b+u!3O)O!b2n/v1m-..O2e/o1F*b-n!vgmy>bObeRovFbbmnjvumz!S*dOqfGospbenaf)/gyjz!**<<**!zGyy/bQbtGpmqp!b-uy!fmuv)nqbpTUXy>fGUybbbbyMGv)nbbn)vGMybbbbyUGf>yQPegogF)bunfvym-!!*qQpftoNp-e!aG)ygbjb!Gm<p*b*uz3y)/.O2t/p1q-!!-2y/f1u*)-q!pgUyybfbURbvbbymGj)ubznSvdMqbGbsybGn>fO/eyozF*b*n<vm!!G*yObfboGpmepab)ug!jm!vn|b!O*TQ>OmfvonpbeO),gmjv!nb<T2<Q`!ZGUyJbMbBGVmRp`bBuB!YmGv!n+b!XzF/>QmOvgngbpX>,,mzv/nQbtFp<q!!*GQyfbobpGemap)bguj!!tv<c2qQj`yZSUdJqMSBbVoRh`fB>B2Y/G1!0+s!byo/hQfO<gg!pG>y,byb/GQmtppbqu!!*tQvfcoqpjeyaO)TgXjF!>m<v*nQbfOoTp,emav)n!b}X}F!<*O!fGoypbebaG)m>pQbOuf!ofpeeh!fmIpppsC{b2b>y)G.!3/<12!Q+`!ZmUvJnMbBNV*R,`mBvBnYbGO!T+<!z!/GQyObgbgGpm>p.bzu/!Oftephqf!W*fOsfuo2p>e)a.)3g/j1!!+<!2mQv`nZbUNJ*M,BmVvRn`bBXBFY<G!!+G!yyb/bQGOmgpgbpu>!.myv/nObtOpFqT!F*>OmfvonpbeOaF),gmjv!nb<TeFf<mb!dGTyubobfGjmepbbsuh!!m>v?n!b*OQXeOoFF>bmnvvnmb)OtXc,bm>vQnfboOpFe<!m!pGpyCbbbbGymGp!bu<!effemhbfdITpuso{f3j>e)b.s3h/!1>!?+!!*mOvenobFFb*n,vmmv)ntbcObF>TOFf<op!eG!ymbpbpGCmbpbbyuG!!fe<h6f/W1f!s+u!3O>O)b.n3v/m1>!.+Q!emovFnbbnOv*m,!mv<n6b/O1X!O+F!<OO!bGnyvbmb>G.mOpebouF!bmnvvnmb!OX<T1X/>1m!v=n!bNONXb,nmvvmn>bpTsXf<[U!MGNybbnbvGmm!pmbpup!CmbvbnybGT!XT<FF>ymjvqncbvTtX!,+m!vEnybjTqFc<vt!>GGyybjbqGcmvptb!uu!bfpemhGfbIbpysG{!5><)6b/c1t!)+f!eOhOfbInpvsm{.2N*b!n+v!m3>/N1N*b,nbvcmt!)ufbephmfGIbpbsy{G3!*<<1!/G5y0b1b/G2m!p+b!uu!offejhefbWsfhs>ue5f>m)bbdcTtu)offejhefbWsfhs!uu2b*p!m+G!b3b/y1G*!,b<cTtT)bfnevhmf>WOfOsbun3v*m<!*!OGsyjbbbqGam)pgbju!!f<e*h*fQItppsq{!4->y)f.u3)/q1p!U+y!fmUvbnbbyXG*),bmnvvnMbbObXyTGX><Qe!oGFybbnbvGmm!pubbup!mfGebhbfyWGf!su<4D>y)j.q3c/v1t!!++!!mDvynjbqTc*v,tm>vFnybjTqXcTvFt<!u!bGpymbGbbGbmypGb!u!<f*e*hOftIppqs!{->ybfcut))qfpeUhyffIUpbsb{y4G*),bfnevhMfbIbpysG{>5O<eo!FGbynbvbmG!mupbbpum!GfbebhyfGW!fs<u1>/b4c,t*)DfyejhqfcWvfts+u*41*/,3f.e)h)f>WEfysjuq5c<vt!!GuybbpbmGGmbpbbyuG!!tv<c1qQj`yZOUXJTMXBOVFRT`FB>BmYvGn!b+O!XzT/XQ,Omgvgnpb,OzF/TCFt<pq!>Gzy/bQbtGpmqp!bu<!1mQf`oZhUuJiMTBjVhRo`>BgByYbGb!R+v!bym/jQuOzgSgdpq,Gys/bCntfp/qy><y/!QGtypbqb!Cp<pQmt!piqp!s3{uTbqpbmoG>bfbeyhGf!Ip<s1{Q!`?Z>U!JfMeBhVfRW`fBsBuY<G!!+G!yzb/bQGOmgpgbpu.!zt/vCctqpjqy>Bz>/tOvtcpqqj!yO<T1XQF`!Z+U!J3M/B1V,Rt`vBcBqYjGy!O+X!TyX/OQFOTgFg<p.!yj/gC)tapiqp>sy{/TOqtbpoq*!!m<vOntbpOq>!m3vunbbpXm<Gb!bjygG)!ai<p6s/{1T!q+b!oo*h!jmTvinubhTo>fmmv>n,bzF/<Ct!pjqg!)*iopbsq{TT{qsbpoi*!!)mgfjo!hu<i6T/j1h!o+>!goyhbjbTRivubhmojfumz>S,dyq/GCstbpnqf!/*zo<bq!TG{ysbpbiGam)pgbju!!t<vzc/qfjnybCs>G)qtdvSczqujjymBb!v+R!b)b2y/g1!0;2!31//11*!*@.!m*vonbbqNT<{s!pGiy!b)b>Gzm/pQbOug!ghps!be<jyf/ofunOb>smGvqndbSOz.umjvmnbbvNR<bb!yGgy!b;b!G1m/p1b!u@!!h*sobbeqjTf{osupTi>am)v>nyb/TQ.Omgvgnpb!N<<Q!OGgygbpb!G3mupbbpum!GmbvbnybGO!O><mzv/nNbtOp,qm>vzn/bCNt<pq!!Gy<byb/GNmtppbqu>!ym/vCntbpTqT!>m<vCntbpTq,!m3vunbbpNm<Gb!bGyyGb!bC<p*pfmh!oqbbSjqsdOS>ybjcqtc)vhts!b+e!j*fCoyujOq*c!v?t>)!tbccbt))uhbsTbbebjyfGo>uDTy*j<qc!vGty!bubbGpmmpGbbub!yhGs!be<jofhojuT>inubhyo)fbmc.t>)ohhsjbTeijufhooufOm*!-*!Obscjtb)qh)sgbje!jf<o*u*T",Xi(z,{accordionViewExpandIcon:Yf(or),accordionViewCollapseIcon:Yf(or,!0),accordionViewLabelColor:Ji,accordionViewLabelFont:fl,accordionViewTitleBackground:fk,accordionViewSelectBackground:lf,accordionViewSelectWidth:3,accordionViewSeparatorColor:_,splitViewDividerSize:1,splitViewDividerBackground:fk,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:yk,rect:[2,2,12,12],background:or}]},propertyViewLabelColor:yb,propertyViewLabelSelectColor:Ji,propertyViewLabelFont:fl,propertyViewExpandIcon:Yf(Rd),propertyViewCollapseIcon:Yf(Rd,!0),propertyViewBackground:cg,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Bo,propertyViewColumnLineColor:Bo,propertyViewSelectBackground:lf,listViewLabelColor:yb,listViewLabelSelectColor:Ji,listViewLabelFont:fl,listViewRowLineVisible:!1,listViewRowLineColor:Bo,listViewSelectBackground:lf,treeViewLabelColor:yb,treeViewLabelSelectColor:Ji,treeViewLabelFont:fl,treeViewExpandIcon:Yf(zh),treeViewCollapseIcon:Yf(zh,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Bo,treeViewSelectBackground:lf,treeViewDoubleClickToToggle:!0,tableViewLabelColor:yb,tableViewLabelSelectColor:Ji,tableViewLabelFont:fl,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Bo,tableViewColumnLineColor:Bo,tableViewSelectBackground:lf,treeTableViewLabelColor:yb,treeTableViewLabelSelectColor:Ji,treeTableViewLabelFont:fl,treeTableViewExpandIcon:Yf(zh),treeTableViewCollapseIcon:Yf(zh,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Bo,treeTableViewColumnLineColor:Bo,treeTableViewSelectBackground:lf,tableHeaderLabelColor:yb,tableHeaderLabelFont:fl,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Pn,tableHeaderBackground:cg,tableHeaderMoveBackground:Gl,tableHeaderInsertColor:lf,tableHeaderSortDescIcon:sf(Rd,!0),tableHeaderSortAscIcon:sf(Rd),tabViewTabGap:1,tabViewLabelColor:Ji,tabViewLabelFont:fl,tabViewTabBackground:fk,tabViewSelectWidth:3,tabViewSelectBackground:lf,tabViewMoveBackground:Gl,tabViewInsertColor:lf,toolbarLabelColor:yb,toolbarLabelSelectColor:Ji,toolbarLabelFont:fl,toolbarBackground:cg,toolbarSelectBackground:lf,toolbarItemGap:8,toolbarSeparatorColor:Si},!0);var ot={translateX:1,sortColumn:1},pt={sortable:1,sortOrder:1,sortFunc:1},qt={focusData:1},rt={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},st={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},tt=function(G,n){n.add(G),G.hasChildren()&&G.eachChild(function(t){tt(t,n)})},ut=function(u,H,x,Z,M,o,L,m,J,c,e){var n,F=x.getValueType(c),K=x.getAlign(c);if(x.getEnumValues(c)){var T=x.toEnumLabel(H,c),N=as||0,Y=0,Q=o,p=z.getTextSize(Z,T).width;return n=Gj(x.toEnumIcon(H,c)),n&&(Y=o+as/2,"center"===K?Y+=(m-(N+p))/2:"right"===K&&(Y=Y+m-(N+p)),Te(u,n,Y,L+J/2,c,e),Q=Y+as/2),T!=I&&(n?Pr(u,T,Z,M,Q,L,m-(Q-o),J):Pr(u,T,Z,M,o,L,m,J,K)),void 0}return H=x.formatValue(H),H!=I?F===is?(Eq(u,o,L,m,J,H),void 0):F===mc||!F&&Je(H)?(n=Gj(H?es:Qn),Te(u,n,o+m/2,L+J/2,c,e),void 0):(Pr(u,H,Z,M,o,L,m,J,K),void 0):void 0},vt=function(Z,N){var G=N.view,u=Nb(Z),x=N.column||N.property;G.getDataModel().beginTransaction(),N.editor=Z,Z.info=N,G.setCurrentEditor(Z),G.getView().insertBefore(u,G._79O),zb(Z,N.editorRect),Z.setFocus?Z.setFocus():cf(Z),Z.commitValue=function(v,l){Z._17Q&&(Z=Z._17Q),l||G.setValue(N.data,x,Z.getValue?Z.getValue():Z.value),Z.close&&Z.close(),Hj(u)},x.onEditorCreated&&x.onEditorCreated(N)},wt=function(Y,P,c,N,Q){var M=mk(Y,c),o=P.value,J=P.view,U=Q.getValueType(P.data);return M.onblur=M.onchange=function(){J.endEditing()},"input"===Y?(o=Q.formatValue(o),o!=I&&(M.value=o),M.onkeydown=function(q){dc(q)?J.endEditing():Li(q)&&J.endEditing(!0)},(U===En||U===sh)&&p(M,Ld,z.numberListener)):Y===Ab&&N.forEach(function(t){var v=K.createElement("option");v.innerHTML=Q.toEnumLabel(t),v.value=t,Q.isEnumEqual(o,t)&&(v.selected=!0),Ik(M,v)}),vt(M,P),M},xt=A.widget={},yt=function(h,Y,a){Ag(e+".widget."+h,Y,a)};Xi(sm,{ms_value:function(t){t.getValue=function(h){var z=this.getItemById(h),I=z.element;return Fp(I)?I:I?I.getValue?I.getValue():I.value:z.selected},t.setValue=function(T,J){var N=this.getItemById(T);if(N){var O=N.element;O&&!Fp(O)?O.setValue?O.setValue(J):O.value=J:Je(J)?(N.selected=J,this.iv()):(N.element=J,this.iv())}},t.v=function(Z,y){var L=this;if(2===arguments.length)L.setValue(Z,y);else{if(!qf(Z))return L.getValue(Z);for(var A in Z)L.setValue(A,Z[A])}return L}},_46o:function(V){V._icon=I,V._accessType=I,V._valueType=I,V._editable=!1,V._batchEditable=!0,V._align=iq,V._nullable=!0,V._emptiable=!1,V.setParent=Bs,V.formatValue=function(r){var H=this,h=H._valueType;return H.getEnumValues()?H.toEnumLabel(r):h===mc?!!r:r!=I&&h===En?b(r):r},V.setEnum=function(Q,d,g,c,s,u,B){var H=this;Q&&!gc(Q)&&Q.values&&(c=Q.editable,g=Q.icons,d=Q.labels,s=Q.strict,u=Q.maxHeight,B=Q.dropDownWidth,Q=Q.values),vq(Q)&&(Q=Q._as),vq(d)&&(d=d._as),vq(g)&&(g=g._as),H._enumValues=Q,H._enumLabels=d,H._enumIcons=g,H._enumEditable=c,H._enumStrict=s==I?!0:s,H._enumMaxHeight=u,H._enumDropDownWidth=B,Q&&Q.length&&Cp(Q[0])&&(H._valueType=sh),H.fp("enum",!1,!0)},V.getEnumDropDownWidth=function(){return this._enumDropDownWidth},V.getEnumMaxHeight=function(){return this._enumMaxHeight},V.isEnumEditable=function(){return this._enumEditable},V.getEnumValues=function(){return this._enumValues},V.getEnumLabels=function(){return this._enumLabels},V.getEnumIcons=function(){return this._enumIcons},V.isEnumStrict=function(){return this._enumStrict},V.isEnumEqual=function(d,f){return this._enumStrict?d===f:d==f},V.toEnumLabel=function($,l){var K=this,d=K.getEnumValues(l),a=K.getEnumLabels(l);if(d&&a)for(var M=0;M<d.length;M++)if(K.isEnumEqual($,d[M]))return a[M];return $},V.toEnumIcon=function(h,n){var L=this,$=L.getEnumValues(n),p=L.getEnumIcons(n);if($&&p)for(var D=0;D<$.length;D++)if(L.isEnumEqual(h,$[D]))return p[D];return _}},_45o:function(_){_._87o=function(J,V,f,G,v,R){if(J){var P=this,g=P._90I,A=_k(1);P._columnLineVisible&&(v-=1),P._rowLineVisible&&(R-=1),0>=v||0>=R||(P._90I||(g=P._90I={}),g[V]||(g[V]=new Gc),zb(A,P.tx()+f,P.ty()+G,v,R),Ik(A,J),P._view.insertBefore(A,P._79O),J.onParentAdded&&J.onParentAdded(A),g[V].add(A))}},_._76o=function(){var P=this,C=P._90I;if(C){for(var N in C)C[N].each(function(N){Hj(N)});delete P._90I}},_._77o=function(O){var P=this;if(P._90I){var d=P._90I[O];d&&(d.each(function(N){Hj(N)}),delete P._90I[O])}}},_47o:function(N){N.getValue=function(U,D){return D.getValue?D.getValue(U,D,this):nb(U,D.getAccessType(),D.getName())},N.setValue=function(M,E,T){if(E.isEmptiable(M)||""!==T||(T=_),E.isNullable(M)||T!=I){var i=this,n=E.getName(M),X=E.getAccessType(M),A=E.getValueType(M);A===En&&Fp(T)?T=Fq(T):A===sh&&Fp(T)?T=parseFloat(T):A===mc&&Fp(T)&&(T="true"===T),i._batchEditable&&E._batchEditable&&i.isSelected(M)?i.sm().each(function(R){E.setValue?E.setValue(R,E,T,i):gm(R,X,n,T)}):E.setValue?E.setValue(M,E,T,i):gm(M,X,n,T)}},N.setCurrentEditor=function(e){this.endEditing(),this._currentEditor=e,this.redraw()},N.isEditing=function(M,x){var c=this,R=c._currentEditor;if(!R)return!1;if(x){var s=R.info;return s?(s.column||s.property)===x&&s.data===M:!1}return!0},N.endEditing=function(j){var T=this,P=T._currentEditor;P&&(delete T._currentEditor,P.commitValue&&P.commitValue(P.info,j),T.redraw(),T.getDataModel().endTransaction())},N.beginEditing=function(u){this.endEditing();var m=this,d=u.column||u.property;if(d.beginEditing)d.beginEditing(u);else{var B=u.data,A=u.value,O=m.getSelectBackground(B),V=d.getEnumValues(B),k=d.getSlider(B),f=d.getColorPicker(B);if(k){var o=jq(xt.Slider,k);return o.setValue(A),o.getView().onblur=function(){m.endEditing()},o.isInstant()&&(o.onValueChanged=function(){m.setValue(B,d,o.getValue())}),vt(o,u),void 0}if(f||d.getValueType(B)===is){var j=jq(xt.ColorPicker,f);return j.setValue(A),j.onClosed=function(){m.endEditing()},j.isInstant()&&(j.onValueChanged=function(R,o){m.setValue(B,d,o)}),vt(j,u),j.open(),void 0}if(V){if(xt.ComboBox){var y=new xt.ComboBox;y.setValue(A),y.setValues(V),y.setLabels(d.getEnumLabels(B)),y.setIcons(d.getEnumIcons(B)),y.setEditable(d.isEnumEditable(B)),y.setStrict(d.isEnumStrict(B)),y.setMaxHeight(d.getEnumMaxHeight(B)),y.setDropDownWidth(d.getEnumDropDownWidth(B)),y.onClosed=function(){m.endEditing()},vt(y,u),y.open()}else wt(Ab,u,O,V,d);return}var F=d.getValueType(B);if(F===mc||Je(A))return m.setValue(B,d,!A),void 0;if(d.getItemEditor(B)){var D=_b(d.getItemEditor(B)),g=new D(B,d,m,u),Y=g.getView();return Y._17Q=g,g.setValue(A),oe(Y),vt(Y,u),g.editBeginning&&g.editBeginning(),void 0}wt("input",u,O,I,d)}}},_44o:function(c){c.init=function(F){var S=this,Y=S.th=new Nt(F),s=S._view=nh(1,S);S.tv=S._tableView=F,Ik(s,Y.getView()),Ik(s,F.getView()),Y.mp(function(G){G.property===dj&&S.iv()}),S.iv()},c.getTableView=function(){return this.tv},c.getTableHeader=function(){return this.th},c.getDataModel=function(){return this.tv.dm()},c.getColumnModel=function(){return this.tv.getColumnModel()},c.setColumns=function(B){this.tv.setColumns(B)},c.addColumns=function(T){this.tv.addColumns(T)},c.endEditing=function(){this.tv.endEditing()},c.validateImpl=function(){var V=this,L=V.th,q=zi(L),t={x:0,y:0,width:V.getWidth(),height:q};zb(L,t),t.y=q,t.height=i(0,V.getHeight()-q),zb(V.tv,t)}},ms_vs:function(r){r._41o=function(){return this._29I.height<this._59I},r._43o=function(){var Z=this;Z._41o()&&(Z._58I||(Nq(function(){Z._94O()},zk),Z.iv()),Z._58I=new Date)},r._94O=function(){var z=this;if(z._58I){var f=new Date;f.getTime()-z._58I.getTime()>=zk?(delete z._58I,z.iv()):Nq(function(){z._94O()},zk)}},r._93I=function(){var M=this,h=M._27I;if(M._58I||!M._autoHideScrollBar){h||Ik(M._79O,h=M._27I=_k());var B=M._29I,A=B.height,_=M._59I,v=M.getScrollBarSize(),D=B.width-v-2,S=A*(-M.ty()/_),R=A*(A/_),Y=h.style;_>A?(gl>R&&(S=S+R/2-gl/2,0>S&&(S=0),S+gl>A&&(S=A-gl),R=gl),Y.visibility=Xn,Y.background=M.getScrollBarColor(),Y.borderRadius=v/2+pn,zb(h,D,S,v,R)):Y.visibility=mr}else h&&(h.style.visibility=mr)}},ms_hs:function(b){b._40o=function(){return this._29I.width<this._91I
},b._42o=function(){var I=this;I._40o()&&(I._95O||(Nq(function(){I._94I()},zk),I.iv()),I._95O=new Date)},b._94I=function(){var t=this;if(t._95O){var F=new Date;F.getTime()-t._95O.getTime()>=zk?(delete t._95O,t.iv()):Nq(function(){t._94I()},zk)}},b._92I=function(){var A=this,z=A._28I;if(A._95O||!A._autoHideScrollBar){z||Ik(A._79O,z=A._28I=_k());var m=A._29I,P=m.width,T=A._91I,B=A.getScrollBarSize(),_=m.height-B-2,K=P*(-A.tx()/T),E=P*(P/T),f=z.style;T>P?(gl>E&&(K=K+E/2-gl/2,0>K&&(K=0),K+gl>P&&(K=P-gl),E=gl),f.visibility=Xn,f.background=A.getScrollBarColor(),f.borderRadius=B/2+pn,zb(z,K,_,E,B)):f.visibility=mr}else z&&(z.style.visibility=mr)}}}),Se(es,Lm(16,16,[{type:qk,rect:[1,1,14,14],background:lf},{type:so,rect:[1,1,14,14],width:1,color:Hn},{type:eo,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),Se(Qn,Lm(16,16,{type:so,rect:[1,1,14,14],width:1,color:Hn})),Se(Fm,Lm(16,16,[{type:Zj,rect:[2,2,12,12],borderWidth:1,borderColor:Hn,background:"#FFF"},{type:Zj,rect:[4,4,8,8],background:lf}])),Se(dr,Lm(16,16,{type:Zj,rect:[2,2,12,12],borderWidth:1,borderColor:Hn})),sm._15Q=function(n){n._29I=Uf,n._59I=0,n._91I=0,n._5o=function(I){var F=this;F._30I=new Gc,F._rows=new Gc,F._rowMap={},F._31I=0,F._14I=0,F._view=nh(1,F),F._canvas=th(F._view),Ik(F._view,F._79O=_k()),F.dm(I?I:new Tf)},n.getCheckIcon=function(I){var V=this.sm(),l=V.co(I);return V.sg()?Gj(l?Fm:dr):Gj(l?es:Qn)},n.checkData=function(u){var o=this.sm(),r=o.co(u);o.sg()&&r||(this._32o=1,r?o.rs(u):o.as(u),delete this._32o)},n.getDataAt=function(f){f.target&&(f=this.lp(f));var N=k(f.y/this._rowHeight),z=this._rows;return 0>N||N>=z.size()?I:z.get(N)},n.onDataDoubleClicked=function(){},n.onDataClicked=function(){},n.adjustTranslateX=function(){return 0},n.adjustTranslateY=function(o){var G=this.getHeight()-this._59I;return G>o&&(o=G),o>0?0:b(o)},n.onPropertyChanged=function(r){var G=this,c=r.property;rt[c]?G.ivm():qt[c]||G.redraw(),c===Wm?G._42o():c===mg&&G._43o()},n.getLabel=function(J){return J.toLabel()},n.getLabelFont=function(){return this._labelFont},n.getLabelColor=function(l){var _=this;if(_.isCheckMode()){if(_._focusData===l)return _._labelSelectColor}else if(_.isSelected(l))return _._labelSelectColor;return _._labelColor},n.getStartRowIndex=function(){return this._31I},n.getEndRowIndex=function(){return this._14I},n.getRowDatas=function(){return this._rows},n.getRowIndex=function(g){return this._rowMap[g._id]},n.getRowSize=function(){return this._rows.size()},n.getViewRect=function(){return Tl(this._29I)},n.isVisible=function(L){return this._visibleFunc?this._visibleFunc(L):!0},n.getCurrentSortFunc=function(){return this._sortFunc},n.setDataModel=function(v){var F=this,y=F._dataModel,O=F._selectionModel;y!==v&&(y&&(y.umm(F.handleDataModelChange,F),y.umd(F.handleDataPropertyChange,F),y.umh(F.handleHierarchyChange,F),O||y.sm().ums(F.handleSelectionChange,F)),F._dataModel=v,v.mm(F.handleDataModelChange,F),v.md(F.handleDataPropertyChange,F),v.mh(F.handleHierarchyChange,F),O?O._21I(v):v.sm().ms(F.handleSelectionChange,F),F.fp("dataModel",y,v))},n.validateModel=function(){var m=this;m._rows.clear(),m._rowMap={},m.buildChildren(m._dataModel._roots);var s=m._rows=m._rows.toList(m.isVisible,m),A=0,q=m.getCurrentSortFunc(),r=s.size();for(q&&s.sort(q);r>A;A++)m._rowMap[s.get(A)._id]=A},n.buildChildren=function(m){var H=this;m.each(function(n){H._rows.add(n),H.buildChildren(n._children)})},n.handleDataModelChange=function(){this.ivm()},n.handleDataPropertyChange=function(B){"parent"===B.property?this.ivm():this.invalidateData(B.data)},n.handleHierarchyChange=function(){this.ivm()},n.handleSelectionChange=function(X){X.datas.each(this.invalidateData,this),this.onSelectionChanged(X)},n.onSelectionChanged=function(H){var g=this,q=g.sm();!g.isAutoMakeVisible()||1!==q.size()||"set"!==H.kind&&"append"!==H.kind||g._32o||g.makeVisible(q.ld())},n.handleBackgroundClick=function(A){Uo(A)&&!this.isCheckMode()&&this.sm().cs()},n.makeVisible=function(q){q&&(this._23I=q,this.iv())},n.scrollToIndex=function(Q){var i=this,c=i._29I,N=c.height,n=i._rowHeight,t=n*Q;Q>=0&&Q<i._rows.size()&&N>0&&(t+n>c.y+N?i.ty(-t+N-n):t<c.y&&i.ty(-t))},n.autoScroll=function(f,$){var e=this,g=e._rowHeight,J=g,x=g/4,h=e._29I,_=e.lp(f),a={x:e.tx(),y:e.ty()};return g>0&&h&&(_.x-h.x<J?e.translate(x,0):h.x+h.width-_.x<J&&e.translate(-x,0),_.y-h.y<J?e.translate(0,x):h.y+h.height-_.y<J&&e.translate(0,-x)),a.x=e.tx()-a.x,a.y=e.ty()-a.y,$&&($.x+=a.x,$.y+=a.y),a},n.getTopRowOrderSelection=function(){var S=this.sm().getTopSelection(),A={},l=new Gc;return S.each(function(y){A[y._id]=y}),this._rows.each(function(K){A[K._id]&&l.add(K)}),l},n.getRowOrderSelection=function(){var E=new Gc;return this._rows.each(function(u){this.isSelected(u)&&E.add(u)},this),E},n.ivm=function(){this.invalidateModel()},n.invalidateModel=function(){var c=this;c._96I||(c._96I=1,c._32I=1,delete c._24I),c.iv()},n.redraw=function(){var h=this;h._32I||(h._32I=1,delete h._24I,h.iv())},n.invalidateData=function(W){var $=this;Ek?$.redraw():$._32I||($._24I||($._24I={}),$._24I[W._id]=W,$.iv())},n.getFocusData=function(){return this._focusData},n.setFocusDataById=function(n){this.setFocusData(this.dm().getDataById(n))},n.setFocusData=function(m){var h=this,v=h._focusData;v!==m&&(h._focusData=m,h.fp("focusData",v,m),v&&h.invalidateData(v),m&&(h.invalidateData(m),h.isAutoMakeVisible()&&h.makeVisible(m)))},n.drawRowBackground=function(u,P,i,O,p,N,f){var x=this,z=x.isCheckMode();(P===x._focusData&&z||i&&!z)&&Eq(u,O,p,N,f,x.getSelectBackground(P))},n.drawData=function(U,V,j){var X=this,H=X._rowHeight,c=H*j,E=X._29I,z=E.x,J=E.width;U.save(),U.beginPath(),U.rect(z,c,J,H),U.clip(),X._87o(X.drawRow(U,V,X.isSelected(V),z,c,J,H),j,z,c,J,H),U.restore(),X._rowLineVisible&&Eq(U,z,c+H-1,J,1,X._rowLineColor)},n._12I=function(d){var K=this,i=K._31I,g=K._29I,v=g.x,D=g.y,l=g.width,c=g.height;for(d.beginPath(),d.rect(v,D,l,c),d.clip(),d.clearRect(v,D,l,c),K._76o(),K._93db(d);i<K._14I;i++)K.drawData(d,K._rows.get(i),i);K._92db(d)},n._13I=function(c){for(var y,w=this,E=w._rowHeight,U=w._29I,W=U.x,s=U.width,g=w._31I,j=w._30I;g<w._14I;g++)y=w._rows.get(g),w._24I[y._id]&&j.add({data:y,index:g});j.isEmpty()||(c.beginPath(),j.each(function(z){c.rect(W,z.index*E,s,E)}),c.clip(),j.each(function(I){c.clearRect(W,I.index*E,s,E)}),j.each(function(A){w._77o(A.index)}),w._93db(c),j.each(function(p){w.drawData(c,p.data,p.index)}),w._92db(c),j.clear())},n.preValidateModel=function(){this.endEditing&&this.endEditing()},n.validateImpl=function(){var n=this,T=n._canvas,U=n.getWidth(),f=n.getHeight(),y=n._rowHeight,R=n._32I;(U!==T.clientWidth||f!==T.clientHeight)&&(Pq(T,U,f),R=1),n._96I&&(n.preValidateModel(),n.validateModel());var N=n._29I,W={x:-n.tx(),y:-n.ty(),width:U,height:f},B=n._rows.size(),o=wr(T),c=n._23I;R||Ck(W,N)||(R=1),n._29I=W,n._59I=B*y,n._31I=k(W.y/y),n._14I=L((W.y+W.height)/y),n._31I<0&&(n._31I=0),n._14I>B&&(n._14I=B),n._99I&&R&&n._99I();var P=n.tx(),r=n.ty();(n._40o()||n._41o())&&(n._59I+=n.getScrollBarSize(),n._99I&&R&&(n._91I+=n.getScrollBarSize())),ig&&!Xh&&(o.save(),Ql(o,U/wb.length,f/wb.length,1)),Ql(o,P,r,1),R?n._12I(o):n._24I&&n._13I(o),n._93I(),n._92I(),o.restore(),n._32I=n._24I=n._96I=I,c&&(n.scrollToIndex(n.getRowIndex(c)),delete n._23I),n.tx(n.tx()),n.ty(n.ty())},n.canHandleSelectMode=function(){return!0}},sm._48o=function(n){n._rootVisible=!0,n._rootData=I,n._35o=function(){this._expandMap={},this._levelMap={}},n.validateModel=function(){var D=this,h=D._rootData;D._rows.clear(),D._levelMap={},D._rowMap={},D._currentLevel=0,h?D._rootVisible?D.isVisible(h)&&D.buildData(h):D.buildChildren(h):D.buildChildren(),delete D._currentLevel},n.buildData=function(p){var I=this,W=p._id,F=I._rows;I._rowMap[W]=F.size(),F.add(p),I._levelMap[W]=I._currentLevel,I.isExpanded(p)&&(I._currentLevel++,I.buildChildren(p),I._currentLevel--)},n.buildChildren=function(C){var o=this,N=C?C._children:o._dataModel._roots,F=o.getCurrentSortFunc();F&&o.isChildrenSortable(C)?N.toList(o.isVisible,o).sort(F).each(o.buildData,o):N.each(function(B){o.isVisible(B)&&o.buildData(B)})},n.getLevel=function(C){return this._levelMap[C._id]},n.getToggleIcon=function(z){var P=this,H=P._loader,n=P._collapseIcon;return H&&!H.isLoaded(z)?n:z.hasChildren()?P.isExpanded(z)?P._expandIcon:n:I},n.isCheckMode=function(){return this._checkMode!=I},n.isChildrenSortable=function(){return!0},n.handleDataModelChange=function(e){var c=this;e.kind===Oe?delete c._expandMap[e.data._id]:e.kind===gs&&(c._expandMap={}),c.ivm()},n.toggle=function(f){var Q=this;Q.isExpanded(f)?Q.collapse(f):Q.expand(f)},n.isExpanded=function(n){return 1===this._expandMap[n._id]},n.expand=function($){var v=this,C=v._loader;v.isExpanded($)||(C&&!C.isLoaded($)&&C.load($),v._expandMap[$._id]=1,v.ivm(),v.onExpanded($))},n.onExpanded=function(){},n.collapse=function(p){var q=this;q.isExpanded(p)&&(delete q._expandMap[p._id],q.ivm(),q.onCollapsed(p))},n.onCollapsed=function(){},n.expandAll=function(t){if(t)this.expand(t),t.eachChild(function(B){this.expandAll(B)},this);else{var P=this;P._dataModel.each(function(V){V.hasChildren()&&(P._expandMap[V._id]=1)}),P.ivm()}},n.collapseAll=function(){this._expandMap={},this.ivm()},n.makeVisible=function(F){if(F){var W=this;if(!W._rootData||F.isDescendantOf(W._rootData)){for(var b=F._parent;b;)W.expand(b),b=b._parent;W._23I=F,W.iv()}}},n.checkData=function(c){var Q,D=this,P=D._checkMode,h=D.sm(),J=h.co(c);if(!h.sg()||!J){if(D._32o=1,P===hl)J?h.rs(c):h.as(c);else if(P===ur)Q=new Gc(c),Q.addAll(c._children);else if("descendant"===P)Q=new Gc,tt(c,Q);else if("all"===P&&(Q=new Gc,tt(c,Q),!J))for(var x=c._parent;x;)Q.add(x),x=x._parent;Q&&(J?h.rs(Q):h.as(Q)),delete D._32o}},n.drawTree=function(K,J,N,q,D,E,y){var _=this,d=_._indent,Z=_._levelMap[J._id],F=_.getIconWidth(J),b=Gj(_.getToggleIcon(J));b?(q+=d*Z,Te(K,b,q+d/2,D+y/2,J,_),q+=d):q+=d*(Z+1),_._checkMode&&(Te(K,_.getCheckIcon(J),q+d/2,D+y/2,J,_),q+=d),_.drawIcon(K,J,q,D,F,y),_.drawLabel(K,J,q+F,D,y)}},sm._14Q=function(m){m.getIcon=function(H){return H.getIcon()},m.getIconWidth=function(u){return this.getIcon(u)?this._indent:0},m.drawIcon=function(G,c,Z,Q,F,l){if(F){var _=this,t=_.getBodyColor(c),y=Gj(_.getIcon(c),t);y&&(l-=_.isRowLineVisible()?1:0,cq(G,y,og,Z,Q,F,l,c,_,t),ko(G,_.getBorderColor(c),Z,Q,F,l))}},m.drawLabel=function(U,O,p,h,l){var N=this;Pr(U,N.getLabel(O),N.getLabelFont(O),N.getLabelColor(O),p,h,0,l)}},sm._50o=function(S){S._98I=function(){var P=this,x=P._39o=new Tf;P._60I=new Gc,x.mm(P._17o,P),x.md(P._18o,P),x.mh(P._19o,P)},S.setColumns=function(M){this._39o.clear(),this.addColumns(M)},S.addColumns=function(H){var Y=this._39o;H.forEach(function(x){if(!(x instanceof At)){var P=_b(x.className);x=jq(P?P:At,x)}Y.add(x)})},S.onColumnClicked=function(){},S.onCheckColumnClicked=function(){},S._3Q=function(U){for(var e,r=0,L=this._60I,H=L.size();H>r;r++)if(e=L.get(r),e.column===U)return e;return I},S.getColumnAt=function(w){var J=this._4Q(w);return J?J.column:I},S._4Q=function(k){for(var r=this,O=k.target?r.lp(k).x:k.x,A=r._60I,u=0;u<A.size();u++){var x=A.get(u),z=x.startX;if(O>=z&&O<z+x.column.getWidth())return x}return I},S.getToolTip=function(B){var e=this,y=e.getDataAt(B),b=e.getColumnAt(B);return y&&b?b.getToolTip(y,e):I},S.adjustTranslateX=function(n){var T=this.getWidth()-this._91I;return T>n&&(n=T),n>0?0:b(n)},S._99I=function(){var z=this,u=z._29I,X=z._60I;X.clear(),z._91I=0,z._39o._roots.each(function(R){if(R.isVisible()){var E=z._91I+R.getWidth();z._91I<=u.x+u.width&&E>=u.x&&X.add({column:R,startX:z._91I}),z._91I=E}})},S.drawData=function(Z,o,g){var N=this,t=N._rowHeight,D=t*g,f=N.isSelected(o),h=N._29I,j=h.x,C=h.width;N.drawRowBackground(Z,o,f,j,D,C,t),N._60I.each(function(T){var w=T.column,n=T.startX,V=w.getWidth();V>0&&!N.isEditing(o,w)&&(Z.save(),Z.beginPath(),Z.rect(n,D,V,t),Z.clip(),N._87o(N.drawCell(Z,o,f,w,n,D,V,t),g,n,D,V,t),N._columnLineVisible&&Eq(Z,n+V-1,D,1,t,N._columnLineColor),Z.restore())}),N._rowLineVisible&&Eq(Z,j,D+t-1,C,1,N._rowLineColor)},S.drawCell=function(a,R,U,M,X,q,H,z){var i=this;if(M.drawCell)return M.drawCell(a,R,U,M,X,q,H,z,i);var d=i.getValue(R,M);ut(a,d,M,i.getLabelFont(R,M,d),i.getLabelColor(R,M,d),X,q,H,z,R,i)},S.getColumnModel=function(){return this._39o},S._17o=function(){this.redraw()},S._18o=function(s){var g=this;s.data===g._sortColumn&&pt[s.property]?g.ivm():(g._42o(),g.redraw())},S._19o=function(){this.redraw()},S.getCurrentSortFunc=function(){var r=this,e=r._sortColumn;if(e&&e.isSortable()){var L=e.getSortFunc(),M=de===e.getSortOrder()?1:-1;return L||(L=zm),function(p,d){return L.call(r,r.getValue(p,e),r.getValue(d,e),p,d)*M}}return r._sortFunc},S.isCellEditable=function(D,G,X){return G.isEditable()&&this.isEditable()?G.isCellEditable?G.isCellEditable(D,G,X,this):!0:!1},S._37O=function(K,I){if(Uo(I))for(var g=this,R=g.lp(I),y=g._60I,Y=g._rowHeight,t=g._29I,D=t.x,O=t.y,c=t.width,a=t.height,i=0;i<y.size();i++){var o=y.get(i),Q=o.startX,H=o.column,w=H.getWidth();if(H!==g._31o&&H!==g._4o&&R.x>=Q&&R.x<Q+w&&g.isCellEditable(K,H,I)){var u={x:Q,y:g.getRowIndex(K)*Y,width:w,height:Y},x={x:u.x+g.tx(),y:u.y+g.ty(),width:u.width,height:u.height},v=0,T=0;return u.x<D?v=u.x-D:u.x+u.width>D+c&&(v=u.x+u.width-D-c),v&&(g.tx(g.tx()-v),x.x-=v),u.y<O?T=u.y-O:u.y+Y>O+a&&(T=u.y+Y-O-a),T&&(g.ty(g.ty()-T),x.y-=T),g.beginEditing({data:K,column:H,value:g.getValue(K,H),event:I,rect:u,editorRect:x,view:g}),void 0}}}},xt.BaseItemEditor=function(l,K,X,z){this._data=l,this._column=K,this._master=X,this._editInfo=z},yt("BaseItemEditor",j,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var zt=A.Tab=function(){nk(zt,this)};Og("Tab",Nj,{ms_ac:["view","closable","disabled","visible"],_icon:I,_closable:!1,_disabled:!1,_visible:!0,setParent:Bs});var At=A.Column=function(){nk(At,this)};Og("Column",Nj,{_46o:1,ms_ac:["accessType","valueType",Xn,ug,Vh,fe,"align",is,"sortOrder",hn,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:de,_sortFunc:I,_sortable:!0,_clickable:!0,setWidth:function(d){16>d&&(d=16);var G=this._width;this._width=d,this.fp(fe,G,d)},getToolTip:function(w,M){return this.formatValue(M.getValue(w,this))}});var Bt=A.Property=function(){nk(Bt,this)};Og("Property",Nj,{_46o:1,ms_ac:["accessType","valueType",ug,Vh,"categoryName",is,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:I,getToolTip:function(O,i,b){var c=this;return i?c.formatValue(b.getValue(O,c)):b.getPropertyName(c)}}),xt.AccordionView=function(){var h=this;h._20o={},h._21o=new Gc,h._10o=I,h._9o=I,h._11o=I,h._view=nh(0,h),h.iv()},yt("AccordionView",j,{ms_v:1,ms_fire:1,ms_ac:[ye,kq,"titleHeight",Zc,Dh,"titleBackground","selectWidth",Nf,"orientation","separatorColor"],_expandIcon:z.accordionViewExpandIcon,_collapseIcon:z.accordionViewCollapseIcon,_titleHeight:Bb,_labelColor:z.accordionViewLabelColor,_labelFont:z.accordionViewLabelFont,_titleBackground:z.accordionViewTitleBackground,_selectBackground:z.accordionViewSelectBackground,_selectWidth:z.accordionViewSelectWidth,_orientation:"v",_separatorColor:z.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(C,o,b,F){var z=this,V=_k(),h={content:o,div:V,canvas:th(V),icon:F};if(z._20o[C])throw C+" already exists";var E=h.downEventFunc=function(i){um(i)},c=h.upEventFunc=function(N){um(N),Uo(N)&&(z._10o===C?z.collapse():z.expand(C))};[Zn,Bj].forEach(function(H){p(V,H,E)}),[ws,Qf].forEach(function(r){p(V,r,c)}),V.style.cursor=yn,Ik(z._view,V),z._20o[C]=h,z._21o.add(C),b&&z.expand(C),z.iv()},remove:function(S){var k=this,A=k._20o[S];if(A){var P=A.div;Hj(P),[Zn,Bj].forEach(function(D){g(P,D,A.downEventFunc)}),[ws,Qf].forEach(function($){g(P,$,A.upEventFunc)}),delete k._20o[S],k._21o.remove(S),k.iv()}},clear:function(){var V=this;V._21o.toArray().forEach(V.remove,V),V._20o={},V._21o.clear(),V.iv()},isExpanded:function(k){return this._10o===k},expand:function(C){var c=this;c._20o[C]&&c._10o!==C&&(c._10o=C,c.onExpanded(C),c.iv())},onExpanded:function(){},collapse:function(){var v=this;v._10o&&(v.onCollapsed(v._10o),delete v._10o,v.iv())},onCollapsed:function(){},initCanvas:function(Y,U,J){Pq(Y,U,J);var B=wr(Y);return Ql(B,0,0,1),B.clearRect(0,0,U,J),B},drawTitle:function(F,N,n,z,u){var M=this,C=Gj(u.icon),s=M.isExpanded(N),j=M._titleHeight,Z=M._titleBackground,G=M._selectWidth,U=M._separatorColor,o=Gj(s?M._expandIcon:M._collapseIcon),k=G+4;Eq(F,0,0,n,z,Z),s&&G&&Eq(F,0,0,G,z,M._selectBackground),(s||M._21o.get(M._21o.size()-1)!==N)&&Eq(F,0,z-1,n,1,U?U:tk(Z)),C&&(Te(F,C,k+bi(C)/2,j/2),k+=bi(C)+2),Pr(F,N,M.getLabelFont(N),M.getLabelColor(N),k,0,0,j),o&&Te(F,o,n-bi(o)/2-4,j/2)},validateImpl:function(){var s=this,u=s._view,H=0,c=0,R=s.getWidth(),K=s.getHeight(),U=s._titleHeight,z=s._21o.size()*U,g=s._11o,O=s._9o;delete s._11o,delete s._9o,s._21o.each(function(S){var x,P,Y=s._20o[S],q=Y.content,N=s._10o===S;Im(s)?(zb(Y.div,H,0,U,K),x=s.initCanvas(Y.canvas,U,K),Fi(x,0,K),Gd(x,-Rg),s.drawTitle(x,S,K,U,Y),x.restore(),N?(P=i(0,R-z),q&&(s._11o=q,s._9o=Nb(q),zb(q,H+U,0,P,K)),H+=U+P):H+=U):(zb(Y.div,0,c,R,U),x=s.initCanvas(Y.canvas,R,U),s.drawTitle(x,S,R,U,Y),x.restore(),N?(P=i(0,K-z),q&&(s._11o=q,s._9o=Nb(q),zb(q,0,c+U,R,P)),c+=U+P):c+=U)});var W=s._9o;g&&g!==s._11o&&g.endEditing&&g.endEditing(),W&&W!==O&&Ik(u,W),O&&O!==W&&Hj(O)}}),xt.SplitView=function(c,U,x,F){var L=this,y=L._dividerDiv=_k(),D=L._60O=th(),R=L._61O=th(),N=D.style,p=R.style;L._view=nh(1,L),Ik(L._view,y),N.msTouchAction=nf,N.pointerEvents=nf,N.cursor=yn,p.msTouchAction=nf,p.pointerEvents=nf,p.cursor=yn,c&&L.setLeftView(c),U&&L.setRightView(U),x&&L.setOrientation(x),F!=I&&L.setPosition(F),L.setStatus(Rh),new Ct(L)},yt("SplitView",j,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:z.splitViewDividerSize,_dividerBackground:z.splitViewDividerBackground,_dragOpacity:z.splitViewDragOpacity,_toggleIcon:z.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(v,w){var S=this,d=S._position;isNaN(v)||(w||(S._82O=0>v?-1:v>1?1:0),S._position=v,S.fp(se,d,v))},getLeftView:function(){return this._leftView},setLeftView:function(F){var b=this,Q=b._leftView,j=b._view;if(b._leftView!==F){if(Q&&Q!==b._rightView){var q=Nb(Q);q.parentNode===j&&Hj(q)}if(b._leftView=F,F){var R=Nb(F);R.parentNode!==j&&j.insertBefore(R,b._dividerDiv)}b.fp("leftView",Q,F)}},getRightView:function(){return this._rightView},setRightView:function(S){var q=this,g=q._rightView,r=q._view;if(q._rightView!==S){if(g&&g!==q._leftView){var I=Nb(g);I.parentNode===r&&Hj(I)}if(q._rightView=S,S){var U=Nb(S);U.parentNode!==r&&r.insertBefore(U,q._dividerDiv)}q.fp("rightView",g,S)}},validateImpl:function(){var r=this,c=r._draggable,u=r._position,q=r.getWidth(),I=r.getHeight(),G=r._dividerSize,F=r._dividerBackground,H=to?18:8,U=r._dividerDiv,v=r._82O,L=r._60O,p=r._61O,Q=r._toggleIcon,f=r._status,Y=U.style,$=null,O=to?20:4,x=Q.comps[0];G>=H||0===G?r._coverDiv&&(Hj(r._coverDiv),delete r._coverDiv):r._coverDiv||(r._coverDiv=_k(),jn&&(r._coverDiv.style.background=ql),Ik(U,r._coverDiv)),r._togglable?L.parentNode||(Ik(U,L),Ik(U,p)):(Hj(L),Hj(p));var n=r._coverDiv,k=r._leftView,M=r._rightView;if(Im(r)){if(G>q&&(G=q),f===Rh)if(1===v)var w=a(u,q),P=i(0,q-G-w);else-1===v?(P=a(-u,q),w=i(0,q-G-P)):(w=b((q-G)*u),P=i(0,q-G-w));else"cl"===f?(w=0,P=i(0,q-G)):"cr"===f&&(P=0,w=i(0,q-G));k&&zb(k,0,0,w,I),M&&zb(M,w+G,0,P,I),zb(U,w,0,G,I),r._22o=w,n&&(zb(n,G/2-H/2,0,H,I),n.style.cursor=c?rh:""),U.style.cursor=c?rh:"";var T=U.clientHeight/2,N=U.clientWidth;Pq(L,N,N),zb(L,0,T-N-O,N,N),$=wr(L),Ql($,0,0,1),x.rotation=-Rg,jp($,Q,0,0,N,N),$.restore(),Pq(p,N,N),zb(p,0,T+O,N,N),$=wr(p),Ql($,0,0,1),x.rotation=Rg,jp($,Q,0,0,N,N),$.restore()}else{if(G>I&&(G=I),f===Rh)if(1===v)var y=a(u,I),l=i(0,I-G-y);else-1===v?(l=a(-u,I),y=i(0,I-G-l)):(y=b((I-G)*u),l=i(0,I-G-y));else"cl"===f?(y=0,l=i(0,I-G)):"cr"===f&&(l=0,y=i(0,I-G));k&&zb(k,0,0,q,y),M&&zb(M,0,y+G,q,l),zb(U,0,y,q,G),r._22o=y,n&&(zb(n,0,G/2-H/2,q,H),n.style.cursor=c?Vq:""),Y.cursor=c?Vq:"";var J=U.clientWidth/2,N=U.clientHeight;Pq(L,N,N),zb(L,J-N-O,0,N,N),$=wr(L),Ql($,0,0,1),x.rotation=0,jp($,Q,0,0,N,N),$.restore(),Pq(p,N,N),zb(p,J+O,0,N,N),$=wr(p),Ql($,0,0,1),x.rotation=h,jp($,Q,0,0,N,N),$.restore()}Y.background=F}});var Ct=function(W){this.sv=W,this.addListeners()};Ag(Ct,j,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(K){var L=this,F=L.sv,j=F._dividerDiv,i=F._60O,C=F._61O,N=F._status,U=K.target;if(U===i)N===Rh?F.setStatus("cl"):"cr"===N&&F.setStatus(Rh);else if(U===C)N===Rh?F.setStatus("cr"):"cl"===N&&F.setStatus(Rh);else if(jf(K)&&(U===j||U===F._coverDiv)&&(um(K),F.isDraggable())){F.getLeftView(),F.getRightView();var X=L.maskDiv=_k();if(X.style.left=0,X.style.top=0,X.style.width=F.getWidth()+"px",X.style.height=F.getHeight()+"px",F.getView().appendChild(X),!F.isContinuousLayout()){var G=L.resizeDiv=_k();G.style.left=j.style.left,G.style.top=j.style.top,G.style.width=j.style.width,G.style.height=j.style.height,G.style.opacity=F.getDragOpacity(),G.style.background=F.getDividerBackground(),Ik(L.getView(),G)}L._lastAbsPosition=F._22o,L._86o=Im(F)?Xe(K).x:Xe(K).y,Fd(L,K)}},handleWindowTouchMove:function(N){jf(N)&&this.update(N,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(O){var r=this;r.update(O,!0),r.sv.setStatus(Rh),r.maskDiv&&Hj(r.maskDiv),r.resizeDiv&&Hj(r.resizeDiv),r.maskDiv=r.resizeDiv=I},handle_mousedown:function(V){Uo(V)&&this.handle_touchstart(V)},handleWindowMouseMove:function(b){this.handleWindowTouchMove(b)},handleWindowMouseUp:function(X){this.handleWindowTouchEnd(X)},update:function(k,v){var H=this,B=H.sv,f=Im(B)?B.getWidth():B.getHeight(),_=B._dividerSize,C=H._lastAbsPosition-H._86o;Im(B)?(C+=Xe(k).x,C>f-_&&(C=f-_),0>C&&(C=0),H.resizeDiv&&(H.resizeDiv.style.left=C+pn)):(C+=Xe(k).y,C>f-_&&(C=f-_),0>C&&(C=0),H.resizeDiv&&(H.resizeDiv.style.top=C+pn)),v&&f!==_&&(1===B._82O?B.setPosition(C,1):-1===B._82O?B.setPosition(C-f+_,1):B.setPosition(C/(f-_),1))}}),xt.TabView=function(){var b=this,m=b._view=nh(1,b),k=b._91O=_k(1),G=b._tabModel=new Tf,X=G.sm(),Q=b.invalidate;b._7o=new Gc,b._canvas=th(k),Ik(m,k),Ik(m,b._92O=_k(1)),X.setSelectionMode(hm),X.ms(b.handleSelectionChange,b),G.mm(Q,b),G.mh(Q,b),G.md(Q,b),b._interactor=new Dt(b),b.iv()},yt("TabView",j,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Zc,Dh,"tabHPadding","tabBackground","selectWidth",Nf,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:wg,_tabHeight:Bb,_tabGap:z.tabViewTabGap,_labelColor:z.tabViewLabelColor,_labelFont:z.tabViewLabelFont,_tabBackground:z.tabViewTabBackground,_selectWidth:z.tabViewSelectWidth,_selectBackground:z.tabViewSelectBackground,_moveBackground:z.tabViewMoveBackground,_insertColor:z.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(F,m,r){var j,G=this._tabModel;return F instanceof zt?(j=F,m&&j.setView(m)):(j=new zt,j.setName(F),j.setView(m)),G.add(j),r&&G.sm().ss(j),j},getLabel:function(g){return g.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(b){this._23o=b,this.iv()},get:function(R){var l=this,u=l._tabModel;if(Cp(R))return u._roots.get(R);if(Fp(R)){var Q;return u.each(function(F){R===l.getLabel(F)&&(Q=F)}),Q}return R instanceof zt?R:I},select:function(i){this._tabModel.sm().ss(this.get(i))},remove:function(m){var j=this;if(m=j.get(m)){var l=j._tabModel,o=l._roots.indexOf(m);j._tabModel.remove(m),j.selectByIndex(--o)}},getCurrentTab:function(){return this._8o},hideTabView:function(o,r){r.parentNode===this._92O&&(xd(r)?(r.style.display=ne,r._tab_=o):Hj(r),Tk())},showTabView:function(k,I){xd(I)&&(I.style.display="block",I._tab_=k),I.parentNode!==this._92O&&(Ik(this._92O,I),Tk())},_24o:function(){var Q,r=this,S=r._8o,v=r._9o,$=r._tabModel.sm().ld();$&&(Q=Nb($.getView())),Q!==v&&(v&&(S.getView()&&S.getView().endEditing&&S.getView().endEditing(),r.hideTabView(S,v)),Q&&r.showTabView($,Q)),r._8o=$,r._9o=Q,S!==$&&r.onTabChanged(S,$)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(R,r){this.selectByIndex(--r)},selectByIndex:function(Y){var p=this,y=p._tabModel,B=y.size();if(B&&!y.sm().ld()){Y==I&&(Y=0),Y>=B&&(Y=B-1),0>Y&&(Y=0);for(var _=Y;_>=0;_--){var Z=p.get(_);if(!Z.isDisabled())return p.select(Z),Z}for(_=Y+1;B>_;_++)if(Z=p.get(_),!Z.isDisabled())return p.select(Z),Z}},getTabWidth:function(b){var H=this.getTabHPadding(),J=4+2*H,K=Gj(b.getIcon());K&&(J+=bi(K,b)+4);var O=this.getLabel(b);return O&&(J+=me(this.getLabelFont(b),O).width+4),b.isClosable()&&(J+=10),J},drawTab:function(Q,k,G,p,T,x,L){var z,_=this,V=_._tabPosition,g=this.getTabHPadding(),t=G+4+g,S=_._selectWidth,f=Gj(k.getIcon()),R=k.isDisabled(),q=_.getLabelColor(k),v=_.getLabelFont(k),s=_.getLabel(k),O=_._selectBackground,I=V===iq+"-vertical",D=V===bq+"-vertical";(I||D)&&(t=p+4+g),R&&(Q.globalAlpha=If),Eq(Q,G,p,T,x,L),k===_._8o&&S&&(V===wg?Eq(Q,G,p+x-S,T,S,O):V===iq?Eq(Q,G+T-S,p,S,x,O):V===bq?Eq(Q,G,p,S,x,O):I?Eq(Q,G+T-S,p,S,x,O):D?Eq(Q,G,p,S,x,O):Eq(Q,G,p,T,S,O));var Y=T/2;if(I&&(Fi(Q,Y,p+x/2),Gd(Q,h),Fi(Q,-Y,-p-x/2)),f){var $=Eg(f,k),m=bi(f,k);if(I||D){var W=G+T/2,y=t+$/2;Fi(Q,W,y),Gd(Q,Rg),Fi(Q,-W,-y),Te(Q,f,G+T/2,t+$/2,k,_),Fi(Q,W,y),Gd(Q,-Rg),Fi(Q,-W,-y),t+=$+4}else Te(Q,f,t+m/2,p+x/2,k,_),t+=m+4}return I||D?(Fi(Q,T/2,t+T/2),Gd(Q,Rg),Fi(Q,-T/2,-t-T/2),Pr(Q,s,v,q,G,t,x,T),Fi(Q,T/2,t+T/2),Gd(Q,-Rg),Fi(Q,-T/2,-t-T/2)):Pr(Q,s,v,q,t,p,T,x),I&&(Fi(Q,Y,p+x/2),Gd(Q,-h),Fi(Q,-Y,-p-x/2)),k.isClosable()&&(z=D?{x:G+T-12,y:p+x-12,width:12,height:12}:{x:G+T-12,y:p+2,width:12,height:12},this.drawCloseIcon(k,Q,q,z)),R&&(Q.globalAlpha=1),z},drawCloseIcon:function(I,G,t,_){var M=_.x,w=_.y;G.strokeStyle=t,G.lineWidth=1,G.beginPath(),G.moveTo(M+2,w+8),G.lineTo(M+8,w+2),G.moveTo(M+8,w+8),G.lineTo(M+2,w+2),G.stroke()},getTabAt:function(j){var C=this._interactor._8Q(j);return C?C.tab:null},validateImpl:function(){var n=this;n._24o();var d,P=n._canvas,x=n._tabPosition,D=n._91O,Y=n._92O,h=n._tabModel,N=n.getWidth(),K=n.getHeight(),F=n._tabHeight,y=n._7o,s=n._tabGap,Z=x===wg,E=x===iq,e=x===bq,J=x===iq+"-vertical",l=x===bq+"-vertical",g=n._23o,a=0;if((E||e)&&h._roots.each(function(l){a=i(n.getTabWidth(l),a)}),Z?(zb(D,0,0,N,F),d={x:0,y:F,width:N,height:i(0,K-F)}):E?(zb(D,0,0,a,K),d={x:a,y:0,width:i(0,N-a),height:K}):e?(zb(D,N-a,0,a,K),d={x:0,y:0,width:i(0,N-a),height:K}):J?(zb(D,0,0,F,K),d={x:F,y:0,width:i(0,N-F),height:K}):l?(zb(D,N-F,0,F,K),d={x:0,y:0,width:i(0,N-F),height:K}):(zb(D,0,K-F,N,F),d={x:0,y:0,width:N,height:i(0,K-F)}),zb(Y,d),J||l){n._9o&&(d.x=0,zb(n._8o.getView(),d)),Pq(P,F,K);var j=wr(P),C=0;if(Ql(j,0,n.ty(),1),j.clearRect(0,0,F,K),y.clear(),h._roots.each(function(o){if(o.isVisible()){var S,G=n.getTabWidth(o);if(!g||g.tab!==o){var P=n.getTabBackground(o);S=n.drawTab(j,o,0,C,F,G,P)}y.add({_75o:S,tab:o,startY:C,endY:C+G,height:G}),C+=G+s}}),n._23Q=i(0,C-s),g){var t=g.position;n.drawTab(j,g.tab,0,g.startY,F,g.height,n._moveBackground),Eq(j,0,t,F,1,n._insertColor)}if(j.restore(),n._selectionChanged){n._selectionChanged=!1;for(var m=n.ty(),$=0;$<y.size();$++){var p=y.get($);if(p.tab===n._8o){if(p.endY+m<0){n.ty(-p.startY);break}if(p.startY+m>K){n.ty(K-p.endY);break}}}}n.ty(n.ty())}else if(E||e){n._9o&&(d.x=0,zb(n._8o.getView(),d)),Pq(P,a,K);var j=wr(P),C=0;if(Ql(j,0,n.ty(),1),j.clearRect(0,0,a,K),y.clear(),h._roots.each(function(X){if(X.isVisible()){var U;if(!g||g.tab!==X){var z=n.getTabBackground(X);U=n.drawTab(j,X,0,C,a,F,z)}y.add({_75o:U,tab:X,startY:C,endY:C+F,height:F}),C+=F+s}}),n._23Q=i(0,C-s),g){var t=g.position;n.drawTab(j,g.tab,0,g.startY,a,g.height,n._moveBackground),Eq(j,0,t,a,1,n._insertColor)}if(j.restore(),n._selectionChanged){n._selectionChanged=!1;for(var m=n.ty(),$=0;$<y.size();$++){var p=y.get($);if(p.tab===n._8o){if(p.endY+m<0){n.ty(-p.startY);break}if(p.startY+m>K){n.ty(K-p.endY);break}}}}n.ty(n.ty())}else{n._9o&&(d.y=0,zb(n._8o.getView(),d)),Pq(P,N,F);var j=wr(P),k=0;if(Ql(j,n.tx(),0,1),j.clearRect(0,0,N,F),y.clear(),h._roots.each(function(h){if(h.isVisible()){var H,R=n.getTabWidth(h);if(!g||g.tab!==h){var L=n.getTabBackground(h);H=n.drawTab(j,h,k,0,R,F,L)}y.add({_75o:H,tab:h,startX:k,endX:k+R,width:R}),k+=R+s}}),n._64I=i(0,k-s),g){var t=g.position;n.drawTab(j,g.tab,g.startX,0,g.width,F,n._moveBackground),Cg(j,n._insertColor,t,0,F)}if(j.restore(),n._selectionChanged){n._selectionChanged=!1;for(var L=n.tx(),$=0;$<y.size();$++){var p=y.get($);if(p.tab===n._8o){if(p.endX+L<0){n.tx(-p.startX);break}if(p.startX+L>N){n.tx(N-p.endX);break}}}}n.tx(n.tx())}for(var G=[],c=Y.children,$=0;$<c.length;$++){var o=c[$],r=o._tab_;r&&!h.contains(r)&&G.push(o)}G.forEach(function(V){Y.removeChild(V)})}});var Dt=function(B){this.tv=B,this.addListeners()};Ag(Dt,j,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(n){this.handleScroll(n,10*(n.wheelDelta/40))},handle_DOMMouseScroll:function(g){this.handleScroll(g,10*-g.detail)},handleScroll:function(j,V){um(j);var O=this.tv,k=O._tabPosition;!O._40o()||k!==wg&&k!==wn||O.tx(this.tv.tx()+V),!O._41o()||k!==iq&&k!==bq&&k!==iq+"-vertical"&&k!==bq+"-vertical"||O.ty(this.tv.ty()+V)},_8Q:function($){var k,A,O=this.tv,G=O._tabPosition,y=O._7o;if(G===wg||G===wn){var Q=O.lp($).x;for(k=0;k<y.size();k++)if(A=y.get(k),A.startX<=Q&&Q<=A.endX)return A}else if(G===iq||G===bq||G===iq+"-vertical"||G===bq+"-vertical"){var m=O.lp($).y;for(k=0;k<y.size();k++)if(A=y.get(k),A.startY<=m&&m<=A.endY)return A}return I},isClickable:function(M){var m=this.tv,w=m._tabPosition,j=this._73o=this._8Q(M);return!m._40o()||w!==wg&&w!==wn?!m._41o()||w!==iq&&w!==bq&&w!==iq+"-vertical"&&w!==bq+"-vertical"?j&&(!j.tab.isDisabled()||m.isMovable()):!0:!0},handle_mousemove:function(s){var a=this;Lq?a._74o=a._8Q(s):a.getView().style.cursor=a.isClickable(s)?yn:""},handle_mousedown:function(F){this.handle_mousemove(F),this.handle_touchstart(F)},handle_touchstart:function(K){var i=this,A=i.tv,p=A._tabPosition;um(K),Uo(K)&&i.isClickable(K)&&(p===wg||p===wn?(i.x=Xe(K).x,i.lp=A.lp(K),i.tx=A.tx()):(i.y=Xe(K).y,i.lp=A.lp(K),i.ty=A.ty()),Fd(i,K))},handle_mouseup:function(S){this.handle_touchend(S)},handle_touchend:function(C){if(fh(C)){var t=this._73o;if(!t)return;var L=this.tv,h=L.getTabModel(),A=t.tab;if(!A.isDisabled()&&A.isClosable()){var u=function(){var y=h._roots.indexOf(A);h.remove(A),L.onTabClosed(A,y)};L.onTabClosing(A,u)&&u()}}},handleWindowMouseMove:function(u){this.handleWindowTouchMove(u)},handleWindowTouchMove:function(T){var s,h=this,Q=h.tv,l=Q._tabPosition,_=h._73o;if(l===wg||l===wn){if(s=Xe(T).x-h.x,!h._25o&&!h.moving&&f(s)>2&&(Q._40o()&&!Ro(T)?h._25o=1:_&&Q.isMovable()&&(h.moving=1)),h._25o)Q.tx(h.tx+s);else if(h.moving){var P=h.lp.x+s,z=Q._tabGap/2;Q._7o.each(function(B){var u=B.endX,q=P-B.startX<u-P;P>=B.startX&&u>=P&&Q._7Q({tab:_.tab,startX:_.startX+s,width:_.width,front:q,insertTab:B.tab,position:q?i(0,B.startX-z):a(Q._64I,u+z)})})}}else if(s=Xe(T).y-h.y,!h._25o&&!h.moving&&f(s)>2&&(Q._41o()&&!Ro(T)?h._25o=1:_&&Q.isMovable()&&(h.moving=1)),h._25o)Q.ty(h.ty+s);else if(h.moving){var U=h.lp.y+s,z=Q._tabGap/2;Q._7o.each(function(d){var t=d.endY,g=U-d.startY<t-U;U>=d.startY&&t>=U&&Q._7Q({tab:_.tab,startY:_.startY+s,height:_.height,front:g,insertTab:d.tab,position:g?i(0,d.startY-z):a(Q._23Q,t+z)})})}},handleWindowMouseUp:function(T){this.handleWindowTouchEnd(T)},handleWindowTouchEnd:function(){var O=this,G=O.tv,C=G._tabPosition,F=G.getTabModel(),y=F._roots,Q=O._73o;if(O.moving){var h=G._23o;if(h&&h.insertTab!==h.tab){var D=h.tab,m=y.remove(D),r=y.indexOf(h.insertTab);
r>=0&&(h.front||r++,r<=y.size()&&(y.add(D,r),F._38I(D,m,r)))}G._7Q(I),delete O.moving}else if(!O._25o&&Q){D=Q.tab;var s=O._74o;if(!s||s.tab===D)if(!D.isDisabled()&&An(Q._75o,O.lp)){var T=function(){var v=y.indexOf(D);F.remove(D),G.onTabClosed(D,v)};G.onTabClosing(D,T)&&T()}else D.isDisabled()||G._8o===D||F.sm().ss(D)}O._25o=O._73o=O._74o=C===wg||C===wn?O.x=O.lp=O.tx=I:O.y=O.lp=O.ty=I}}),xt.PropertyView=function(s){var R=this;R._view=nh(1,R),R._canvas=th(R._view),Ik(R._view,R._79O=_k()),R._rows=new Gc,R._28o=new Gc,R._26o={},R._26Q={};var y=R._propertyModel=new Tf,I=R.ivm;y.mm(I,R),y.md(I,R),y.mh(I,R),R.dm(s?s:new Tf),new Et(R)},yt("PropertyView",j,{ms_ac:[Zc,Mg,Dh,ug,Vh,"categorizable",zg,hn,Jo,ye,kq,$k,Hb,$q,"selectRowIndex",Nf,"background",Mr,ch,qm,cp,xo],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Uf,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:as,_background:z.propertyViewBackground,_expandIcon:z.propertyViewExpandIcon,_collapseIcon:z.propertyViewCollapseIcon,_scrollBarColor:Xq,_scrollBarSize:Eh,_autoHideScrollBar:vc,_selectBackground:z.propertyViewSelectBackground,_rowHeight:em,_rowLineVisible:z.propertyViewRowLineVisible,_rowLineColor:z.propertyViewRowLineColor,_10I:.5,_columnLineVisible:z.propertyViewColumnLineVisible,_columnLineColor:z.propertyViewColumnLineColor,_labelColor:z.propertyViewLabelColor,_labelSelectColor:z.propertyViewLabelSelectColor,_labelFont:z.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(x){0>x&&(x=0),x>1&&(x=1);var q=this,g=q._10I;q._10I=x,q.fp("columnPosition",g,x)},getPropertyName:function(E){return E.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(Q,A,p){return p===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(N,u){return u===this._selectRowIndex?this._labelSelectColor:N.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(n){var u=this.getHeight()-this._59I;return u>n&&(n=u),n>0?0:b(n)},isExpanded:function(h){if(!h)return!0;var Z=this._26o[h];return Z?Z.isExpanded:!(this._26Q[h]===!1)},toggle:function(q){var K=this;K.isExpanded(q)?K.collapse(q):K.expand(q)},expandAll:function(){this.validate();for(var Y in this._26o)this.expand(Y)},expand:function(X){if(X&&X!==ne){var J=this,b=J._26o[X];b&&!b.isExpanded&&(b.isExpanded=!0,J.onExpanded(X),J.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var x in this._26o)this.collapse(x)},collapse:function(P){if(P&&P!==ne){var t=this,n=t._26o[P];n&&n.isExpanded&&(n.isExpanded=!1,t.onCollapsed(P),t.ivm())}},onCollapsed:function(){},getCategoryName:function(V){if(!this.isCategorizable())return ne;var F=V.getCategoryName();return F?F:ne},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(x){var q=this,H=q._dataModel;H!==x&&(H&&(H.umd(q.handlePropertyChange,q),q._selectionModel||H.sm().ums(q.handleSelectionChange,q)),q._dataModel=x,x.md(q.handlePropertyChange,q),q._selectionModel?q._selectionModel._21I(x):x.sm().ms(q.handleSelectionChange,q),q.fp(Vi,H,x))},isVisible:function(V){return this._visibleFunc?this._visibleFunc(V):!0},onPropertyChanged:function(d){var X=this,N=d.property;st[N]?X.ivm():X.iv(),N===mg&&X._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:pg},handlePropertyChange:function(D){this._27o===D.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var m=this;m._96I||(m.setSelectRowIndex(-1),m._96I=1,m.iv())},redraw:function(){this.iv()},validateModel:function(){var L=this,M=L._rows,u=L._28o,w={},d=new Gc,K=L._27o;L.updateCurrentData(),K!==L._27o&&L.endEditing(),M.clear(),u.clear(),L.getRawProperties().each(function(V){if(L.isVisible(V)){d.add(V);var G=L.getCategoryName(V);w[G]||(u.add(G,G===ne?0:_),w[G]={isExpanded:L.isExpanded(G),properties:new Gc})}}),L._sortFunc&&d.sort(L._sortFunc);for(var y in L._26o)L._26Q[y]=L.isExpanded(y);L._26o=w,u.each(function(m){m!==ne&&M.add(m);var D=w[m];D.isExpanded&&d.each(function(U){L.getCategoryName(U)===m&&(D.properties.add(U),M.add({property:U,data:L._27o}))},L)})},validateImpl:function(){var d=this;d._76o(),d._96I&&(d.validateModel(),delete d._96I);var u=d._canvas,Q=d.getWidth(),C=d.getHeight(),r=-d.ty(),B=d._rowHeight,q=d._indent,j=Q-q,S=d._rows,F=S.size(),T=d._9I=q+j*d._10I,e=d._59I=F*B;Pq(u,Q,C),d._29I={x:0,y:r,width:Q,height:C},d._31I=k(r/B),d._14I=L((r+C)/B),d._31I<0&&(d._31I=0),d._14I>F&&(d._14I=F);var Y,P=wr(u),X=d._background;Ql(P,0,-r,1),P.beginPath(),P.rect(0,r,Q,C),P.clip(),P.clearRect(0,r,Q,C),d._93db(P),X&&Eq(P,0,0,q,e,X);for(var v=d._31I;v<d._14I;v++){var H=S.get(v),r=B*v;if(Fp(H))X&&Eq(P,q,r,j,B,X),Y=Gj(d.isExpanded(H)?d._expandIcon:d._collapseIcon),Y&&cq(P,Y,og,0,r,q,B),P.save(),P.beginPath(),P.rect(q,r,j,B),P.clip(),d.drawCategoryName(P,H,v,q,r,j,B),P.restore();else{var f=H.property,o=H.data,Y=Gj(f.getIcon()),i=d._selectRowIndex===v?d.getSelectBackground():I;if(Y&&cq(P,Y,og,0,r,q,B),i&&Eq(P,q,r,j,B,i),P.save(),P.beginPath(),P.rect(q,r,T-q,B),P.clip(),d.drawPropertyName(P,f,v,q,r,T-q,B),P.restore(),!d.isEditing(o,f)){var V=T+1,w=Q-T-1;P.save(),P.beginPath(),P.rect(V,r,w,B),P.clip(),d._87o(d.drawPropertyValue(P,f,d.getValue(o,f),v,V,r,w,B,o),v,V,r,w,B),P.restore()}}d._rowLineVisible&&Eq(P,q,r+B-1,j,1,d._rowLineColor)}d._columnLineVisible&&(Eq(P,T,0,1,e,d._columnLineColor),Eq(P,Q-1,0,1,e)),d._92db(P),d._93I(),P.restore(),d.ty(d.ty())},drawCategoryName:function(L,k,q,D,W,F,h){Pr(L,k,this.getCategoryFont(k),this.getCategoryColor(k),D,W,F,h)},drawPropertyName:function(d,u,H,n,K,o,V){return u.drawPropertyName?(u.drawPropertyName(d,u,H,n,K,o,V,this),void 0):(Pr(d,this.getPropertyName(u),this.getPropertyFont(u,H),this.getPropertyColor(u,H),n,K,o,V),void 0)},drawPropertyValue:function(v,E,N,d,m,p,Q,K,e){return E.drawPropertyValue?E.drawPropertyValue(v,E,N,d,m,p,Q,K,e,this):(ut(v,N,E,this.getLabelFont(E,N,d),this.getLabelColor(E,N,d),m,p,Q,K,e,this),void 0)},isPropertyEditable:function(H){return H.isEditable()&&this.isEditable()},setProperties:function(B){this._propertyModel.clear(),this.addProperties(B)},addProperties:function(Y){if(Y){var n=this._propertyModel;Y.forEach(function(e){if(!(e instanceof Bt)){var m=_b(e.className);e=jq(m?m:Bt,e)}n.add(e)})}},getRowIndexAt:function(Q){var K=this,c=k(K.lp(Q).y/K._rowHeight);return c>=0&&c<K._rows.size()?c:-1},getPropertyAt:function(L){var m=this,F=m.getRowIndexAt(L);return F>=0?m._rows.get(F).property:I},getToolTip:function(W){var h=this,w=h.getPropertyAt(W),m=h._27o;return w&&m?w.getToolTip(m,h._9I<h.lp(W).x,h):I}});var Et=function(L){this.pv=L,this.addListeners()};Ag(Et,j,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(S){this.getView().style.cursor=S},clear:function(){var h=this;h._62O=h.cp=h.ty=h.p=I,h.setCursor(hl)},handle_mousedown:function(g){this.handle_touchstart(g)},handle_touchstart:function(S){var T=this,J=T.pv;um(S),J.setFocus(S)&&(Uo(S)?(T.cp=Xe(S),T.ty=J.ty(),T.p=J.getColumnPosition(),T.handle_touchmove(S)):J.setSelectRowIndex(J.getRowIndexAt(S)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(j){this.handle_touchend(j)},handle_touchend:function(l){var Y=this;if(Y.cp&&!Y._62O){var t=Y.pv,W=t.lp(l),g=W.x,p=W.y,k=t._indent,R=t.getRowIndexAt(l),x=t._9I;if(R>=0){var j=t._rowHeight,d=j*R,I=t._rows.get(R),r=I.property;if(Fp(I))Gj(t.isExpanded(I)?t._expandIcon:t._collapseIcon)&&g>=0&&k>=g&&p>=d&&d+j>=p?t.toggle(I):we(l)&&t.toggle(I);else if(g>x&&t.isPropertyEditable(r,l)){var w={x:x+1,y:d,width:t.getWidth()-x-1,height:j},P={x:w.x+t.tx(),y:w.y+t.ty(),width:w.width,height:w.height},X=0,K=t._29I;w.y<K.y?X=w.y-K.y:w.y+j>K.y+K.height&&(X=w.y+j-K.y-K.height),X&&(t.ty(t.ty()-X),P.y-=X),t.beginEditing({data:I.data,property:r,value:t.getValue(I.data,r),event:l,rect:w,editorRect:P,view:t})}}t.setSelectRowIndex(R)}Y.clear()},handleWindowMouseMove:function(z){this.handleWindowTouchMove(z)},handleWindowTouchMove:function(W){var a=this,Q=a.pv,y=a.ty,m=a.cp,k=Xe(W),o=a._62O;if("p"===o)Q.setTranslateY(y+k.y-m.y);else if("c"===o){var w=Q.getWidth()-Q._indent;if(w>16){var K=a.p-(m.x-k.x)/w,O=16/w;O>K&&(K=O),K>1-O&&(K=1-O),Q.setColumnPosition(K)}}else"s"===o&&Q.setTranslateY(y+(m.y-k.y)*Q._59I/Q._29I.height)},handle_mousemove:function(r){this.handle_touchmove(r)},handle_touchmove:function(p){if(!Lq&&Uo(p)){var t=this,R=t.pv,Y=f(R.lp(p).x-R._9I)<=(to?8:3);t.cp?t._62O||(Y?(t._62O="c",Fd(t,p)):f(Xe(p).y-t.cp.y)>=2&&(t._62O=t.isV(p)?"s":"p",Fd(t,p))):(Y?t.setCursor(rh):t.setCursor(hl),t.isV(p)&&R._43o())}},isV:function(m){var O=this.pv,T=O._29I;return O._41o()&&T.x+T.width-O.lp(m).x<_e},handle_mousewheel:function(K){this.handleScroll(K,K.wheelDelta/40)},handle_DOMMouseScroll:function(p){2===p.axis&&this.handleScroll(p,-p.detail)},handleScroll:function(a,I){var Z=this.pv;um(a),Z.endEditing(),Z.translate(0,I*Z.getRowHeight())},handle_keydown:function(K){var g=this.pv,P=g._rows.size(),$=g._selectRowIndex+(mq(K)?-1:1);(mq(K)||si(K))&&(0>$&&($=0),$>=P&&($=P-1),g.setSelectRowIndex($))}}),xt.ListView=function(r){this._5o(r),new Ft(this)},yt("ListView",j,{ms_ac:[Zc,Mg,Dh,Mr,zg,ch,qm,hn,Jo,$k,Hb,$q,Vn,Nf],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:as,_rowHeight:em,_rowLineVisible:z.listViewRowLineVisible,_rowLineColor:z.listViewRowLineColor,_scrollBarColor:Xq,_scrollBarSize:Eh,_autoMakeVisible:Un,_autoHideScrollBar:vc,_selectBackground:z.listViewSelectBackground,_labelColor:z.listViewLabelColor,_labelSelectColor:z.listViewLabelSelectColor,_labelFont:z.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(y){var j=this,u=j._checkMode;j._checkMode=y,j.fp(Jp,u,y)},drawRow:function(n,$,f,v,W,V,w){var U=this,T=0,x=U._indent,F=U.getIconWidth($);U.drawRowBackground(n,$,f,v,W,V,w),U._checkMode&&(Te(n,Gj(U.getCheckIcon($)),T+x/2,W+w/2,$,U),T+=x),U.drawIcon(n,$,T,W,F,w),U.drawLabel(n,$,T+F,W,w)}});var Ft=function(X){this.list=X,this.addListeners()};Ag(Ft,j,{ms_listener:1,getView:function(){return this.list._view},clear:function(c){var y=this,W=y.list;c&&"d"===y._62O&&!y.dragCancel&&W.handleDragAndDrop(c,"end"),W.draggingData&&(W.draggingData=null,W.redraw()),y.dragCancel=y._62O=y._isV=y._isH=y.cp=y.tx=y.ty=I},handle_mousedown:function(c){this.handle_touchstart(c)},handle_touchstart:function(M){var o=this,T=o.list;if(um(M),T.setFocus(M)){var Z=T.getDataAt(M);o.cp=Xe(M),o.tx=T.tx(),o.ty=T.ty(),Uo(M)?Z&&T.handleDragAndDrop&&!o.isV(M)&&!o.isH(M)&&(T.draggingData=Z,T.redraw(),T.handleDragAndDrop(M,"prepare")):(Z?o._33o(M,Z):this._cancelDataDoubleSelect(),o.clear(M))}},handleWindowMouseUp:function(F){this.clear(F)},handleWindowTouchEnd:function(v){this.clear(v)},handle_mouseup:function(f){this.handle_touchend(f)},handle_touchend:function(v){var n=this,r=n.list;if(!n._isV&&!n._isH&&n.cp&&!n._62O){var I=r.getDataAt(v);I?(r.isCheckMode()?n._34o(v,I):n._33o(v,I),we(v)?r.onDataDoubleClicked(I,v):r.onDataClicked(I,v)):(n._cancelDataDoubleSelect(),r.handleBackgroundClick(v))}n.clear(v)},handleWindowMouseMove:function(q){this.handleWindowTouchMove(q)},handleWindowTouchMove:function(M){var k=this,G=k.list,N=k._62O,C=k.tx,p=k.ty,u=k.cp,E=Xe(M),V=G._29I;"p"===N?G.setTranslate(C+E.x-u.x,p+E.y-u.y):"v"===N?G.ty(p+(u.y-E.y)*G._59I/V.height):"h"===N?G.tx(C+(u.x-E.x)*G._91I/V.width):"d"===N&&(k.dragCancel||G.handleDragAndDrop(M,"between"))},handle_mousemove:function(L){this.handle_touchmove(L)},handle_touchmove:function(t){if(!Lq&&Uo(t)){var X=this,B=X.list;if(X._isV=X.isV(t),X._isH=X.isH(t),X.cp){if(!X._62O){if(Hd(Xe(t),X.cp)<2)return;X._isV?X._62O="v":X._isH?X._62O="h":B.draggingData&&!this.dragCancel?(X._62O="d",B.handleDragAndDrop(t,"begin")):X._62O="p",X._62O&&"d"!==X._62O&&B.draggingData&&(B.draggingData=null,B.redraw()),Fd(X,t)}}else X._isV&&B._43o(),X._isH&&B._42o()}},isV:function(m){var F=this.list,i=F._29I;return F._41o()&&i.x+i.width-F.lp(m).x<_e},isH:function(R){var H=this.list,c=H._29I;return H._40o()&&c.y+c.height-H.lp(R).y<_e},handle_mousewheel:function(x){this.handleScroll(x,x.wheelDelta/40,x.wheelDelta!==x.wheelDeltaX)},handle_DOMMouseScroll:function(u){this.handleScroll(u,-u.detail,1)},handleScroll:function(I,o,_){var q=this.list;um(I),q.endEditing&&q.endEditing(),_&&q._41o()?q.translate(0,o*q.getRowHeight()):q._40o()&&q.translate(10*o,0)},handle_keydown:function(F){if(!z.isInput(F.target)){var n,p=this.list,Z=p.sm(),O=p._rows,h=O.size();if(Kf(F))p.selectAll();else if(yq(F))p.handleDelete&&p.handleDelete(F);else if(Li(F))"d"!==this._62O||this.dragCancel||(p.handleDragAndDrop(F,"cancel"),this.dragCancel=!0);else if(Ui(F))p.isCheckMode()&&(n=p.getFocusData(),n&&p.checkData(n));else if(mq(F)||si(F)){var s=p.isCheckMode();if(n=s?p.getFocusData():Z.ld()){var t=p.getRowIndex(n);t>=0&&(mq(F)?0!==t&&(n=O.get(t-1),s?p.setFocusData(n):Z.ss(n)):t!==h-1&&(n=O.get(t+1),s?p.setFocusData(n):Z.ss(n)))}else h>0&&(n=O.get(0),s?p.setFocusData(n):Z.ss(n))}}},_34o:function(m,a){var E=this.list,l=E.lp(m).x;return l>=0&&l<=E._indent?(E.checkData(a),void 0):(E.setFocusData(a),void 0)},_33o:function(O,s){var E=this.list,Y=E.sm(),q=Y.ld();if(!E.canHandleSelectMode(O,s))return this._cancelDataDoubleSelect(),void 0;if(Ro(O))E.isSelected(s)?Y.rs(s):Y.as(s);else if(Io(O))if(q)for(var h=E.getRowIndex(q),I=E.getRowIndex(s);h!==I;)h+=I>h?1:-1,Y.as(E._rows.get(h));else Y.ss(s);else Uo(O)?(Y.contains(s)?E.handleDataDoubleSelect&&(this._handleDataDoubleSelect(O,s),we(O)&&this._cancelDataDoubleSelect()):this._cancelDataDoubleSelect(),Y.ss(s)):Y.contains(s)||Y.ss(s)},_handleDataDoubleSelect:function(r,J){this._cancelDataDoubleSelect(),this._doubleSelectTimer=Nq(function(){this.list.handleDataDoubleSelect(r,J),this._doubleSelectTimer=_}.bind(this),z.doubleClickSpeed)},_cancelDataDoubleSelect:function(){this._doubleSelectTimer&&(np(this._doubleSelectTimer),this._doubleSelectTimer=_)}}),xt.TreeView=function(O){var E=this;E._35o(),E._5o(O),new Gt(E)},yt("TreeView",j,{ms_ac:[Zc,Mg,Dh,"rootVisible",Jp,"rootData",hn,Jo,$k,Hb,$q,zg,Mr,ch,qm,ye,kq,Vn,Nf,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:I,_indent:as,_rowHeight:em,_rowLineVisible:z.treeViewRowLineVisible,_rowLineColor:z.treeViewRowLineColor,_scrollBarColor:Xq,_scrollBarSize:Eh,_autoHideScrollBar:vc,_expandIcon:z.treeViewExpandIcon,_collapseIcon:z.treeViewCollapseIcon,_autoMakeVisible:Un,_selectBackground:z.treeViewSelectBackground,_labelColor:z.treeViewLabelColor,_labelSelectColor:z.treeViewLabelSelectColor,_labelFont:z.treeViewLabelFont,_doubleClickToToggle:z.treeViewDoubleClickToToggle,drawRow:function(Y,m,A,Z,a,O,V){var F=this;F.drawRowBackground(Y,m,A,Z,a,O,V),F.drawTree(Y,m,A,0,a,O,V)},isOnToggleIcon:function(f){var t=this.getDataAt(f);if(t){var m=this.getIndent(),X=this.lp(f).x;if(Gj(this.getToggleIcon(t))){var k=m*this.getLevel(t);if(X>=k&&k+m>=X)return!0}}return!1}});var Gt=function(z){nk(Gt,this,[z])};Ag(Gt,Ft,{toggle:function(g,s,N,y){var j=this.list,u=j.lp(g).x;if(Gj(j.getToggleIcon(s))){var C=N*y;if(u>=C&&C+N>=u)return j.toggle(s),!0}return j.isDoubleClickToToggle()&&we(g)?(j.toggle(s),!0):!1},_34o:function(t,j){var O=this.list,S=O.lp(t).x,G=O._levelMap[j._id],h=O._indent,L=h*(G+1);return S>=L&&L+h>=S?(O.checkData(j),void 0):(this.toggle(t,j,h,G)||O.setFocusData(j),void 0)},_33o:function(B,q){var T=this,I=T.list;if(!T.toggle(B,q,I._indent,I.getLevel(q)))if(Io(B)){var K=I.sm();if(K.size()>0){for(var f=I._rows,O=null,o=0,D=f.size();D>o;o++)if(I.isSelected(f.get(o))){O=o;break}for(var W=null,o=f.size()-1;o>=0;o--)if(I.isSelected(f.get(o))){W=o;break}var i,V,R=I.getRowIndex(q);for(O>R?(i=R-1,V=O):R>W?(i=W,V=R):(i=O,V=W);i!==V;)i++,K.as(I._rows.get(i))}else K.ss(q)}else Gt.superClass._33o.call(T,B,q)},handle_keydown:function(c){if(li(c)||ar(c)){var U=this.list,y=U._rows,G=U.isCheckMode(),R=U.sm(),M=G?U.getFocusData():R.ld();M?M.hasChildren()&&(li(c)?U.collapse(M):U.expand(M)):y.size()>0&&(M=y.get(0),G?U.setFocusData(M):R.ss(M))}else Gt.superClass.handle_keydown.call(this,c)}});var Ht=xt.TableView=function(T){this._98I(),this._5o(T),new It(this)};yt("TableView",j,{ms_ac:[Zc,Mg,Dh,"sortMode",ug,Vh,Mr,ch,qm,cp,xo,"sortColumn",hn,Jo,$k,Hb,$q,Vn,Nf],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:bc,_editable:!0,_batchEditable:!1,_rowHeight:em,_rowLineVisible:z.tableViewRowLineVisible,_rowLineColor:z.tableViewRowLineColor,_columnLineVisible:z.tableViewColumnLineVisible,_columnLineColor:z.tableViewColumnLineColor,_scrollBarColor:Xq,_scrollBarSize:Eh,_autoHideScrollBar:vc,_autoMakeVisible:Un,_selectBackground:z.tableViewSelectBackground,_labelColor:z.tableViewLabelColor,_labelSelectColor:z.tableViewLabelSelectColor,_labelFont:z.tableViewLabelFont,getCheckColumn:function(){var i=this;if(!i._31o){var X=i._31o=new At;X.setEditable(!0),X.setWidth(40),X.getValue=i.getCheckColumValue,X.drawCell=i.drawCheckColumnCell}return i._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(O){var h=this,y=h._39o,t=h.getCheckColumn();O!==h.isCheckMode()&&(O?y.add(t,0):y.remove(t),h.fp(Jp,!O,O))},getCheckColumValue:function(O,z,D){return D.isSelected(O)},drawCheckColumnCell:function(t,D,e,y,Z,v,a,I,f){Te(t,f.getCheckIcon(D),Z+a/2,v+I/2,D,f)}});var It=function(i){nk(It,this,[i])};Ag(It,Ft,{_34o:function(U,x){var C=this.list,A=C._31o;if(C.isCellEditable(x,A,U)){var R=C._3Q(A),t=C.lp(U).x;if(R&&t>=R.startX&&t<R.startX+A.getWidth())return C.checkData(x),void 0}C._37O(x,U),C.setFocusData(x)},_33o:function(D,M){this.list._37O(M,D),It.superClass._33o.apply(this,arguments)}});var Jt=xt.TreeTableView=function(J){var D=this,m=D._4o=new At;D._35o(),D._98I(),D._5o(J),m.setDisplayName("Name"),m.setEditable(!0),m.setWidth(180),m.drawCell=Kt,m.getValue=Lt,D._39o.add(m),new Mt(D)},Kt=function(N,n,A,v,V,z,X,G,H){H.drawTree(N,n,A,V,z,X,G)},Lt=function(i,H,m){return m.getLabel(i)};yt("TreeTableView",j,{ms_ac:[Zc,Mg,Dh,"sortMode",ug,Vh,zg,Jp,"rootData","rootVisible",hn,Jo,"sortColumn",ye,kq,$k,Hb,$q,Vn,qm,Mr,ch,cp,xo,Nf,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:bc,_checkMode:I,_editable:!0,_batchEditable:!1,_indent:as,_rowHeight:em,_rowLineVisible:z.treeTableViewRowLineVisible,_rowLineColor:z.treeTableViewRowLineColor,_columnLineVisible:z.treeTableViewColumnLineVisible,_columnLineColor:z.treeTableViewColumnLineColor,_expandIcon:z.treeTableViewExpandIcon,_collapseIcon:z.treeTableViewCollapseIcon,_scrollBarColor:Xq,_scrollBarSize:Eh,_autoHideScrollBar:vc,_autoMakeVisible:Un,_selectBackground:z.treeTableViewSelectBackground,_labelColor:z.treeTableViewLabelColor,_labelSelectColor:z.treeTableViewLabelSelectColor,_labelFont:z.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Mt=function(Q){nk(Mt,this,[Q])};Ag(Mt,Ft,{_34o:function(M,l){var S=this.list,h=S._4o,I=S._3Q(h),L=S.lp(M).x;if(I){var P=S._indent,A=I.startX+P*S.getLevel(l);if(Gj(S.getToggleIcon(l))&&L>=A&&A+P>=L)return S.toggle(l),void 0;if(S.isCellEditable(l,h)&&(A+=P,L>=A&&A+P>=L))return S.checkData(l),void 0}S._37O(l,M),S.setFocusData(l)},_33o:function(R,B){var f=this.list,e=f.lp(R).x;if(Gj(f.getToggleIcon(B))){var m=f._3Q(f._4o);if(m){var V=f._indent,X=m.startX+V*f.getLevel(B);if(e>=X&&X+V>=e)return f.toggle(B),void 0}}f._37O(B,R),Mt.superClass._33o.apply(this,arguments)}});var Nt=xt.TableHeader=function(L){var K=this,v=K._view=nh(1,K),e=K._39o=L.getColumnModel(),G=K.iv;K.tv=K._tableView=L,K._60I=new Gc,K._canvas=th(v),v.style.background=z.tableHeaderBackground||"",v.style.height=wm+pn,e.mm(G,K),e.md(G,K),e.mh(G,K),L.mp(function(h){ot[h.property]&&K.iv()},K),new Ot(K),K.iv()};yt("TableHeader",j,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Zc,Dh,zg,"moveBackground","insertColor",cp,xo,"resizable","movable"],_checkIcon:Qn,_movable:!0,_resizable:!0,_labelColor:z.tableHeaderLabelColor,_labelFont:z.tableHeaderLabelFont,_columnLineColor:z.tableHeaderColumnLineColor,_columnLineVisible:z.tableHeaderColumnLineVisible,_sortDescIcon:z.tableHeaderSortDescIcon,_sortAscIcon:z.tableHeaderSortAscIcon,_moveBackground:z.tableHeaderMoveBackground,_insertColor:z.tableHeaderInsertColor,_indent:as,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(E){return E.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(H){return H.getColor()||this._labelColor},getLabelAlign:function(m){return m._align},onPropertyChanged:function(){this.iv()},_5Q:function(T){this._61I=T,this.iv()},getLogicalPoint:function(p){return Qe(p,this._canvas,this.tv.tx())},validateImpl:function(){var h=this,z=h._canvas,s=h.getWidth(),t=h.getHeight(),E=h.tv,C=h._60I,m=h._61I,D=-E.tx(),f=0;(s!==z.clientWidth||t!==z.clientHeight)&&Pq(z,s,t),C.clear(),h._39o._roots.each(function(q){if(q.isVisible()){var $=f+q.getWidth();D+s>=f&&$>=D&&C.add({column:q,startX:f}),f=$}});var a=wr(z);if(Ql(a,-D,0,1),a.beginPath(),a.rect(D,0,s,t),a.clip(),a.clearRect(D,0,s,t),C.each(function(P){var X=P.column,b=P.startX,K=X.getWidth();K>0&&(a.save(),a.beginPath(),a.rect(b,0,K,t),a.clip(),m&&m.column===X||h.drawColumn(a,X,b,0,K,t),h._columnLineVisible&&Eq(a,b+K-1,0,1,t,h._columnLineColor),a.restore())}),m){var Q=m.column,f=m.startX,P=m.position,W=Q.getWidth();a.save(),a.beginPath(),a.rect(f,0,W,t),a.clip(),a.fillStyle=h._moveBackground,a.fill(),h.drawColumn(a,Q,f,0,W,t),a.restore(),Cg(a,h._insertColor,P,0,t)}a.restore()},_6Q:function(n){var T=this.tv;return T._31o===n&&T.sm().getSelectionMode()===rj},drawColumn:function(W,N,M,n,s,V){var t=this,S=t.tv,y=Gj(N.getIcon()),$=t.getLabelAlign(N);if(t._6Q(N)){var F=Gj(t._checkIcon);Te(W,F,M+s/2,n+V/2,N,t)}else{var Q=t.getLabel(N),D=t.getLabelFont(N),R=t.getLabelColor(N),e=me(D,Q).width,U=y?t._indent:0;$===iq?(y&&cq(W,y,og,M,n,U,V),Pr(W,Q,D,R,M+U,n,s,V,iq)):$===bq?(y&&cq(W,y,og,M+s-e-U,n,U,V),Pr(W,Q,D,R,M,n,s,V,bq)):(y&&cq(W,y,og,M+(s-e-U)/2,n,U,V),Pr(W,Q,D,R,M+(s-e+U)/2,n,0,V,iq))}if(N.isSortable()&&S.getSortColumn()===N&&(y=Gj(N.getSortOrder()===de?t._sortAscIcon:t._sortDescIcon))){var k=bi(y,N)/2+2;Te(W,y,$===bq?M+k:M+s-k,n+V/2,N,S)}}});var Ot=function(k){var G=this;G.th=k,G.tv=k._tableView,G.addListeners()};Ag(Ot,j,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(e){this.getView().style.cursor=e},handle_mousemove:function(K){if(!Lq){var w=this;delete w._29o,w.setCursor(hl);for(var k=w.th,h=k._60I,m=k.lp(K).x,I=h.size()-1;I>=0;I--){var F=h.get(I),q=F.column,L=F.startX+q.getWidth();if(k.isResizable()&&f(L-m)<=(to?10:3))return w._29o=F,w.setCursor(rh),void 0;m>F.startX&&L>m&&(w._29o=F),(q.isClickable()||q.isSortable()||k.isMovable()||w.tv.getCheckColumn&&q===w.tv.getCheckColumn())&&m>F.startX&&L>m&&w.setCursor(yn)}}},handle_mousedown:function(h){this.handle_touchstart(h)},handle_touchstart:function(s){var L=this;um(s),L.tv.endEditing(),L.handle_mousemove(s),L._29o&&(L.x=Xe(s).x,L.lx=L.th.lp(s).x,L.w=L._29o.column.getWidth(),Fd(L,s))},handleWindowMouseMove:function(Y){this.handleWindowTouchMove(Y)},handleWindowTouchMove:function(H){var B=this,a=B.th,F=B.getView().style.cursor,m=B._29o,l=Xe(H).x-B.x;if(B.resizing||B.moving||(F===rh?B.resizing=1:a.isMovable()&&F===yn&&f(l)>2&&(B.moving=1)),B.resizing)m.column.setWidth(B.w+l);else if(B.moving){var O=B.lx+l;a._60I.each(function(A){var k=A.startX,h=k+A.column.getWidth();if(O>=k&&h>=O){var c={column:m.column,startX:m.startX+l,front:h-O>O-k,insertColumn:A.column};c.position=c.front?k:h,a._5Q(c)}})}},_16Q:function(q,T){var m=this,K=m.tv,_=m.th,F=_._checkIcon;if(_._6Q(q)){var o=Gj(F),e=m.lx,h=q.getWidth(),y=bi(o,q);if(e>=T+h/2-y&&T+h/2+y>=e){_.setCheckIcon(F===es?Qn:es);var O=K.sm(),z=K._rows;return F===es?O.rs(z):O.ss(z),K.onCheckColumnClicked(q),!0}}return!1},handleWindowMouseUp:function(N){this.handleWindowTouchEnd(N)},handleWindowTouchEnd:function(u){var b=this,m=b.tv,V=b.th,Z=b._29o;if(b.moving){var i=V._61I;if(i&&i.insertColumn!==i.column){var F=i.column,l=m.getColumnModel()._roots,J=l.remove(F),v=l.indexOf(i.insertColumn);v>=0&&(i.front||v++,v<=l.size()&&(l.add(F,v),m.getColumnModel()._38I(F,J,v)))}V._5Q(I),delete b.moving}else if(!b.resizing&&Z){F=Z.column;var P=V.lp(u).x,p=Z.startX,M=!0;if(V.onColumnClicked){var n=V.onColumnClicked(F,u,p);n===!1&&(M=!1)}if(M&&P>=p&&P<=p+F.getWidth()&&!b._16Q(F,p)){if(F.isSortable()){var N=m.getSortMode(),j=F.getSortOrder();N===bc?m.getSortColumn()===F?(j===gn&&m.setSortColumn(I),F.setSortOrder(j===de?gn:de)):m.setSortColumn(F):"bistate"===N&&(m.getSortColumn()===F?F.setSortOrder(j===de?gn:de):m.setSortColumn(F))}m.onColumnClicked(F,u,p)}}b._29o=b.resizing=b.x=b.lx=b.w=I}}),xt.TablePane=function(P){this.init(new Ht(P))},yt("TablePane",j,{ms_v:1,_44o:1}),xt.TreeTablePane=function(N){this.init(new Jt(N))},yt("TreeTablePane",j,{ms_v:1,_44o:1}),xt.Toolbar=function(_){var A=this,M=A._view=nh(1,A),u=M.style;u.background=z.toolbarBackground||"",u.height=Bb+pn,A._canvas=th(M),A._30o=new Gc,A._90I=new Gc,A.setItems(_||[]),M.handleGroupSelectedChanged=function(F){if(F.isSelected()){var E=F.getGroupId();null!=E&&A._items.forEach(function(P){var D=P.element;D&&D!==F&&D.setSelected&&D.getGroupId&&D.getGroupId()===E&&D.setSelected(!1)})}},new Pt(A)},yt("Toolbar",j,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[vn,Zc,Dh,Mg,Nf,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:z.toolbarLabelColor,_labelSelectColor:z.toolbarLabelSelectColor,_labelFont:z.toolbarLabelFont,_selectBackground:z.toolbarSelectBackground,_itemGap:z.toolbarItemGap,_separatorColor:z.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(i){var L=this.getItemInfoAt(i);return L?L.item.toolTip:I},getLabelColor:function(e){return e&&e.selected&&e.type!==es&&e.type!==Gn?this._labelSelectColor:this._labelColor},onPropertyChanged:function(T){this.iv(),T.property===vn&&this._items.forEach(function(S){uk(S)})},redraw:function(){this.iv()},addItem:function(Z,i){var H=this._items;i==I?H.push(Z):H.splice(i,0,Z),this.fp(vn,I,H)},removeItem:function(s){if(s)for(var W=this._items,C=0;C<W.length;C++)s===W[C]&&(W.splice(C,1),this.fp(vn,I,W))},removeItemById:function(G){if(G!=I)for(var o=this._items,l=0;l<o.length;l++)if(G===o[l].id){var H=o.splice(l,1)[0];return this.fp(vn,I,o),H}},getItemById:function(h){if(h!=I)for(var H=this._items,i=0;i<H.length;i++){var x=H[i];if(h===x.id)return x}},setItemVisible:function(y,X){var Q=this.getItemById(y);Q&&(Q.visible=X)},getItemInfos:function(){return this._30o},getItemInfoAt:function(e){var L=this,g=0,u=L._30o,D=L.lp(e),R=D.x,S=D.y;if(S>=0&&S<=L.getHeight())for(;g<u.size();g++){var y=u.get(g);if(y.startX<=R&&R<=y.endX)return y}return I},drawItem:function(z,q,c,t,T){if(q.visible===!1)return 0;if(gg(q.visible)&&!q.visible())return 0;var n=this,r=q.disabled;r&&(z.globalAlpha=If);var v=n.drawItemImpl(z,q,c,t,T),V=n._itemGap;return r&&(z.globalAlpha=1),this._currentItem!==q||"separator"===q||q.separator===!0||q.unfocusable||ko(z,n._separatorColor,c-V/2,0,v+V,t),v},drawItemImpl:function(S,t,o,U,l){var V=this,p=V._view,n=V._itemGap,B=U/2,q=t.type,R=t.element,e=t.label;Fp(R)&&(e=R,R=I);var k,P=V.getLabelFont(t),J=V.getLabelColor(t),s=t.selected,m=Gj(t.icon),T=bi(m,t),O=0,z=T+(e?me(P,e).width:0);if("separator"===t||t.separator===!0)return Cg(S,V._separatorColor,o,U/4,B),1;if(R){m&&Te(S,m,o+T/2,B,t,V),Pr(S,e,P,J,o+T,0,0,U);var A=Nb(R);l||V._90I.add(A),A.parentNode!==p&&Ik(p,A),R.iv&&R.iv(),R.validate&&R.validate();var c=A.getBoundingClientRect(),g=c.width,N=A.style;return oe(A),N.left=V.tx()+o+z+pn,N.top=(U-c.height)/2+pn,z+g}return q===Gn?k=Gj(s?Fm:dr):q===es&&(k=Gj(s?es:Qn)),k?(O=bi(k,t),Te(S,k,o+O/2,B,t,V),o+=O,z+=O):s&&Eq(S,o-n/2,0,z+n,U,V.getSelectBackground(t)),m&&Te(S,m,o+T/2,B,t,V),Pr(S,e,P,J,o+T,0,0,U),z},validateImpl:function(){var X=this,r=X._canvas,s=X.getWidth(),G=X.getHeight(),S=X._30o,t=X._items;Pq(r,s,G);var w=wr(r),T=X._itemGap,B=T/2;Ql(w,X.tx(),0,1),w.clearRect(0,0,s,G);var O=X._90I;X._90I=new Gc,S.clear(),t.forEach(function(J){var o=X.drawItem(w,J,B,G);S.add({item:J,startX:B,endX:B+o,width:o}),o&&(B+=o+T)}),O.each(function(r){X._90I.contains(r)||Hj(r)});var n=X._64I;X._64I=i(0,B-T/2),w.restore(),X._stickToRight?(X._65O=0,w=wr(r),B=s-X._64I+T/2,Ql(w,0,0,1),w.clearRect(0,0,s,G),S.clear(),t.forEach(function(M){var V=X.drawItem(w,M,B,G,!0);S.add({item:M,startX:B,endX:B+V,width:V}),V&&(B+=V+T)}),w.restore()):X.tx(X.tx()),n!==X._64I&&X.onSumWidthChanged(n,X._64I)},onSumWidthChanged:function(){},handleClick:function(q,H){var B=this,W=q.type,e=q.action,d=q.groupId,l=q.selected;q.disabled||(d!=I?l||(q.selected=!0,this._items.forEach(function(O){O.groupId===d&&q!==O&&(O.selected=!1)}),e&&q.action(q,B,H)):W===es||"toggle"===W?(q.selected=!l,e&&q.action(q,B,H)):e&&q.action(q,B,H)),Tk(),B.iv()}});var Pt=function(I){this.tb=I,this.addListeners()};Ag(Pt,j,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(L){this.handleScroll(L,10*(L.wheelDelta/40))},handle_DOMMouseScroll:function(C){this.handleScroll(C,10*-C.detail)},handleScroll:function(F,J){um(F);var $=this.tb;$.isScrollable()&&!$._stickToRight&&($.tx($.tx()+J),Vl())},handle_mousemove:function(W){var t=this;Lq||t.setItem(W)},handle_mouseout:function(p){var M=this;p.target===M.getView()?M.tb.setCurrentItem(I):M.handle_mousemove(p)},handle_mousedown:function(A){this.handle_mousemove(A),this.handle_touchstart(A)},handle_touchstart:function(V){var J=this,F=J.tb,z=V.target;Uo(V)&&(z===J.getView()||z===F._canvas)&&(um(V),F.setFocus(V)&&(this.setItem(V,!0),(F.isScrollable()||J.info&&!J.info.item.disabled)&&(J.x=Xe(V).x,J.tx=F.tx(),Fd(J,V))))},handleWindowMouseMove:function(e){this.handleWindowTouchMove(e)},handleWindowTouchMove:function(d){var Y=this,t=Y.tb;if(!t._stickToRight){var S=Xe(d).x-Y.x;!Y._25o&&f(S)>2&&t.isScrollable()&&(Y._25o=1),Y._25o&&t.tx(Y.tx+S)}},handleWindowMouseUp:function(B){this.handleWindowTouchEnd(B)},handleWindowTouchEnd:function(P){var M=this,d=M.tb,Z=M.info,j=M.tb.getItemInfoAt(P);if(!M._25o&&Z){var q=Z.item;j&&j.item===q&&d.handleClick(q,P)}M._25o=M.x=M.tx=I,M.setItem()},setItem:function(B,L){var d=this,e=d.tb,U=d.info=B?e.getItemInfoAt(B):I,F=U?U.item:I;e.setCurrentItem(F),L&&F&&gg(F.onDown)&&F.onDown(B)}}),xt.BorderPane=function(){this._view=nh(1,this),this.iv()},yt("BorderPane",j,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(i,Q){this._12o("leftView",i),Q!=I&&this.setLeftWidth(Q)},getRightView:function(){return this._rightView},setRightView:function(b,O){this._12o("rightView",b),O!=I&&this.setRightWidth(O)},getTopView:function(){return this._topView},setTopView:function(e,b){this._12o("topView",e),b!=I&&this.setTopHeight(b)},getBottomView:function(){return this._bottomView},setBottomView:function(C,p){this._12o("bottomView",C),p!=I&&this.setBottomHeight(p)},getCenterView:function(){return this._centerView},setCenterView:function(Q){this._12o("centerView",Q)},_12o:function(M,X){var f=this,C="_"+M,F=f._view,t=f[C];t!==X&&(t&&(t.getView?Hj(t.getView()):Hj(t)),f[C]=X,X&&(X.getView?Ik(F,X.getView(),1):Ik(F,X,1)),f.fp(M,t,X))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var A=this,h=A._topView,V=A._bottomView,Y=A._leftView,x=A._rightView,w=A._centerView,G=A.getWidth(),l=A.getHeight(),o=0,b=0,j=G,p=l,D=0,U=0,C=0,X=0;
h&&(D=A._topHeight==I?zi(h):A._topHeight,b=D),V&&(U=A._bottomHeight==I?zi(V):A._bottomHeight,p=l-U),Y&&(C=A._leftWidth==I?qr(Y):A._leftWidth,o=C),x&&(X=A._rightWidth==I?qr(x):A._rightWidth,j=G-X);var m=i(0,j-o),t=i(0,p-b);h&&zb(h,0,0,G,D),V&&zb(V,0,p,G,U),Y&&zb(Y,0,b,C,t),x&&zb(x,j,b,X,t),w&&zb(w,o,b,m,t)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);